---
url: https://code.visualstudio.com/docs/python/tutorial-fastapi
session_id: fast_api
chunk_number: 15
title: FastAPI Item Management with Redis
summary: This section provides an example of setting up a FastAPI application that utilizes Redis for managing items. It includes a route for adding items where the quantity needs to be greater than zero, and checks if the item already exists in the database. If the item exists, the quantity is incremented; if not, a new item ID is generated and stored in Redis.
embedding: [-0.03426634520292282, -0.003888099454343319, 0.009825126267969608, -0.04100288078188896, 0.005420235451310873, -0.03336651995778084, -0.00015760253882035613, 0.0411001592874527, 0.021693101152777672, 0.0017327729146927595, 0.023249557241797447, -0.011503180488944054, 0.013473070226609707, -0.07154832035303116, 0.025219446048140526, 0.002655398566275835, 0.0062805418856441975, 0.028137801215052605, -0.02151070535182953, 0.05476778745651245, 0.042826853692531586, 0.008189632557332516, 0.01160653866827488, -0.009539371356368065, -0.008736823685467243, -0.022592928260564804, 0.007551242131739855, 0.05000114068388939, -0.01498088613152504, -0.07757958769798279, 0.0006623296649195254, -0.008444988168776035, -0.003149390919134021, 0.02996177226305008, 0.0012144610518589616, -0.0147376898676157, 0.008858421817421913, 0.016999414190649986, 0.035360727459192276, -0.016561660915613174, 0.006991890724748373, -0.039981454610824585, 0.021206708624958992, -0.0032770689576864243, 0.01692645624279976, 0.044042833149433136, -0.033220600336790085, 0.013667627237737179, -0.03531209006905556, -0.01185581460595131, 0.0008823462412692606, -0.0033196283038705587, -0.07106193155050278, 0.0006961491308175027, 0.0022997241467237473, -0.010281119495630264, -0.036819905042648315, 0.024307461455464363, -0.039981454610824585, 0.017911400645971298, 0.026727262884378433, -0.012257088907063007, -0.01641574315726757, 0.0044930498115718365, -0.034120429307222366, 0.0014766569947823882, -0.0032740288879722357, 0.05505961924791336, -0.05053617060184479, 0.033463798463344574, 0.002111247042194009, -0.034606821835041046, -0.01934625767171383, -0.05724838748574257, 0.032223496586084366, -0.053454525768756866, 0.013594668358564377, 0.0478610135614872, 0.00786131713539362, -0.049855221062898636, -0.07577993720769882, -0.0014204178005456924, -0.003255789168179035, -0.02726229466497898, 0.008001155219972134, -0.05136303976178169, -0.0927550345659256, -0.011284303851425648, 0.04618296027183533, -0.04749621823430061, -0.028064841404557228, 0.023821068927645683, 0.025657199323177338, 0.022799644619226456, 0.0005840508965775371, -0.009490732103586197, 0.01573479361832142, 0.0025566001422703266, -0.010572955012321472, 0.06576025485992432, 0.08117889612913132, -0.008748983964323997, -0.0017859721556305885, -0.029329461976885796, 0.03954370319843292, -0.022811803966760635, 0.006016066297888756, 0.024951931089162827, -0.03956802189350128, -0.06945683807134628, -0.06882452964782715, -0.027481170371174812, 0.024781692773103714, -0.021778220310807228, -0.012348287738859653, 0.033682674169540405, 0.0027952364180237055, -0.011557899415493011, 0.029864493757486343, -0.05530281737446785, 0.007624201010912657, 0.02604631334543228, -0.016367103904485703, -0.05812389403581619, -0.042121581733226776, -0.029353782534599304, 0.04438330605626106, -0.03091023862361908, -0.002436521928757429, -0.026678623631596565, 0.04496697708964348, 0.004225533921271563, 0.06366876512765884, -0.033001724630594254, -0.008846261538565159, 0.011539660394191742, -0.033439479768276215, -0.008013314567506313, -0.024015625938773155, 0.020355522632598877, 0.008140993304550648, -0.0684354156255722, -0.030253607779741287, -0.014202658087015152, 0.0008907060837373137, -0.047715093940496445, -0.02003936655819416, -0.00724116712808609, -0.007934276014566422, 0.01472553052008152, 0.05097392573952675, 0.05004977807402611, -0.008274750784039497, -0.04182974621653557, 0.015746954828500748, -0.004787925165146589, 0.0521899051964283, 0.008256510831415653, 0.010633754543960094, -0.03674694523215294, -0.0551568977534771, 0.003754341509193182, -0.04331324249505997, -0.060750413686037064, -0.0031767503824084997, -0.015418639406561852, -0.0062562222592532635, -0.034631140530109406, -0.026435427367687225, -0.05048753321170807, -0.006003906484693289, -0.004085696302354336, 0.030837278813123703, -0.023480594158172607, -0.04535609111189842, 0.000883866217918694, -0.006894612219184637, 0.0001282479934161529, 0.03241805359721184, -0.013120435178279877, -0.027675727382302284, -0.05136303976178169, -0.07164560258388519, 0.020464960485696793, -0.006055585574358702, -0.04039489105343819, 0.015138964168727398, 0.013655466958880424, -0.030059050768613815, 0.03241805359721184, -0.00512536009773612, 0.01858019083738327, -0.05413547530770302, 0.008408509194850922, 0.0032983485143631697, -0.013083956204354763, 0.03351243585348129, -0.010639834217727184, 0.0015777354128658772, 0.0396166630089283, -0.007453963626176119, 0.05632423982024193, -0.006487258709967136, -0.0037239419762045145, 0.02221597358584404, -0.06522522121667862, -0.03470410034060478, 0.0038333802949637175, -0.0375981330871582, -0.014287777245044708, -0.015442959032952785, -0.03788996860384941, -0.025024889037013054, 0.04209726303815842, 0.0035689042415469885, 0.011454541236162186, -0.011284303851425648, 0.03448522090911865, 0.02896466851234436, 0.050098419189453125, -0.053454525768756866, 0.012123330496251583, 0.03820612281560898, -0.022276772186160088, 0.026167912408709526, 0.017960039898753166, 0.022337570786476135, -0.030083371326327324, -0.005778949707746506, 0.014336416497826576, 0.0067486949265003204, 0.011630858294665813, 0.01688997633755207, 0.01350954920053482, 0.07704456150531769, -0.0001718523126328364, -0.013594668358564377, -0.030740000307559967, 0.0032740288879722357, 0.06123680621385574, -0.026240870356559753, -0.0036996223498135805, -0.01185581460595131, -0.025195127353072166, 0.0478610135614872, 0.00023084640270099044, -0.03064272180199623, -0.0740775614976883, 0.0324423722922802, 0.034898657351732254, 0.06663575768470764, -0.03553096577525139, 0.03628487512469292, -0.04876083880662918, 0.010931669734418392, -0.06911636143922806, 0.0065298182889819145, -0.025657199323177338, 0.015321360900998116, 0.027456851676106453, -0.038011565804481506, 0.0152119230479002, -0.0047423262149095535, 0.015746954828500748, 0.011661258526146412, 0.021401265636086464, 0.008986099623143673, 0.034120429307222366, -0.02852691523730755, -0.02777300588786602, -0.007040529977530241, 0.0333908386528492, 0.02898898720741272, -0.01713317260146141, 0.004158655181527138, 0.006925011985003948, -0.0010875430889427662, -0.03314764425158501, 0.039932817220687866, -0.028332358226180077, -0.004316732753068209, -0.0521899051964283, 0.01646438241004944, 0.028453955426812172, 0.013375791721045971, 0.02706773765385151, 0.0005563113372772932, 0.017254771664738655, 0.03188302367925644, -0.001823971513658762, -0.01662246137857437, 0.010670233517885208, -0.019151700660586357, -0.042340461164712906, 0.01910306140780449, 0.01338795106858015, -0.0015146563528105617, 0.022580767050385475, -0.0023331635165959597, 0.0023605232127010822, 0.06507930159568787, 0.05914531648159027, 0.01620902679860592, 0.03373131528496742, -0.012609723024070263, -0.012190209701657295, -0.007691080216318369, -0.004699766635894775, 0.05836708843708038, 0.0064446995966136456, 0.004125215578824282, 0.02804052270948887, 0.021826859563589096, -0.023504912853240967, -0.025268085300922394, 0.013120435178279877, 0.0064203799702227116, -0.0115943793207407, 0.016756217926740646, -0.03088591806590557, 0.007636360824108124, -0.0022799645084887743, 0.01688997633755207, 0.005058480892330408, -0.02485465258359909, -0.03966530039906502, 0.0007151488680392504, -0.025705838575959206, -0.006274462211877108, -0.022763164713978767, 0.03557960316538811, 0.00845714844763279, 0.009265775792300701, 0.014713370241224766, 0.013643307611346245, 0.0003712541947606951, 0.023504912853240967, 0.03861955925822258, 0.06862997263669968, 0.04054080694913864, 0.039008673280477524, 0.003982337657362223, -0.0037634612526744604, 0.0010396637953817844, -0.046450477093458176, 0.06123680621385574, 0.032028939574956894, 0.06629528850317001, -0.048663560301065445, 0.0012988197850063443, 0.010226400569081306, 0.01195917371660471, 0.04255933687090874, -0.006149824243038893, -0.01741284877061844, -0.01956513524055481, -0.034606821835041046, -0.010718872770667076, -0.05150895565748215, -0.023225238546729088, -0.04146495461463928, 0.018215395510196686, -0.01907874271273613, 0.0062440624460577965, 0.0033561077434569597, -0.0017768522957339883, 0.01013520173728466, -0.04666935279965401, -0.07830917835235596, -0.003733061719685793, 0.04776373505592346, 0.03543368726968765, -0.022848283872008324, -0.01208077184855938, -0.06498202681541443, 0.0018178916070610285, 0.0019106102408841252, 0.024027785286307335, 0.02176606096327305, -0.02200925722718239, 0.033950190991163254, 0.011807175353169441, -0.023590032011270523, 0.012275328859686852, 0.06478746980428696, 0.017583085224032402, -0.005538793746381998, 0.022143013775348663, -0.016573822125792503, 0.009496811777353287, 0.02194845676422119, -0.04066240414977074, 0.03881411626935005, 0.034606821835041046, 0.03110479563474655, -0.02097567357122898, 0.018543710932135582, 0.025414003059267998, 0.05170351266860962, 0.01715749315917492, 0.004748405888676643, -0.00809843372553587, -0.0342177078127861, 0.008536187000572681, 0.013096115551888943, 0.0012965397909283638, 0.0511198416352272, 0.018640989437699318, 0.005742470268160105, -0.032199177891016006, 0.0022769244387745857, 0.015357840806245804, 0.024088583886623383, 0.011746376752853394, -0.027967562898993492, -0.007666760589927435, -0.011418062262237072, -0.005453675054013729, -0.03553096577525139, -0.035166170448064804, -0.0007926676189526916, -0.061917755752801895, -0.007885636761784554, -0.012317887507379055, -0.02536536380648613, 0.01074319239705801, 0.04107584059238434, -0.02966993674635887, -0.014421534724533558, 0.017303410917520523, -0.042364779859781265, -0.044796742498874664, 0.001731252996250987, 0.01038447767496109, 0.03713605925440788, -0.008840181864798069, -0.03574984148144722, 0.011199185624718666, -0.0016172548057511449, -0.04659639298915863, 0.009217136539518833, -0.057588860392570496, -0.01741284877061844, 0.052724938839673996, -0.049174271523952484, -0.018057318404316902, -0.012427326291799545, -0.011320783756673336, 0.028064841404557228, 0.04825012758374214, -0.004313692916184664, -0.025778798386454582, -0.054719146341085434, 0.024210182949900627, -0.027359573170542717, -0.04613431915640831, 0.0032588292378932238, -0.016063109040260315, 0.03691718354821205, 0.0028484356589615345, -0.009046899154782295, 0.04572088643908501, -0.032247815281152725, 0.02056223899126053, 0.02777300588786602, -0.010682393796741962, 0.062452785670757294, 0.03093455731868744, 0.01363114733248949, -0.022811803966760635, -0.019358418881893158, 0.00724724680185318, 0.005335116758942604, 0.015370000153779984, -0.04032193124294281, -0.057102467864751816, 0.002647798741236329, 0.05822117254137993, 0.005128399934619665, 0.04900403693318367, -0.01741284877061844, -0.0029806734528392553, -0.012372607365250587, -0.009776487946510315, -0.01425129733979702, 0.03088591806590557, -0.0018665308598428965, 0.023249557241797447, -0.018677469342947006, 0.007788358721882105, -0.020440641790628433, 0.05724838748574257, 0.01766820438206196, -0.012743481434881687, -0.025949034839868546, -0.06478746980428696, 0.02125534787774086, -0.022982042282819748, 0.040443528443574905, -0.01596583053469658, 0.004049216862767935, -0.027335254475474358, -0.0018452511867508292, 0.01909090206027031, -0.011624778620898724, -0.041173119097948074, 0.027481170371174812, -0.012062531895935535, 0.02221597358584404, 0.024927610531449318, -0.03324492275714874, -0.005192238837480545, 0.0002756856847554445, 0.017741162329912186, -0.010810071602463722, 0.006894612219184637, -0.011807175353169441, 0.05364908277988434, -0.027651408687233925, 0.005085840821266174, 0.009849445894360542, 0.016488702967762947, -0.011339022777974606, 0.035847119987010956, -0.00798291526734829, -0.012609723024070263, -0.01686565764248371, -0.04134335368871689, 0.031007517129182816, -0.009332654066383839, 0.02242268994450569, 0.020197445526719093, -0.02176606096327305, 0.05559465289115906, -0.002055007964372635, -0.00022001656179782003, -0.028186440467834473, 0.003717862069606781, 0.01881122589111328, -0.02563288062810898, 0.014275616966187954, 0.04739893972873688, 0.011582219041883945, -0.03086159937083721, 0.0015541757456958294, -0.008292990736663342, 0.014105379581451416, -0.02290908247232437, 0.00045371291344054043, -0.025730159133672714, 0.01620902679860592, -0.007301966194063425, 0.007569482084363699, 0.015114644542336464, 0.02102431282401085, 0.01591719128191471, -0.0018194116419181228, -0.020683838054537773, 0.016002310439944267, -0.0007527682464569807, 0.027359573170542717, -0.018495071679353714, 0.04343484342098236, 0.02607063390314579, -0.043386202305555344, -0.004520409274846315, 0.01510248426347971, -0.014202658087015152, -0.041927024722099304, -0.014190498739480972, 0.003948898520320654, -0.012159810401499271, -0.00989200547337532, -0.017704684287309647, 0.021133750677108765, 0.043361883610486984, -0.032004620879888535, -0.03292876482009888, -0.028429636731743813, 0.040686726570129395, -0.019224660471081734, -0.012962358072400093, 0.015370000153779984, 0.016342785209417343, -0.04932019114494324, -0.00045713287545368075, 0.022823963314294815, -0.01620902679860592, 0.029499700292944908, -0.017291249707341194, 0.017765482887625694, -0.0027587569784373045, 0.014883607625961304, 0.0016172548057511449, 0.001953169470652938, 0.03212621808052063, 0.012196289375424385, 0.042632296681404114, -0.04275389388203621, 0.028137801215052605, -0.014348575845360756, 0.01977185159921646, -0.013558188453316689, 0.0046359277330338955, 0.004906483460217714, 0.019698891788721085, 0.002127966843545437, 0.0004837324668187648, -0.00712564866989851, -0.03699014335870743, -0.024270981550216675, -0.008973940275609493, -0.02757844887673855, -0.054913703352212906, 0.027894604951143265, -0.01087694987654686, -0.0015496158739551902, 0.05116848275065422, 0.009533291682600975, -0.033682674169540405, -0.007210767362266779, -0.019929928705096245, 0.01958945393562317, -0.005405035801231861, 0.02053792029619217, 0.02248348854482174, -0.012135490775108337, -0.04421307146549225, -0.024198021739721298, -0.014956566505134106, 0.029037626460194588, 0.019480016082525253, -0.0004723326419480145, 0.013691946864128113, -0.007222927175462246, 0.017510127276182175, 0.03699014335870743, 0.005991746671497822, -0.0009492252138443291, 0.020927034318447113, 0.028891708701848984, -0.002428922103717923, -0.002672118367627263, 0.0008869061712175608, 0.016513021662831306, -0.009812966920435429, -0.001836131326854229, 0.03305036574602127, 0.028137801215052605, -0.009028659202158451, -0.0357012040913105, -0.025438323616981506, 0.03404746949672699, 0.03601735830307007, 0.03504457324743271, -0.01663462072610855, 0.005322956945747137, 0.00043015327537432313, -0.01644006371498108, 0.018750427290797234, -0.0007634080830030143, 0.008147072978317738, -0.035360727459192276, 0.023310355842113495, -0.005994786508381367, 0.029840175062417984, 0.006535897962749004, 0.05141167715191841, 0.032685570418834686, 0.01787492074072361, -0.03312332183122635, -0.042364779859781265, 0.05719974637031555, 0.01766820438206196, 0.0017646924825385213, 0.010718872770667076, 0.03288012742996216, -0.027213655412197113, -0.021389106288552284, 0.03205325827002525, -0.013850023970007896, -0.006870292592793703, -0.042145904153585434, -0.01597798988223076, 0.00939953327178955, -0.057832058519124985, -0.02755413018167019, 0.014154018834233284, -0.01637926511466503, 0.010329758748412132, -0.007356685120612383, -0.011953093111515045, 0.007757958956062794, 0.015321360900998116, 0.008937460370361805, 0.03788996860384941, 0.010779672302305698, 0.030983196571469307, 0.0008610665681771934, -0.06493338942527771, 0.0028195560444146395, -0.01664678007364273, 0.019261140376329422, -0.04581816494464874, -0.046474795788526535, 0.014336416497826576, 0.004848724231123924, 0.006870292592793703, 0.028356676921248436, 0.028551233932375908, -0.008153152652084827, 0.019030103459954262, -0.022568607702851295, 0.02752980962395668, -0.05311405286192894, 0.003818180412054062, -0.02609495259821415, 0.009016498923301697, -0.020878395065665245, -0.0112235052511096, -0.023553552106022835, 0.02124318853020668, -0.0011415021726861596, -0.02607063390314579, 0.018458591774106026, -0.027359573170542717, 0.02000288851559162, 0.03506889194250107, 0.031566865742206573, 0.022130854427814484, -0.017242610454559326, -0.014518813230097294, 0.010706713423132896, 0.012646202929317951, 0.0037513014394789934, -0.011703817173838615, -0.010196001268923283, 0.017680363729596138, 0.008365949615836143, 0.0024517218116670847, -0.029086265712976456, 0.021802539005875587, -0.012384766712784767, 0.012311807833611965, -0.051314398646354675, -0.027870284393429756, 0.010548635385930538, 0.042340461164712906, -0.03497161343693733, -0.02394266612827778, -0.034193385392427444, 0.007757958956062794, -0.01185581460595131, 0.02872147224843502, -0.00940561294555664, 0.00712564866989851, 0.03302604332566261, 0.07038098573684692, -0.03893571346998215, 0.033001724630594254, -0.01558887679129839, 0.011332943104207516, -0.01736420951783657, 0.025243766605854034, -0.025049209594726562, -0.004176894668489695, 0.02366298995912075, -0.014044580981135368, 0.016513021662831306, 0.03686854615807533, 0.020221764221787453, -0.04248637706041336, -0.0027511571533977985, 7.086889672791585e-05, 0.033439479768276215, -0.0371847003698349, 0.005678631365299225, 0.008548346348106861, 0.005639112088829279, -0.010080482810735703, -0.025024889037013054, 0.009800807572901249, -0.005091920495033264, -0.028794430196285248, 0.016050949692726135, -0.039495062083005905, -0.01814243756234646, 0.006925011985003948, -0.02898898720741272, 0.0007911476423032582, -0.02194845676422119, -0.041416313499212265, -0.014385055750608444, -0.039203230291604996, 0.006918931845575571, 0.0018954104743897915, 0.004338012542575598, -0.08633465319871902, -0.013679786585271358, 0.0227145254611969, -0.009429932571947575, 0.0008861461537890136, 0.02874579094350338, -0.001763172447681427, 0.0091624166816473, -0.021449904888868332, -0.01449449360370636, 0.02000288851559162, -0.0007197087979875505, -0.0011741816997528076, 0.0011453020852059126, 0.05671335384249687, 0.031275033950805664, 0.04294845089316368, 0.004955122712999582, 0.017935719341039658, -0.007520842831581831, 0.012403006665408611, 0.018166756257414818, 0.022386210039258003, 0.008840181864798069, -0.028162119910120964, 0.013047476299107075, -0.008761143311858177, 0.005693831015378237, 0.055935125797986984, -0.0034169068094342947, 0.02628950960934162, 0.01639142446219921, -0.049101315438747406, -0.01646438241004944, -0.013229873962700367, 0.03181006386876106, 0.005964386742562056, 0.011010708287358284, 0.03696582466363907, 0.04178110882639885, 0.006870292592793703, 0.003056672401726246, 0.021097270771861076, -0.021328307688236237, 1.3477914762916043e-05, -0.01613606885075569, -0.04075968265533447, 0.012068611569702625, -0.0079768355935812, -0.011612619273364544, 0.016269825398921967, 0.023808907717466354, -0.004830484744161367, 0.021449904888868332, 0.009837286546826363, 0.018422111868858337, 0.0003243249375373125, 0.009229295887053013, -0.028672832995653152, 0.003401706926524639, 0.02723797596991062, 0.040443528443574905, -0.005104080308228731, -0.0267759021371603, 0.02585175633430481, 0.00184069131501019, 0.0011194625403732061, 0.026484066620469093, -0.012585403397679329, 0.01639142446219921, 0.03144526854157448, 0.0066149369813501835, 0.008998259902000427, 0.007648520637303591, 0.012962358072400093, -0.011874054558575153, 0.01765604503452778, 0.010238559916615486, -0.001877170754596591, -0.035871438682079315, 0.022495649755001068, 0.006487258709967136, 0.012804280035197735, 0.018726108595728874, 0.019358418881893158, 0.030521124601364136, -0.010044002905488014, 0.003207149915397167, 0.023517074063420296, -0.008621305227279663, 0.04727734252810478, -0.0004434530856087804, 0.03280716761946678, 0.00773363932967186, 0.014932246878743172, 0.021607981994748116, -0.012792120687663555, -0.026629984378814697, 0.01715749315917492, 0.0021583663765341043, 0.023006360977888107, 0.03066704235970974, -0.018300514668226242, 0.015503758564591408, -0.0020200484432280064, 0.014689050614833832, -0.0032345096115022898, -0.017753323540091515, -0.024793853983283043, 0.009533291682600975, 0.012396926991641521, 0.015236242674291134, 0.03844932094216347, 0.038984350860118866, 0.006335261277854443, -0.009034738875925541, 0.015880711376667023, -0.003231469541788101, -0.04058944806456566, 0.008603066205978394, -0.022507809102535248, 0.011411981657147408, -0.0025444403290748596, 0.03701446205377579, -0.011679497547447681, -0.004763605538755655, 0.020623037591576576, 0.0026052393950521946, -0.0015959751326590776, 0.0015002165455371141, 0.01736420951783657, 0.06828949600458145, 0.0034169068094342947, 0.07840646058320999, 0.0034564260859042406, -0.02006368711590767, 0.04032193124294281, -0.018020838499069214, -0.04829876497387886, 0.0002654258569236845, -0.04032193124294281, 0.0060495054349303246, -0.022276772186160088, -0.0219727773219347, -0.017206132411956787, 0.012475965544581413, 0.00014544272562488914, 0.022130854427814484, -0.02124318853020668, -0.012500285170972347, 0.007429643999785185, -0.0009385853772982955, -0.02607063390314579, -0.009733928367495537, -0.018653148785233498, 0.05457323044538498, -0.03643079102039337, -0.04156223312020302, -0.02056223899126053, -0.005985666532069445, 0.02485465258359909, 0.021814700216054916, 0.0306913610547781, -0.054670508950948715, -0.00013869784015696496, -0.009624489583075047, -0.01712101325392723, -0.009685289114713669, -0.023529233410954475, -0.006912852171808481, 0.005018961615860462, 0.014458014629781246, -0.016245506703853607, 0.052724938839673996, 0.03185870125889778, 0.0255599208176136, 0.022860443219542503, 0.005335116758942604, -0.008207871578633785, 0.01375274546444416, -0.049101315438747406, 0.020112326368689537, 0.012634042650461197, 0.007423564326018095, 0.04075968265533447, 0.012159810401499271, -0.019443536177277565, 0.006204543169587851, 0.019747531041502953, 0.002042848151177168, 0.011758537031710148, -0.003964098170399666, -0.013655466958880424, 0.02412506379187107, 0.0014736170414835215, -0.009375213645398617, -0.005110160447657108, 0.00010601834947010502, -0.02193629741668701, 0.033634036779403687, -0.01639142446219921, 0.009253615513443947, 0.014081059955060482, -0.02582743763923645, 0.02029472403228283, 0.017485806718468666, -0.018507231026887894, 0.019151700660586357, 0.005742470268160105, 0.04496697708964348, -0.01982049085199833, -0.016999414190649986, 0.020416321232914925, 0.0006604297086596489, -0.004064416512846947, 0.007058769930154085, -0.037257660180330276, -0.009934565052390099, -0.0396166630089283, -0.036819905042648315, -0.03696582466363907, -0.012190209701657295, -0.028405316174030304, 0.021206708624958992, -0.04973362386226654, -0.004380571655929089, -0.022349731996655464, 0.007812677882611752, 0.0029046747367829084, 0.011673417873680592, 0.013132595457136631, 0.02338331565260887, -0.040443528443574905, -0.008815862238407135, 0.015163283795118332, -0.020452801138162613, -0.00536855636164546, 0.008499707095324993, 0.04465082287788391, 0.013898663222789764, -0.016075268387794495, -0.008262591436505318, -0.018750427290797234, -0.03844932094216347, 0.023602191358804703, 0.00975824799388647, 0.00822611153125763, 0.035093214362859726, 0.022094374522566795, -0.005000722128897905, 0.0012099011801183224, -0.009034738875925541, -0.033925872296094894, -0.024210182949900627, 0.0025961194187402725, -0.0047575258649885654, -0.007301966194063425, -0.015284881927073002, 0.0014986966270953417, -0.030545443296432495, 0.014105379581451416, -0.007739719469100237, -0.007064849603921175, -0.00459640845656395, -0.02633814886212349, -0.012111171148717403, -0.012743481434881687, 0.026994779706001282, 0.01861666887998581, 0.03942210599780083, 0.0091928169131279, -0.0049004037864506245, -0.006730454973876476, -0.01425129733979702, 0.0166954193264246, -0.02489113248884678, 0.007903876714408398, -0.01484712865203619, -0.02631383016705513, -0.03981122002005577, -0.0009378253598697484, 0.013521709479391575, 0.005933987442404032, 0.01958945393562317, 0.018397793173789978, -0.004058336839079857, 0.011278224177658558, -0.020951353013515472, 0.023735949769616127, 0.01361898798495531, 0.031542547047138214, -0.004368411842733622, -0.00071742880390957, -0.01573479361832142, 0.015807753428816795, 0.010773591697216034, 0.018300514668226242, -0.03409610688686371, 0.03917890787124634, -0.030350886285305023, -0.0024030825588852167, 0.009812966920435429, 0.023225238546729088, 0.005815429147332907, -0.0032770689576864243, -0.0091928169131279, -0.03195597976446152, -0.018251875415444374, 0.06235550716519356, 0.016111748293042183, 0.0016932536382228136, -0.012463805265724659, 0.031226392835378647, 0.03574984148144722, -0.020866233855485916, 0.00283779576420784, -0.000798747525550425, 0.006210623309016228, -0.05700518935918808, 0.0011688617523759604, 0.023760268464684486, 0.005322956945747137, 0.006143744103610516, 0.02006368711590767, -0.005012881942093372, -0.0164279043674469, 0.01460393238812685, -0.023334676399827003, -0.023529233410954475, -0.000547191477380693, 0.046499114483594894, -0.026921819895505905, -0.02104863151907921, 0.010189920663833618, -0.038303401321172714, 0.0012053411919623613, -0.029524018988013268, 0.016063109040260315, 0.029888814315199852, 0.0011848214780911803, -0.013351472094655037, -0.000823067151941359, 0.001269180211238563, 0.02512216754257679, 0.008846261538565159, 0.0001230230845976621, -0.008864501491189003, 0.013801384717226028, 0.0043592918664216995, 0.023966986685991287, 0.057588860392570496, 0.007745799142867327, 0.007107409182935953, -0.018069477751851082, 0.035360727459192276, -0.025486962869763374, -0.00736276526004076, 0.030715681612491608, -0.01012912206351757, -0.030472485348582268, -0.019261140376329422, 0.011861895211040974, 0.05379500240087509, -5.9279074775986373e-05, 0.005149679724127054, 0.034679777920246124, -0.022580767050385475, 0.016792697831988335, -0.01350954920053482, 0.004973362199962139, 0.023322517052292824, 0.01594151183962822, -0.017729002982378006, -0.02558424137532711, -0.028380997478961945, -0.007423564326018095, 0.008311230689287186, -0.009776487946510315, 0.02126750908792019, 0.05447595193982124, 0.012019972316920757, -0.028137801215052605, 0.01787492074072361, 0.012621883302927017, 0.0008116673561744392, 0.01160653866827488, 0.022130854427814484, 0.005325996782630682, 0.007350605446845293, -0.020866233855485916, 0.008438908495008945, 0.00975824799388647, -0.01712101325392723, -0.007235086988657713, 0.02726229466497898, 0.05617832392454147, 0.0035810640547424555, -0.0516548752784729, 0.019492175430059433, -0.01049391645938158, 0.022641567513346672, 0.030958877876400948, -0.00891922041773796, -0.016245506703853607, -0.002691878005862236, -0.03769541159272194, 0.005414155311882496, 0.03545800596475601, 0.004620728082954884, 0.01314475480467081, -0.03348811715841293, 0.0014705770881846547, -0.007964675314724445, -0.004374491982161999, -0.0015914151445031166, -0.01695077493786812, -0.04494265839457512, -0.02289692312479019, -0.001954689621925354, 0.0015192163409665227, -0.022130854427814484, 0.034655459225177765, 0.0045052096247673035, -0.0035567444283515215, 0.008159232325851917, 0.05510826036334038, 0.02441689930856228, -0.013047476299107075, 0.018409952521324158, 0.029840175062417984, 0.0016856536967679858, 0.0063048615120351315, 0.013667627237737179, 0.013120435178279877, -0.023298196494579315, 0.0032953086774796247, 0.016829177737236023, -0.00761204119771719, 0.0026538786478340626, 0.033925872296094894, -0.00343818636611104, 0.0046450477093458176, -0.017984358593821526, 0.027383893728256226, 0.015601037070155144, 0.01977185159921646, -0.040443528443574905, 0.008207871578633785, -0.008049794472754002, -0.001288939849473536, 0.013059636577963829, 0.03353675827383995, 0.018944984301924706, 0.017048053443431854, -0.01977185159921646, 0.045064255595207214, -0.028332358226180077, 0.0019318899139761925, -0.022994201630353928, 0.019443536177277565, 0.0183248333632946, -0.01338795106858015, -0.00811059307307005, 0.016111748293042183, -0.014081059955060482, -0.011393742635846138, -0.014701210893690586, 0.010214240290224552, -0.025195127353072166, -0.022301092743873596, 0.03645510971546173, 0.0061467839404940605, 0.014299936592578888, 0.0152119230479002, -0.017546607181429863, 0.034144748002290726, 0.013533868826925755, -0.013205554336309433, -0.016744058579206467, -0.023298196494579315, 0.002983713522553444, -0.018020838499069214, -0.006377820391207933, -0.015844233334064484, -0.008992179296910763, -0.010682393796741962, -0.017473647370934486, -0.022398371249437332, -0.0011407422134652734, -0.0367712676525116, 0.017558766528964043, 0.0015655755996704102, 0.00537463603541255, 0.0005373116000555456, 0.007198607549071312, 0.0006425699684768915, -0.008870581164956093, -0.007678920403122902, 0.000968984910286963, 0.037549495697021484, 0.0007402284536510706, -0.01197133306413889, -0.01412969920784235, -0.015163283795118332, 0.0019668492022901773, -0.01281644031405449, 0.027456851676106453, -0.0021051671355962753, 0.0028362758457660675, -0.02852691523730755, 0.00036992423702031374, -0.0031311511993408203, 0.014263457618653774, 0.023614350706338882, 0.014348575845360756, 0.031566865742206573, 0.019492175430059433, -0.004787925165146589, 0.024052103981375694, -0.021693101152777672, -0.022410530596971512, -0.009581930935382843, -0.00355978449806571, 0.014385055750608444, 0.025462642312049866, 0.0011787415714934468, 0.014324256218969822, 0.010329758748412132, -0.009059058502316475, 0.016610300168395042, 0.010907350108027458, 0.022568607702851295, -0.017339888960123062, -0.003173710545524955, 0.008451067842543125, 0.03110479563474655, 0.0043592918664216995, 0.008055874146521091, -0.0016795737901702523, 0.002650838578119874, 0.01375274546444416, 0.014409375376999378, 0.037792690098285675, -0.009904165752232075, 0.00380298076197505, 0.033706992864608765, 0.014141859486699104, 0.04562360793352127, -0.01147278118878603, 0.026654304936528206, -0.032466694712638855, 0.013010997325181961, -0.0319073423743248, -0.0043836114928126335, -0.020574398338794708, 0.01589287258684635, -0.009733928367495537, -0.010688473470509052, 0.004909523297101259, 0.017497967928647995, -0.025243766605854034, 0.03540936857461929, -0.017266931012272835, 0.012707001529633999, 0.043337564915418625, 0.0047332062385976315, 0.0030992317479103804, -0.0035932238679379225, -0.00811059307307005, -0.00786131713539362, -0.003526344895362854, 0.0038333802949637175, 0.01737636886537075, -0.02267804555594921, 0.007776198908686638, 0.006858133245259523, 0.02558424137532711, 0.008907061070203781, 0.013424430973827839, 0.01171597745269537, 0.039738260209560394, -0.009429932571947575, -0.014810648746788502, -0.054427310824394226, -0.025778798386454582, -0.0006927291979081929, -0.009776487946510315, -0.021632302552461624, 0.010317599400877953, -0.03227213770151138, 0.03426634520292282, -0.014701210893690586, 0.010810071602463722, 0.039470743387937546, -0.04314300790429115, -0.028843069449067116, -0.005249998066574335, -0.009022579528391361, -0.008524026721715927, 0.00711956899613142, 0.016476543620228767, 0.008177472278475761, 0.014081059955060482, -0.009253615513443947, 0.015066005289554596, -0.04399419203400612, -0.002225245349109173, 0.011795016005635262, 0.0023164439480751753, -0.012536764144897461, -0.03436362370848656, -0.0227145254611969, -0.012962358072400093, -0.017741162329912186, 0.008797623217105865, -0.012044291943311691, -0.009198896586894989, -0.014567452482879162, -0.027408212423324585, 0.015199762769043446, 0.005456714890897274, 0.005684711504727602, -0.002719237469136715, -0.013728425838053226, 0.0047544860281050205, -0.012427326291799545, 0.003389547113329172, -0.03499593585729599, 0.010700632818043232, -0.012658362276852131, -0.02655702643096447, -0.02680022269487381, -0.05501098185777664, -0.013740585185587406, 0.0010313038947060704, 0.05486506596207619, 0.0033105083275586367, 0.006827733479440212, -0.0002449061721563339, 0.0159536711871624, 0.041854068636894226, 0.028697151690721512, 0.008426748216152191, 0.025754477828741074, 0.03305036574602127, 0.0012820999836549163, -0.00928401481360197, -0.024526337161660194, 0.017814122140407562, -0.01425129733979702, -0.002699477830901742, -0.024076424539089203, 0.011296464130282402, -0.027140697464346886, 0.012670522555708885, -0.0032375494483858347, 0.007520842831581831, -0.007685000076889992, -0.024295300245285034, 0.022982042282819748, -0.029402421787381172, -0.009691368788480759, -0.003644903190433979, 0.00023464634432457387, -0.0036783425603061914, 0.0195408146828413, -0.026143591850996017, -0.005514474119991064, -0.03837636113166809, 0.025462642312049866, 0.022361891344189644, -0.0171696525067091, -0.0029897934291511774, 0.010177761316299438, -0.04421307146549225, 0.03166414424777031, 0.001127062365412712, -0.027189336717128754, 0.030083371326327324, -0.015041685663163662, 0.003465545829385519, 0.005082800518721342, 0.021656621247529984, -0.01766820438206196, 0.012342207133769989, -0.012804280035197735, -0.01692645624279976, 0.037087421864271164, -0.02461145631968975, 0.0019440497271716595, 0.001852851128205657, 0.011782855726778507, -0.01135726273059845, -0.006426459643989801, 0.01049391645938158, 0.030983196571469307, 0.0448940210044384, 0.016549501568078995, 0.0017297329613938928, -0.016804857179522514, 0.011807175353169441, 0.07135376334190369, -0.0045416890643537045, -0.0019790090154856443, -0.003413866739720106, 0.009235375560820103, 0.027335254475474358, -0.012840759940445423, 0.018653148785233498, -0.027651408687233925, -0.001269180211238563, 0.03694150224328041, 0.015041685663163662, -0.008031554520130157, -0.041854068636894226, 0.010232480242848396, 0.016281986609101295, -0.020148806273937225, 0.01670757867395878, 0.028940347954630852, 0.017534445971250534, -0.023042840883135796, 0.02098783291876316, -0.010390558280050755, -0.009837286546826363, -0.041635189205408096, -0.04440762847661972, -0.015552397817373276, 0.022167334333062172, -0.016549501568078995, 0.0009218656341545284, -0.012105091474950314, 0.01763172447681427, -0.01640358380973339, 0.04460218548774719, -0.02731093391776085, 0.010518236085772514, -0.013801384717226028, 0.011825415305793285]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-16T00:48:18.978976", "url_path": "/docs/python/tutorial-fastapi", "chunk_size": 4547}
updated_dt: 2025-03-16T00:48:18.980509
---
```
import redis
from fastapi import FastAPI, HTTPException
from models import ItemPayload
app = FastAPI()
redis_client = redis.StrictRedis(host="0.0.0.0", port=6379, db=0, decode_responses=True)
# Route to add an item
@app.post("/items/{item_name}/{quantity}")
def add_item(item_name: str, quantity: int) -> dict[str, ItemPayload]:
  if quantity <= 0:
    raise HTTPException(status_code=400, detail="Quantity must be greater than 0.")
  # Check if item already exists
  item_id_str: str | None = redis_client.hget("item_name_to_id", item_name)
  if item_id_str is not None:
    item_id = int(item_id_str)
    redis_client.hincrby(f"item_id:{item_id}", "quantity", quantity)
  else:
    # Generate an ID for the item
    item_id: int = redis_client.incr("item_ids")
    redis_client.hset(
      f"item_id:{item_id}",
      mapping={
        "item_id": item_id,
        "item_name": item_name,
        "quantity": quantity,
      },
    )
    # Create a set so we can search by name too
    redis_client.hset("item_name_to_id", item_name, item_id)
  return {
    "item": ItemPayload(item_id=item_id, item_name=item_name, quantity=quantity)
  }

# Route to list a specific item by ID but using Redis
@app.get("/items/{item_id}")
def list_item(item_id: int) -> dict[str, dict[str, str]]:
  if not redis_client.hexists(f"item_id:{item_id}", "item_id"):
    raise HTTPException(status_code=404, detail="Item not found.")
  else:
    return {"item": redis_client.hgetall(f"item_id:{item_id}")}

@app.get("/items")
def list_items() -> dict[str, list[ItemPayload]]:
  items: list[ItemPayload] = []
  stored_items: dict[str, str] = redis_client.hgetall("item_name_to_id")
  for name, id_str in stored_items.items():
    item_id: int = int(id_str)
    item_name_str: str | None = redis_client.hget(f"item_id:{item_id}", "item_name")
    if item_name_str is not None:
      item_name: str = item_name_str
    else:
      continue # skip this item if it has no name
    item_quantity_str: str | None = redis_client.hget(
      f"item_id:{item_id}", "quantity"
    )
    if item_quantity_str is not None:
      item_quantity: int = int(item_quantity_str)
    else:
      item_quantity = 0
    items.append(
      ItemPayload(item_id=item_id, item_name=item_name, quantity=item_quantity)
    )
  return {"items": items}

# Route to delete a specific item by ID but using Redis
@app.delete("/items/{item_id}")
def delete_item(item_id: int) -> dict[str, str]:
  if not redis_client.hexists(f"item_id:{item_id}", "item_id"):
    raise HTTPException(status_code=404, detail="Item not found.")
  else:
    item_name: str | None = redis_client.hget(f"item_id:{item_id}", "item_name")
    redis_client.hdel("item_name_to_id", f"{item_name}")
    redis_client.delete(f"item_id:{item_id}")
    return {"result": "Item deleted."}

# Route to remove some quantity of a specific item by ID but using Redis
@app.delete("/items/{item_id}/{quantity}")
def remove_quantity(item_id: int, quantity: int) -> dict[str, str]:
  if not redis_client.hexists(f"item_id:{item_id}", "item_id"):
    raise HTTPException(status_code=404, detail="Item not found.")
  item_quantity: str | None = redis_client.hget(f"item_id:{item_id}", "quantity")
  # if quantity to be removed is higher or equal to item's quantity, delete the item
  if item_quantity is None:
    existing_quantity: int = 0
  else:
    existing_quantity: int = int(item_quantity)
  if existing_quantity <= quantity:
    item_name: str | None = redis_client.hget(f"item_id:{item_id}", "item_name")
    redis_client.hdel("item_name_to_id", f"{item_name}")
    redis_client.delete(f"item_id:{item_id}")
    return {"result": "Item deleted."}
  else:
    redis_client.hincrby(f"item_id:{item_id}", "quantity", -quantity)
    return {"result": f"{quantity} items removed."}
Copy
```

  13. Re-run the debugger to test this application by interacting with the `/docs` route. You can stop the debugger once you're done.


Congrats! You now have a working FastAPI application with routes to add, list, and delete items from a grocery list, and the data is persisted in a Redis database.
## [Optional: Set up database deletion](https://code.visualstudio.com/docs/python/tutorial-fastapi#_optional-set-up-database-deletion)
With the data now persisted by Redis, you might want to create a script to erase all testing data. To do so, create a new file called `flushdb.py` with the following content:
```
import redis
redis_client = redis.StrictRedis(host='0.0.0.0', port=6379, db=0, decode_responses=True)
redis_client.flushdb()
Copy