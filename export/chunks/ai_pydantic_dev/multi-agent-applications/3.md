---
url: https://ai.pydantic.dev/multi-agent-applications/
session_id: pydantic_ai_docs
chunk_number: 3
title: Creating a Flight Search Agent with Pydantic AI
summary: This chunk demonstrates the creation of a flight search agent using Pydantic AI. It defines a FlightDetails model to capture flight information and a Failed model for unsatisfactory search results. The agent utilizes explicit type annotations to indicate possible outcomes of the search, aligning with upcoming PEP-747 standards.
embedding: [-0.04253598675131798, -0.005070840939879417, 0.05080687254667282, -0.03636564314365387, -0.0015918173594400287, -0.01839287579059601, 0.00024636246962472796, 0.02542969398200512, 0.03247964009642601, 0.055506836622953415, 0.0070302532985806465, -0.0431661494076252, 0.004007441457360983, -0.017828354611992836, -0.031691934913396835, -0.03479023650288582, -0.01606914959847927, 0.027307054027915, 0.007765443064272404, 0.04786611348390579, 0.06600955128669739, 0.01173678133636713, 0.014218047261238098, 0.008907613344490528, -0.027517108246684074, -0.0076472875662148, 0.010883436538279057, 0.061598408967256546, -0.0008172423113137484, -0.03247964009642601, 0.05650459602475166, -0.015872225165367126, 0.004670424852520227, 0.0014728413661941886, 0.0030310172587633133, -0.038728754967451096, -0.004575244151055813, 0.046527016907930374, -0.02793721668422222, -0.009465569630265236, 0.010745587758719921, -0.023933056741952896, 0.034921519458293915, -0.0011790936114266515, -0.05062307417392731, 0.04253598675131798, 0.019508788362145424, 0.06737489998340607, 0.016331719234585762, -0.024326909333467484, -0.03381873667240143, 0.01995515450835228, 0.003336252411827445, -0.0009124231874011457, -0.007397848181426525, -0.011159132234752178, -0.027595877647399902, -0.0007216512458398938, 0.0012480176519602537, -0.022029440850019455, 0.018077794462442398, 0.031324341893196106, 0.023946184664964676, 0.05928781256079674, -0.01988951303064823, 0.019456274807453156, -0.013062749058008194, 0.01644987426698208, -0.04096058011054993, -0.008566275238990784, 0.010870307683944702, 0.019430018961429596, -0.04080303758382797, -0.03129808232188225, -0.029040001332759857, -0.03949020057916641, 0.03384499251842499, 0.062281087040901184, -0.001058476511389017, -0.03725837171077728, 0.0025387026835232973, 0.01837974786758423, -0.0024697785265743732, 0.025967957451939583, -0.021333634853363037, -0.05109569802880287, -0.07798264175653458, -0.03324108570814133, -0.009590289555490017, -0.07966307550668716, -0.04271978512406349, 0.024996455758810043, -0.019101809710264206, 0.017185064032673836, 0.07598713040351868, 0.06359392404556274, -0.003994313068687916, -0.02380177192389965, -0.004631039686501026, 0.00411246856674552, 0.030169041827321053, -0.0009838087717071176, -0.06212354451417923, 0.02159620262682438, 0.02898748777806759, -0.03644441440701485, -0.005691157653927803, 0.051962170749902725, -0.03822987526655197, -0.0005321101052686572, -0.084914430975914, 0.0293025691062212, -0.009537776000797749, 0.020703472197055817, -0.05408897250890732, 0.0101154251024127, 0.012800181284546852, -0.022725244984030724, 0.03623436018824577, -0.03775725141167641, -0.05561186373233795, -0.0014178662095218897, 0.008395605720579624, -0.005445000249892473, 0.0039024141151458025, -0.004804991185665131, -0.025482207536697388, -0.03691703453660011, -0.048758845776319504, 0.019246220588684082, 0.041354432702064514, 0.001389968441799283, 0.006554349325597286, 0.006206446792930365, -0.03822987526655197, 0.009084846824407578, -0.043612513691186905, 0.0136535270139575, -0.005346537102013826, 0.01079810131341219, 0.008736943826079369, -0.03184947744011879, -0.00834965705871582, 0.021346762776374817, -0.03964773938059807, 0.008723815903067589, -0.0468946136534214, 0.025613490492105484, -0.05540180951356888, 0.0283048115670681, 0.023670488968491554, -0.02062470279633999, -0.04145945981144905, -0.03612933307886124, 0.00029682472813874483, 0.004693399649113417, 0.011782730929553509, 0.03626061603426933, 0.026795046404004097, -0.015399602241814137, -0.002144850790500641, 0.017893996089696884, -0.02637493796646595, -0.03161316365003586, -0.018852369859814644, -0.029066257178783417, -0.03515782952308655, -0.00917674507945776, -0.055191755294799805, -0.04363877326250076, -0.029197541996836662, -0.0195875596255064, -0.007246871944516897, -0.0022679294925183058, 0.04350748658180237, -0.027412081137299538, -0.02762213535606861, -0.029092514887452126, -0.032689694315195084, -0.04699964076280594, -0.010942514054477215, 0.0003918004222214222, -0.049704089760780334, -0.038807522505521774, -0.04395385459065437, -0.009327721782028675, 0.034921519458293915, 0.024274395778775215, -0.004880479536950588, 0.04216839000582695, 0.031639423221349716, 0.026269910857081413, 0.025324666872620583, 0.009944756515324116, -0.029538879171013832, -0.0013965326361358166, 0.07556702196598053, -0.0008787816623225808, 0.038098592311143875, 0.014218047261238098, -0.0007634980138391256, 0.017500145360827446, 0.03922763094305992, -0.028094757348299026, 0.012005913071334362, -0.03696954995393753, -0.0026617811527103186, -0.002520651090890169, -0.0006646247929893434, 0.0016919213812798262, -0.0011692473199218512, -0.0809234008193016, 0.04474155604839325, -0.05091189965605736, -0.05020296573638916, -0.01861605793237686, -0.017211319878697395, -0.008428427390754223, -0.005697721615433693, 0.04513540863990784, 0.004637604113668203, -0.004972378257662058, 0.016502387821674347, -0.04127566143870354, 0.005723978392779827, -0.003702206304296851, 0.0042142136953771114, -0.0464482456445694, -0.0010486302198842168, 0.021950669586658478, 0.020086437463760376, -0.01830097660422325, -0.009189873933792114, -0.006619991268962622, 0.037179604172706604, -0.030169041827321053, 0.031376853585243225, -0.027832189574837685, 0.005799466744065285, 0.018734212964773178, -0.008277450688183308, 0.0019052576972171664, 0.01957443170249462, 0.002842296613380313, 0.03410755842924118, -0.0008041139226406813, -0.02380177192389965, -0.047498516738414764, 0.03820361942052841, 0.0464482456445694, 0.06811009347438812, -0.02353920415043831, -0.004480063449591398, -0.011264159344136715, -0.023906799033284187, 0.004158417694270611, -0.00458837253972888, -0.03211204335093498, 0.006291781552135944, -0.009242387488484383, -0.04337620362639427, 0.04009410738945007, -0.03292600437998772, 0.035814251750707626, -0.013187468983232975, -0.020532803609967232, 0.02189815603196621, 0.01511077769100666, -0.00724030751734972, -0.02704448625445366, -0.0017526402371004224, 0.030116528272628784, 0.012636076658964157, -0.003561076009646058, -0.03258466720581055, -0.011697396636009216, -0.0020217723213136196, 0.006938354577869177, 0.0010018603643402457, -0.01990264095366001, -0.018406003713607788, 0.04256224259734154, 0.05477164685726166, 0.019535046070814133, -0.0016508951084688306, 0.021780000999569893, 0.027096999809145927, -0.013075876981019974, -0.045187920331954956, 0.01795963943004608, 0.024038083851337433, 0.01496636588126421, 0.0005591873778030276, -0.025915443897247314, 0.04030416160821915, 0.013299060054123402, 0.02633555233478546, 0.007404412608593702, 0.023316022008657455, 0.01605602167546749, 0.034947775304317474, -0.014585642144083977, -0.028042243793606758, -0.02733330987393856, 0.011251031421124935, 0.014756311662495136, 0.016344847157597542, 0.00042215982102788985, 0.0257316455245018, -0.018445389345288277, -0.01740824617445469, 0.06411906331777573, -0.0032246611081063747, -0.0507543608546257, -0.01998141035437584, -0.03305728733539581, 0.0540364570915699, -0.016554901376366615, 0.0077063655480742455, -0.009399928152561188, -0.024957071989774704, -0.027464594691991806, 0.03641815483570099, 0.007614466827362776, -0.029512623324990273, -0.011218209750950336, 0.03628687188029289, 0.006029213313013315, -0.0367332361638546, 0.012124069035053253, 0.009774086996912956, -0.023302894085645676, -0.014454358257353306, 0.029538879171013832, 0.017473887652158737, -0.03192824497818947, -0.02220010943710804, 0.03276846557855606, 0.013226853683590889, 0.05248730629682541, -0.03762596845626831, -0.012386636808514595, -0.047183435410261154, 0.008297143504023552, -0.0367332361638546, 0.016213562339544296, 0.020782243460416794, 0.025639748200774193, 0.027595877647399902, 0.01676495559513569, -0.0068661486729979515, 0.017788968980312347, -0.00514304731041193, 0.08055580407381058, -0.02092665433883667, -0.044190164655447006, -0.005300587974488735, 0.0001618484384380281, -0.019193707033991814, 0.008133037947118282, -0.08003067225217819, 0.01446748711168766, -0.0018264873651787639, -0.020060181617736816, -0.024248138070106506, 0.026860687881708145, -0.023723002523183823, -0.0353153720498085, -0.045214179903268814, 0.033319856971502304, 0.04114437848329544, 0.007955804467201233, -0.03605056181550026, 0.009216130711138248, -0.020191464573144913, -0.04440021887421608, -0.014611898921430111, 0.0024796249344944954, -0.04854879155755043, 0.03129808232188225, 0.04379631206393242, -0.015859095379710197, -0.01870795711874962, -0.03305728733539581, 0.017487017437815666, 0.028199784457683563, -0.003646410536020994, -0.005930750630795956, -0.02602047100663185, 0.016226692125201225, 0.047761086374521255, -0.04629070684313774, 0.010325479321181774, -0.007003996521234512, 0.005953725427389145, -0.006390244234353304, -0.0005534437368623912, 0.047734830528497696, 0.04279855266213417, -0.010417378507554531, 0.010391121730208397, -0.02603359892964363, 0.010049783624708652, 0.011126311495900154, -0.03507906198501587, 0.016239820048213005, 0.0366019532084465, 0.0033165598288178444, -0.00835622102022171, 0.021504303440451622, 0.05429902672767639, -0.018524158746004105, 0.024051211774349213, 0.0005431871977634728, 0.019508788362145424, -0.020086437463760376, -0.0023778798058629036, 0.008001754060387611, 0.05267110466957092, 0.0495990626513958, 0.003336252411827445, -0.07567204535007477, 0.023670488968491554, 0.007168101612478495, -0.047130923718214035, 0.04723595082759857, 0.0617559514939785, -0.03421258553862572, 0.044505245983600616, -0.0391751192510128, -0.0077063655480742455, 0.0035709224175661802, 0.035236600786447525, 0.03119305707514286, -0.027569621801376343, -0.0035118446685373783, -0.018104050308465958, 0.019456274807453156, -0.018511030822992325, -0.012767360545694828, 0.03408130258321762, -0.07168101519346237, 0.022909041494131088, 0.03437012806534767, -0.02699197269976139, -0.01316777616739273, -0.031954504549503326, -0.012334123253822327, 0.009544339962303638, 0.024064339697360992, -0.0010051424615085125, -0.020099567249417305, -0.029145028442144394, 0.020716600120067596, -0.034921519458293915, -0.057764921337366104, 0.05571689084172249, 0.005973417777568102, 0.08638481050729752, 0.004575244151055813, 0.04783985763788223, 0.03500029072165489, -0.05587443336844444, 0.017920253798365593, -0.01806466653943062, 0.04114437848329544, 0.02956513687968254, -0.016528643667697906, -0.015990380197763443, 0.01030578650534153, 0.03373996540904045, -0.0347377210855484, 0.01966632902622223, -0.034265100955963135, -0.019206836819648743, -0.018484774976968765, 0.006091573275625706, 0.020454032346606255, -0.008211808279156685, -0.005678029265254736, 0.0334511399269104, -0.0007241127896122634, 0.02319786697626114, 0.03723211586475372, -0.010903128422796726, 0.040986835956573486, 0.016948752105236053, -0.01191401481628418, -0.021714359521865845, 0.02213446795940399, -0.011434828862547874, 0.02545594982802868, 0.04337620362639427, -0.014835081994533539, 0.010890000499784946, -0.04156448692083359, 0.006692197173833847, 0.008769765496253967, -0.0019791049417108297, -0.02155681885778904, 0.023276636376976967, -0.00805426761507988, 0.01396860834211111, 0.03675949573516846, 0.04274604097008705, -0.046238191425800323, 0.0028800407890230417, -0.016331719234585762, 0.0016377667197957635, 0.01933811977505684, -0.06963298469781876, -0.011703960597515106, -0.004453806672245264, 0.02537718042731285, -0.020703472197055817, 0.03384499251842499, -0.006692197173833847, 0.018524158746004105, -0.025560976937413216, -0.004824683535844088, 0.026479965075850487, -0.029223797842860222, -0.014572514221072197, 0.024011826142668724, 0.006446039769798517, -0.014441230334341526, -0.0030523508321493864, -0.042457215487957, -0.0031508137471973896, 0.00013159160153008997, 0.016003508120775223, 0.008625352755188942, 0.005054430570453405, 0.012373508885502815, -0.03051038086414337, 0.03450141102075577, 0.0038892857264727354, -0.006409937050193548, -0.03591927886009216, -0.023565461859107018, 0.0018166410736739635, 0.0056320796720683575, -0.018471645191311836, -0.03373996540904045, 0.00465729646384716, 0.011710524559020996, 0.03539414331316948, -0.001572945388033986, 0.004850940313190222, 0.0001587714796187356, 0.03205953165888786, 0.00580274872481823, 0.025862930342555046, -0.03093048930168152, 0.010417378507554531, 0.03854495659470558, -0.027779676020145416, -0.02095291204750538, 0.03528911620378494, -0.01990264095366001, 0.0008960127015598118, -0.005024891812354326, 0.01578032597899437, -0.006793942302465439, -0.026243653148412704, 0.037127088755369186, 0.017539530992507935, 0.008782893419265747, -0.019482532516121864, -0.009393363259732723, 0.002103824634104967, -0.0020349007099866867, -0.02476014569401741, 0.003154095960780978, 0.03087797574698925, -0.013942351564764977, 0.014060506597161293, -0.025285281240940094, -0.031639423221349716, 0.03253215178847313, 0.001096220687031746, -0.01895739696919918, 0.01396860834211111, 0.023723002523183823, -0.004256880842149258, -0.03093048930168152, -0.02062470279633999, 0.007056510075926781, -0.01862918585538864, 0.013955479487776756, 0.008500632829964161, -0.016594287008047104, 0.008014882914721966, 0.00823150109499693, -0.0373108871281147, 0.03116679936647415, -0.014375587925314903, 0.02153056114912033, -0.020519675686955452, 0.012084683403372765, 0.03350365534424782, -0.02188502810895443, -0.024563219398260117, 0.006373833864927292, -0.006436193827539682, -0.01318090409040451, 0.008073960430920124, 0.012163454666733742, -0.0017624865286052227, -0.005563155747950077, -0.0049231466837227345, 0.019193707033991814, -0.009386799298226833, -0.03830864652991295, -0.0014096610248088837, 0.009196437895298004, -0.056767161935567856, -0.0014498666860163212, 0.05671465024352074, -0.019233092665672302, 0.0030260940548032522, -0.010213888250291348, 0.020861012861132622, 0.005986546166241169, -0.006807070691138506, -0.02511461265385151, -0.034895263612270355, -0.01928560622036457, 0.007043381687253714, -0.003912260290235281, -0.012491663917899132, 0.04279855266213417, 0.0353153720498085, 0.003603743389248848, -0.017828354611992836, 0.0022580833174288273, 0.03087797574698925, -0.011467649601399899, -0.016213562339544296, -0.01223566010594368, 0.014021121896803379, 0.01991576887667179, 0.012150325812399387, -0.020125823095440865, 0.0010092450538650155, 0.016187306493520737, -0.027490850538015366, 0.014493743889033794, 0.050413019955158234, -0.019482532516121864, -0.0012455560499802232, -0.03657569736242294, 0.020322749391198158, 0.005326844751834869, 0.0378885380923748, 0.00034810748184099793, -0.011178825050592422, -0.02091352641582489, -0.010647124610841274, 0.03891254961490631, -0.04043544456362724, 0.034947775304317474, 0.011067233979701996, 0.014257432892918587, -0.015832839533686638, 0.021412406116724014, 0.028856202960014343, 0.03279472142457962, 0.03121931292116642, -0.0037120524793863297, -0.027543364092707634, -0.00834965705871582, -0.0004233906220179051, -0.005592694506049156, 0.00034728695754893124, 0.007922983728349209, 0.015885353088378906, -0.022620217874646187, -0.03547291085124016, 0.047813598066568375, -0.01675182767212391, -0.0014211483066901565, -0.04852253198623657, 0.04613316431641579, 0.04497786611318588, -0.010561790317296982, -0.022331392392516136, -0.02504896931350231, 0.020414648577570915, 0.03389750421047211, 0.00917018111795187, -0.005097097717225552, 0.0052152532152831554, 0.02988021820783615, 0.007214050740003586, 0.022751500830054283, -0.01575406827032566, 0.025534721091389656, -0.003249276662245393, -0.0617559514939785, -0.041984595358371735, 0.01709316484630108, 0.012281609699130058, 0.01127728819847107, -0.024379422888159752, -0.029433852061629295, -0.00916361715644598, 0.022593960165977478, 0.025193382054567337, -0.030011501163244247, -0.011323236860334873, 0.02055905945599079, -0.010036654770374298, 0.0038860037457197905, -0.023893671110272408, 0.0037875408306717873, -0.03959522768855095, 0.013902965933084488, 0.024038083851337433, -0.006511681713163853, -0.04726220667362213, 0.018826112151145935, 0.007266564294695854, -0.002973580500110984, -0.011841808445751667, -0.04497786611318588, 0.0012348892632871866, 0.036549441516399384, 0.013863581232726574, 0.012130632996559143, -0.0009690393344499171, -0.01061430387198925, 0.01740824617445469, -0.017250705510377884, 0.009465569630265236, 0.0009321157704107463, -0.04999291151762009, 0.01933811977505684, -0.032978519797325134, 0.012255352921783924, 0.010968770831823349, -0.033319856971502304, -0.016476130113005638, 0.004076365381479263, -0.03484274819493294, -0.007273128721863031, 0.006055470556020737, 0.04828622192144394, -0.03497403487563133, 0.024904558435082436, -0.04482032731175423, 0.01048958394676447, 0.02188502810895443, -0.016659928485751152, 0.029827704653143883, 0.028488608077168465, -0.006905533839017153, 0.027464594691991806, -0.049756601452827454, 0.01546524465084076, 0.010666817426681519, 0.009281772188842297, -0.002793065272271633, 0.008264321833848953, -0.01868169941008091, -0.016318589448928833, 0.04728846251964569, -0.030799204483628273, 0.01415240578353405, 0.017907125875353813, -0.02255457639694214, -0.013732297345995903, -0.007168101612478495, 0.027123255655169487, 0.03284723311662674, -0.04833873361349106, 0.0074503617361187935, -0.012150325812399387, 0.020493417978286743, -0.01799902319908142, 0.0018428978510200977, 0.018484774976968765, -0.006012802943587303, -0.011795858852565289, 0.027123255655169487, -0.02181938663125038, -0.00019025910296477377, 0.004004159010946751, -0.00321317370980978, -0.024668246507644653, -0.009216130711138248, -0.007516003679484129, -0.007680108770728111, 0.011054105125367641, 0.010673381388187408, -0.008494068868458271, 0.014034249819815159, -0.11164383590221405, -0.033950019627809525, -0.012524484656751156, -0.01528144720941782, -0.005809313151985407, -0.022423291578888893, 0.05112195387482643, 0.018235335126519203, -0.01925935037434101, -0.022318264469504356, 0.015058264136314392, 0.022108210250735283, 0.0019479249604046345, -0.01479569636285305, 0.04442647472023964, -0.015242061577737331, 0.020716600120067596, 0.012445714324712753, 0.02120235189795494, -0.044557757675647736, -0.03279472142457962, -0.0016968445852398872, -0.05881519243121147, 0.007653851993381977, -0.020847884938120842, 0.009741266258060932, -0.025928571820259094, -0.0007314975373446941, 0.02767464891076088, -0.01865544356405735, -0.02317160926759243, -0.02250206284224987, 0.013614141382277012, -0.0004627757880371064, -0.007772007491439581, 0.0688977986574173, -0.008290578611195087, -0.003204968525096774, 0.03303103148937225, 0.007785135880112648, -0.00886166375130415, 0.00917674507945776, 0.037205860018730164, 0.010699638165533543, 0.032295841723680496, -0.02704448625445366, -0.01610853523015976, -0.026545606553554535, 0.0027405517175793648, 0.009203001856803894, 0.041013091802597046, 0.001037142938002944, -0.0011807347182184458, 0.005139764863997698, 0.01961381547152996, 0.053563833236694336, -0.04151197150349617, 0.011677703820168972, -0.00931459292769432, 0.028803689405322075, 0.01159236952662468, 0.006035777740180492, 0.004345497582107782, -0.008284014649689198, -0.019049296155571938, 0.00755538884550333, -0.006508399732410908, 0.03090423159301281, -0.029827704653143883, -0.00806083157658577, -0.007817956618964672, 0.035814251750707626, 0.008743508718907833, 0.0011708883102983236, -0.011441392824053764, 0.0315869078040123, 0.0142968175932765, 0.0222263652831316, -0.022265750914812088, -0.017303219065070152, 0.026283038780093193, -0.03594553470611572, 0.02801598608493805, 0.013955479487776756, -0.03928014636039734, 0.021740615367889404, 0.0034232279285788536, -0.021320506930351257, 0.0010469892295077443, 0.021307379007339478, 0.017119422554969788, 0.021924413740634918, -0.02247580513358116, 0.006820199079811573, -0.05949786677956581, 0.024300651624798775, -0.03725837171077728, 0.042614758014678955, 0.03156065195798874, 0.0027996294666081667, 0.043560001999139786, 0.04056672751903534, 0.009734702296555042, 0.01869482919573784, 0.003413381753489375, 0.05797497555613518, -0.017158806324005127, -0.029040001332759857, -0.014716926030814648, 0.01837974786758423, 0.00539576867595315, -0.0024287523701786995, -0.030694177374243736, 0.04371754080057144, -0.022108210250735283, -0.009590289555490017, 0.04416390880942345, -0.016633670777082443, -0.044584017246961594, -0.012833002023398876, -0.0030983001925051212, 0.021373020485043526, 0.018839241936802864, 0.037494685500860214, -0.021044811233878136, -0.012170018628239632, -0.047813598066568375, -0.0023335714358836412, -0.029801446944475174, -0.008290578611195087, 0.02124173566699028, 0.019167451187968254, -0.01174334529787302, -0.004890325479209423, -0.007673544343560934, -0.009570596739649773, 0.04952029138803482, -0.02707074210047722, -0.003633282147347927, -0.032637178897857666, 0.005369511898607016, -0.014821953140199184, -0.006314755883067846, -0.0010469892295077443, -0.027149513363838196, 0.006659376434981823, 0.0247995313256979, 0.006662658415734768, -0.022987812757492065, 0.023040326312184334, 0.01396860834211111, 0.03368744999170303, 0.010824358090758324, 0.022593960165977478, -0.01957443170249462, 0.020519675686955452, -0.03184947744011879, -0.06506430357694626, 0.005536898970603943, -0.02445819228887558, -0.010528969578444958, 0.041643254458904266, 0.00997101329267025, -0.004161700140684843, 0.02314535342156887, -0.016200434416532516, -0.042641013860702515, 0.014139276929199696, -0.01765768602490425, 0.012793617323040962, -0.012320995330810547, 0.02349982038140297, 0.0031393265817314386, -0.010345172137022018, 0.039070092141628265, 0.06501179188489914, 0.043612513691186905, 0.016581157222390175, 0.011868065223097801, 0.05729229748249054, 0.010758716613054276, 0.04145945981144905, -0.012255352921783924, -0.0064690145663917065, 0.045161664485931396, -0.002756962087005377, 0.004601500928401947, 0.013410651125013828, 0.02061157301068306, -0.00897981971502304, 0.04250973090529442, 0.0036365643609315157, -0.02376238815486431, 0.021609332412481308, -0.022383905947208405, 0.024523833766579628, 0.04408513754606247, -0.026781916618347168, -0.013443471863865852, -0.0057764919474720955, 0.010056347586214542, 0.009216130711138248, -0.017303219065070152, 0.006912097800523043, -0.004217495676130056, 0.031350597739219666, -0.00013733527157455683, -0.012642640620470047, -0.029696419835090637, -0.026545606553554535, -0.03127182647585869, -0.0030983001925051212, 0.0025419846642762423, 0.0045194486156105995, 0.0008225757628679276, -0.0049395570531487465, -0.030694177374243736, -0.020375262945890427, -0.041065607219934464, -0.017132550477981567, -0.03484274819493294, -0.018865497782826424, -0.026178011670708656, 0.00033497909316793084, 0.021438661962747574, 0.025626618415117264, -0.020703472197055817, -0.0023007504642009735, 0.03513157367706299, 0.01605602167546749, -0.013495986349880695, 0.017788968980312347, -0.021307379007339478, -0.011887758038938046, 0.01935124769806862, -0.013784810900688171, -0.0003099531168118119, -0.01127728819847107, 0.0305891502648592, 0.017946509644389153, 0.005940597038716078, 0.018589802086353302, -0.0003515947319101542, -0.029197541996836662, 0.046159423887729645, 0.01668618433177471, 0.04915269464254379, 0.028462352231144905, -0.0060521881096065044, -0.004818119574338198, 0.013732297345995903, 0.019705714657902718, 0.007968933321535587, -0.03442263975739479, 0.023263508453965187, -0.01612166315317154, 0.004578526131808758, 0.030799204483628273, -0.019364377483725548, -0.008750072680413723, -0.015071392990648746, 0.0063410126604139805, -0.006761121563613415, -0.012924901209771633, -0.018471645191311836, -0.018458517268300056, -0.0009116026340052485, 0.025009585544466972, 0.018799856305122375, 0.009104538708925247, -0.03405504673719406, 0.0024632143322378397, 0.009498391300439835, 0.011861501261591911, -0.001695203478448093, -0.015675298869609833, -0.015452115796506405, -0.014520000666379929, -0.017158806324005127, -0.023027198389172554, -0.011146004311740398, -0.010010397993028164, -0.0046835532411932945, -0.005461410619318485, 0.035236600786447525, 0.007673544343560934, 0.0005222638137638569, -0.048417504876852036, 0.00866473838686943, 0.0038137976080179214, 0.047761086374521255, -0.0057929023168981075, -0.0015868942718952894, -0.0035774866119027138, 0.008415298536419868, -0.015320831909775734, 0.013331880792975426, 0.028409838676452637, -0.006413219030946493, -0.019994540140032768, 0.008782893419265747, 0.016646800562739372, -0.006085009314119816, 0.004204367287456989, 0.019206836819648743, 0.023342279717326164, 0.014244304038584232, -0.01644987426698208, 0.018852369859814644, 0.003400253364816308, -0.042929839342832565, -0.035577937960624695, 0.045896854251623154, -0.022436419501900673, 0.010358300060033798, 0.02439255081117153, -0.04657953232526779, 0.002983426908031106, -0.023604847490787506, 0.016607414931058884, 0.00836934894323349, 0.02893497422337532, 0.011887758038938046, 0.020204594358801842, 0.005110226105898619, -0.017198191955685616, 0.0015015597455203533, 0.03224332630634308, -0.003462613094598055, -0.029486365616321564, 0.06243862584233284, 0.01610853523015976, 0.008500632829964161, -0.0032279430888593197, -0.06485424935817719, -0.03119305707514286, -0.04925772175192833, 0.0017395118484273553, 0.005878237076103687, -0.02054593153297901, 0.006386962253600359, -0.034895263612270355, -0.007837649434804916, 0.0003954927669838071, 0.004578526131808758, 0.009905370883643627, 0.013456600718200207, -0.014677541330456734, 0.01802528090775013, 0.02407746948301792, 0.07572455704212189, 0.0028160398360341787, -0.029775191098451614, 0.029722677543759346, 0.04216839000582695, -0.011132875457406044, 0.03757345303893089, 0.01010886114090681, -0.00967562384903431, 0.006334448698908091, -0.03226958587765694, 0.04757728800177574, 0.023421049118041992, -0.0014121225103735924, 0.016266075894236565, 0.010548662394285202, 0.039096347987651825, -0.023893671110272408, 0.024261265993118286, 0.008310271427035332, 0.02129424922168255, 0.04723595082759857, 0.00652481010183692, -0.023368535563349724, 0.0006490348023362458, -0.006514964159578085, 0.009216130711138248, -0.04980911687016487, 0.011270723305642605, 0.04227341711521149, 0.015990380197763443, -0.037468425929546356, 0.005415461491793394, -0.020007668063044548, -0.04019913449883461, 0.013299060054123402, 0.028121013194322586, -0.00345933111384511, 0.018878625705838203, 0.02961765043437481, -0.0025944982189685106, 0.00836934894323349, 0.00773262232542038, -0.0008410375448875129, 0.014940109103918076, 0.019167451187968254, -0.02384115755558014, -0.030090272426605225, 0.012471971102058887, 0.0029079385567456484, 0.0024911120999604464, 0.02478640154004097, -0.021504303440451622, -0.03224332630634308, -0.022344522178173065, -0.03190198913216591, -0.005077405367046595, 0.04195833578705788, 0.0008640122250653803, 0.021976927295327187, -0.035866763442754745, -0.01638423278927803, -0.0017657686257734895, 0.032348357141017914, 0.01318090409040451, -0.03822987526655197, -0.024904558435082436, 0.0008324220543727279, 0.0012020682916045189, 0.05461410805583, -0.04022539034485817, -0.031324341893196106, 0.012576998211443424, -0.009130795486271381, 0.001673869788646698, 0.016161048784852028, 0.010594611056149006, -0.025180254131555557, 0.027832189574837685, 0.017565786838531494, 0.011513599194586277, -0.021044811233878136, -0.0019938743207603693, 0.009091410785913467, -0.019364377483725548, -0.042641013860702515, 0.018865497782826424, 0.012491663917899132, -0.0501767098903656, 0.024641990661621094, 0.0007868829416111112, -0.00029005538090132177, 0.0012463766615837812, 0.017001265659928322, 0.024878300726413727, 0.013187468983232975, -0.00930802896618843, 0.013312187977135181, -0.029066257178783417, 0.0034790236968547106, 0.009623110294342041, 0.006291781552135944, -0.01366665493696928, 0.01079810131341219, -0.055821917951107025, 0.023079711943864822, -0.03174445033073425, -0.007207486778497696, -0.0021481330040842295, -0.0041813924908638, -0.018117180094122887, -0.010765280574560165, 0.009760959073901176, -0.021793128922581673, 0.002673268551006913, -0.011342929676175117, -0.026296166703104973, 0.03119305707514286, -0.00392867112532258, -0.024379422888159752, 0.0038761573377996683, -0.009590289555490017, -0.0025255742948502302, -0.019863255321979523, -0.011631754226982594, 0.04096058011054993, -0.0025387026835232973, -0.018484774976968765, 0.015557142905890942, -0.012898644432425499, -0.01965320110321045, 0.010804666206240654, 0.02767464891076088, -0.006603580433875322, -0.024011826142668724, -0.00377441244199872, -0.007686672732234001, -0.016174178570508957, -0.006534656509757042, 0.002312237862497568, -0.021162966266274452, 0.02155681885778904, -0.002205569762736559, -0.04857504740357399, -0.005005198996514082, -0.004873915109783411, 0.03471146523952484, -0.022397035732865334, -0.02482578717172146, -0.0036825137212872505, 0.006554349325597286, 0.0009321157704107463, 0.02515399642288685, -0.019679458811879158, -0.010345172137022018, -0.04828622192144394, 0.017565786838531494, -0.02632242441177368, -0.027149513363838196, -0.017867740243673325, 0.014244304038584232, -0.0027011665515601635, 0.010076040402054787, -0.001742793945595622, 0.005110226105898619, 0.0240905974060297, 0.020440904423594475, -0.009130795486271381, 0.024628860875964165, 0.0027093717362731695, 0.023723002523183823, -0.029696419835090637, -0.0008295502047985792, -0.006977739743888378, 0.021333634853363037, -0.005858544260263443, 0.03213829919695854, -0.01433620322495699, 0.0041059041395783424, -0.018537288531661034, 0.0010043218499049544, -0.025259023532271385, 0.0173688605427742, -0.011402007192373276, 0.008763200603425503, 0.009203001856803894, -0.028383580967783928, -0.006682350765913725, -0.006012802943587303, -0.028147270902991295, 0.01610853523015976, -0.012833002023398876, 0.01190745085477829, -0.013410651125013828, 0.021950669586658478, -0.005175868049263954, -0.036470670253038406, -0.016515515744686127, 0.026598120108246803, 0.038466185331344604, -0.0017231013625860214, -0.019390633329749107, -0.011539855971932411, -0.010870307683944702, -0.018865497782826424, 0.006446039769798517, -0.00458180857822299, -0.005399050656706095, 0.015268318355083466, 0.028803689405322075, 0.007273128721863031, 0.03182321786880493, 0.008329964242875576, -0.014913852326571941, 0.05666213482618332, -0.005198842845857143, 0.03599804639816284, -0.010758716613054276, 0.018852369859814644, -0.046789586544036865, -0.005179150030016899, 0.018826112151145935, 0.013285931199789047, -0.03121931292116642, -0.005763363558799028, 0.022370778024196625, 0.02669001929461956, 0.022909041494131088, -0.0035282550379633904, -0.01835349015891552, 0.04928398132324219, 0.008736943826079369, 0.016213562339544296, 0.0035151266492903233, 0.007200922351330519, -0.018747342750430107, -0.01091625727713108, 0.028068499639630318, 0.028068499639630318, -0.016869982704520226, 0.003593896981328726, 0.03833490237593651, -0.017605172470211983, 0.01931186392903328, -0.017631428316235542, 0.004125596955418587, 0.010364864952862263, 0.00754882488399744, -0.016292333602905273, -0.0007286256877705455, 0.045214179903268814, -9.374491492053494e-05, -0.014309946447610855, -0.031954504549503326, 0.03791479393839836, -0.024707632139325142, -0.010666817426681519, -0.02449757792055607, -0.007220615167170763, 0.009852857328951359, -0.013587884604930878, 0.008841970935463905, 0.010443635284900665, 0.022081954404711723, 0.022961555048823357, 0.022423291578888893, -0.017552658915519714, -0.019443146884441376, -0.0374421700835228, -0.012938029132783413, 0.03022155538201332, -0.00978721585124731, -0.02223949506878853, -0.0014506871812045574, 0.005507360212504864, 0.000862371176481247, 0.007338770665228367, -0.011086925864219666, -0.010095732286572456, -0.011710524559020996, -0.000709753658156842, 0.004276573192328215, 0.005723978392779827, -0.025311537086963654, 0.006705325562506914, 0.037153344601392746, -0.0013415574794635177, 0.014546257443726063, 0.017500145360827446, -0.022383905947208405, 0.027149513363838196, -0.0027815778739750385, 0.029407596215605736, -0.008480940945446491, 0.008513761684298515, 0.01767081394791603, 0.016541773453354836, 0.002036541700363159, -0.011500470340251923, -0.0022974684834480286, -0.02247580513358116, -0.022042568773031235, 0.05156831815838814, 0.006101419683545828, -0.002417264971882105, 0.010903128422796726, 0.006912097800523043, 0.0002568241616245359, -0.033293601125478745, 0.010640560649335384, 0.02213446795940399, -0.01303649228066206, 0.016843724995851517, 0.0009961166651919484, 0.015018879435956478, 0.038098592311143875, -0.012268481776118279, -0.0146512845531106, -0.044242676347494125, 0.03090423159301281, -0.000365543644875288, 0.0016115099424496293, 0.010036654770374298, -0.011749910190701485, 0.03211204335093498, 0.00683332746848464, -0.002077567856758833, -0.006859584245830774, 0.01929873414337635, -0.01764455810189247, 0.035210344940423965, 0.039989080280065536, 0.05343255028128624, -0.0066134268417954445, 0.006475578993558884, 0.022357650101184845, -0.006931790616363287, -0.0019397197756916285, 0.033950019627809525, 0.012353816069662571, -0.02600734308362007, -0.01416553370654583, -0.0010272966464981437, 0.013679783791303635, -0.0009312952170148492, 0.04513540863990784, -0.008756636641919613, -0.0049559674225747585, -0.036470670253038406, -0.013784810900688171, 0.03933265805244446, 0.028121013194322586, 0.019482532516121864, -0.008881356567144394, -0.009708445519208908, 0.003173788543790579, -0.014572514221072197, 0.009445877745747566, -0.03087797574698925, 0.0009165257797576487, -0.04400636628270149, -0.002647011773660779, -0.004128878936171532, 0.021123580634593964, -0.010049783624708652, 0.009820036590099335, -0.008690995164215565, -0.010633996687829494, 0.0026962433476001024, 0.0031212749890983105, 0.017539530992507935, -0.009157052263617516, 0.04594936966896057, -0.02932882495224476, 0.0003236968768760562, -0.014047378674149513, -0.029696419835090637, 0.00787047017365694, 0.009413056075572968, -0.03838741406798363, 0.01602976582944393, -0.03759971261024475, 0.029722677543759346, -0.0017231013625860214, 0.022357650101184845, -0.0022383907344192266, -0.008415298536419868, -0.02381490170955658, -0.01957443170249462]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-14T10:14:11.946922", "url_path": "/multi-agent-applications/", "chunk_size": 4848}
updated_dt: 2025-03-14T10:14:11.946922
---
```
fromtypingimport Literal, Union
frompydanticimport BaseModel, Field
fromrich.promptimport Prompt
frompydantic_aiimport Agent, RunContext
frompydantic_ai.messagesimport ModelMessage
frompydantic_ai.usageimport Usage, UsageLimits

classFlightDetails(BaseModel):
  flight_number: str

classFailed(BaseModel):
"""Unable to find a satisfactory choice."""

flight_search_agent = Agent[None, Union[FlightDetails, Failed]]( 
Define the first agent, which finds a flight. We use an explicit type annotation until PEP-747[](https://peps.python.org/pep-0747/) lands, see structured results[](https://ai.pydantic.dev/results/#structured-result-validation). We use a union as the result type so the model can communicate if it's unable to find a satisfactory choice; internally, each member of the union will be registered as a separate tool.
[](https://ai.pydantic.dev/multi-agent-applications/#__code_2_annotation_1)
  'openai:gpt-4o',
  result_type=Union[FlightDetails, Failed], # type: ignore
  system_prompt=(
    'Use the "flight_search" tool to find a flight '
    'from the given origin to the given destination.'
  ),
)

@flight_search_agent.tool 
Define a tool on the agent to find a flight. In this simple case we could dispense with the tool and just define the agent to return structured data, then search for a flight, but in more complex scenarios the tool would be necessary.
[](https://ai.pydantic.dev/multi-agent-applications/#__code_2_annotation_2)
async defflight_search(
  ctx: RunContext[None], origin: str, destination: str
) -> Union[FlightDetails, None]:
  # in reality, this would call a flight search API or
  # use a browser to scrape a flight search website
  return FlightDetails(flight_number='AK456')

usage_limits = UsageLimits(request_limit=15) 
Define usage limits for the entire app.
[](https://ai.pydantic.dev/multi-agent-applications/#__code_2_annotation_3)

async deffind_flight(usage: Usage) -> Union[FlightDetails, None]: 
Define a function to find a flight, which asks the user for their preferences and then calls the agent to find a flight.
[](https://ai.pydantic.dev/multi-agent-applications/#__code_2_annotation_4)
  message_history: Union[list[ModelMessage], None] = None
  for _ in range(3):
    prompt = Prompt.ask(
      'Where would you like to fly from and to?',
    )
    result = await flight_search_agent.run(
      prompt,
      message_history=message_history,
      usage=usage,
      usage_limits=usage_limits,
    )
    if isinstance(result.data, FlightDetails):
      return result.data
    else:
      message_history = result.all_messages(
        result_tool_return_content='Please try again.'
      )

classSeatPreference(BaseModel):
  row: int = Field(ge=1, le=30)
  seat: Literal['A', 'B', 'C', 'D', 'E', 'F']

# This agent is responsible for extracting the user's seat selection
seat_preference_agent = Agent[None, Union[SeatPreference, Failed]]( 
As with flight_search_agent above, we use an explicit type annotation to define the agent.
[](https://ai.pydantic.dev/multi-agent-applications/#__code_2_annotation_5)
  'openai:gpt-4o',
  result_type=Union[SeatPreference, Failed], # type: ignore
  system_prompt=(
    "Extract the user's seat preference. "
    'Seats A and F are window seats. '
    'Row 1 is the front row and has extra leg room. '
    'Rows 14, and 20 also have extra leg room. '
  ),
)

async deffind_seat(usage: Usage) -> SeatPreference: 
Define a function to find the user's seat preference, which asks the user for their seat preference and then calls the agent to extract the seat preference.
[](https://ai.pydantic.dev/multi-agent-applications/#__code_2_annotation_6)
  message_history: Union[list[ModelMessage], None] = None
  while True:
    answer = Prompt.ask('What seat would you like?')
    result = await seat_preference_agent.run(
      answer,
      message_history=message_history,
      usage=usage,
      usage_limits=usage_limits,
    )
    if isinstance(result.data, SeatPreference):
      return result.data
    else:
      print('Could not understand seat preference. Please try again.')
      message_history = result.all_messages()

async defmain(): 
Now that we've put our logic for running each agent into separate functions, our main app becomes very simple.
[](https://ai.pydantic.dev/multi-agent-applications/#__code_2_annotation_7)
  usage: Usage = Usage()
  opt_flight_details = await find_flight(usage)
  if opt_flight_details is not None:
    print(f'Flight found: {opt_flight_details.flight_number}')
    #> Flight found: AK456
    seat_preference = await find_seat(usage)
    print(f'Seat preference: {seat_preference}')
    #> Seat preference: row=1 seat='A'

```

_(This example is complete, it can be run "as is" â€” you'll need to add`asyncio.run(main())` to run `main`)_
The control flow for this example can be summarised as follows: