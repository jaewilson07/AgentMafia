---
url: https://ai.pydantic.dev/api/agent/
session_id: pydantic_ai_docs
chunk_number: 48
title: Agent API - Message Handling
summary: This section describes the message handling methods in the Agent API, including the 'all_messages' function that returns the history of messages based on the result of a tool call. It also details the parameters used for message modification and return data structure.
embedding: [0.04858057200908661, 0.01894829422235489, 0.01541813649237156, -0.013325758278369904, 0.024921506643295288, 0.016423413529992104, -0.04801948741078377, -0.01541813649237156, -0.009696242399513721, 0.01026317197829485, -0.01860930398106575, -0.02424352988600731, -0.01699618622660637, -0.028171120211482048, 0.0025409532245248556, 0.009965095669031143, -0.011367807164788246, 0.012601024471223354, -0.0013917527394369245, 0.060456860810518265, 0.042595669627189636, 0.007679845206439495, 0.014623266644775867, -0.011660038493573666, -0.00385453412309289, -0.01665719784796238, -0.011741863563656807, 0.043764594942331314, 0.01656368374824524, -0.022490140050649643, -0.04834678769111633, -0.01966133899986744, -0.04762205109000206, -0.029643967747688293, 0.014389481395483017, 0.009620262309908867, -0.004772141110152006, 0.029643967747688293, 0.014377792365849018, 0.009959250688552856, 0.0027688939590007067, -0.026394352316856384, 0.02604367583990097, 0.024383800104260445, -0.015371379442512989, 0.02662813849747181, -0.006674568634480238, 0.0525081641972065, 0.01535969041287899, 0.0008576996042393148, 0.0016277297399938107, 0.03366507217288017, 0.01746375672519207, -0.0021552075631916523, -0.04102930799126625, -0.006113484036177397, -0.013395894318819046, -0.009667019359767437, -0.0064641619101166725, -0.051198966801166534, 0.014342724345624447, -0.0205029658973217, 0.014377792365849018, 0.01988343521952629, 0.007001867983490229, 0.0026052442844957113, -0.022899264469742775, 0.012063317932188511, -0.006505073979496956, 0.0007671078201383352, -0.011473010294139385, 0.0025730987545102835, -0.07434370368719101, -0.017533892765641212, -0.02662813849747181, -0.03223898261785507, 0.051292479038238525, 0.03237925469875336, -0.005029304884374142, -0.026745030656456947, -0.007977921515703201, 0.026651516556739807, -0.014798605814576149, 0.06831204891204834, -0.013243933208286762, -0.004859810695052147, 0.0038603786379098892, -0.02217452973127365, 0.0015122982440516353, -0.03130384162068367, -0.04114620015025139, -0.015745434910058975, -0.019205456599593163, 0.005049760919064283, 0.060643889009952545, -0.004611413925886154, -0.009146847762167454, -0.0035623025614768267, -0.016154559329152107, 0.010222258977591991, 0.05199383571743965, -0.05751116946339607, -0.04016430303454399, 0.06265444308519363, 0.024804612621665, 0.01650523766875267, 0.017381932586431503, -0.008042212575674057, -0.014950565993785858, 0.011432098224759102, -0.05709035322070122, -0.011496389284729958, 0.0035330792888998985, 0.010362530127167702, -0.05171329528093338, 0.013290690258145332, -0.04512055218219757, 0.012577645480632782, 0.04762205109000206, 0.0048539661802351475, -0.055594127625226974, -0.031046679243445396, 0.023273320868611336, 0.0017709231469780207, 0.016926050186157227, -0.005531942937523127, -0.034226156771183014, -0.022712236270308495, -0.034109264612197876, 0.01650523766875267, 0.08215212821960449, 0.009216982871294022, 0.013524475507438183, -0.034880757331848145, -0.01088270265609026, -0.00879616942256689, 0.009082556702196598, 0.003527234774082899, -0.06812501698732376, 0.035839278250932693, 0.02616056799888611, 0.007539574056863785, -0.054331690073013306, 0.009216982871294022, -0.016107803210616112, 0.0367276594042778, -0.025692997500300407, -0.037662800401449203, -0.002665151609107852, -0.0357925184071064, 0.010315773077309132, 0.016867604106664658, -0.02777368575334549, -0.002878480823710561, -0.013781639747321606, 0.004807209130376577, 0.05278870463371277, 0.03130384162068367, 0.02210439369082451, -0.017791057005524635, -0.03235587850213051, 0.031935062259435654, -0.016271453350782394, -0.009667019359767437, -0.04219823330640793, -0.008077279664576054, -0.02229142189025879, -0.0305323526263237, -0.027913957834243774, -0.06410390883684158, -0.01087101362645626, -0.011899668723344803, 0.007340856362134218, -0.04467635974287987, 0.005131585989147425, -0.03997727483510971, -0.060363348573446274, -0.041543636471033096, -0.039837002754211426, -0.013442651368677616, -0.0007641855045221746, 0.0002219133311882615, -0.07289423793554306, -0.08734216541051865, -0.03756928816437721, -0.018375519663095474, 0.01727672852575779, 0.03359493985772133, 0.024781234562397003, 0.040117546916007996, -0.024874748662114143, -0.004669860005378723, 0.049188412725925446, 0.013629679568111897, 0.0022574886679649353, -0.010105366818606853, 0.04685056209564209, 0.002013475401327014, 0.004132153932005167, 0.0309999231249094, 0.026932058855891228, 0.05512655898928642, 0.06443121284246445, -0.02022242359817028, 0.004301648121327162, -0.05068463832139969, -0.029269911348819733, 0.01020472589880228, -0.025692997500300407, -0.051573023200035095, -0.011332739144563675, -0.03572238236665726, 0.0007185243302956223, -0.025225427001714706, -0.0007619937532581389, -0.0008306681411340833, -0.10380064696073532, 0.02133290283381939, -0.037078339606523514, 0.0310233011841774, 0.03301047533750534, 0.028311392292380333, 0.06620797514915466, -0.0028828640934079885, -0.00041825638618320227, 0.025809889659285545, 0.009567661210894585, -0.025739753618836403, -0.011928891763091087, 0.025692997500300407, 0.014857051894068718, -0.004585112910717726, -0.04806624352931976, -0.031233707442879677, 0.02093546837568283, -0.04558812081813812, 0.04988976940512657, 0.01517266221344471, 0.03532494977116585, -0.034109264612197876, 0.0035623025614768267, 0.002796655986458063, 0.017229972407221794, 0.04261904954910278, -0.013956978917121887, -0.00524847861379385, 0.005619612522423267, -0.04923516884446144, 0.014225831255316734, 0.03130384162068367, 0.046616777777671814, 0.0077675143256783485, 0.021566687151789665, -0.00770322373136878, -0.013279001228511333, -0.005531942937523127, -0.05241464823484421, 0.011695106513798237, -0.017580648884177208, 0.0310233011841774, 0.06171930208802223, -0.007890251465141773, -0.015055769123136997, 0.041660528630018234, 0.002822956768795848, 0.0054881083779037, 0.028568556532263756, -0.009696242399513721, -0.0155116505920887, -0.013056905008852482, 0.013466029427945614, -0.010467734187841415, 0.05363033339381218, 0.022349867969751358, -0.013617989607155323, 0.020760128274559975, -0.022408314049243927, -0.0012668237322941422, 0.037545908242464066, -0.01489211991429329, 0.010374220088124275, 0.04121633619070053, 0.016855916008353233, 0.0030567420180886984, 0.001529832137748599, 0.010461889207363129, -0.003267148742452264, 0.021110806614160538, -0.010748276486992836, -0.015184351243078709, 0.0008759640622884035, -6.502151518361643e-05, 0.012133453972637653, -0.012904944829642773, 0.005879698786884546, 0.030134916305541992, 0.028100986033678055, 0.01650523766875267, -0.02653462439775467, 0.003749330760911107, -0.014845362864434719, -0.056809812784194946, 0.020479585975408554, -0.006960955448448658, 0.016668887808918953, 0.039930518716573715, -0.010771654546260834, -0.040608495473861694, 0.045564740896224976, 0.008930595591664314, 0.00010502071381779388, 0.04502703621983528, -0.02739962935447693, -0.02229142189025879, -0.04388148710131645, -0.013466029427945614, 0.02728273719549179, -0.03761604428291321, 0.012565956450998783, 0.016551993787288666, -0.014155696146190166, -0.0396265983581543, 0.03572238236665726, 0.015581785701215267, -0.03616657480597496, 0.008924751542508602, -0.03394561633467674, -0.020210733637213707, -0.0077207572758197784, 0.019147010520100594, -0.003258381737396121, 0.016820847988128662, 0.02632421813905239, 0.041263092309236526, 0.02863869071006775, 0.006820684298872948, -0.0214614849537611, -0.007282410282641649, -0.010970371775329113, 0.04467635974287987, -0.010771654546260834, 0.043180134147405624, -0.06817177683115005, -0.058259282261133194, -0.014260899275541306, 0.014810294844210148, 0.005903077311813831, 0.03635360300540924, -0.02845166251063347, 0.016154559329152107, 0.046710290014743805, 0.03967335447669029, 0.049188412725925446, 0.01975485309958458, 0.0002765241079032421, -0.022244665771722794, -0.014272588305175304, 0.02170695923268795, 0.001735855359584093, 0.02938680350780487, -0.046429749578237534, 0.008965663611888885, -0.0077207572758197784, -0.05218086391687393, -0.00013278270489536226, 0.0305323526263237, -0.06606771051883698, -0.0010432666167616844, -0.013127041049301624, 0.011169089935719967, 0.03282344713807106, -0.030508972704410553, 0.02365906536579132, 0.0007824499625712633, -0.029410183429718018, -0.020549722015857697, -0.014424549415707588, -0.003305138787254691, -0.01885478012263775, 0.03995389863848686, -0.005613768007606268, 0.013115352019667625, 0.021777095273137093, -0.0023846093099564314, 0.02721260115504265, 0.0035944480914622545, -0.0014304734067991376, -0.007522040046751499, 0.0219524335116148, -0.000744825170841068, 0.029527075588703156, -0.014494684524834156, -0.019895123317837715, -0.004807209130376577, 0.007598020136356354, 0.009725465439260006, 0.011005439795553684, 0.009707932360470295, 0.032987095415592194, 0.008930595591664314, 0.010017697699368, 0.019123632460832596, -0.0009329491876997054, 0.006458316929638386, -0.010847634635865688, -0.0038603786379098892, -0.012413996271789074, -0.006002435926347971, 0.02985437400639057, -0.013746571727097034, 0.03932267799973488, 0.04858057200908661, -0.01493887696415186, -0.02758665755391121, -0.013886842876672745, -0.04261904954910278, 0.03149086982011795, 0.07093044370412827, 0.03855118528008461, 0.014050493016839027, -0.016049357131123543, -0.05793198198080063, -0.02353048324584961, 0.003457099199295044, -0.030321944504976273, 0.03408588841557503, 0.038691457360982895, -0.03226236253976822, -0.0016438023885712028, -0.07588668912649155, -0.042408641427755356, 0.008240929804742336, 0.029410183429718018, -0.01938079670071602, 0.008053901605308056, -0.0214848630130291, 0.021905677393078804, 0.010608005337417126, 0.005642991047352552, -0.010689829476177692, 0.06859258562326431, -0.002592093776911497, -0.017452068626880646, 0.037265367805957794, -0.045097172260284424, -0.014634955674409866, -0.024453936144709587, -0.013197176158428192, 0.07794399559497833, -0.01737024262547493, 0.06541310995817184, -0.0069901784881949425, -0.060456860810518265, -0.023331766948103905, -0.06003604829311371, 1.325315679423511e-05, 0.047458402812480927, -0.0021391347981989384, 0.032402634620666504, -0.05063788220286369, 0.036797795444726944, 0.009222827851772308, -0.02223297581076622, 0.02371751144528389, -0.01821186952292919, -0.06700284779071808, -0.0010827179066836834, -0.025435833260416985, -0.00563422404229641, 0.022735614329576492, 0.04325027018785477, -0.010876857675611973, 0.012752984650433064, 0.0033635850995779037, 0.0044097742065787315, -0.017510514706373215, 0.00520172156393528, 0.02112249657511711, 0.03184155002236366, -0.004918256774544716, 0.0017796901520341635, -0.0396265983581543, -0.04649988189339638, -0.03128046542406082, -0.05077815428376198, -0.0037697870284318924, 0.00774998078122735, -0.0629817396402359, -0.009906649589538574, -0.006411559879779816, 0.008392889983952045, 0.040117546916007996, -0.015114215202629566, -0.010479423217475414, 0.007177206687629223, 0.005876776296645403, -0.009404011070728302, -0.002529263962060213, 0.005026382394134998, -0.04446595162153244, -0.03824726492166519, -0.006364802829921246, 0.01860930398106575, 0.015932463109493256, 0.04332040250301361, -0.03371183201670647, -0.006616122089326382, -0.022209597751498222, -0.0013055443996563554, 0.025716375559568405, -0.045003656297922134, -0.021636823192238808, 0.009415700100362301, 0.0012792436173185706, 0.027913957834243774, 0.001963796094059944, 0.002028086921200156, -0.011993182823061943, -0.014459616504609585, -0.011952269822359085, 0.0362834669649601, -0.015909085050225258, 0.019614581018686295, -0.017755988985300064, 0.0183638297021389, 0.016107803210616112, -0.0013859081082046032, -0.013968667946755886, 0.01594415307044983, 0.003036285750567913, 0.02322656288743019, 0.004956246819347143, 0.026932058855891228, -0.002511730184778571, -0.003208702430129051, -0.03139735758304596, -0.008743567392230034, -0.004538355860859156, -0.013372515328228474, 0.0032320809550583363, 0.022069325670599937, 0.047762323170900345, -0.0006666532135568559, 0.006581054534763098, 0.021777095273137093, 0.05161977931857109, 0.009474147111177444, 0.02381102554500103, 0.014763537794351578, 0.002736748429015279, -0.00022173069010023028, -0.009269584901630878, 0.04458284378051758, -0.054705746471881866, 0.004845199175179005, -0.006119328550994396, -0.038691457360982895, -0.047575294971466064, 0.04152025654911995, 0.022466761991381645, -0.002971994923427701, -0.010625539347529411, 0.04196444898843765, 0.06097118929028511, -0.021929055452346802, 0.021344592794775963, 0.05199383571743965, 0.04970274120569229, -0.025996917858719826, 0.010397598147392273, 0.0849107950925827, 0.013711503706872463, 0.002282328438013792, -0.03186492621898651, -0.006844062823802233, -0.012858187779784203, 0.0064875404350459576, 0.02279406040906906, -0.0667690634727478, 0.02768017165362835, -0.013302380219101906, -0.029129641130566597, 0.029807617887854576, 0.007995455525815487, -0.021730337291955948, 0.012004871852695942, -0.021660201251506805, -0.0017577727558091283, 0.018924914300441742, -0.034389808773994446, -0.0033928081393241882, 0.018282005563378334, -0.006446627900004387, -0.020877022296190262, -0.031935062259435654, 0.025505969300866127, 0.002409449080005288, -0.00885461550205946, -0.02938680350780487, 0.00774998078122735, 0.0025015019346028566, 0.0025964772794395685, -0.03399237245321274, 0.044816628098487854, -0.0018366752192378044, 0.005327381193637848, -0.018714508041739464, -0.007977921515703201, -0.06817177683115005, 0.015032391063869, 0.008398734964430332, -0.004383473191410303, -0.04853381589055061, -0.011344428174197674, 0.009491680189967155, 0.015020701102912426, -0.023448659107089043, 0.014821983873844147, 0.0386447012424469, -0.031911686062812805, -0.02322656288743019, -0.018959982320666313, 0.020175665616989136, -0.015862328931689262, 0.020047083497047424, 0.0007729524513706565, -0.012203589081764221, -0.012811430729925632, -0.002916470868512988, 0.008860460482537746, -0.014401170425117016, -0.0038633011281490326, 0.04923516884446144, -0.02061985805630684, -0.019965259358286858, 0.013115352019667625, 0.013933599926531315, 0.03799010068178177, -0.005312769673764706, -0.013851774856448174, 0.04028119519352913, 0.030649244785308838, 0.007410991936922073, -0.00629466725513339, 0.016855916008353233, 0.006306356750428677, -0.017604028806090355, -0.0028974758461117744, -0.0043074931018054485, 0.019824987277388573, 0.004804286640137434, -0.02018735557794571, 0.021157564595341682, -0.006411559879779816, 0.016201317310333252, 0.0014640800654888153, 0.004780908115208149, 0.017101390287280083, -0.007551263086497784, -0.007130449637770653, -0.055781155824661255, 0.015394757501780987, -0.020456207916140556, 0.02365906536579132, -2.8104455850552768e-05, 0.0024401333648711443, -0.0014443544205278158, -0.0006246449192985892, 0.042408641427755356, 0.021625135093927383, 0.000777335895691067, 0.00842211302369833, 0.023577241227030754, -0.003874990390613675, 0.01111648790538311, 0.01814173348248005, 0.03118695132434368, -0.01988343521952629, -0.0023115514777600765, 0.051666535437107086, -0.02870882675051689, -0.0009081095340661705, -0.05554737150669098, -0.022221285849809647, 0.041543636471033096, -0.034413184970617294, 0.004865655209869146, -0.005283546168357134, 0.022770682349801064, 0.006458316929638386, 0.009544282220304012, -0.014997323043644428, -0.008211706764996052, 0.0064641619101166725, 0.02350710518658161, -0.004120464902371168, 0.008819548413157463, -0.014073871076107025, 0.027446387335658073, -0.036400362849235535, -0.007533729076385498, -0.026090431958436966, -0.01258933451026678, 0.0008219011942856014, -0.03705495968461037, 0.034413184970617294, -0.029550453647971153, -0.01669226586818695, 0.007054469548165798, 0.009123468771576881, -0.01628314144909382, 0.012788052670657635, -0.004035717807710171, 0.03310398757457733, -0.012413996271789074, 0.0053244587033987045, -0.012717916630208492, 0.011700951494276524, 0.027984092012047768, -0.015897396951913834, 0.016049357131123543, 0.004167221952229738, -0.059007395058870316, 0.01006445474922657, 0.0048568882048130035, -0.028311392292380333, -0.009240361861884594, 0.0467570461332798, -0.013968667946755886, -0.007533729076385498, -0.02157837711274624, 0.03184155002236366, -0.00442146323621273, -0.01873788610100746, -0.026955436915159225, -0.043460674583911896, -0.04009416699409485, 0.017054632306098938, 0.00770322373136878, -0.0016394190024584532, -0.009374788030982018, -0.006177774630486965, -0.0032729932572692633, -0.03691468760371208, 0.009883270598948002, -0.024266907945275307, -0.027119087055325508, 0.000471588660730049, -0.040795523673295975, 0.011724329553544521, -0.004100008402019739, 0.006405715364962816, -0.009818979538977146, 0.009363099001348019, 0.038878485560417175, 0.013653057627379894, 0.01802484132349491, -0.018936604261398315, -0.02174202725291252, 0.021099116653203964, 0.006458316929638386, 0.04063187539577484, -0.022934332489967346, 0.0410526879131794, -0.007305788807570934, 0.0015006089815869927, 0.008258463814854622, 0.017346864566206932, -0.004552967380732298, -0.021590067073702812, -0.04682718217372894, 0.010935304686427116, 0.040070790797472, 0.0367276594042778, 0.02164851315319538, -0.004967936314642429, 0.026207324117422104, -0.03607306256890297, 0.011005439795553684, 0.01712476834654808, 0.020760128274559975, 0.013173798099160194, 0.009567661210894585, -0.012519199401140213, 0.024196771904826164, 0.0037639422807842493, -0.01984836719930172, -0.020245801657438278, 0.010046920739114285, -0.02353048324584961, -0.021870609372854233, -0.007212274707853794, 0.027259359136223793, 0.022712236270308495, -0.016107803210616112, 0.013454340398311615, 0.017510514706373215, -0.044512707740068436, -0.009211137890815735, 0.04692069813609123, -0.027610035613179207, 0.015032391063869, 0.016423413529992104, -0.051105450838804245, 0.02910626120865345, -0.01521941926330328, -0.035067785531282425, 0.01078918855637312, -0.03415602445602417, 0.01935741677880287, -0.0314674936234951, 0.008182482793927193, 0.019462620839476585, -0.013980356976389885, -0.03572238236665726, 0.031046679243445396, -0.012963390909135342, -0.016481859609484673, 0.002901859348639846, -0.04783245921134949, -0.014401170425117016, -0.011028818786144257, -0.006516763474792242, -0.022244665771722794, 0.02517866902053356, 0.05264843627810478, -0.009965095669031143, -0.02718922309577465, 0.03378196805715561, 0.0012244501849636436, -0.013746571727097034, -0.06134524568915367, 0.021473173052072525, 0.003629515878856182, 0.04493352398276329, -0.017966395244002342, -0.04196444898843765, 0.05306924879550934, -0.01601428911089897, 0.011034662835299969, -0.000665922649204731, 0.00969039835035801, -0.015207729302346706, -0.009591039270162582, -0.0014933032216504216, 0.02281743846833706, 0.026277460157871246, 0.010140434838831425, -0.01512590516358614, -0.02690868079662323, 0.01011121179908514, 0.0544252023100853, 0.03997727483510971, -0.02393960766494274, -0.021414726972579956, -0.009456613101065159, 0.016177939251065254, 0.008778635412454605, -0.005640069022774696, -0.01997694931924343, -0.01761571690440178, 0.0031590228900313377, -0.029503697529435158, -0.006697947159409523, 0.006014125421643257, -0.018445655703544617, -0.006914198398590088, -0.002624239306896925, 0.03263641893863678, -0.024921506643295288, 0.013033526949584484, -0.00510236294940114, -0.009035799652338028, 0.04119295999407768, -0.00030501667060889304, -0.01173601858317852, 0.02324994094669819, 0.009421545080840588, 0.0030245964881032705, 0.017779367044568062, 0.014167385175824165, -0.046032313257455826, 0.011046352796256542, 0.038317400962114334, 0.009146847762167454, 0.021847229450941086, 0.006978489458560944, 0.028568556532263756, 0.02595016174018383, 0.02634759619832039, 0.001340612187050283, -0.05998929217457771, -0.011326895095407963, -0.008772791363298893, -0.007188896182924509, 0.02037438377737999, -0.04715448245406151, 0.009930027648806572, 0.022431693971157074, -0.012203589081764221, -0.001879048882983625, -0.02074844017624855, 0.01230879221111536, -0.007960387505590916, -0.0343664288520813, 0.024594206362962723, 0.07093044370412827, 0.010093677788972855, -0.010046920739114285, 0.02632421813905239, 0.051666535437107086, -0.013699814677238464, 0.0051987990736961365, 0.03476386517286301, -0.025692997500300407, -0.03389886021614075, 0.013547854498028755, -0.04659339785575867, 0.02749314345419407, 0.02985437400639057, 0.01659875176846981, 0.0013946749968454242, 0.0410059317946434, -0.03546522185206413, 0.019860055297613144, 0.0005486647132784128, 0.02155499905347824, -0.028498420491814613, 0.024804612621665, -0.04145012050867081, 0.013594611547887325, -0.058820366859436035, 0.018901536241173744, 0.011034662835299969, -0.04420878738164902, 0.016961118206381798, 0.00775582529604435, -0.04350743070244789, 0.0050614504143595695, 0.0012193361762911081, 0.0025482589844614267, -0.04224499315023422, -0.016680575907230377, 0.02090040035545826, 0.0014414320467039943, -0.01030992902815342, -0.03368845209479332, 0.005517331417649984, -0.0036821174435317516, 0.021157564595341682, 0.015581785701215267, -0.01173601858317852, 0.04640636965632439, -0.006633656099438667, -0.016528615728020668, 0.00293400464579463, 0.0016540305223315954, -0.028475042432546616, 0.07621398568153381, -0.007083692587912083, -0.011718484573066235, 0.0008460103417746723, -0.01622469536960125, -0.02756327949464321, -0.017966395244002342, -0.009246205911040306, 0.05026382580399513, -0.003988960757851601, 0.04016430303454399, -0.0037405637558549643, -0.0007744135800749063, 0.005473496858030558, 0.037452396005392075, 0.009024109691381454, 0.020771818235516548, 0.02238493598997593, 0.060363348573446274, 0.011233380995690823, 0.03219222649931908, 0.02461758442223072, -0.0012733989860862494, -0.0015648999251425266, -0.0042402795515954494, 0.0039188251830637455, 0.04000065475702286, -0.02056141197681427, -0.008322753943502903, 0.03275331109762192, 0.030111538246273994, -0.0169377401471138, 0.05564088746905327, 0.018924914300441742, 0.01675071194767952, -0.011040507815778255, -0.018153423443436623, -0.026487866416573524, 0.011619126424193382, 0.032098714262247086, 0.06901340186595917, 0.018165113404393196, -0.04275931790471077, 0.058072254061698914, 0.035254813730716705, 0.004596802406013012, 0.005330303218215704, -0.012951701879501343, 0.00615439610555768, -0.0028507187962532043, 0.0014779610792174935, 0.003062586532905698, -0.006399870850145817, -0.03644711896777153, -0.0053244587033987045, -0.00505560589954257, -0.01823524758219719, 0.02728273719549179, -0.01802484132349491, -0.025833267718553543, 0.015231108292937279, -0.009497525170445442, 0.004111697897315025, -0.020736750215291977, 0.028662070631980896, 0.0028828640934079885, 0.04579852893948555, 0.03948632627725601, -0.00814157072454691, 0.01917038857936859, 0.0012587873497977853, -0.03941619023680687, -0.025833267718553543, 0.03492751345038414, -0.019801609218120575, 0.03219222649931908, 0.009836513549089432, -0.02127445675432682, 0.004763374105095863, -0.007183051202446222, 0.026487866416573524, -0.013594611547887325, 0.010625539347529411, 0.03165452182292938, 0.00413507642224431, 0.043063241988420486, 0.03532494977116585, 0.016306519508361816, -0.01981329917907715, 0.018562547862529755, 0.006481695454567671, -0.0028594855684787035, -0.007674000225961208, 0.025809889659285545, -0.019030118361115456, -0.0032203916925936937, 0.006709636189043522, 0.002242877148091793, 0.04367108270525932, 0.014260899275541306, 0.0124023063108325, 0.01579219289124012, 0.023425281047821045, -0.01489211991429329, -0.011379496194422245, -0.015207729302346706, 0.002099683741107583, 0.03576914221048355, 0.020105529576539993, -0.004725384060293436, 0.02396298758685589, 0.04058511555194855, -0.005683903582394123, -0.017907949164509773, -0.037826452404260635, -0.02065492607653141, -0.025716375559568405, -0.008334443904459476, 0.011613281443715096, -0.026932058855891228, -0.03223898261785507, -0.01994188129901886, -0.031070057302713394, -0.000761263188906014, 0.001848364481702447, 0.01864437200129032, -0.054705746471881866, 0.030649244785308838, 0.013769950717687607, -0.00624791020527482, 0.012367239221930504, 0.012530888430774212, 0.0005095787346363068, 0.0011871906463056803, 0.011806154623627663, -0.004254891071468592, 0.003965582232922316, 0.0031502561178058386, -0.0034541769418865442, 0.020082151517271996, -0.0012244501849636436, -0.0020324704237282276, -0.016645507887005806, -0.0315142497420311, -0.0006995292496867478, 0.009205293841660023, -0.011946425773203373, 0.0003355183289386332, 0.005812485236674547, -0.018808022141456604, 0.008007144555449486, 0.022548586130142212, 0.010678140446543694, 0.013688125647604465, 0.014202453196048737, -0.014073871076107025, -0.03167789801955223, -0.008708500303328037, 0.006171930115669966, -0.013407583348453045, 0.01808328740298748, 0.03663414716720581, -0.03492751345038414, -0.006189464125782251, -0.02176540531218052, 0.00959688425064087, 0.017755988985300064, 0.004734151065349579, -0.015020701102912426, 0.03572238236665726, 0.02270054630935192, -0.03443656489253044, -0.006692102178931236, -0.05666954070329666, 0.014144007116556168, -0.03476386517286301, -0.009199448861181736, -0.004479909781366587, -0.04091241583228111, -0.025318941101431847, -0.005605001002550125, -0.002878480823710561, 0.0014823444653302431, 0.015628542751073837, 0.0036090596113353968, 0.03504440560936928, -0.005204643588513136, 0.016458479687571526, 0.034600213170051575, 0.06718987971544266, 0.021192630752921104, 0.005005926359444857, 0.014821983873844147, -0.006896664388477802, 0.007223963737487793, -0.04455946758389473, -0.004114619921892881, -0.01588570699095726, -0.01706632226705551, -0.025903403759002686, 0.012834809720516205, 0.02183554135262966, -0.0019988638814538717, 0.01864437200129032, 0.02260703220963478, 0.021262766793370247, 0.013840085826814175, 0.0030508972704410553, -0.011139866895973682, -0.00255118147470057, 0.01512590516358614, -0.02728273719549179, -0.006592743564397097, -0.010081988759338856, 0.007901941426098347, 0.03738225996494293, -0.040070790797472, 0.048720844089984894, 0.04486338794231415, -0.04416203126311302, -0.04607906937599182, 0.01802484132349491, -0.022151151672005653, -0.012039939872920513, -0.02632421813905239, 0.011683417484164238, 0.007089537102729082, -0.009900804609060287, 0.01926390267908573, 0.019275592640042305, 0.01898336037993431, -0.012682848609983921, 0.018901536241173744, 0.0010410748654976487, 0.0037464085035026073, 0.026651516556739807, -0.020082151517271996, -0.005762806162238121, 0.020771818235516548, 0.010163812898099422, -0.0003340571711305529, -0.028288014233112335, -0.020035395398736, 0.015160972252488136, 0.0044448417611420155, 0.004029872827231884, 0.05306924879550934, -0.013664746657013893, 0.015745434910058975, -0.040070790797472, -0.010946993716061115, 0.019860055297613144, 0.005718971136957407, -0.0004752415406983346, -0.03235587850213051, 0.013828396797180176, -0.018246937543153763, -0.0072999438270926476, 0.04563487693667412, -0.028124364092946053, 0.00973715540021658, -0.025435833260416985, 0.016364965587854385, -0.005298157688230276, 0.029129641130566597, -0.023542173206806183, -0.03375858813524246, 0.05077815428376198, 0.00307719805277884, 0.033548180013895035, -0.04016430303454399, -0.005862164776772261, 0.03948632627725601, -0.04635961353778839, -0.01699618622660637, 0.015102526172995567, -0.006826528813689947, -0.017393620684742928, 0.0024445168673992157, 0.037171851843595505, -0.034693729132413864, -0.001317233662120998, 0.007568797096610069, 0.01786119118332863, 0.0424320213496685, 0.004804286640137434, -0.010911925695836544, 0.01898336037993431, 0.004231512546539307, 0.021601755172014236, 0.014260899275541306, 0.0014012502506375313, 0.04369445890188217, 0.0024532838724553585, 0.010689829476177692, -0.017393620684742928, 0.009579350240528584, -0.021344592794775963, 0.03752253204584122, 0.0047312285751104355, 0.009100090712308884, -0.008696810342371464, 0.026581380516290665, -0.003138566855341196, -0.03922916203737259, -0.04657001793384552, 0.009316341951489449, -0.013886842876672745, -0.04219823330640793, 0.02976085990667343, 0.0036645836662501097, -0.025131912901997566, 0.015441514551639557, -0.04161377251148224, 0.0010089294519275427, 0.006335579790174961, -0.04750515893101692, -0.009462457150220871, -0.007773359306156635, 0.0035944480914622545, 0.017019564285874367, 0.03272993117570877, -0.010923614725470543, -0.011139866895973682, -0.02824125625193119, -0.030953165143728256, -0.007089537102729082, -0.008088969625532627, 0.01978992111980915, 0.016213005408644676, 0.030275188386440277, -0.03670428320765495, -0.022314799949526787, -0.019275592640042305, -0.004985470324754715, -0.0017153992084786296, -0.02213946171104908, 0.016271453350782394, -0.03738225996494293, -0.02538907714188099, -0.03749915212392807, 0.016727333888411522, -0.009292962960898876, -0.0073993029072880745, -0.03109343722462654, -0.008112347684800625, -0.025435833260416985, -0.026651516556739807, 0.008065590634942055, 0.01919376850128174, -0.010467734187841415, -0.015184351243078709, 0.04035133123397827, 0.006697947159409523, 0.04084227979183197, -0.0011886517750099301, 0.04173066467046738, -0.008363666944205761, -0.0021625133231282234, -0.012659470550715923, 0.002023703418672085, 0.016610441729426384, 0.019298970699310303, 0.018585925921797752, 0.013010147958993912, -0.00746943848207593, -0.004804286640137434, -0.01770923100411892, -0.04570501297712326, 0.0020251646637916565, -0.006674568634480238, 0.02728273719549179, 0.03394561633467674, -0.021940743550658226, 0.006177774630486965, 0.008802014403045177, -0.01603766717016697, -0.02623070403933525, -0.01569867879152298, 0.03380534425377846, 0.01526617631316185, -5.8491968957241625e-05, -0.05695008486509323, 0.015196040272712708, 0.0056313020177185535, 0.013571232557296753, -0.011174933984875679, 0.021905677393078804, 0.01182953268289566, 0.002982222940772772, -0.009427390061318874, -0.047458402812480927, -0.0035243125166743994, -0.0002662960032466799, 0.04339053854346275, 0.000935871503315866, -0.004190600477159023, 0.008311064913868904, 0.023448659107089043, -0.002466434147208929, 0.017872881144285202, 0.006101794540882111, -0.010555403307080269, 0.007913630455732346, -0.0012259113136678934, 0.025529347360134125, -0.00394804822281003, 0.03981362655758858, -0.030298566445708275, -0.024290286004543304, 0.018574237823486328, 0.01622469536960125, -0.007054469548165798, -0.011537301354110241, 0.002846335293725133, 0.007241497747600079, -0.0003002679150085896, -0.03738225996494293, -0.023682445287704468, 0.0472479946911335, -0.010537869296967983, 0.007364234887063503, 0.020771818235516548, -0.002292556455358863, -0.004602646920830011, -0.04783245921134949, 0.0041613769717514515, 0.06209335848689079, -0.008953974582254887, 0.012752984650433064, 0.015686988830566406, -0.012191900052130222, 0.02842828445136547, -0.005637146532535553, -0.01671564392745495, 0.01759233884513378, -5.8674613683251664e-05, -0.010456044226884842, 0.02170695923268795, -0.0009475607657805085, 0.003676272928714752, -0.01063722837716341, -0.023214874789118767, -0.010952838696539402, -0.0016058123437687755, 0.023016156628727913, -0.02208101563155651, 0.009234516881406307, 0.005698515102267265, -0.00510820746421814, 0.009485836140811443, 0.008018833585083485, -0.006470006424933672, 0.01249582041054964, 0.024757856503129005, 0.013021837919950485, -0.03443656489253044, -0.022864196449518204, 0.009164380840957165, 0.003702573711052537, 0.004681549500674009, 0.00423443503677845, 0.01690267212688923, 0.004851043689996004, 0.009544282220304012, 0.005911844316869974, -0.02080688625574112, 0.00482182065024972, -0.03254290670156479, -0.005306924693286419, -0.005765728186815977, -0.022840818390250206, -0.010608005337417126, -0.019088564440608025, 0.030228430405259132, 0.020888710394501686, 0.01752220280468464, 0.020853642374277115, 0.02033931575715542, 0.025225427001714706, -0.012823119759559631, 0.010420977137982845, -0.04402175918221474, 0.04526082053780556, 0.04806624352931976, 0.004792597144842148, -0.014775226823985577, -0.028895854949951172, -0.0017066322034224868, -0.0039977277629077435, -0.07911292463541031, 0.011928891763091087, -0.013395894318819046, -0.00615439610555768, 0.0047750636003911495, -0.04114620015025139, 0.01088270265609026, -0.031233707442879677, 0.04016430303454399, 0.016587061807513237, -0.008182482793927193, -0.006037503946572542, -0.000412411754950881, 0.010865168645977974, -0.011619126424193382, 0.023401902988553047, -0.013010147958993912, 0.004295803606510162, 0.0013435345608741045, 0.038223884999752045, -0.02796071395277977, 0.030415458604693413, -0.017674162983894348, 0.012893255800008774, 0.0027878889814019203, -0.051666535437107086, -0.00524847861379385, 0.010759965516626835, 0.024921506643295288, -0.006434938404709101, 0.026745030656456947, 0.012893255800008774, 0.004953324794769287, -0.01564023271203041, 0.006768082734197378, 0.005882620811462402, 0.02272392436861992, 0.028381528332829475, 0.0004226398596074432, -0.03177141398191452, -0.02213946171104908, -0.005648835562169552, -0.037662800401449203, 0.011513923294842243, 0.0062829782254993916, -0.005590389482676983, -0.019719785079360008, -0.02718922309577465, -0.00418767798691988, -0.0014005196280777454, 0.023916229605674744, 0.012121764943003654, -0.02236155793070793, 0.00482182065024972, 0.01795470528304577, -0.012624402530491352, -0.006072571501135826, 0.0008708499954082072, -0.00827015284448862, -0.0031414891127496958, 0.009626107290387154, 0.0324493907392025, 0.02651124633848667, -0.012834809720516205, -0.007498661521822214, -0.013314069248735905, -0.014646644704043865, 0.00442730775102973, -0.014003735966980457, 0.0023173962254077196, 0.00964364130049944, 0.04455946758389473, -0.02854517661035061, 0.02415001578629017, -0.017475446686148643, 0.013840085826814175, -0.030649244785308838, 0.013933599926531315, -0.008743567392230034, 0.014541441574692726, -0.028778962790966034, 0.022560276091098785, -0.007416836451739073, 0.018924914300441742, -0.02997126802802086, -0.011847066693007946, 0.009176070801913738, -0.006084260996431112]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-14T10:14:24.251943", "url_path": "/api/agent/", "chunk_size": 4546}
updated_dt: 2025-03-14T10:14:24.253555
---
If `None`, the last message will
        not be modified.
    Returns:
      JSON bytes representing the new messages.
    """
    return _messages.ModelMessagesTypeAdapter.dump_json(
      self.new_messages(result_tool_return_content=result_tool_return_content)
    )
  defusage(self) -> _usage.Usage:
"""Return the usage of the whole run."""
    return self._state.usage

```
  
---|---  
####  all_messages
```
all_messages(
  *, result_tool_return_content: str[](https://docs.python.org/3/library/stdtypes.html#str) | None = None
) -> list[](https://docs.python.org/3/library/stdtypes.html#list)[ModelMessage[](https://ai.pydantic.dev/api/messages/#pydantic_ai.messages.ModelMessage "pydantic_ai.messages.ModelMessage")]

```

Return the history of _messages.
Parameters:
Name | Type | Description | Default  
---|---|---|---  
`result_tool_return_content` |  `str[](https://docs.python.org/3/library/stdtypes.html#str) | None` |  The return content of the tool call to set in the last message. This provides a convenient way to modify the content of the result tool call if you want to continue the conversation and want to set the response to the result tool call. If `None`, the last message will not be modified. |  `None`  
Returns:
Type | Description  
---|---  
`list[](https://docs.python.org/3/library/stdtypes.html#list)[ModelMessage[](https://ai.pydantic.dev/api/messages/#pydantic_ai.messages.ModelMessage "pydantic_ai.messages.ModelMessage")]` |  List of messages.  
Source code in `pydantic_ai_slim/pydantic_ai/agent.py`
```
1483
1484
1485
1486
1487
1488
1489
1490
1491
1492
1493
1494
1495
1496
1497
1498
```
| ```
defall_messages(self, *, result_tool_return_content: str | None = None) -> list[_messages.ModelMessage]:
"""Return the history of _messages.
  Args:
    result_tool_return_content: The return content of the tool call to set in the last message.
      This provides a convenient way to modify the content of the result tool call if you want to continue
      the conversation and want to set the response to the result tool call. If `None`, the last message will
      not be modified.
  Returns:
    List of messages.
  """
  if result_tool_return_content is not None:
    return self._set_result_tool_return(result_tool_return_content)
  else:
    return self._state.message_history

```
  
---|---  
####  all_messages_json
```
all_messages_json(
  *, result_tool_return_content: str[](https://docs.python.org/3/library/stdtypes.html#str) | None = None
) -> bytes[](https://docs.python.org/3/library/stdtypes.html#bytes)

```

Return all messages from [`all_messages`](https://ai.pydantic.dev/api/agent/#pydantic_ai.agent.AgentRunResult.all_messages) as JSON bytes.
Parameters:
Name | Type | Description | Default  
---|---|---|---  
`result_tool_return_content` |  `str[](https://docs.python.org/3/library/stdtypes.html#str) | None` |  The return content of the tool call to set in the last message. This provides a convenient way to modify the content of the result tool call if you want to continue the conversation and want to set the response to the result tool call. If `None`, the last message will not be modified. |  `None`  
Returns:
Type | Description  
---|---  
`bytes[](https://docs.python.org/3/library/stdtypes.html#bytes)` |  JSON bytes representing the messages.  
Source code in `pydantic_ai_slim/pydantic_ai/agent.py`
```
1500
1501
1502
1503
1504
1505
1506
1507
1508
1509
1510
1511
1512
1513
1514
```
| ```
defall_messages_json(self, *, result_tool_return_content: str | None = None) -> bytes:
"""Return all messages from [`all_messages`][pydantic_ai.agent.AgentRunResult.all_messages] as JSON bytes.
  Args:
    result_tool_return_content: The return content of the tool call to set in the last message.
      This provides a convenient way to modify the content of the result tool call if you want to continue
      the conversation and want to set the response to the result tool call. If `None`, the last message will
      not be modified.
  Returns:
    JSON bytes representing the messages.
  """
  return _messages.ModelMessagesTypeAdapter.dump_json(
    self.all_messages(result_tool_return_content=result_tool_return_content)
  )

```
  
---|---  
####  new_messages
```
new_messages(
  *, result_tool_return_content: str[](https://docs.python.org/3/library/stdtypes.html#str) | None = None
) -> list[](https://docs.python.org/3/library/stdtypes.html#list)[ModelMessage[](https://ai.pydantic.dev/api/messages/#pydantic_ai.messages.ModelMessage "pydantic_ai.messages.ModelMessage")]