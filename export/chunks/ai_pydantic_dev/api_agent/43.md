---
url: https://ai.pydantic.dev/api/agent/
session_id: pydantic_ai_docs
chunk_number: 43
title: Using Pydantic AI Agent
summary: This document chunk demonstrates how to use the Pydantic AI Agent with OpenAI's GPT-4o model. It outlines the process of running an asynchronous query to retrieve the capital of France, captures the interaction's nodes including user prompts and model responses, and formats the output into a structured list.
embedding: [0.014482244849205017, 0.03846774995326996, -0.014971048571169376, -0.049062296748161316, 0.002084522508084774, 0.01832447201013565, 0.02660004049539566, 0.03651253506541252, 0.003504043910652399, 0.00198505655862391, 0.005592829082161188, -0.011015145108103752, -0.05383666604757309, -0.06484044343233109, -0.010355828329920769, -0.02998756803572178, -0.0045441738329827785, -0.012890788726508617, 0.03246569260954857, 0.00800843071192503, 0.0375128798186779, -0.012958994135260582, 0.009560099802911282, 0.03655800595879555, -0.028487052768468857, 0.016323786228895187, -0.016107803210616112, 0.0789816603064537, -0.004299771506339312, 0.00959988683462143, 0.03676262125372887, 0.0061327870935201645, -0.037240058183670044, -0.0003195344179403037, 0.014948314055800438, 0.002694106660783291, -0.010441084392368793, 0.012333779595792294, -0.012595233507454395, 0.047425370663404465, 0.02355354093015194, -0.030533209443092346, -0.022553198039531708, 0.016664812341332436, 0.016789855435490608, -0.016141904518008232, -0.009713562205433846, 0.006593172438442707, 0.029100900515913963, 0.021086784079670906, -0.020006868988275528, -0.0016241371631622314, -0.018688233569264412, 0.048061955720186234, -0.07293412834405899, -0.011754035018384457, 0.02328071929514408, -0.017983445897698402, 0.010156895965337753, -0.03062414936721325, 0.02150738425552845, 0.01016826368868351, 0.009088347665965557, 0.0653860867023468, -0.02914636954665184, 0.03537578135728836, -0.025008585304021835, 0.054291367530822754, -0.02496311627328396, -0.012390617281198502, 0.007326378952711821, 0.04978981986641884, -0.07798131555318832, -0.028350641950964928, -0.042332716286182404, -0.0025520124472677708, 0.055700939148664474, 0.00771287502720952, -0.027782265096902847, -0.009139501489698887, 0.0033534239046275616, -0.0017619684804230928, 0.010247835889458656, 0.021450545638799667, 0.01605096459388733, -0.06456761807203293, -0.037467408925294876, -0.0438787005841732, -0.023667216300964355, -0.07284318655729294, 0.006456762086600065, -0.006598856300115585, -0.006195308640599251, 0.061020947992801666, 0.020143279805779457, 0.053154610097408295, 0.012720275670289993, 0.0006326746079139411, 0.03426176309585571, 0.031147057190537453, 0.007837917655706406, -0.04458348825573921, -0.054018545895814896, 0.00430545536801219, 0.011430060490965843, 0.004723212216049433, -0.017881138250231743, 0.05019905045628548, -0.028896283358335495, -0.05306367203593254, -0.07520763576030731, -0.027463974431157112, 0.0033704752568155527, 0.026281749829649925, -0.07247942686080933, -0.05101751536130905, -0.00385643751360476, 0.008900783024728298, 0.07325241714715958, -0.04024108871817589, -0.0030123977921903133, 0.019950030371546745, -0.020484305918216705, -0.005905436351895332, 0.017801566049456596, -0.022666873410344124, -0.02603166364133358, -0.01691489852964878, 0.01755147986114025, -0.01343643106520176, 0.0026344270445406437, -0.008014114573597908, -0.03473920002579689, -0.01631241850554943, -0.019586268812417984, 0.004078104626387358, -0.028850814327597618, -0.005814495962113142, -0.04622041434049606, 0.03785390406847, -0.014402671717107296, -0.04451528191566467, -0.02264413796365261, -0.009224757552146912, 0.01035014446824789, 0.0708879753947258, -0.027463974431157112, 0.03076056018471718, -0.02425832860171795, 0.03546672314405441, 0.06743223965167999, 0.004001373890787363, -0.017949344590306282, 0.015482587739825249, -0.012186001986265182, 0.002685581101104617, -0.009628305211663246, 0.014720963314175606, -0.01351600419729948, -0.026259014382958412, -0.03799031674861908, 0.013186344876885414, -0.00491646071895957, -0.02489490993320942, -0.0057207141071558, -0.008605226874351501, -0.05101751536130905, -0.010520657524466515, -0.02291695773601532, 0.003944536205381155, -0.010389930568635464, -0.03946809470653534, -0.036171507090330124, 0.034193556755781174, 0.06188488006591797, -0.005555884446948767, -0.06343086808919907, -0.00733774621039629, -0.029305515810847282, -0.0029868208803236485, -0.0159145537763834, -0.01574404165148735, -0.03742193803191185, -0.008770056068897247, -0.019074730575084686, 0.021848410367965698, 0.029100900515913963, 0.019006524235010147, -0.053654782474040985, -0.00776402885094285, 0.03676262125372887, 0.05233614891767502, 0.01811985671520233, 0.013163610361516476, -0.013254550285637379, 0.01428899634629488, 0.04656143859028816, -0.00926454458385706, 0.03230654448270798, 0.011947283521294594, 0.004558383021503687, -0.002405655337497592, 0.008093687705695629, 0.022132597863674164, 0.032010991126298904, -0.04399237409234047, -0.01902925968170166, -0.01799481362104416, 0.01495968084782362, -0.018210796639323235, 0.022405419498682022, -0.049835290759801865, 0.015664469450712204, -0.004518596921116114, -0.006956933997571468, -0.0469706691801548, -0.0347619354724884, 0.028964489698410034, 0.024713030084967613, 0.0385359562933445, 0.021029947325587273, 0.03735373169183731, 0.006638642866164446, 0.039581771939992905, 0.00949757918715477, 0.01902925968170166, 0.0007644669967703521, -0.020757125690579414, 0.02760038524866104, 0.05806538835167885, 0.002881671069189906, -0.004367976915091276, -0.020245587453246117, -0.05028999224305153, 0.027623118832707405, -0.04506092518568039, -0.005194965284317732, -0.0007094054599292576, 0.0018088596407324076, -0.03332962468266487, -0.04356040805578232, -0.02217806875705719, 0.019040627405047417, -0.014595920220017433, 0.007690140046179295, 0.012856686487793922, 0.01993866264820099, -0.0010124214459210634, 0.031237997114658356, 0.03749014437198639, 0.017528744414448738, -0.0054393671452999115, -0.02305336855351925, -0.023144308477640152, 0.014789167791604996, -0.029260044917464256, -0.010100058279931545, 0.012652071192860603, -0.022939693182706833, -0.013390961103141308, 0.04567477107048035, 0.041286900639534, -0.02398550696671009, -0.014766433276236057, -0.01315224263817072, -0.019540799781680107, 0.03210192918777466, -0.021996187046170235, 0.0004689109919127077, -0.051472216844558716, 0.010242152959108353, -0.006468129809945822, -0.0008213046821765602, -0.04947153106331825, -0.04351493716239929, 0.03219287097454071, 0.027714060619473457, 0.036035098135471344, 0.0029413506854325533, -0.05892932042479515, -0.016255579888820648, 0.03480740264058113, 0.0500626415014267, 0.040923140943050385, 0.021734734997153282, -0.015505323186516762, -0.032283809036016464, -0.004055369645357132, 0.04599306359887123, 0.009105398319661617, 0.03394347056746483, 0.0032596418168395758, 0.02928278036415577, -0.025804312899708748, 0.03098791092634201, -0.04951699823141098, 0.016926266252994537, 0.003569407155737281, 0.03076056018471718, -0.03403441235423088, -0.0009683722164481878, -0.029032694175839424, 0.003617719281464815, -0.014016175642609596, 0.02248499169945717, -0.003728552721440792, -0.022894224151968956, 0.01415258552879095, 0.03219287097454071, -0.018085753545165062, -0.019688576459884644, 0.08075499534606934, -0.04394690692424774, 0.0015871926443651319, 0.009753348305821419, -0.004956246819347143, 0.05010811239480972, -0.02794141136109829, 0.018676865845918655, -0.002259298460558057, -0.018233532086014748, -0.0037768648471683264, 0.015016518533229828, 0.0548824779689312, -0.010236469097435474, -0.005447892937809229, 0.029692010954022408, 0.01758558303117752, -0.0020234219264239073, 0.02509952522814274, -0.0363079197704792, -0.03805851936340332, 0.015903186053037643, 0.002529277466237545, -0.007400267757475376, -0.01963173970580101, -0.015368912369012833, 0.004228724632412195, 0.04585665091872215, 0.04433340206742287, -0.02566790208220482, 0.007008087821304798, 0.00548483757302165, -0.027395768091082573, -0.011231128126382828, 0.05397307500243187, -0.004277036525309086, 0.009304330684244633, -0.046515967696905136, 0.002900143386796117, 0.017062675207853317, -0.0007879125187173486, 0.04501545429229736, 0.024462943896651268, -0.0076048835180699825, 0.008105055429041386, -0.018517721444368362, 0.02957833558320999, -0.02311020717024803, -0.005669559817761183, -0.08271021395921707, -0.029692010954022408, 0.012970361858606339, -0.012470190413296223, -0.04506092518568039, -0.019893193617463112, -0.04103681445121765, 0.0036205612123012543, 0.010276255197823048, 0.057610686868429184, 0.06838711351156235, 0.019245242699980736, -0.03055594488978386, -0.00364329619333148, -0.004245775751769543, 0.010963991284370422, -0.03874057158827782, -0.025781577453017235, 0.04076399281620979, 0.059111203998327255, -0.010242152959108353, 0.04110502079129219, 0.01224283967167139, -0.017949344590306282, 0.037171851843595505, -0.010179631412029266, -0.037876639515161514, -0.013356857933104038, -0.004407763015478849, 0.02057524584233761, 0.030896971002221107, -0.06111188977956772, -0.03041953407227993, 0.012356515042483807, -0.04733443260192871, 0.016505666077136993, 0.03990006074309349, 0.01655113697052002, 0.03642159327864647, 0.021200459450483322, -0.002489491133019328, 0.005624089855700731, -0.03160175681114197, 0.025554226711392403, -0.012583865784108639, -0.026850126683712006, 0.045583829283714294, 0.016289683058857918, 0.01570993848145008, 0.01768789067864418, 0.030101243406534195, 0.004302613437175751, -0.000490935577545315, -0.01021941751241684, -0.010424032807350159, -0.018176695331931114, -0.0017136564711108804, -0.024440208449959755, 0.011634675785899162, 0.03282945230603218, -0.022462256252765656, -0.057747095823287964, 0.02121182717382908, 0.019154302775859833, -0.027395768091082573, 0.05406401678919792, 0.01768789067864418, -0.01896105520427227, 0.002642952837049961, 0.0013527370756492019, 0.055564530193805695, 0.05151768773794174, -0.006445394363254309, -0.019336184486746788, -0.013834294863045216, 0.0015147245721891522, 0.03564860299229622, 0.0057207141071558, -0.021666528657078743, -0.01013416051864624, 0.04567477107048035, -0.061430178582668304, 0.03551219031214714, 0.022291744127869606, -0.025781577453017235, -0.01677848771214485, -0.048925887793302536, -0.02298516407608986, -0.01879054121673107, -0.010469503700733185, -0.021314134821295738, -0.0007282329606823623, -0.022621402516961098, -0.00439639575779438, -0.04458348825573921, -0.01556216087192297, 0.11731300503015518, -0.0008269884274341166, 0.07343430072069168, 0.014720963314175606, 0.011373222805559635, -0.010543392039835453, 0.006763685494661331, 0.029623806476593018, -0.039445359259843826, 0.04033202677965164, 0.0004923565429635346, 0.016062332317233086, -0.011299333535134792, 0.041286900639534, 0.06574984639883041, 0.0019125883700326085, -0.006166889797896147, -0.003461415646597743, -0.02575884386897087, -0.006019111722707748, 0.009838605299592018, 0.04901682958006859, -0.023940036073327065, -0.02596345916390419, -0.012299677357077599, -0.014141218736767769, 0.016767119988799095, 0.0075764646753668785, -0.02907816506922245, 0.02157558873295784, 0.021962085738778114, 0.001975109800696373, -0.032511159777641296, -0.002921457402408123, 0.022700974717736244, 0.01869960129261017, 0.0033846846781671047, -0.009236125275492668, 0.041627928614616394, 0.002978295087814331, -0.015039253979921341, 0.0069114635698497295, -0.03999100252985954, -0.021393708884716034, -0.016801223158836365, -0.003373317187651992, -0.009372536092996597, 0.0155280577018857, -0.022030290216207504, -0.05565547198057175, 0.04076399281620979, 0.03889971971511841, 0.02033652737736702, 0.08202815800905228, -0.055700939148664474, 0.018415413796901703, -0.004743105731904507, -0.013311387971043587, -0.016926266252994537, 0.00800843071192503, -0.008321038447320461, 0.02295106090605259, -0.015403015539050102, 0.007673088926821947, -0.00902582611888647, -0.008184627629816532, -0.02589525282382965, 0.0047942595556378365, 0.04324211925268173, 0.010372878983616829, 0.017460539937019348, -0.013925234787166119, -0.005567252170294523, -0.0018230690620839596, 0.030715089291334152, 0.008696167729794979, -0.0045384899713099, 0.04692520201206207, -0.0032454323954880238, 0.024508414790034294, 0.045515626668930054, 0.010719588957726955, -0.06820522993803024, -0.011435744352638721, -0.0029044062830507755, 0.04253733158111572, -0.030010303482413292, 0.018313104286789894, -0.04194621741771698, -0.019574901089072227, -0.010412666015326977, -0.021518751978874207, 0.016607973724603653, -0.012799848802387714, 0.0068546258844435215, 0.010145528241991997, 0.013311387971043587, -0.02723662368953228, 0.02630448527634144, -0.0031004962511360645, -0.00974766444414854, -0.007724242750555277, 0.04119596257805824, 0.004541331902146339, -0.004507229197770357, 0.013913867995142937, 0.015925921499729156, -0.015584895387291908, 0.015073356218636036, 0.04037749767303467, 0.02780500054359436, -0.0310561154037714, -0.020495671778917313, -0.01273164339363575, 0.0072695412673056126, 0.018949687480926514, 0.01304993499070406, -0.008372192271053791, 0.021382341161370277, -0.030328594148159027, 0.040013737976551056, 0.019279345870018005, -0.05133580416440964, 0.01952943205833435, -0.004893725272268057, -0.04294656217098236, 0.018870115280151367, 5.3418552852235734e-05, 0.025804312899708748, 0.0054876795038580894, -0.03555766120553017, -0.003035132773220539, 0.002095889998599887, -0.012117796577513218, -0.021484648808836937, -0.00601342786103487, 0.0053541106171905994, -0.007423002738505602, -0.05065375193953514, -0.004978982266038656, -0.014073013328015804, 0.001148831914179027, -0.023394394665956497, 0.007610567379742861, 0.029532866552472115, 0.0018244900275021791, 0.00025239487877115607, 0.032715778797864914, 0.005723556037992239, 0.001003185287117958, 0.01782430149614811, -0.0039047496393322945, -0.023371659219264984, 0.009167919866740704, 0.010674118995666504, 0.0004895146703347564, -0.01825626753270626, -0.033215947449207306, -0.008821209892630577, 0.01902925968170166, -0.031101586297154427, 0.04046843945980072, 0.05715598538517952, -0.02944192662835121, 0.03826313465833664, 0.04626588150858879, 0.01852908916771412, 0.019245242699980736, -0.00291008991189301, -0.01598276011645794, -0.015266604721546173, 0.008593859151005745, -0.00875868834555149, 0.002517909975722432, -0.05260897055268288, 0.005371162202209234, 0.02964654192328453, 0.01684669218957424, -0.06374915689229965, -0.04274194687604904, -0.002564800903201103, -0.04406058043241501, -0.01902925968170166, -0.000654343981295824, 0.016255579888820648, 0.03555766120553017, -0.04653870314359665, 0.010202365927398205, -0.01641472615301609, -0.00601342786103487, -0.0014046014985069633, 0.005555884446948767, 0.011481214314699173, -0.029169104993343353, -0.057110514491796494, -0.019586268812417984, 0.01087305136024952, -0.0008454606868326664, -0.001373340841382742, -0.010463819839060307, -0.009997750632464886, 0.002070313086733222, -0.0027211045380681753, 0.01499378401786089, -0.026008928194642067, 0.01164035964757204, -0.017108146101236343, -0.0019509538542479277, -0.0430147685110569, -0.00468058418482542, 0.02878260798752308, 0.012777113355696201, 0.028327906504273415, 0.012708908878266811, -0.022564563900232315, 0.020006868988275528, 0.026622775942087173, 0.01715361699461937, 0.013254550285637379, -0.01542575005441904, -0.001982214627787471, -0.025440551340579987, -0.03728552907705307, 0.024803970009088516, 0.013845662586390972, 0.003685924457386136, -0.041286900639534, 0.0796637162566185, 0.06529514491558075, 0.000932138180360198, -0.02419012226164341, 0.002546328818425536, 0.01244745496660471, 0.02382636070251465, -0.021757468581199646, 0.011697197332978249, 0.006820523180067539, 0.022803282365202904, 0.009071296080946922, 0.006041846703737974, 0.002888775896281004, 0.02455388382077217, -0.02703200839459896, -0.03742193803191185, 0.0016454512951895595, -0.020109176635742188, -0.01457318477332592, 0.04451528191566467, -0.017767462879419327, -0.019893193617463112, 0.005763342138379812, 0.005661034490913153, 0.0014067329466342926, -0.03946809470653534, -0.009219073690474033, -0.0023388711269944906, -0.04476536810398102, 0.0009655303438194096, -0.04951699823141098, -0.023644480854272842, 0.0030294491443783045, 0.021200459450483322, -0.023735420778393745, -0.049426060169935226, -0.01006595604121685, 0.009150869213044643, -0.004038318060338497, 0.008650696836411953, -0.009202023036777973, -0.02324661798775196, -0.015653101727366447, 0.0234853345900774, 0.010946939699351788, -0.002810623962432146, 0.004970456473529339, -0.02632722072303295, -0.002283454407006502, -0.021518751978874207, -0.015152929350733757, -0.00014760038175154477, -0.05297273024916649, 0.021223194897174835, -0.027077477425336838, -0.0117426672950387, -0.008156209252774715, -0.011049248278141022, -0.0161760076880455, -0.003600667929276824, -0.0035381463821977377, -0.015198399312794209, 0.01785840280354023, 0.022598667070269585, -0.008900783024728298, 0.0013328439090400934, -0.03323868289589882, 0.006542018614709377, -0.0006934198900125921, -0.015368912369012833, 0.047789134085178375, 0.019006524235010147, 0.030737824738025665, -0.021098151803016663, -0.03990006074309349, -0.007525310851633549, -0.0397409163415432, 0.015903186053037643, 0.012583865784108639, 0.004342400003224611, 0.006706847809255123, 0.020256955176591873, -0.009224757552146912, 0.01319771260023117, -0.038172196596860886, 0.03292039409279823, -0.024281062185764313, 0.008048217743635178, -0.017142249271273613, 0.03573954105377197, 0.0224508885294199, -0.02243952266871929, 0.02680465765297413, -0.014266260899603367, 0.020984476432204247, -0.005763342138379812, 0.0016568187857046723, -0.0006827628239989281, -0.0054621025919914246, 0.014016175642609596, 0.032352015376091, -0.03232927992939949, 0.02646362967789173, -0.014550450257956982, -0.017199086025357246, -0.0061043682508170605, -0.07679909467697144, -0.034125350415706635, 0.031147057190537453, 0.005621247924864292, 0.01916567049920559, -0.0133341234177351, -0.0006646458059549332, -0.06584078818559647, -0.004322506487369537, -0.004780049901455641, 0.002024842891842127, 0.029396455734968185, -0.039854589849710464, 0.01125386357307434, 0.01447087712585926, 0.015994127839803696, 0.011810872703790665, 0.010884418152272701, 0.011469846591353416, -0.024212857708334923, -0.04365134984254837, 0.008753005415201187, -0.018085753545165062, -0.018165327608585358, 0.006195308640599251, 0.015368912369012833, -0.04526554048061371, -0.04633408784866333, -0.009287279099225998, -0.06388556957244873, 0.007508259266614914, -0.01732412911951542, 0.006144154816865921, 0.002699790522456169, -0.013129507191479206, 0.027054741978645325, 0.02596345916390419, -0.028850814327597618, -0.052017856389284134, -0.01234514731913805, 0.01248155813664198, -0.02200755476951599, 0.023098839446902275, 0.023894567042589188, 0.04988076165318489, 0.005899752490222454, -0.0022990847937762737, -0.012799848802387714, -0.02362174540758133, -0.0015630365815013647, 0.019688576459884644, 0.018176695331931114, -0.0018614345462992787, -0.001746338210068643, -0.00652496749535203, -0.0008269884274341166, 0.017233189195394516, 0.030305858701467514, -0.006922831293195486, -0.009400954470038414, -0.016403358429670334, 0.030192183330655098, 0.019688576459884644, -0.03521663695573807, 0.0018060177098959684, 0.010327409021556377, 0.03410261496901512, 0.044037844985723495, 0.03833134099841118, -0.010179631412029266, -0.027213888242840767, -0.017733361572027206, 0.00016838166629895568, -0.0030948123894631863, -0.002159832278266549, -0.006968301255255938, -0.023462601006031036, -0.011708565056324005, 0.014220790937542915, 0.004882358014583588, 0.02864619717001915, 0.017812933772802353, 0.00898035615682602, -0.008917834609746933, 0.003302270080894232, 0.015209767036139965, -0.04724349081516266, 0.02080259658396244, -0.010617281310260296, 0.019040627405047417, 0.03198825567960739, -0.012538395822048187, -0.01564173400402069, -0.003853595582768321, -0.012811216525733471, -0.01839267835021019, -0.0075480458326637745, 0.024940380826592445, -0.011418692767620087, 0.002394287846982479, 0.012686173431575298, -0.05551905930042267, -0.03473920002579689, 0.022666873410344124, 0.039308950304985046, 0.000917928759008646, 0.008286936208605766, 0.026690982282161713, 0.027895940467715263, -0.017130881547927856, 0.02964654192328453, -0.03828587010502815, 0.021586956456303596, -0.02646362967789173, -0.022121230140328407, 0.005641140975058079, 0.012299677357077599, 0.025281406939029694, 0.03317048028111458, -0.035330310463905334, -0.015403015539050102, -0.014118483290076256, 0.02539508230984211, 0.03742193803191185, -0.0262362789362669, -0.032715778797864914, 0.0018472251249477267, -0.017471907660365105, -0.023599009960889816, 0.01386839710175991, 0.020075073465704918, -0.011577838100492954, 0.01252702809870243, -0.012504292652010918, -0.026690982282161713, -0.023576276376843452, 0.005518940277397633, 0.02582704834640026, 0.011066298931837082, -0.021586956456303596, 0.006337402854114771, -0.015823613852262497, -0.0006142023485153913, 0.04196895286440849, -0.02710021287202835, -0.03521663695573807, -0.007656037341803312, 0.0030521841254085302, -0.03471646457910538, 0.024235593155026436, -0.023303454741835594, -0.05133580416440964, 0.006848942022770643, -0.014868740923702717, -0.025940723717212677, -0.0010372878750786185, 0.017369600012898445, -0.008724586106836796, 0.006428343243896961, 0.019790885969996452, 0.043355792760849, 0.009804502129554749, 0.02059798128902912, -0.014345834031701088, 0.00350120197981596, -0.010247835889458656, 0.007877704687416553, 0.00941232219338417, 0.05820180103182793, -0.0012298256624490023, -0.01254976261407137, -0.0216778963804245, -0.014766433276236057, 0.004964772611856461, 0.019643107429146767, -0.025213200598955154, -0.0061271036975085735, -0.005476311780512333, 0.026645511388778687, 0.020529774948954582, 0.006712531670928001, 0.06725036352872849, 0.05756521597504616, 0.06770506501197815, -0.006451078224927187, -0.035330310463905334, 0.05229067802429199, -0.008599543012678623, 0.018017549067735672, -0.0035949840676039457, 0.012470190413296223, 0.019154302775859833, 0.00505855493247509, 0.01343643106520176, 0.04096861183643341, -0.017369600012898445, 0.011401641182601452, 0.01937028579413891, 0.02787320502102375, -0.010844632051885128, 0.03926347941160202, -0.0028703035786747932, -0.005024452228099108, -0.002448283601552248, -0.00525180296972394, 0.0020291057880967855, -0.010208049789071083, 0.012902156449854374, 0.035625867545604706, -0.0011779612395912409, -0.02241678722202778, 0.027714060619473457, 0.04260553419589996, 0.007724242750555277, -0.0178925059735775, -0.02398550696671009, 0.009088347665965557, 0.028987225145101547, 0.008065268397331238, -0.038103990256786346, -0.0137206194922328, 0.014504979364573956, 0.006183941382914782, -0.02057524584233761, 0.027623118832707405, -0.006752318236976862, 0.01715361699461937, -0.021132254973053932, -0.028668932616710663, -0.006502232048660517, 0.005533149465918541, 0.01688079535961151, 0.009582835249602795, 0.04499271884560585, 0.007980012334883213, -0.0036802408285439014, -0.0049363537691533566, -0.00558714522048831, 0.008451765403151512, -0.005794602911919355, -0.005155178718268871, 0.025804312899708748, -0.01517566479742527, 4.0008409996517e-05, 0.0036234031431376934, 0.007104711607098579, 0.014482244849205017, -0.017847036942839622, 0.014448141679167747, -0.026349954307079315, -0.04030929133296013, 0.022337213158607483, 0.008622278459370136, -0.00010399521852377802, 0.06306710839271545, -0.012856686487793922, -0.001462149666622281, -0.04888041689991951, -0.0013193449703976512, 0.023189779371023178, -0.030806031078100204, -0.008031166158616543, 0.0005712188431061804, 0.027259359136223793, 0.013459166511893272, -0.006570437457412481, -0.002588957082480192, 0.00790612306445837, 0.014527714811265469, -0.025144996121525764, 0.00762193463742733, -0.015971392393112183, 0.0045498572289943695, -0.04153698682785034, 0.024212857708334923, 0.045038189738988876, 0.04285562038421631, -0.00894625298678875, -0.009088347665965557, 0.01408438105136156, 0.03282945230603218, -0.02432653307914734, -0.010333092883229256, 0.00421167304739356, -0.003674556966871023, -0.02850978821516037, -0.021700631827116013, 0.008258516900241375, 0.01615327224135399, -0.028691668063402176, -0.0017207611817866564, -0.03035132959485054, -0.009759032167494297, -0.0012397721875458956, -0.025849783793091774, -0.018415413796901703, 0.0186654981225729, 0.02425832860171795, -0.007843601517379284, -0.014379936270415783, 0.02016601338982582, 0.04044570401310921, 0.008849629200994968, 0.04626588150858879, 0.013845662586390972, -0.017881138250231743, -0.05360931530594826, 0.010094374418258667, -0.0004998164949938655, -0.03062414936721325, 0.02009780891239643, -0.005581461824476719, -0.014118483290076256, -0.006894412450492382, -0.06465855985879898, 0.0028830920346081257, 0.0011424376862123609, -0.026372689753770828, -0.008588175289332867, -0.009906809777021408, 0.01117429044097662, 0.044947247952222824, 0.03376159071922302, -0.02221217192709446, 0.0027012114878743887, -0.03889971971511841, 0.015925921499729156, 0.004078104626387358, -0.0022109863348305225, -0.015607630833983421, -0.002614533994346857, -0.024644823744893074, -0.016676180064678192, -0.03762655332684517, 0.002058945596218109, 0.006598856300115585, -0.0034131035208702087, -0.010509289801120758, 0.026759186759591103, -0.02864619717001915, 0.03351150453090668, -0.019779518246650696, -0.004424814600497484, -0.014300364069640636, -0.00463227229192853, -0.038672368973493576, -0.028123291209340096, -0.0063771894201636314, -0.003796757897362113, 0.01581224612891674, 0.0029470345471054316, 0.03312500938773155, -0.0031829108484089375, 0.021893879398703575, 0.033352360129356384, 0.02047293819487095, 0.04137784242630005, 0.0682961717247963, -0.003941694274544716, -0.020984476432204247, 0.02160969190299511, -0.004819836467504501, -0.00412073265761137, 0.017074042931199074, 0.004075262695550919, 0.013084037229418755, -0.03451184928417206, -0.03446637839078903, 0.027350299060344696, 0.016073700040578842, 0.0034415223635733128, 0.02097310870885849, -0.007553729694336653, 0.01457318477332592, -0.016960367560386658, -0.008315354585647583, -0.004666374530643225, 0.023462601006031036, 0.08598406612873077, -0.03146534785628319, -0.02009780891239643, 0.02171199955046177, -0.005413790233433247, 0.01839267835021019, 0.0030948123894631863, 0.012924891896545887, 0.018506353721022606, -0.002753786277025938, -0.03487560898065567, -0.020381996408104897, 0.006956933997571468, -0.04133237153291702, 0.019051995128393173, 0.030510473996400833, -0.043264854699373245, -0.015857717022299767, 0.020791228860616684, 0.016960367560386658, 0.005780393723398447, -0.019813619554042816, -0.033420562744140625, 0.014209423214197159, 0.016642076894640923, 0.01875643990933895, -0.004902251064777374, 0.03292039409279823, -0.013788824900984764, 0.004853939171880484, 0.013345491141080856, 0.02816876210272312, 0.003697291947901249, -0.003813809249550104, -0.04801648482680321, 0.01624421402812004, 0.04419699311256409, 0.02375815622508526, 0.03273851051926613, -0.006894412450492382, -0.010770742781460285, -0.017403701320290565, 0.03387526422739029, -0.019438492134213448, -0.057337865233421326, 0.009389586746692657, 0.0056837694719433784, -0.03387526422739029, 0.0746619924902916, -0.01631241850554943, -0.029191840440034866, 0.003711501369252801, -0.014834638684988022, 0.018801908940076828, 0.0052915895357728004, 0.004649323411285877, -0.027850469574332237, -0.004367976915091276, 0.04669785127043724, 0.03537578135728836, -0.016073700040578842, -0.03153355419635773, 0.0024994376581162214, -0.009810185991227627, -0.02137097343802452, 0.04160519316792488, 0.014925578609108925, -0.022689606994390488, 0.014811903238296509, 0.011526684276759624, 0.023576276376843452, 0.0075196269899606705, -0.012356515042483807, 0.003907591570168734, -0.0032312229741364717, -0.018972422927618027, -0.018335839733481407, -0.05470059812068939, 0.029669277369976044, 0.020995844155550003, 0.004234408028423786, -0.014539082534611225, 0.00017868350550998002, 0.025804312899708748, 0.02076849341392517, 0.00010621544060995802, 0.011992753483355045, 0.00845744926482439, 0.0397409163415432, -0.015755409374833107, -0.004666374530643225, 0.016994470730423927, -0.015027886256575584, -0.01006595604121685, -0.014880108647048473, -0.007468473166227341, 0.004637955687940121, -0.037967581301927567, 0.011754035018384457, -0.012333779595792294, -0.01768789067864418, -0.0035239369608461857, -0.008951936848461628, -0.007815183140337467, 0.010043220594525337, 0.04619767889380455, -0.011708565056324005, -0.005121076479554176, 0.003432996803894639, -0.008730269968509674, -0.009469159878790379, 0.0061555225402116776, -0.016460197046399117, 0.009446424432098866, 0.03196552023291588, -0.0013790245866402984, -0.00264721573330462, 0.021484648808836937, -0.036330655217170715, -0.01959763653576374, 0.021848410367965698, -0.0032226971816271544, -0.026577305048704147, 0.0020831015426665545, 0.017676522955298424, 0.03305680304765701, 0.003504043910652399, 0.03082876466214657, 0.011583521962165833, 0.0002518620458431542, -0.017005838453769684, 0.014777800999581814, -0.006223727483302355, -0.001753442920744419, -0.046515967696905136, 0.007962960749864578, -0.02921457588672638, -0.019438492134213448, -0.023076104000210762, 0.015596263110637665, -0.028532521799206734, 0.007371848914772272, -0.010810529813170433, 0.0024610720574855804, 0.02362174540758133, 0.00582017982378602, 0.0013676569797098637, -0.0005321429343894124, 0.009247492998838425, 0.026918333023786545, 0.009946596808731556, -0.008036850020289421, 0.004362293053418398, 0.02143917791545391, -0.011219761334359646, 0.010162579827010632, -0.011532368138432503, -0.00951462984085083, 0.013095404952764511, -0.01809712126851082, -0.0009541627950966358, 0.011378906667232513, -0.0023246617056429386, -0.02800961583852768, 0.01358420867472887, -0.019824987277388573, -0.01605096459388733, 0.005416632164269686, -0.017494643107056618, -0.001188618247397244, -0.03564860299229622, -0.003504043910652399, 0.015300706960260868, 0.009383903816342354, 0.014777800999581814, -0.017278658226132393, -0.034830138087272644, 0.01631241850554943, 0.05106298625469208, 0.01768789067864418, -0.0004721081058960408, -0.03401167690753937, 0.006905779708176851, -0.00790612306445837, 0.012470190413296223, -0.0013683674624189734, 0.012902156449854374, 0.0030123977921903133, -0.008059585466980934, -0.0032141716219484806, -0.00026678192079998553, 0.00178612454328686, -0.013084037229418755, 0.030896971002221107, -0.006598856300115585, 0.025554226711392403, -0.003913275431841612, 0.011867710389196873, -0.008696167729794979, -0.0002612757671158761, 0.010026169009506702, -0.014414039440453053, -0.026827391237020493, -0.014198056422173977, -0.016255579888820648, -0.0003921800816897303, 0.016039596870541573, -0.037035442888736725, -0.007752661593258381, 0.01839267835021019, 0.004845413379371166, 0.0034131035208702087, -0.009372536092996597, 0.03230654448270798, -0.03319321200251579, 0.004200305789709091, -0.04337852820754051, 0.023371659219264984, -0.021189091727137566, 0.012970361858606339, 0.05579188093543053, -0.032374750822782516, 0.023599009960889816, -0.0005854282644577324, 0.007207019720226526, 0.018483618274331093, -0.007360481657087803, -0.02823696658015251, -0.006303300149738789, 0.023394394665956497, 0.03317048028111458, -0.03726279363036156, -0.016607973724603653, 0.009741980582475662, 0.012652071192860603, 0.02250772714614868, -0.03560313209891319, -0.03794484585523605, 0.019415756687521935, 0.008167576976120472, -0.007315011229366064, -0.00529443146660924, 0.01570993848145008, 0.01244745496660471, -0.0095487330108881, -0.015539425425231457, -0.008099371567368507, -0.049562469124794006, -0.003262483747676015, 0.020359262824058533, 0.01946122571825981, -0.005928171332925558, 0.010566127486526966, 0.0038365444634109735, 0.04965341091156006, -0.009844288229942322, -0.04053664207458496, 0.010139844380319118, -0.023940036073327065, -0.009082663804292679, 0.01467549242079258, -0.0014152586227282882, -0.004919302649796009, -0.02482670545578003, -0.006252146326005459, -0.010190998204052448, 0.02696380205452442, 0.030465004965662956, -0.01301583182066679, 0.018517721444368362, -0.013982072472572327, 0.03892245143651962, -0.049698881804943085, -0.0027154209092259407, -0.01470959559082985, 0.02301926538348198, -0.02914636954665184, -0.014073013328015804, -0.0461067371070385, -0.015550793148577213, 0.012265574187040329, 0.024394739419221878, 0.0014607287012040615, 0.015516690909862518, 0.014038910157978535, -0.011810872703790665, 0.004285562317818403, -0.030328594148159027, -0.008235782384872437, 0.013390961103141308, -0.002507963217794895, 0.02100721187889576, -0.027282092720270157, 0.01527797244489193, 0.01865413226187229, -0.015596263110637665, -0.007508259266614914, -0.060384366661310196, 0.007673088926821947, 0.008770056068897247, 0.00657612131908536, -0.00473173800855875, -0.004714686889201403, 0.04278741776943207, -0.02110951952636242, -0.0409458763897419, 0.01495968084782362, 0.02512226067483425, -0.0023104522842913866, 0.008429029956459999, 0.034625522792339325, 0.034284498542547226, 0.00705355778336525, 0.02398550696671009, 0.02566790208220482, 0.015687203034758568, -0.004888041876256466, 0.03055594488978386, 0.017142249271273613, -0.024849440902471542, -0.01224283967167139, 0.015005151741206646, -0.00596227403730154, -0.011361855082213879, -0.001835857518017292, -0.006354454439133406, -0.019824987277388573, -0.01588045246899128, 0.018279002979397774, -0.026759186759591103, 0.04378775879740715, 0.006428343243896961, 0.0023275036364793777, 0.014300364069640636, 0.0015530900564044714, 0.0064624459482729435, 0.015221134759485722, -0.03119252622127533, 0.04174160212278366, -0.03739920258522034, 0.0016411883989349008, 0.019290713593363762, -0.012754378840327263, -0.017074042931199074, -0.0009342696284875274, 0.008031166158616543, 0.017983445897698402, 0.014686860144138336, -0.012106428854167461, -0.02914636954665184, -0.013777457177639008, 0.03085150010883808, -0.011049248278141022, -0.006337402854114771, -0.00601342786103487, -0.023508070036768913, -0.0034386804327368736, 0.00842334609478712, -0.028919018805027008, -0.011128820478916168, -0.02921457588672638, -0.0017491800244897604, -0.01527797244489193, -0.009094031527638435, 0.003972955048084259, -0.005865650251507759, -0.003725710790604353, -0.007309327367693186]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-15T11:17:10.538611", "url_path": "/api/agent/", "chunk_size": 3908}
updated_dt: 2025-03-15T11:17:10.540129
---
```python
  from pydantic_ai import Agent
  agent = Agent('openai:gpt-4o')
  async def main():
    nodes = []
    # Iterate through the run, recording each node along the way:
    async with agent.iter('What is the capital of France?') as agent_run:
      async for node in agent_run:
        nodes.append(node)
    print(nodes)
    '''
    [
      ModelRequestNode(
        request=ModelRequest(
          parts=[
            UserPromptPart(
              content='What is the capital of France?',
              timestamp=datetime.datetime(...),
              part_kind='user-prompt',
            )
          ],
          kind='request',
        )
      ),
      CallToolsNode(
        model_response=ModelResponse(
          parts=[TextPart(content='Paris', part_kind='text')],
          model_name='gpt-4o',
          timestamp=datetime.datetime(...),
          kind='response',
        )
      ),
      End(data=FinalResult(data='Paris', tool_name=None, tool_call_id=None)),
    ]
    '''
    print(agent_run.result.data)
    #> Paris
  ```
  You can also manually drive the iteration using the [`next`][pydantic_ai.agent.AgentRun.next] method for
  more granular control.
  """
  _graph_run: GraphRun[
    _agent_graph.GraphAgentState, _agent_graph.GraphAgentDeps[AgentDepsT, Any], FinalResult[ResultDataT]
  ]
  @property
  defctx(self) -> GraphRunContext[_agent_graph.GraphAgentState, _agent_graph.GraphAgentDeps[AgentDepsT, Any]]:
"""The current context of the agent run."""
    return GraphRunContext[_agent_graph.GraphAgentState, _agent_graph.GraphAgentDeps[AgentDepsT, Any]](
      self._graph_run.state, self._graph_run.deps
    )
  @property
  defnext_node(
    self,
  ) -> _agent_graph.AgentNode[AgentDepsT, ResultDataT] | End[FinalResult[ResultDataT]]:
"""The next node that will be run in the agent graph.
    This is the next node that will be used during async iteration, or if a node is not passed to `self.next(...)`.
    """
    next_node = self._graph_run.next_node
    if isinstance(next_node, End):
      return next_node
    if _agent_graph.is_agent_node(next_node):
      return next_node
    raise exceptions.AgentRunError(f'Unexpected node type: {type(next_node)}') # pragma: no cover
  @property
  defresult(self) -> AgentRunResult[ResultDataT] | None:
"""The final result of the run if it has ended, otherwise `None`.
    Once the run returns an [`End`][pydantic_graph.nodes.End] node, `result` is populated
    with an [`AgentRunResult`][pydantic_ai.agent.AgentRunResult].
    """
    graph_run_result = self._graph_run.result
    if graph_run_result is None:
      return None
    return AgentRunResult(
      graph_run_result.output.data,
      graph_run_result.output.tool_name,
      graph_run_result.state,
      self._graph_run.deps.new_message_index,
    )
  def__aiter__(
    self,
  ) -> AsyncIterator[_agent_graph.AgentNode[AgentDepsT, ResultDataT] | End[FinalResult[ResultDataT]]]:
"""Provide async-iteration over the nodes in the agent run."""
    return self
  async def__anext__(
    self,
  ) -> _agent_graph.AgentNode[AgentDepsT, ResultDataT] | End[FinalResult[ResultDataT]]:
"""Advance to the next node automatically based on the last returned node."""
    next_node = await self._graph_run.__anext__()
    if _agent_graph.is_agent_node(next_node):
      return next_node
    assert isinstance(next_node, End), f'Unexpected node type: {type(next_node)}'
    return next_node
  async defnext(
    self,
    node: _agent_graph.AgentNode[AgentDepsT, ResultDataT],
  ) -> _agent_graph.AgentNode[AgentDepsT, ResultDataT] | End[FinalResult[ResultDataT]]:
"""Manually drive the agent run by passing in the node you want to run next.
    This lets you inspect or mutate the node before continuing execution, or skip certain nodes
    under dynamic conditions. The agent run should be stopped when you return an [`End`][pydantic_graph.nodes.End]
    node.
    Example: