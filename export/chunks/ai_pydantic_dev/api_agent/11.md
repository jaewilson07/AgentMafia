---
url: https://ai.pydantic.dev/api/agent/
session_id: pydantic_ai_docs
chunk_number: 11
title: Agent API Arguments and Return Value
summary: Describes various parameters for invoking the agent API, including user input, result type, conversation history, model settings, dependencies, and usage limits. Also notes that the result of the run is returned, and mentions a future deprecation related to the use of the method.
embedding: [0.05395958200097084, 0.04585054889321327, -0.029352115467190742, -0.05007759854197502, -0.020110836252570152, 0.03642595186829567, 0.02861885167658329, 0.040221672505140305, 0.0030058419797569513, 0.016606265679001808, 0.003604314522817731, 0.015193655155599117, -0.030279478058218956, -0.052838120609521866, 0.008114425465464592, 0.007958067581057549, -0.03521822392940521, 0.022688042372465134, 0.01289681438356638, -0.0031568079721182585, 0.03707294911146164, 0.00854575727134943, 0.02017553523182869, 0.05288125202059746, -0.04934433475136757, 0.015883786603808403, -0.04697201028466225, 0.06590746343135834, -0.06996198743581772, -0.003774151438847184, 0.01728561334311962, -0.00029856234323233366, -0.022817440330982208, -0.023917336016893387, 0.003334732260555029, 0.007844842970371246, 0.012012585066258907, 0.03439869359135628, -0.01644451729953289, 0.022925274446606636, 0.018072793260216713, -0.008826122619211674, -0.015484804287552834, 0.037094518542289734, 0.039229609072208405, 0.017102297395467758, 0.027044489979743958, 0.04015697166323662, 0.027993420138955116, 0.02430553548038006, -0.047187674790620804, 0.008955522440373898, -0.0029465339612215757, 0.010750940069556236, -0.021048981696367264, -0.023615404963493347, 0.010686240158975124, -0.019312871620059013, 0.012487049214541912, -0.08691331744194031, 0.004952225834131241, -0.012336083687841892, 0.011991018429398537, -0.008885431103408337, -0.05395958200097084, 0.0318107046186924, -0.006513107102364302, 0.03914334252476692, 0.02350757084786892, 0.008632023818790913, -0.009904451668262482, 0.04127843305468559, -0.0814785361289978, 0.006345965899527073, -0.057022035121917725, -0.0014921376714482903, 0.06763279438018799, 0.02365853823721409, 0.022537074983119965, -0.004493935965001583, 0.020617650821805, -0.03483002632856369, 0.027605222538113594, 0.021728329360485077, 0.022580208256840706, -0.05521044507622719, -0.0611196868121624, -0.012012585066258907, -0.026591593399643898, -0.04615247994661331, -0.034657493233680725, 0.02747582271695137, 0.04011383652687073, 0.05986882373690605, 0.028209086507558823, 0.024758433923125267, -0.008540365844964981, -0.0013485851231962442, 0.037482716143131256, 0.023766370490193367, 0.00976426899433136, -0.017156213521957397, -0.0377630814909935, -0.035606421530246735, 0.009990718215703964, 0.0041434792801737785, -0.026505326852202415, 0.03487315773963928, -0.037137649953365326, -0.05719456821680069, -0.008373224176466465, 0.021199947223067284, -0.039423707872629166, 0.02071470022201538, -0.07625942677259445, -0.027303289622068405, 0.012961514294147491, -0.031379371881484985, 0.010200992226600647, 0.000887599540874362, -0.007240979000926018, 0.033363498747348785, -0.08022767305374146, 0.0037391057703644037, 0.004154262598603964, 0.004747343249619007, 0.015161305665969849, -0.027605222538113594, 0.011322454549372196, 0.0047203851863741875, 0.012670365162193775, 0.008378616534173489, -0.022817440330982208, -0.030818641185760498, -0.015560287050902843, -0.021695978939533234, -0.08165106922388077, -0.027303289622068405, -0.06577806919813156, -0.012336083687841892, -0.029589347541332245, -0.02872668392956257, -0.017080731689929962, -0.022989973425865173, 0.01413689274340868, 0.05111279338598251, -0.038884542882442474, 0.04714454337954521, -0.04904239997267723, -0.02881295047700405, 0.021933211013674736, 0.008362441323697567, -0.030732376500964165, 0.020488251000642776, 0.012627231888473034, -0.005165195558220148, 0.002163397613912821, -0.00859428197145462, 0.007284112274646759, -0.0417313314974308, -0.024521199986338615, 0.012702715583145618, -0.015398537740111351, 0.004782388918101788, -0.004121912643313408, -0.05240678787231445, 0.007030704990029335, 0.005000750534236431, -0.03897080942988396, -0.033169399946928024, 0.03448496013879776, 0.014773107133805752, -0.011969451792538166, 0.018320810049772263, 0.01162438653409481, -0.01749049685895443, -0.07078151404857635, -0.028338486328721046, 0.00993680115789175, -0.03979033976793289, -0.04438402131199837, -0.03334193304181099, -0.050552062690258026, -0.0427233949303627, -0.028058119118213654, -0.02579362876713276, 0.026224961504340172, -0.024564333260059357, 0.017317963764071465, -0.003876592731103301, -0.013285012915730476, 0.053140051662921906, -0.0058661093935370445, 0.00047446475946344435, -0.02101663127541542, 0.0181374941021204, 0.035110391676425934, -0.011376370675861835, 0.016358250752091408, 0.011171488091349602, -0.004065300337970257, 0.012206683866679668, 0.03502412512898445, -0.010422049090266228, 0.046583812683820724, -0.011376370675861835, -0.0027066057082265615, 0.02995597943663597, -0.009489295072853565, 0.005833759903907776, 0.027303289622068405, -0.022493941709399223, 0.006717989686876535, -0.007079229690134525, -0.0018843798898160458, -0.008534973487257957, -0.035800520330667496, 0.004615248180925846, -0.015312271192669868, 0.027152324095368385, 0.038927674293518066, 0.025966161862015724, 0.03567112237215042, 0.011969451792538166, 0.012454699724912643, 0.038194410502910614, -0.008939347229897976, -0.006723381113260984, -0.0030220169574022293, 0.04302532598376274, -0.016325900331139565, -0.026311226189136505, -0.020606866106390953, -0.06521733850240707, 0.024133002385497093, -0.07513796538114548, 0.01833159290254116, 0.019291305914521217, 0.03148720785975456, -0.06677012890577316, -0.052449923008680344, -0.005143629387021065, 0.044642820954322815, 0.0015784039860591292, -0.009047180414199829, 0.02339973859488964, -0.0037040601018816233, -0.03655535355210304, 0.013328146189451218, 0.009057963266968727, 0.03124997392296791, -0.013533028773963451, 0.006815039087086916, -0.03933744132518768, -0.014859373681247234, -0.03731018304824829, -0.004755430854856968, -0.024952532723546028, -0.027346422895789146, -0.042313627898693085, 0.048567935824394226, -0.009489295072853565, -0.07043644785881042, 0.016757233068346977, -0.004065300337970257, 0.013220313005149364, 0.04162349924445152, -0.05400271341204643, 0.04239989444613457, 0.011441070586442947, 0.011376370675861835, -0.05555550754070282, 0.04078240320086479, -0.01694054901599884, -0.03461436182260513, 0.02747582271695137, 0.038927674293518066, 0.04194699600338936, 0.02564266324043274, -0.07449096441268921, 0.01882762461900711, 0.06500167399644852, 0.030883342027664185, 0.05991195887327194, -0.0058984593488276005, -0.02031571790575981, -0.010519099421799183, -0.010740156285464764, 0.01575438678264618, 0.01848255842924118, 0.03213420510292053, 0.0043402742594480515, 0.03155190497636795, -0.00020218668214511126, 0.00909031368792057, -0.016379816457629204, 0.022235143929719925, 0.009958367794752121, -0.00735420361161232, -0.02945994772017002, 0.0033589948434382677, -0.015614203177392483, 0.001908642239868641, 0.002538116881623864, 0.02046668343245983, 0.049818798899650574, -0.030646109953522682, -0.02380950376391411, 0.02777775377035141, 0.00012543998309411108, 0.008578106760978699, 0.07069525122642517, -0.05590057373046875, -0.012400783598423004, 0.05270871892571449, -0.020887231454253197, 0.05452031269669533, -0.0012070544762536883, 0.01600240170955658, -0.00024211854906752706, 0.007542910985648632, -0.016929764300584793, 0.015592636540532112, 0.047575876116752625, 0.010767114348709583, 0.026893524453043938, 0.004585593938827515, -0.007348812185227871, -0.023680103942751884, 0.050508927553892136, -0.023831069469451904, -0.024478068575263023, -0.003170287236571312, 0.006912088952958584, 0.026397492736577988, 0.0007979634683579206, -0.036900416016578674, -0.008529582060873508, 0.06478600203990936, 0.06513106822967529, 0.00486865546554327, -0.030279478058218956, -0.031767573207616806, -0.0008498580427840352, 0.032177336513996124, 0.025232898071408272, 0.05594370886683464, 0.004539764951914549, -0.01957167126238346, -0.012292950414121151, 0.02160971239209175, -0.01234686654061079, 0.029201148077845573, -0.01048135757446289, -0.015916135162115097, 0.0066586812026798725, -0.0027591742109507322, 0.02091958187520504, 0.0058661093935370445, 0.013921227306127548, -0.04899926856160164, 0.008869255892932415, -0.0017253264086320996, -0.012163550592958927, -0.0387551449239254, -0.0030381919350475073, -0.059308093041181564, -0.006345965899527073, 0.007063054945319891, 0.01918347179889679, 0.049214933067560196, 0.018816839903593063, 0.001513704308308661, 0.04207639768719673, -0.060990285128355026, 0.004154262598603964, -0.018913889303803444, 0.012648798525333405, 0.02121073007583618, 0.05969629064202309, 0.006917480379343033, 0.03368699550628662, -0.01819141022861004, -0.0063998824916779995, 0.033212531358003616, 0.049258068203926086, -0.05460657924413681, 0.0076669189147651196, -0.0243486687541008, 0.03944527357816696, 0.027713054791092873, -0.07121284306049347, 0.006949830334633589, -0.00277130538597703, 0.01843942515552044, 0.010351957753300667, 0.014298642054200172, 0.011645953170955181, 0.038474779576063156, 0.021286213770508766, 0.008206083439290524, 0.030236344784498215, 0.001997604500502348, 0.05404584854841232, 0.031530339270830154, 0.017080731689929962, 0.06379394233226776, -0.039531540125608444, 0.02067156694829464, 0.05232052132487297, 0.05352824926376343, -0.003946683835238218, 0.03364386409521103, -0.034355562180280685, -0.03903551027178764, -0.025276031345129013, 0.007887976244091988, -0.005973942577838898, 0.047877807170152664, 0.08337639272212982, -0.011300887912511826, -0.032026369124650955, 0.008605064824223518, 0.02896391600370407, -0.022386109456419945, 0.07690642029047012, 0.015441671013832092, -0.048222873359918594, 0.022235143929719925, 0.00973731093108654, -0.007882584817707539, 0.013781044632196426, 0.02370167151093483, 0.011893969029188156, 0.003439869498834014, 0.0056396606378257275, 0.003423694521188736, -0.013845743611454964, -0.04697201028466225, 0.003294294932857156, 0.021685196086764336, 0.005936201196163893, 0.03657691925764084, 0.014503524638712406, -0.052493054419755936, 0.006081775296479464, -0.02930898219347, -0.012864464893937111, 0.0025623792316764593, 0.013241879642009735, -0.02728172391653061, -0.021922428160905838, 0.0020137792453169823, -0.00015661043289583176, -0.07613002508878708, -0.027713054791092873, 0.07768282294273376, 0.025081932544708252, 0.04304689168930054, 0.018159059807658195, 0.00675573106855154, -0.02838161773979664, 0.002790176309645176, 0.009279021061956882, -0.05745336785912514, -0.003504569176584482, 0.043003760278224945, 0.001197619130834937, -0.03161660581827164, 0.033061567693948746, 0.030128510668873787, -0.033169399946928024, -0.021480312570929527, -0.021555796265602112, -0.0006891196244396269, -0.008793773129582405, 0.032673366367816925, 0.03502412512898445, -0.000154504319652915, 0.002884529996663332, 0.03297530114650726, -0.040221672505140305, 0.02339973859488964, 0.010260299779474735, -0.02465059980750084, -0.024585900828242302, -0.019312871620059013, -0.054477181285619736, -0.06625252962112427, 0.04477221891283989, 0.04013540595769882, 0.010874947533011436, -0.023723237216472626, -0.008437924087047577, -0.0004801933828275651, -0.02201947756111622, -0.006987571716308594, 0.03597305342555046, -0.011947885155677795, -0.006054817233234644, -0.04507414996623993, 0.021232297644019127, 0.0011794223682954907, 0.00403834180906415, -0.03362229838967323, -0.010254908353090286, -0.022342976182699203, 0.04050203785300255, 0.02027258463203907, 0.033212531358003616, -0.04541921615600586, 0.033773262053728104, 0.02995597943663597, 0.0016929764533415437, -0.01160281989723444, 0.010475966148078442, -0.00456941919401288, -0.01234686654061079, -0.007003746461123228, 0.02667785808444023, 0.009500077925622463, -0.01535540446639061, 0.01888154074549675, -0.015064255334436893, -0.018396291881799698, 0.02644062601029873, 0.00851879920810461, 0.019097205251455307, -0.0017010639421641827, 0.019614804536104202, 0.011613602750003338, 0.025599529966711998, -0.01351146213710308, 0.021598929539322853, 0.008141383528709412, 0.0025974249001592398, 0.0061788251623511314, 0.021350914612412453, -0.04145096614956856, -0.030689243227243423, -0.0011039392556995153, 0.0196255873888731, -0.01749049685895443, -0.003636664478108287, -0.011656736023724079, -0.003280815901234746, 0.021156813949346542, -0.03806501254439354, -0.006340574473142624, -0.03633968532085419, -0.015819085761904716, 0.014374124817550182, 0.020013784989714622, -0.02301154099404812, -0.005343120079487562, -0.012109634466469288, -0.04011383652687073, 0.0041812206618487835, 0.006610156502574682, -0.006567023228853941, -0.025211330503225327, -0.0066532897762954235, 0.010050025768578053, -0.006820430979132652, -0.00683121383190155, 0.020984282717108727, 0.02514663152396679, 0.01244391594082117, -0.009694177657365799, 0.02777775377035141, 0.014913289807736874, -0.009198145940899849, 0.023291906341910362, 0.004480456933379173, -0.0029519256204366684, -0.028058119118213654, 0.04000600427389145, 0.04602308198809624, -0.032867468893527985, 0.020898016169667244, -0.02221357636153698, -0.036404386162757874, 0.005968550685793161, -0.006917480379343033, 0.0035153524950146675, 0.02762678824365139, -0.047273941338062286, 0.005806801375001669, -0.024521199986338615, 0.012088067829608917, -0.0031028916127979755, -0.026246527209877968, -0.005715143401175737, 0.02042355015873909, -0.04129999876022339, -0.0016309726051986217, 0.011764569208025932, 0.01478388998657465, -0.034851592034101486, 0.0014463086845353246, 0.04438402131199837, 0.014104543253779411, -0.00759143615141511, 0.036447517573833466, 0.033363498747348785, 0.0063998824916779995, 0.0412568673491478, -0.0004960313090123236, -0.04705827683210373, 0.00017194292740896344, 0.005812193267047405, -0.03474375978112221, -0.0047257766127586365, -0.01470840722322464, -0.006610156502574682, 0.012001801282167435, -0.049559999257326126, 0.0104328328743577, 0.054088979959487915, 0.013058563694357872, -0.0015905352775007486, 0.040178537368774414, -0.02415456995368004, 0.02324877306818962, 0.028683550655841827, -0.010971996933221817, -0.04129999876022339, 0.011408720165491104, 0.008481057360768318, 0.03413989394903183, -0.005186762195080519, 0.025448564440011978, 0.0076669189147651196, -0.00020302912162151188, -0.04602308198809624, -0.022472376003861427, -0.008610457181930542, -0.007143929600715637, -0.02217044308781624, -0.01834237575531006, 0.04145096614956856, 0.011829269118607044, -0.035606421530246735, 0.010950430296361446, -0.017113080248236656, 0.0029761879704892635, 0.006227349862456322, 0.007208629045635462, 0.0024612857960164547, -0.026203393936157227, -0.032673366367816925, -0.03010694496333599, -0.003917030058801174, 0.007284112274646759, 0.0206284336745739, -0.03314783424139023, 0.005246070679277182, 0.03342819958925247, -0.021005848422646523, -0.0036420561373233795, 0.00027227806276641786, 0.02137248031795025, -0.024758433923125267, 0.025081932544708252, -0.058316029608249664, 0.02648375928401947, 0.033816397190093994, 0.018148276954889297, 0.0437154583632946, -0.011883185245096684, -0.04326255992054939, -0.025017231702804565, 0.013759477995336056, -0.0033104699105024338, 0.026613159105181694, -0.006599373184144497, -0.027691487222909927, -0.04069613665342331, -0.018105143681168556, 0.04097650200128555, -0.004415757022798061, -0.027238590642809868, -0.042205795645713806, 0.017673812806606293, 0.023486005142331123, -0.01951775513589382, -0.009014829993247986, -0.012476266361773014, 0.01932365447282791, 0.01907563954591751, -0.01670331507921219, -0.010723982006311417, -0.014859373681247234, 0.0193775724619627, 0.0033104699105024338, 0.004572114907205105, -0.015538720414042473, -0.004413061309605837, -0.02365853823721409, -0.04039420187473297, 0.005979334004223347, -0.009101096540689468, -0.030128510668873787, 0.005941592622548342, -0.01933443918824196, -0.02101663127541542, -0.005477911327034235, -0.0013600423699244857, -0.022073393687605858, -0.003558485535904765, 0.01472997386008501, 0.018115926533937454, -0.030042245984077454, -0.0003952749539166689, -0.04861107096076012, 0.01808357611298561, -0.006540065165609121, 0.00790415145456791, 0.00458289822563529, -0.014913289807736874, 0.019258955493569374, -0.010573015548288822, -0.03124997392296791, 0.02797185443341732, 0.01574360392987728, -0.0270876232534647, 0.008179125376045704, 0.02663472481071949, 0.02439180202782154, 0.0243486687541008, -0.0039601633325219154, -0.007866409607231617, 0.0168974157422781, -0.03263023495674133, -0.0035692688543349504, 0.0014651794917881489, -0.029546214267611504, -0.007790926843881607, 0.011333237402141094, 0.003952075727283955, -0.0140398433431983, -0.016121018677949905, 0.023378172889351845, -0.019302088767290115, 0.01763067953288555, -0.009780444204807281, 0.022688042372465134, 0.033859528601169586, -0.028144385665655136, -0.0031891579274088144, -0.02121073007583618, 0.004251311998814344, 0.006292049773037434, 0.046885743737220764, 0.029826579615473747, 0.022688042372465134, 0.04999133199453354, 0.0044669779017567635, -0.01396436057984829, 0.010249516926705837, -0.0020636520348489285, -0.010632324032485485, 0.020337283611297607, 0.025081932544708252, 0.017921827733516693, 0.02324877306818962, 0.019754987210035324, 0.01219590101391077, -0.018460992723703384, -0.027454255148768425, -0.03720235079526901, 0.0006897935527376831, -0.025707362219691277, 0.04800720512866974, 0.02751895599067211, -0.0161425843834877, 0.034657493233680725, -0.005019621457904577, -0.017760077491402626, -0.0002301558415638283, 0.012411566451191902, -0.0014206984778866172, -0.003423694521188736, 0.0034425652120262384, 0.008254608139395714, -0.014417258091270924, -6.019265856593847e-05, -0.008103642612695694, -0.011419503949582577, -0.004790476523339748, -0.05529671162366867, -0.005302682518959045, 0.017415013164281845, -0.0023440176155418158, 0.002527333563193679, -0.015150521881878376, -0.002248315839096904, -0.08419592678546906, 0.023313472047448158, -0.020110836252570152, -0.03523978963494301, 0.01753362827003002, -0.004709601867944002, -0.02568579651415348, -0.02534073032438755, 0.01100973878055811, -0.003361690556630492, 0.01966872066259384, 0.015053472481667995, -0.009731918573379517, -0.06966005265712738, 0.017652245238423347, 0.018169842660427094, 0.011268537491559982, -0.025448564440011978, 0.02082253247499466, -0.03513195738196373, -0.030667675659060478, -0.029503080993890762, -0.07565555721521378, 0.014859373681247234, -0.001355998683720827, -0.014654491096735, 0.0027362597174942493, -0.016358250752091408, 0.012584099546074867, -0.02816595323383808, -0.04058830440044403, 0.01103130541741848, 0.009009438566863537, -0.021793028339743614, -0.03105587512254715, 0.016379816457629204, 0.007629177533090115, 0.029783446341753006, 0.0024626338854432106, 0.008998655714094639, -0.010378916747868061, -0.036447517573833466, 0.02042355015873909, -0.01951775513589382, 0.021739112213253975, -0.010756331495940685, -0.008206083439290524, 0.00869672279804945, 0.013317362405359745, -0.0071547129191458225, -0.007079229690134525, -0.02534073032438755, -0.04239989444613457, -0.009775051847100258, 0.008195300586521626, 0.042809661477804184, -0.008319308049976826, 0.001775199081748724, 0.00587689271196723, 0.014827023260295391, 0.016110233962535858, 0.0019045985536649823, 0.009979934431612492, -0.0392511747777462, -0.003787630470469594, -0.023787938058376312, -0.0007831364055164158, -0.0031972452998161316, -0.011937101371586323, -0.048869870603084564, 0.004243224393576384, 0.03036574460566044, -0.003930509090423584, -0.007914934307336807, 0.009052571840584278, -0.005332336761057377, 0.0002795230830088258, 0.019302088767290115, 0.01842864230275154, -0.006513107102364302, -0.024219268932938576, -0.001767111592926085, 0.01902172341942787, -0.002116220537573099, -0.01640138402581215, -0.00971574429422617, 0.005087017081677914, -0.006788081023842096, -0.0008532278006896377, 0.019938303157687187, 0.03612402081489563, -0.020143184810876846, 0.026850391179323196, -0.016185717657208443, -0.0243486687541008, -0.0035234398674219847, -0.022989973425865173, -0.0034371735528111458, 0.011236188001930714, -0.00550217367708683, 0.019258955493569374, 0.006534673739224672, -0.028209086507558823, 0.030171643942594528, -0.027195457369089127, 0.005445561371743679, -0.029481513425707817, -0.0012104242341592908, 0.014428041875362396, 0.03161660581827164, -0.008082075975835323, 0.0029034006875008345, -0.0029438380151987076, -0.016185717657208443, -0.007801710162311792, -0.009990718215703964, 0.048179738223552704, -0.06185295060276985, -0.04580741375684738, 0.0136624276638031, -0.023442871868610382, 0.03571425378322601, 0.027367988601326942, 0.03150877356529236, 0.01594848558306694, 0.038086578249931335, -0.008901605382561684, -0.041558798402547836, 0.004706906154751778, 0.009284412488341331, -0.017102297395467758, 0.007796318270266056, -0.006680247839540243, 0.014029059559106827, -0.040523603558540344, -0.006545457057654858, 0.01599161885678768, -0.04196856543421745, -0.014481958001852036, -0.021501880139112473, 0.005941592622548342, -0.010734764859080315, 0.01175378542393446, -0.021296996623277664, -0.05879049748182297, -0.018752140924334526, 0.00076089589856565, -0.017673812806606293, -0.01339284610003233, 0.02236454375088215, -0.020984282717108727, -0.02122151479125023, 0.02697979100048542, 0.004264791030436754, -0.03914334252476692, 0.0019800816662609577, -0.014093759469687939, -0.022073393687605858, -0.018967807292938232, 0.01639060117304325, 0.003065149998292327, 0.08540365844964981, -0.005909242667257786, 0.016778798773884773, -0.0022307930048555136, 0.01031421683728695, -0.016174934804439545, 0.01480545662343502, -0.044944752007722855, 0.026893524453043938, -0.04352135583758354, 0.0026742557529360056, -0.006221957970410585, -0.007440469693392515, 0.020046135410666466, 0.009613302536308765, 0.032824333757162094, -0.018913889303803444, -0.004051821306347847, 0.040868669748306274, 0.016972897574305534, 0.050163865089416504, -0.018417859449982643, -0.008297741413116455, 0.002685039071366191, -0.007375770248472691, 0.01411532610654831, 0.05059519410133362, -0.01942070573568344, -0.002997754607349634, 0.0025003752671182156, 0.03700825199484825, -0.03269493579864502, 0.0018776403740048409, -0.027367988601326942, -0.021275430917739868, 0.03452809527516365, -0.012314517050981522, -0.036900416016578674, -0.003003146266564727, -0.020951932296156883, 0.02518976479768753, -0.004119216464459896, -0.024262402206659317, 0.027152324095368385, 0.04930119961500168, 0.004367232322692871, -0.0044669779017567635, -0.04177446290850639, -0.021588146686553955, 0.01867665722966194, -0.03489472717046738, -0.009947584941983223, -0.009203537367284298, -0.0019868211820721626, -0.017123864963650703, -0.0161533672362566, 0.026073994114995003, -0.01535540446639061, -0.0013991318410262465, 0.024758433923125267, -0.01470840722322464, -0.008384007960557938, 0.036296553909778595, 0.021253863349556923, -0.0031433289404958487, 0.0001548412983538583, 0.023787938058376312, 0.021642062813043594, -0.0013061260106042027, 0.016379816457629204, -0.027001356706023216, -0.004960313439369202, -0.011807702481746674, 0.050508927553892136, -0.04306845739483833, 0.01470840722322464, 0.000562078959774226, 0.029934411868453026, 0.012206683866679668, 0.00914422981441021, 0.026052428409457207, -0.016962114721536636, -0.024607466533780098, 0.03448496013879776, 0.033514466136693954, 0.000547251955140382, 0.04030793532729149, -0.00675573106855154, -0.010950430296361446, 0.0044022779911756516, 0.0017253264086320996, -0.005973942577838898, 0.004763518460094929, -0.012519399635493755, -0.008588890545070171, 0.008168341591954231, 0.01177535206079483, -0.001831811387091875, 0.006567023228853941, 0.015517153777182102, -0.006453799083828926, -0.014287859201431274, -0.012810547836124897, -0.021081332117319107, -0.009640260599553585, -0.012044934555888176, 0.021577361971139908, 0.02469373308122158, 0.03463592752814293, 0.0009455597028136253, -0.005930809304118156, 0.03864730894565582, 0.027411121875047684, -0.024478068575263023, -0.02116759866476059, 0.0009954324923455715, -0.009802009910345078, 0.012260599993169308, 0.010502924211323261, 0.012206683866679668, 0.02266647480428219, -0.0283169187605381, -0.0014436129713431, 0.04015697166323662, -0.028511017560958862, -0.021038198843598366, -0.03060297667980194, 0.006852780468761921, -0.013975143432617188, 0.027562089264392853, 0.006825822405517101, -0.03532605618238449, 0.032026369124650955, 0.05262245237827301, -0.004841696936637163, 0.06370767951011658, 0.01703759841620922, 0.006788081023842096, -0.015937702730298042, -0.014503524638712406, -0.009386853314936161, -0.008011984638869762, -0.03996287286281586, -0.002259099157527089, 0.01933443918824196, 0.031573470681905746, -0.03737488389015198, -0.010416657663881779, 0.004051821306347847, -0.027238590642809868, 0.00867515616118908, -0.01045979093760252, 0.004356449004262686, -0.0007871801499277353, 0.011036696843802929, -0.021253863349556923, -0.0015420104609802365, -0.023831069469451904, -0.011074438691139221, -0.014665273949503899, 0.019657937809824944, 0.008826122619211674, -0.05305378511548042, -0.027497388422489166, -0.015312271192669868, -6.913310244271997e-06, 0.010858772322535515, 0.01293994765728712, 0.0074782115407288074, 0.029179582372307777, -0.018892323598265648, 0.003350907238200307, 0.022030260413885117, -0.013673211447894573, -0.002871050965040922, -0.029395248740911484, -0.0258367620408535, -0.020552949979901314, -0.024262402206659317, -0.012659582309424877, -0.00018432685465086251, -0.01282133162021637, 0.013878094032406807, 0.02217044308781624, 0.010060809552669525, 0.0009799314429983497, 0.010195600800216198, 0.026419060304760933, 0.010281866416335106, 0.04550548270344734, 0.0015743602998554707, 0.014471175149083138, 0.003019321244210005, -0.0042135706171393394, -0.021598929539322853, 0.0005664596683345735, 0.009300587698817253, 0.02002456970512867, -0.016325900331139565, -0.020304935052990913, 0.036835718899965286, 0.006292049773037434, 0.016929764300584793, 0.018655091524124146, 0.020488251000642776, 0.030128510668873787, 0.034959424287080765, 0.020649999380111694, 0.005076233763247728, 0.021695978939533234, 0.04641127958893776, 0.024111436679959297, -0.010923472233116627, 0.010621540248394012, 0.007084621582180262, -0.003992512822151184, -0.002019170904532075, 0.03373013064265251, 0.05879049748182297, 0.03170287236571312, -0.005057362839579582, -0.03213420510292053, 0.008993263356387615, -0.03437712788581848, 0.019852036610245705, 0.020197100937366486, 0.0046583809889853, -0.001648495439440012, -0.0028872259426862, 0.027109190821647644, 0.011710653081536293, -0.019808903336524963, -0.004245920106768608, 0.005839151330292225, 0.013888876885175705, 0.03010694496333599, -0.015172088518738747, 0.0017320659244433045, -0.017921827733516693, -0.0021377871744334698, -0.040415771305561066, 0.03394579514861107, -0.02255864255130291, -0.0008222258184105158, -0.037439581006765366, -0.0032376828603446484, 0.015323054976761341, 0.01922660507261753, 0.019959868863224983, -0.01525835506618023, -0.022644909098744392, 0.025858329609036446, 0.04058830440044403, 0.007397336885333061, -0.03140094131231308, 0.02872668392956257, 0.0014058713568374515, -0.023076239973306656, 0.05076772719621658, -0.021782245486974716, -0.017997311428189278, 0.009122663177549839, -0.0168974157422781, -0.022148877382278442, 0.013263446278870106, 0.02687195874750614, 0.005283812060952187, 0.027303289622068405, 0.04455655440688133, 0.020908799022436142, -0.018105143681168556, -0.015495587140321732, 0.016983680427074432, 0.002187659963965416, 0.02469373308122158, 0.04641127958893776, 0.017274830490350723, -0.013069347478449345, -0.017501279711723328, 0.042658694088459015, 0.04060987010598183, 0.01293994765728712, -0.017005247995257378, 0.001831811387091875, 0.023227205500006676, 0.009349112398922443, 0.0015527937794104218, -0.02797185443341732, 0.0014004796976223588, 0.008858472108840942, -0.010686240158975124, 0.006836605723947287, 0.0035800521727651358, -0.03254396840929985, -0.004580202512443066, -0.04516041651368141, 0.0006537369336001575, -0.01050831563770771, 0.020401984453201294, 0.002226749435067177, -0.0010688935872167349, -0.01297229714691639, -0.021394046023488045, -0.01406140998005867, -0.021685196086764336, -0.005580352619290352, 0.008432532660663128, -0.020779399201273918, -0.013630078174173832, -0.005925417877733707, -0.016617050394415855, 0.009009438566863537, -0.007036096416413784, -0.0031190665904432535, -0.00862124003469944, 0.01729639619588852, -0.020898016169667244, 0.012713498435914516, -0.0018776403740048409, 0.027799321338534355, -0.00971574429422617, 0.0268288254737854, -0.020401984453201294, -0.015614203177392483, 0.010060809552669525, -0.02896391600370407, -0.00973731093108654, 0.00072180648567155, -0.0044022779911756516, -0.018601175397634506, 0.03884141147136688, -0.010492141358554363, -0.007532127667218447, -0.004679947625845671, 0.013166396878659725, 0.014201592653989792, -0.020499033853411674, 0.019064856693148613, 0.0347868911921978, -0.012886031530797482, -0.016832714900374413, 0.010222558863461018, 0.02071470022201538, 0.021674413233995438, -0.02866198495030403, -0.017177781090140343, -0.00924667064100504, -0.010254908353090286, -0.0010095854522660375, 0.023593837395310402, -0.012185117229819298, 0.014827023260295391, -0.003979033790528774, 0.0020892624743282795, -0.01744736358523369, -0.008125209249556065, 0.013834960758686066, 0.01898937299847603, 0.02270960807800293, -0.004906396847218275, 0.0053916447795927525, -0.0007811145624145865, 0.016854282468557358, 0.03487315773963928, 0.003604314522817731, -0.0077046602964401245, 0.01463292445987463, -0.014600574038922787, 0.0031568079721182585, -0.022342976182699203, -0.022817440330982208, -0.01051370706409216, -0.008351657539606094, -0.013317362405359745, 0.004475065041333437, -0.024327101185917854, -0.0033967362251132727, -0.02881295047700405, -0.03144407272338867, 0.01411532610654831, -0.006141083315014839, -0.008109034039080143, 0.0158945694565773, -0.014546657912433147, 0.028014985844492912, -0.01108522154390812, 0.009322154335677624, 0.00548869464546442, 0.028252219781279564, 0.012454699724912643, 0.009483903646469116, -0.04129999876022339, -0.017770862206816673, -0.0069444384425878525, 0.008955522440373898, -0.0007979634683579206, 0.0218577291816473, -0.007634568959474564, -0.02102741412818432, -0.009731918573379517, 0.031379371881484985, 0.0027214328292757273, -0.0134144127368927, 0.04679947718977928, 0.00802276749163866, -0.00231166766025126, 0.010653890669345856, 0.007753185462206602, -0.005806801375001669, 0.0033293406013399363, 0.006383707746863365, -0.023593837395310402, -0.030495142564177513, 0.007559086196124554, -0.026160260662436485, 0.018622741103172302, -0.013166396878659725, -0.016121018677949905, -0.03127153962850571, 0.05240678787231445, -0.006232741288840771, 0.039380572736263275, 0.015387754887342453, 0.024952532723546028, -0.03489472717046738, -0.009252062998712063, -0.04541921615600586, 0.035455457866191864, -0.030624542385339737, -0.005650443956255913, 0.037784647196531296, -0.02941681444644928, -7.510392606491223e-05, 0.005432082340121269, 0.007542910985648632, 0.011193054728209972, 0.004987271502614021, -0.027756188064813614, 0.0076938774436712265, 0.031681306660175323, 0.012573315761983395, -0.0064322324469685555, -0.05132845789194107, 0.0014449608279392123, 0.002140483120456338, 0.0031109789852052927, -0.04602308198809624, -0.004515502601861954, 0.011419503949582577, -0.01297229714691639, 0.010163250379264355, -0.028014985844492912, 0.004388798959553242, 0.020639216527342796, -0.026117127388715744, -0.014902506023645401, -0.010837206616997719, 0.0033562988974153996, 0.018266892060637474, 0.018148276954889297, 0.03258709982037544, -0.0009226452093571424, 0.00644840719178319, -0.01625041849911213, 0.05003446340560913, 0.0006456494447775185, -0.0635782778263092, 0.030797075480222702, -0.03662005066871643, 0.010141683742403984, -0.006464582402259111, -0.009656435810029507, -0.00670720636844635, -0.022235143929719925, 0.0013586945133283734, 0.006922871805727482, 0.006076383870095015, 0.034765325486660004, -0.020854882895946503, -0.025125065818428993, -0.012616449035704136, 0.021739112213253975, -0.02652689255774021, 0.016724882647395134, -0.04084710031747818, -0.0019153818720951676, -0.038431644439697266, -0.020596083253622055, -0.0327812023460865, -0.0377630814909935, -0.009181971661746502, 0.008006592281162739, 0.0018776403740048409, 0.008502623997628689, -0.0008694027201272547, -0.016164151951670647, 0.001353976782411337, -0.019215822219848633, 0.016239633783698082, -0.019409921020269394, -0.03707294911146164, -0.004510110709816217, -0.036749452352523804, 0.008162950165569782, 0.021987127140164375, 0.007100796326994896, -0.03830224648118019, -0.04615247994661331, 0.00039190519601106644, -0.0007811145624145865, -0.0077370102517306805, -0.010033851489424706, -0.021296996623277664, 0.026268092915415764, 0.028360052034258842, -0.04597994685173035, 0.01105287205427885, 0.031163707375526428, -0.026742558926343918, -0.014891723170876503, 0.009877493605017662, 0.008087467402219772, 0.01103130541741848, 0.005367382429540157, 0.008416357450187206, 0.010023067705333233, -0.008987871930003166, 0.021739112213253975, 0.010847989469766617, -0.037396449595689774, -0.017706161364912987, 0.009532428346574306, 0.015344621613621712, -0.026419060304760933, 0.0034290861804038286, -0.040825534611940384, -0.013371279463171959, -0.02160971239209175, -0.02038041688501835, -0.0352613590657711, 0.03200480341911316, 0.0004653663490898907, 0.03357916325330734, 0.018773706629872322, 0.0025165502447634935, -0.017016030848026276, 0.014891723170876503, -0.035304490476846695, 0.032371435314416885, -0.03502412512898445, 0.019097205251455307, 0.023529138416051865, 0.01112835481762886, -0.056418173015117645, 0.028748249635100365, 0.007580652832984924, 0.025060364976525307, 0.024866266176104546, -0.0025556397158652544, -0.018363943323493004, -0.010912689380347729, 0.03051671013236046, 0.00014675383863504976, -0.010179425589740276, -0.02777775377035141, 0.008006592281162739, -0.006486148573458195, 0.010880338959395885, -0.018709007650613785, 0.015560287050902843, -0.03963937237858772, -0.007564477622509003, -0.01415845938026905, -0.0013755434192717075, -0.001680845278315246, -0.0056396606378257275, 0.004448106978088617, 0.018115926533937454]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-15T11:17:03.718033", "url_path": "/api/agent/", "chunk_size": 5000}
updated_dt: 2025-03-15T11:17:03.719045
---
```
    Args:
      user_prompt: User input to start/continue the conversation.
      result_type: Custom result type to use for this run, `result_type` may only be used if the agent has no
        result validators since result validators would expect an argument that matches the agent's result type.
      message_history: History of the conversation so far.
      model: Optional model to use for this run, required if `model` was not set when creating the agent.
      deps: Optional dependencies to use for this run.
      model_settings: Optional settings to use for this model's request.
      usage_limits: Optional limits on model request count or token usage.
      usage: Optional usage to start with, useful for resuming a conversation or agents used in tools.
      infer_name: Whether to try to infer the agent name from the call frame if it's not set.
    Returns:
      The result of the run.
    """
    # TODO: We need to deprecate this now that we have the `iter` method.
    #  Before that, though, we should add an event for when we reach the final result of the stream.
    if infer_name and self.name is None:
      # f_back because `asynccontextmanager` adds one frame
      if frame := inspect.currentframe(): # pragma: no branch
        self._infer_name(frame.f_back)
    yielded = False
    async with self.iter(
      user_prompt,
      result_type=result_type,
      message_history=message_history,
      model=model,
      deps=deps,
      model_settings=model_settings,
      usage_limits=usage_limits,
      usage=usage,
      infer_name=False,
    ) as agent_run:
      first_node = agent_run.next_node # start with the first node
      assert isinstance(first_node, _agent_graph.UserPromptNode) # the first node should be a user prompt node
      node = first_node
      while True:
        if self.is_model_request_node(node):
          graph_ctx = agent_run.ctx
          async with node._stream(graph_ctx) as streamed_response: # pyright: ignore[reportPrivateUsage]
            async defstream_to_final(
              s: models.StreamedResponse,
            ) -> FinalResult[models.StreamedResponse] | None:
              result_schema = graph_ctx.deps.result_schema
              async for maybe_part_event in streamed_response:
                if isinstance(maybe_part_event, _messages.PartStartEvent):
                  new_part = maybe_part_event.part
                  if isinstance(new_part, _messages.TextPart):
                    if _agent_graph.allow_text_result(result_schema):
                      return FinalResult(s, None, None)
                  elif isinstance(new_part, _messages.ToolCallPart) and result_schema:
                    for call, _ in result_schema.find_tool([new_part]):
                      return FinalResult(s, call.tool_name, call.tool_call_id)
              return None
            final_result_details = await stream_to_final(streamed_response)
            if final_result_details is not None:
              if yielded:
                raise exceptions.AgentRunError('Agent run produced final results')
              yielded = True
              messages = graph_ctx.state.message_history.copy()
              async defon_complete() -> None:
"""Called when the stream has completed.
                The model response will have been added to messages by now
                by `StreamedRunResult._marked_completed`.
                """
                last_message = messages[-1]
                assert isinstance(last_message, _messages.ModelResponse)
                tool_calls = [
                  part for part in last_message.parts if isinstance(part, _messages.ToolCallPart)
                ]
                parts: list[_messages.ModelRequestPart] = []
                async for _event in _agent_graph.process_function_tools(
                  tool_calls,
                  final_result_details.tool_name,
                  final_result_details.tool_call_id,
                  graph_ctx,
                  parts,
                ):
                  pass
                # TODO: Should we do something here related to the retry count?
                #  Maybe we should move the incrementing of the retry count to where we actually make a request?
                # if any(isinstance(part, _messages.RetryPromptPart) for part in parts):
                #   ctx.state.increment_retries(ctx.deps.max_result_retries)
                if parts:
                  messages.append(_messages.ModelRequest(parts))
              yield StreamedRunResult(
                messages,
                graph_ctx.deps.new_message_index,
                graph_ctx.deps.usage_limits,
                streamed_response,
                graph_ctx.deps.result_schema,
                _agent_graph.build_run_context(graph_ctx),
                graph_ctx.deps.result_validators,
                final_result_details.tool_name,
                on_complete,
              )
              break
        next_node = await agent_run.next(node