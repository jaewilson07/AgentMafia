---
url: https://ai.pydantic.dev/api/agent/
session_id: pydantic_ai_docs
chunk_number: 23
title: Agent Run Method
summary: This document details the async `run` method for an agent, which accepts a user prompt and optional parameters such as `result_type`, `message_history`, and `model`. It outlines the process of building an internal agent graph and executing it to return the results.
embedding: [-0.00012413444346748292, 0.04662858322262764, -0.016472941264510155, -0.03413669764995575, -0.01904136687517166, 0.044013459235429764, 0.01665973663330078, 0.03712541237473488, 0.01527045201510191, -0.008277332410216331, -0.018049020320177078, -0.02337266504764557, 0.004264168906956911, -0.035654403269290924, -0.02573094516992569, -0.0321987047791481, -0.03581785038113594, -0.008849390782415867, -0.010051880031824112, -0.006199243012815714, 0.03782588988542557, -0.016881555318832397, 0.013087291270494461, 0.017453612759709358, -0.038619767874479294, 0.00761187681928277, -0.05062131583690643, 0.04370991885662079, -0.019987013190984726, 0.015970932319760323, -0.025334006175398827, -0.015060308389365673, -0.022391993552446365, -0.029630281031131744, 0.008826040662825108, -0.03163832053542137, 0.0065436456352472305, 0.009456472471356392, -0.006566994823515415, 0.016367869451642036, 0.029583582654595375, -0.0763055607676506, 0.037942636758089066, 0.007617713883519173, -0.008464126847684383, 0.03131143003702164, 0.028439465910196304, 0.028462816029787064, 0.046395089477300644, -0.023139171302318573, -0.05300294607877731, 0.0275755412876606, 0.023559458553791046, 0.038059383630752563, -0.03294588252902031, -0.03119468502700329, 0.007576852571219206, 0.0047545041888952255, -0.014815140515565872, -0.024166541174054146, 0.009117907844483852, -0.016507966443896294, -0.004354647360742092, 0.030027220025658607, -0.0280658770352602, 0.026127884164452553, 0.017453612759709358, 0.03817613050341606, -0.03749899938702583, -0.005008427891880274, 0.0370553620159626, 0.02813592553138733, -0.05571146681904793, -0.02442338317632675, -0.010040205903351307, -0.012059921398758888, 0.03714875876903534, 0.0359579436480999, -0.0017409833380952477, -0.03654167801141739, 0.007080679759383202, -0.001482681487686932, 0.001237513730302453, 0.033903203904628754, 0.009205467067658901, -0.05216237157583237, -0.07065502554178238, -0.025380706414580345, -0.010863268747925758, -0.08695285022258759, 0.004909193608909845, 0.04184197261929512, 0.00011072683264501393, 0.04408350586891174, 0.07350364327430725, 0.05622515082359314, -0.004982159938663244, 0.006911397445946932, 0.007880393415689468, 0.032011911273002625, 0.05328313633799553, -0.024983767420053482, -0.012048246338963509, 0.021983379498124123, 0.005104743875563145, 0.007991302758455276, -0.014266431331634521, 0.015317150391638279, -0.0323154516518116, -0.018772849813103676, -0.030167315155267715, 0.020197156816720963, -0.019029691815376282, 0.01858605444431305, -0.06103511154651642, -0.04501748085021973, 0.009777525439858437, -0.042075466364622116, 0.02400309592485428, -0.02991047315299511, -0.01966012269258499, 0.02517056092619896, -0.025497451424598694, 0.0005614780820906162, 0.03054090403020382, 0.007932930253446102, -0.03654167801141739, -0.03131143003702164, -0.013600976206362247, -0.004804121796041727, 0.015142031013965607, -0.007045655976980925, -0.0005848273867741227, -0.0052390024065971375, -0.015982605516910553, -0.003642493160441518, -0.05015432834625244, -0.005886945873498917, -0.04361652210354805, 0.03336616978049278, -0.022450366988778114, -0.0045735472813248634, -0.05080810934305191, 0.006164219230413437, -0.013414181768894196, 0.052956245839595795, -0.05332983657717705, 0.03420674800872803, -0.05216237157583237, 0.002345146844163537, 0.023045774549245834, 0.010139440186321735, -0.03427679464221001, 0.0038759862072765827, -0.004923786967992783, 0.010828244499862194, -0.007728623226284981, 0.0075885276310145855, 0.006707090884447098, -0.03469708189368248, -0.018387585878372192, 0.006088334135711193, -0.03892330825328827, -0.034907225519418716, -0.02622128091752529, -0.03651832789182663, -0.01135944202542305, -0.006777138914912939, -0.023220892995595932, -0.03233880177140236, -0.014453225769102573, 0.009409774094820023, -0.035654403269290924, 0.003102540271356702, 0.0431261844933033, -0.047539204359054565, -0.05930726230144501, -0.024796972051262856, -0.0263613760471344, -0.027668938040733337, -0.031358130276203156, -0.007944604381918907, -0.012375136837363243, -0.014394852332770824, -0.04431699961423874, -0.0003422134032007307, 0.010086904279887676, 0.004952973686158657, 0.009164606221020222, 0.02030222862958908, 0.03829287737607956, 0.03215200826525688, 0.032548945397138596, -0.008411590941250324, -0.03287583589553833, -0.0025582092348486185, 0.07691264152526855, -0.01220001745969057, 0.036845218390226364, 0.029653631150722504, 0.00838240422308445, -0.003210530849173665, 0.041631828993558884, -0.0032397175673395395, 0.024119842797517776, -0.04121154174208641, -0.0029055303893983364, -0.01860940456390381, -0.027995828539133072, -0.007045655976980925, 0.027085205540060997, -0.03626148775219917, 0.0321987047791481, -0.0048712510615587234, -0.0208976361900568, 0.012048246338963509, -0.03107793815433979, 0.003928522113710642, -0.009654941968619823, 0.03871316462755203, 0.016437917947769165, 0.036284834146499634, -0.009363075718283653, -0.019029691815376282, 0.024983767420053482, 0.03901670500636101, -0.001330910949036479, -0.04062780737876892, -0.003651249222457409, 0.05267605558037758, -0.01665973663330078, -0.040324266999959946, -0.014745092950761318, -0.01796729862689972, 0.043966758996248245, -0.021306250244379044, 0.04557786136865616, 0.03245554864406586, 0.023045774549245834, -0.04772600159049034, -0.01853935606777668, 0.009905947372317314, 0.04492408409714699, -0.02086261287331581, 0.00292596104554832, 0.01858605444431305, 0.004684456158429384, -0.033856507390737534, 0.036775171756744385, 0.03401995077729225, 0.03110128827393055, -0.014826815575361252, -0.009736664593219757, -0.02517056092619896, -0.023220892995595932, 0.0203489288687706, -0.0021568930242210627, -0.012807099148631096, -0.036121390759944916, -0.016297822818160057, 0.030307410284876823, 0.027995828539133072, -0.003913928754627705, 0.03567775338888168, -0.010221162810921669, -0.013951215893030167, 0.020138785243034363, -0.03602799400687218, -1.6805122868390754e-05, -0.03647163137793541, -0.004544360563158989, -0.015644041821360588, 0.009187955409288406, -0.04366321861743927, -0.05935395881533623, 0.007115704007446766, 0.03240884840488434, 0.02860291115939617, -0.01461667101830244, -0.029583582654595375, -0.03574780002236366, 0.06495779752731323, 0.019975339993834496, 0.020477348938584328, -0.0003639209608081728, -0.004208714235574007, 0.006882210727781057, -0.025987787172198296, 0.01198987290263176, 0.01608767732977867, 0.01374107226729393, 0.0010835541179403663, 0.03642493113875389, 0.003911010455340147, 0.019987013190984726, -0.04765595123171806, 0.04380331560969353, 0.014313130639493465, -0.02447008155286312, -0.009473985061049461, 0.037358902394771576, -0.002553831320255995, 0.03777919337153435, -0.020605770871043205, 0.02449343167245388, 0.047562554478645325, -0.02998051978647709, -0.00612919544801116, 0.03630818426609039, -0.019263185560703278, -0.02397974580526352, 0.07546498626470566, -0.022823955863714218, -0.01080489531159401, 0.02878970466554165, -0.03250224515795708, 0.051134999841451645, -0.02743544615805149, 0.033132679760456085, -0.005098906811326742, -0.015725763514637947, -0.02385132573544979, 0.016507966443896294, 0.018329212442040443, -0.04086130112409592, -0.015877533704042435, 0.028953149914741516, -0.008750155568122864, -0.038432974368333817, 0.04779604822397232, -0.025497451424598694, -0.03847967088222504, -0.011376953683793545, 0.0032747413497418165, 0.043289631605148315, -0.013542602770030499, -0.019520027562975883, 0.0036629238165915012, 0.05454400181770325, 0.06402382254600525, -0.04917365685105324, 0.007880393415689468, -0.047002170234918594, -0.003791345050558448, 0.013951215893030167, 0.05398361757397652, 0.03633153438568115, 0.008119724690914154, -0.0016665573930367827, 0.027832383289933205, 0.03404330089688301, 0.023559458553791046, 0.02261381223797798, 0.020489023998379707, -0.006450248416513205, -0.01973017118871212, -0.031918514519929886, 0.019870266318321228, -0.03411335125565529, 0.017126722261309624, -0.05426380783319473, -0.009987669996917248, 0.004579384345561266, 0.0004016811726614833, -0.03997402638196945, 0.006438573822379112, -0.024306636303663254, 0.005417041014879942, -0.007033981382846832, 0.0336463637650013, 0.053516630083322525, 0.03467373177409172, -0.006782975979149342, -0.01110843662172556, -0.014441551640629768, -0.028229322284460068, -0.03511736914515495, 0.0003750483738258481, 0.04170187562704086, 0.06262286007404327, 0.039857279509305954, 0.021317925304174423, 0.00215543364174664, -0.021703189238905907, 0.004760341718792915, 0.027995828539133072, -0.009129581972956657, -0.014733417890965939, -0.021995054557919502, 0.019286533817648888, 0.0741107240319252, -0.07140220701694489, -0.02503046579658985, 0.005802304949611425, -0.025380706414580345, 0.02385132573544979, 0.01224671583622694, 0.019391605630517006, 0.029116595163941383, 0.022263571619987488, 0.014651695266366005, 0.0008865442941896617, -0.015165380202233791, 0.03964713588356972, 0.009363075718283653, -0.0004436369927134365, 0.04065115749835968, 0.00025501829804852605, 0.018877921625971794, 0.03392655402421951, 0.060147836804389954, -0.0019219404784962535, 0.015142031013965607, -0.04123489186167717, -0.019286533817648888, -0.04132828861474991, -0.014219732955098152, -0.027272000908851624, 0.039156801998615265, 0.09227649122476578, -0.03289918601512909, -0.10292378067970276, 5.3442340686160605e-06, 0.014441551640629768, -0.017371891066432, 0.04361652210354805, 0.052395861595869064, -0.03593459725379944, 0.008738481439650059, 0.0005643967306241393, 0.03222205489873886, 0.021201178431510925, 0.0056155105121433735, 0.012608630582690239, -0.024656876921653748, -0.024843670427799225, -0.00031831683008931577, -0.00629847776144743, -0.012912170961499214, 6.795015360694379e-05, 0.03882991150021553, -0.04894016310572624, 0.039693836122751236, 0.054077014327049255, -0.024049794301390648, 0.010559727437794209, -0.0527227520942688, -0.015854185447096825, 0.03703201562166214, -0.03955373913049698, -0.028276020660996437, -0.02937343902885914, -0.03770914301276207, -0.014698393642902374, -0.07364373654127121, -0.02811257541179657, 0.0726630687713623, 0.02979372628033161, 0.04529767110943794, 0.03292253613471985, 0.04009077325463295, -0.007372546475380659, -0.031941864639520645, 0.021995054557919502, -0.013309109956026077, 0.02995717152953148, -0.01797897182404995, 0.015422222204506397, -0.015457246452569962, 0.04737576097249985, 0.018702801316976547, -0.030867794528603554, 0.0028894776478409767, 0.0020051223691552877, -0.00922297965735197, -0.010372933000326157, -0.00045786547707393765, 0.03105458989739418, 0.0030879469122737646, -0.021294575184583664, 0.024049794301390648, -0.005446227733045816, 0.0381527803838253, 0.02440003491938114, -0.03453363850712776, 0.008820204064249992, -0.012923846021294594, -0.03411335125565529, -0.026127884164452553, 0.02937343902885914, 0.046348389238119125, 0.002202132251113653, 0.009176281280815601, -0.01100920233875513, 0.06234266981482506, 0.010991689749062061, -0.0004031405260320753, -0.009800874628126621, -0.04132828861474991, -0.012491883710026741, -0.030097266659140587, 0.014581647701561451, -0.008312356658279896, 0.0417952723801136, -0.006946421228349209, -0.021633140742778778, 0.012970544397830963, 0.021247876808047295, 0.004097804892808199, 0.046955473721027374, -0.057719506323337555, -0.0003006224287673831, 0.016928253695368767, 0.01493188738822937, -0.013169013895094395, 0.008434940129518509, -0.01551561988890171, 0.021714862436056137, 0.0013316406402736902, -0.014406527392566204, 0.0044217766262590885, -0.009094558656215668, -0.014359829016029835, -0.02519391104578972, -0.0035228279884904623, 0.012760400772094727, 0.027248650789260864, -0.053423233330249786, -0.002791702514514327, -0.0006118250312283635, 0.003341870615258813, 0.026548171415925026, -0.006251778919249773, 0.0346270352602005, -0.010886617936193943, 0.013297434896230698, 0.006788813509047031, 0.03953038901090622, -0.04595145210623741, -0.01675313338637352, -0.009795038029551506, 0.02087428793311119, -0.012748725712299347, -0.0013965809484943748, -0.018702801316976547, 0.02397974580526352, 0.04107144474983215, -0.016005955636501312, 0.014511599205434322, -0.019321558997035027, 0.03488387539982796, 0.010676474310457706, 0.027201952412724495, -0.023197544738650322, 0.030050568282604218, 0.002162730321288109, -0.018095718696713448, -0.008592547848820686, 0.009795038029551506, -0.025287307798862457, -0.0046290019527077675, -0.009689966216683388, 0.01674145832657814, -0.017628733068704605, -0.007279148790985346, 0.018212465569376945, 0.035584356635808945, -0.024913718923926353, -0.02029055543243885, 0.03544425964355469, 0.023454386740922928, 0.003899335628375411, 0.0013768799835816026, -0.008306519128382206, 0.016286147758364677, -0.03544425964355469, 0.027668938040733337, 0.001311939675360918, -0.060194533318281174, 0.03058760240674019, -0.026174582540988922, -0.040417663753032684, 0.00982422474771738, 0.01800232194364071, 0.010332072153687477, -0.00585192209109664, -0.03950704261660576, 0.012106619775295258, -0.004468475002795458, -0.0027187359519302845, -0.008942787535488605, -0.013962890021502972, 0.01731351763010025, -0.012375136837363243, -0.029723677784204483, 0.011616284027695656, 0.01290049683302641, 0.004888762719929218, -0.04006742313504219, 0.013087291270494461, 0.053936917334795, -0.004258331377059221, -0.013379157520830631, 0.034440238028764725, 0.021096106618642807, -0.014289780519902706, 0.043966758996248245, 0.011750542558729649, -0.03633153438568115, -0.02444673329591751, 0.012176668271422386, -0.03117133490741253, -0.023477736860513687, -0.018866246566176414, -0.018119068816304207, 0.02573094516992569, -0.02102605812251568, 0.033272773027420044, 0.06649885326623917, -0.02281228080391884, 0.002111653797328472, 0.030891144648194313, 0.004226225893944502, 0.0405811108648777, 0.006566994823515415, -0.02274223230779171, -0.03686856850981712, -0.003639574395492673, 0.009147094562649727, 0.04950054734945297, -0.053610026836395264, 0.014476574957370758, 0.025567499920725822, 0.016893230378627777, -0.03205861151218414, -0.009456472471356392, -0.02566089667379856, -0.023512760177254677, -0.017605382949113846, -0.0050551267340779305, 0.02145802043378353, 0.021154480054974556, -0.023594483733177185, -0.007956279441714287, -0.012340113520622253, 0.010046042501926422, -0.021644815802574158, -0.00019226701988372952, 0.015317150391638279, -0.029583582654595375, -0.038596417754888535, -0.037428952753543854, 0.006928909104317427, -0.01669475995004177, 0.012958870269358158, -0.0008310896810144186, -0.002782946452498436, 0.0016183994011953473, -0.02339601330459118, 0.0018402178538963199, 0.009830061346292496, 0.00015423317381646484, -0.005066801328212023, 0.0017176340334117413, -0.02580099366605282, 0.01607600413262844, 0.01856270618736744, 0.03535086289048195, 0.046395089477300644, 0.01372939720749855, -0.028836404904723167, 0.005539624951779842, 0.023792952299118042, 0.01319236308336258, -0.002730410546064377, 0.0017117966199293733, -0.0037679956294596195, -0.0274587944149971, -0.015258777886629105, 0.006998957134783268, -0.004427613690495491, -0.016379544511437416, -0.03581785038113594, 0.07481120526790619, 0.06206247955560684, -0.023547783493995667, 0.006923072040081024, -0.005364505108445883, 0.01794394850730896, 0.032478898763656616, -0.004523929674178362, -0.015854185447096825, -0.013425855897367, 0.039133451879024506, 0.012433510273694992, 0.0009332429617643356, -0.0024896208196878433, 0.002637013327330351, -0.019846918061375618, -0.033716410398483276, -0.02440003491938114, -0.00803800206631422, 0.019870266318321228, 0.02329094149172306, -0.015317150391638279, -0.04609154909849167, -0.027902431786060333, 0.001631533377803862, 0.004135747440159321, -0.019018016755580902, -0.028369417414069176, 0.005367423873394728, -0.032595645636320114, 0.007962116040289402, -0.010186138562858105, -0.006561157759279013, -0.004232063423842192, 0.033716410398483276, -0.0020182563457638025, -0.010302885435521603, -0.008685945533216, 0.013752746395766735, 0.0030879469122737646, 0.0210143830627203, -0.0019846917130053043, -0.0512750968337059, 0.008709294721484184, 0.039483692497015, -0.0017117966199293733, 0.02208845131099224, -0.0029551477637141943, -0.0490802600979805, 0.018702801316976547, -0.030190665274858475, -0.045834705233573914, -0.028859753161668777, -0.01730184257030487, 0.018854571506381035, -0.00837656669318676, -0.02331429161131382, -0.002209428930655122, -0.030751047655940056, -0.015749113634228706, -0.031381480395793915, -0.007220775820314884, -0.02624463103711605, 0.0019613425247371197, 0.04968734085559845, -0.016414567828178406, 0.01492021232843399, -0.04340637847781181, 0.006496946793049574, -0.00160380604211241, 0.0038117757067084312, 0.030610952526330948, 0.025357356294989586, 0.021376298740506172, -0.025520801544189453, -0.04945385083556175, 0.023069122806191444, -0.0032280427403748035, -0.0007172617479227483, -0.004649432376027107, 0.004468475002795458, -0.0012477290583774447, 0.0016432080883532763, 0.030727699398994446, 0.015025284141302109, -0.018259163945913315, -0.0012003007577732205, -0.025380706414580345, 0.017710454761981964, -0.002209428930655122, 0.012176668271422386, 0.01909974031150341, -0.04441039636731148, 0.021061081439256668, -0.015060308389365673, 0.01912308856844902, -0.02038395218551159, -0.009112070314586163, 0.02214682474732399, -0.031007889658212662, -0.004877088125795126, 0.02503046579658985, -0.016461268067359924, 0.006782975979149342, -0.00642106169834733, -0.025287307798862457, -0.017208445817232132, -0.06836679577827454, -0.029093246906995773, 0.022870654240250587, 0.011435327120125294, 0.005478333216160536, -0.0019905290100723505, -0.00038343953201547265, -0.07116871327161789, 0.0007727164193056524, 0.006882210727781057, -0.020477348938584328, 0.00478952843695879, 0.0010820948518812656, -0.004121154081076384, 0.02400309592485428, -0.010635613463819027, 0.021259551867842674, 0.018912944942712784, -0.007144890259951353, -0.019461654126644135, -0.027785684913396835, 0.014196383766829967, 0.004270005971193314, 0.008563361130654812, -0.026524821296334267, 0.06346344202756882, -0.018971318379044533, -0.04880006983876228, -7.228254617075436e-06, -0.07518479228019714, 0.008592547848820686, -0.006485272198915482, -0.01606432907283306, -0.023769602179527283, 0.027832383289933205, 0.001330910949036479, -0.019263185560703278, -0.035094019025564194, -0.016578013077378273, -0.005539624951779842, -0.0140329385176301, -0.03236215189099312, 0.04265919700264931, 0.01977686956524849, 0.04286934435367584, 0.0014877892099320889, -0.021376298740506172, 0.014138010330498219, -0.015468921512365341, 0.029466835781931877, 0.017021650448441505, 0.028252670541405678, 0.005513356998562813, -0.017220119014382362, 0.013052267022430897, 0.006012448575347662, 0.01622777432203293, 0.005023021250963211, 0.00922881718724966, -0.00866843294352293, -0.02393304742872715, 0.03476712852716446, 0.025217261165380478, -0.04377996549010277, 0.014523274265229702, 0.0010842838091775775, 0.015795812010765076, 0.00718575157225132, 0.00927551556378603, -0.006479435134679079, -0.02458682842552662, 0.002717276569455862, 0.0038584743160754442, -0.03040080890059471, 0.010075229220092297, 0.012141644023358822, -0.015597342513501644, -0.028953149914741516, 0.0053528305143117905, -0.01551561988890171, -0.019029691815376282, 0.03775584325194359, -0.0023524435237050056, 0.017570359632372856, 0.011458676308393478, -0.0010820948518812656, -0.002931798342615366, 0.048192985355854034, -0.02085093781352043, 0.0515085905790329, 0.00701063172891736, -0.05024772509932518, 0.008347379975020885, -0.009608243592083454, -0.008761830627918243, -0.024143191054463387, 0.009059534408152103, 0.01739523932337761, -0.008954462595283985, 0.0028646690770983696, -0.023512760177254677, -0.03665842488408089, -0.0030178988818079233, -0.015083657577633858, 0.03170837089419365, -0.0024677307810634375, -0.007676087319850922, 0.039063405245542526, 0.01607600413262844, -0.02266051061451435, 0.014499925076961517, -0.04599815234541893, 0.03161497414112091, -0.02626797929406166, -0.014861838892102242, 0.022403668612241745, 0.03964713588356972, -0.0020620364230126143, 0.025287307798862457, -0.0454377681016922, 0.01468671951442957, -0.01253858208656311, 0.017103374004364014, 0.06080161780118942, -0.055197782814502716, -0.037919286638498306, -0.004205795470625162, -0.02631467767059803, 0.03222205489873886, 0.012059921398758888, -0.006444410886615515, 0.009071208536624908, 0.02217017486691475, -0.014278106391429901, -0.03287583589553833, -0.03721880912780762, 0.027809035032987595, 0.0029609850607812405, 0.04954724758863449, -0.02815927378833294, -0.00803216453641653, -0.02573094516992569, -0.001160169136710465, 0.014149685390293598, -0.049967534840106964, -0.025941088795661926, -0.02262548729777336, -0.008884414099156857, -0.013110640458762646, 0.02261381223797798, -0.010110253468155861, -0.06080161780118942, -0.010653125122189522, 0.02274223230779171, -0.013682698830962181, -0.009030347689986229, 0.0216214656829834, -0.009975994937121868, -0.004296273924410343, 0.03698531538248062, 0.030027220025658607, -0.025964438915252686, 0.012328438460826874, -0.02032557874917984, -0.015188729390501976, -0.016531314700841904, 0.005781874060630798, 0.013344133272767067, 0.045671261847019196, 0.028229322284460068, 0.003312684129923582, -0.0001421024790033698, -0.014429876580834389, -0.0008588170167058706, -0.0024618934839963913, -0.015025284141302109, -0.008645083755254745, -0.04102474823594093, 0.028976500034332275, 0.0002579369756858796, -0.027225300669670105, 0.03532751277089119, 0.04237900674343109, 0.023431038483977318, -0.015725763514637947, -0.005028858780860901, 0.06224927306175232, 0.005428715609014034, 0.06108180806040764, -0.0014038776280358434, -0.004795365501195192, 0.0008289006655104458, 0.011382791213691235, -0.005843166261911392, 0.013215712271630764, 2.548130851209862e-06, -0.006561157759279013, 0.04375661537051201, 0.01492021232843399, -0.004579384345561266, 0.016507966443896294, -0.03768579289317131, 0.02750549279153347, 0.03663507476449013, -0.02741209603846073, -0.026197930797934532, -0.014873513951897621, 0.0026355539448559284, 0.020010363310575485, -0.008861064910888672, -0.010553890839219093, 0.012223366647958755, 0.042729247361421585, 0.007868719287216663, -0.020068736746907234, -0.04137498512864113, 0.00629264023154974, -0.03521076589822769, 0.0008624653564766049, -0.0028062958735972643, 0.005300294607877731, 0.01131274364888668, 0.017757155001163483, -0.019403280690312386, -0.006847186479717493, -0.02631467767059803, -0.012912170961499214, -0.013659349642693996, -0.007798671256750822, 5.7689227105583996e-05, 0.016869880259037018, -0.001256485003978014, 0.011213508434593678, 0.0010375851998105645, 0.002245912328362465, 0.023792952299118042, 0.011610446497797966, -0.001973017118871212, -0.0028121331706643105, -0.023115821182727814, -0.020068736746907234, 0.0405811108648777, -0.011079249903559685, 0.010688149370253086, -0.023699555546045303, 0.02442338317632675, 0.0002971565118059516, 0.012608630582690239, 0.03406665101647377, -0.036284834146499634, -0.017103374004364014, 0.03168502077460289, 0.028509514406323433, 0.0069931200705468655, 0.0500609315931797, 0.00731417303904891, -0.036284834146499634, -0.00478952843695879, 0.0023130415938794613, 0.025427404791116714, -0.01497858576476574, 0.005227327812463045, -0.025217261165380478, 0.025334006175398827, 0.024656876921653748, -0.021084431558847427, 0.015667390078306198, 0.01100920233875513, 0.036051344126462936, -0.03112463653087616, 0.005023021250963211, -0.02463352680206299, -0.010133602656424046, -0.003934359643608332, 0.02388634905219078, 0.030891144648194313, 0.01788557507097721, -0.004293355159461498, -0.018119068816304207, 0.03943699225783348, 0.017021650448441505, -0.018947970122098923, -0.016449593007564545, -0.021364623680710793, -0.001628614729270339, -0.005154361482709646, 0.00149873411282897, -0.02220519818365574, 0.012305089272558689, -0.03418339788913727, -0.00314632011577487, 0.028276020660996437, -0.0046640257351100445, -0.012772075831890106, -0.03990397974848747, -0.004392589908093214, -0.009053696878254414, 0.03768579289317131, 0.014768442139029503, -0.02325591817498207, 0.015994280576705933, 0.02440003491938114, -0.009182117879390717, 0.04244905337691307, 0.021072756499052048, -0.015410548076033592, -0.002372874179854989, -0.0035140719264745712, 0.018971318379044533, -0.027318699285387993, -0.01911141537129879, 0.030774397775530815, 0.01225839089602232, 0.004474312532693148, -0.023022424429655075, 0.012129968963563442, 0.007769484538584948, -0.0707017257809639, -0.01255025714635849, 0.01288882177323103, -0.003309765364974737, 0.028346069157123566, 0.011633796617388725, -0.03833957388997078, -0.007571015506982803, -0.03397325426340103, 0.025520801544189453, -0.012445185333490372, 0.010256187058985233, -0.007576852571219206, -0.024189891293644905, -0.01739523932337761, -0.008434940129518509, -0.012713702395558357, 0.022508740425109863, 0.0010529081337153912, -0.04109479486942291, 0.02577764354646206, -0.0026574439834803343, -0.010302885435521603, 0.010495517402887344, -0.04837978258728981, 0.0010456115705892444, -0.023127496242523193, -0.00305876019410789, -0.010974178090691566, -0.019029691815376282, -0.004780772142112255, -0.014254757203161716, -0.003353545442223549, 0.003905172925442457, 0.01163963321596384, -0.010326234623789787, -0.014313130639493465, 0.011447002179920673, 0.026711616665124893, 0.0336463637650013, 0.06869368255138397, 0.004462637938559055, 0.0009456472471356392, 0.026594869792461395, -0.005306131672114134, -0.015994280576705933, 0.012912170961499214, 0.01071149855852127, 0.009363075718283653, -0.02088596299290657, -0.020582420751452446, 0.017792178317904472, -0.00611752038821578, 0.013075616210699081, 0.021948356181383133, 0.01908806525170803, 0.010600589215755463, 0.0178622268140316, 0.02507716417312622, -0.0019277777755632997, 0.02393304742872715, 0.06916067004203796, 0.0026253387331962585, -0.014266431331634521, 0.007220775820314884, 0.02862626127898693, 0.013098965398967266, -0.048146288841962814, 0.03212865814566612, 0.04083795100450516, 0.012118294835090637, -0.021189503371715546, -0.006240104325115681, 0.008522500284016132, -0.06785310804843903, 0.013472555205225945, 0.007098191883414984, -0.007331685163080692, -0.004115317016839981, 0.022473715245723724, 0.009987669996917248, 0.01669475995004177, 0.011172647587954998, -0.026805013418197632, -0.00015815513324923813, 0.018095718696713448, 0.019963664934039116, -0.012912170961499214, 0.015118681825697422, -0.011271881870925426, -0.0025859365705400705, 0.003508234629407525, 0.022006729617714882, -0.030821096152067184, -0.0101744644343853, -0.04707222059369087, -0.00701646925881505, 0.06271626055240631, -0.000331998075125739, 0.031358130276203156, -0.012270065024495125, -0.017745479941368103, 0.025357356294989586, 0.03238549828529358, 0.004955891985446215, -0.03539756312966347, 0.008166423067450523, 0.007419244851917028, -0.02874300628900528, 0.06719932705163956, -0.03570110350847244, -0.02449343167245388, 0.007518479600548744, -0.03154492378234863, 0.010822407901287079, 0.019987013190984726, -0.006397712510079145, -0.02984042465686798, 0.01738356426358223, 0.04662858322262764, 0.02095600962638855, -0.021668164059519768, -0.0018416772363707423, -0.02025553025305271, -0.02088596299290657, -0.014721742831170559, 0.029606930911540985, 0.02979372628033161, -0.010588914155960083, 0.029046548530459404, 0.03040080890059471, 0.007413407787680626, 0.025380706414580345, 0.004798284266144037, -0.0008106590248644352, 0.03098454140126705, 0.01675313338637352, -0.0033156026620417833, -0.035537656396627426, 0.008189772255718708, 0.0012258390197530389, 0.005787711590528488, -0.004535604268312454, -0.003610387910157442, -0.008580873720347881, 0.03689191862940788, -0.015410548076033592, 0.017652081325650215, 0.00897781178355217, 0.015924232080578804, -0.0007537450874224305, 0.0027347884606570005, -0.012083270587027073, -0.0007712570950388908, -0.004007326439023018, -0.04123489186167717, 0.0038351251278072596, 0.03766244649887085, -0.016414567828178406, -0.022999076172709465, -0.00891943834722042, -0.012328438460826874, -0.000723463948816061, 0.015188729390501976, -0.0066020190715789795, 0.0005552758811973035, 0.019881941378116608, -0.03401995077729225, -0.004080292768776417, -0.010536378249526024, 0.016321171075105667, -0.009427285753190517, 0.027832383289933205, -0.014721742831170559, 0.005250677466392517, 0.01858605444431305, -0.005481251515448093, -0.027201952412724495, 0.009666616097092628, -0.01794394850730896, -0.009637429378926754, 0.05692563205957413, 0.0055921608582139015, -0.022006729617714882, -0.02340768836438656, -0.02869630791246891, 0.005936563480645418, 0.013694372959434986, 0.018259163945913315, 0.009147094562649727, -0.013087291270494461, -0.0034177559427917004, 0.01200154796242714, 0.01105006318539381, 0.00040131635614670813, -0.017488637939095497, 0.008516662754118443, -0.009993506595492363, -0.02039562724530697, -0.0019613425247371197, 0.00041700416477397084, -0.0037621583323925734, 0.013892842456698418, -0.012912170961499214, 0.0003686638083308935, 0.01616940088570118, 0.019321558997035027, 0.024867020547389984, 0.008586710318922997, 0.01225839089602232, 0.022929027676582336, -0.012807099148631096, 0.015235427767038345, -0.0037679956294596195, 0.03749899938702583, -0.006409387104213238, -0.0017190932994708419, -0.002874884521588683, -0.00927551556378603, -0.016589688137173653, -0.010898292995989323, -0.014943561516702175, -0.002158352406695485, 0.015118681825697422, -0.0006800487753935158, -0.017476962879300117, -0.013239061459898949, -0.011569585651159286, -0.013752746395766735, -0.014173034578561783, -0.01194317452609539, -0.0417952723801136, 0.004007326439023018, 0.0022138068452477455, -0.003303928067907691, 0.03752234950661659, -0.025497451424598694, -0.031521573662757874, 0.03119468502700329, 0.038503021001815796, 0.002432706765830517, 0.003552014473825693, -0.011411977931857109, 0.0004388941451907158, 0.011073412373661995, 0.020057061687111855, -0.0002161635784432292, 0.03273573890328407, -0.0024808647576719522, -0.012877147644758224, -0.000418828334659338, 0.031241383403539658, -0.013227387331426144, -0.015036959201097488, 0.039133451879024506, -0.0031258894596248865, 0.027131903916597366, 0.010297047905623913, 0.009082883596420288, -0.010308722965419292, 0.010559727437794209, 0.021142804995179176, -0.009182117879390717, -0.026174582540988922, 0.007512642070651054, -0.031334780156612396, -0.0011660064337775111, 0.030657650902867317, -0.026431424543261528, -0.026805013418197632, 0.047515857964754105, 0.010705661028623581, 0.03392655402421951, -0.020068736746907234, -0.0014432795578613877, -0.03056425414979458, -0.03598129376769066, -0.021808261051774025, 0.0406978577375412, -0.005849003326147795, -0.004739910829812288, 0.05809309706091881, -0.034743782132864, 0.00982422474771738, -0.008615897037088871, -0.011482025496661663, 0.03040080890059471, -0.01106757577508688, -0.02451678179204464, -0.017185095697641373, 0.03885326161980629, 0.02340768836438656, -0.030914492905139923, -0.027692288160324097, 0.009987669996917248, -0.014885188080370426, 0.00611752038821578, -0.05314304307103157, -0.02454013004899025, 0.02869630791246891, -0.013986240141093731, -0.011166810058057308, -0.012935520149767399, 0.02580099366605282, -0.007646900601685047, -0.007378383539617062, -0.018924620002508163, -0.03107793815433979, -0.026408076286315918, -0.008475800976157188, 0.02512386254966259, 0.019263185560703278, -0.021084431558847427, 0.007938766852021217, -0.006432736292481422, 0.013892842456698418, -0.01016278937458992, -0.040347617119550705, 0.0009850491769611835, -0.02878970466554165, -0.03654167801141739, 0.03324942663311958, 0.008948625065386295, -0.027855733409523964, -0.010606426745653152, 0.011756380088627338, 0.004544360563158989, -0.007892068475484848, 0.023104147985577583, -0.02219352312386036, 0.02281228080391884, -0.017628733068704605, 0.021259551867842674, -0.03847967088222504, -0.0031784255988895893, -0.012491883710026741, 0.018947970122098923, -0.026057835668325424, -0.04356982186436653, -0.020138785243034363, -0.01983524300158024, 0.006818000227212906, 0.01981189474463463, -0.0007143430993892252, -0.003409000113606453, 0.008767668157815933, -0.022999076172709465, 0.012421835213899612, -0.03530416265130043, 0.032081957906484604, 0.01799064688384533, -0.025917740538716316, 0.019286533817648888, -0.036681775003671646, 0.017138397321105003, 0.03416004776954651, -0.003070435021072626, -8.491489279549569e-05, -0.022345295175909996, 0.011242695152759552, 0.007500967476516962, 0.02082758955657482, 0.016437917947769165, -0.012853797525167465, 0.0038555555511265993, 0.01665973663330078, -0.03544425964355469, 0.012667003087699413, 0.026758315041661263, -0.017465287819504738, -0.00141920056194067, 0.01140614040195942, 0.03481382876634598, -0.003108377568423748, 0.013169013895094395, 0.01608767732977867, 0.005630103405565023, -0.003251392161473632, 0.031334780156612396, 0.011476187966763973, -0.015994280576705933, -0.010699823498725891, 0.012725376524031162, 0.017582034692168236, -0.005694314371794462, 0.028859753161668777, -0.01438317820429802, -0.02991047315299511, -0.03630818426609039, -0.02815927378833294, -0.0131806880235672, 0.038666464388370514, 0.03640158101916313, 0.03546760976314545, 0.015060308389365673, 0.014604996889829636, -0.007617713883519173, 0.04083795100450516, -0.011003364808857441, 0.04714226722717285, -0.025847692042589188, -0.014266431331634521, 0.00581981660798192, -0.009053696878254414, -0.03362301364541054, 0.030377458781003952, 0.01914643868803978, 0.026454774662852287, 0.024750273674726486, -0.005767280701547861, -0.022356968373060226, -0.012760400772094727, 0.01859772950410843, -0.02033725380897522, -0.023699555546045303, -0.032081957906484604, -0.0025115106254816055, -0.00961991772055626, -0.0178622268140316, -0.05454400181770325, 0.010267861187458038, -0.02380462735891342, 0.02036060206592083, -0.01071149855852127, 0.0069347466342151165, -0.003966465126723051, -0.018375910818576813, -0.03324942663311958, -0.027715636417269707]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-15T11:17:06.265773", "url_path": "/api/agent/", "chunk_size": 4565}
updated_dt: 2025-03-15T11:17:06.267281
---
```
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
```
| ```
async defrun(
  self,
  user_prompt: str | Sequence[_messages.UserContent],
  *,
  result_type: type[RunResultDataT] | None = None,
  message_history: list[_messages.ModelMessage] | None = None,
  model: models.Model | models.KnownModelName | None = None,
  deps: AgentDepsT = None,
  model_settings: ModelSettings | None = None,
  usage_limits: _usage.UsageLimits | None = None,
  usage: _usage.Usage | None = None,
  infer_name: bool = True,
) -> AgentRunResult[Any]:
"""Run the agent with a user prompt in async mode.
  This method builds an internal agent graph (using system prompts, tools and result schemas) and then
  runs the graph to completion. The result of the run is returned.
  Example:
  ```python
  from pydantic_ai import Agent
  agent = Agent('openai:gpt-4o')
  async def main():
    agent_run = await agent.run('What is the capital of France?')
    print(agent_run.data)
    #> Paris
  ```
  Args:
    user_prompt: User input to start/continue the conversation.
    result_type: Custom result type to use for this run, `result_type` may only be used if the agent has no
      result validators since result validators would expect an argument that matches the agent's result type.
    message_history: History of the conversation so far.
    model: Optional model to use for this run, required if `model` was not set when creating the agent.
    deps: Optional dependencies to use for this run.
    model_settings: Optional settings to use for this model's request.
    usage_limits: Optional limits on model request count or token usage.
    usage: Optional usage to start with, useful for resuming a conversation or agents used in tools.
    infer_name: Whether to try to infer the agent name from the call frame if it's not set.
  Returns:
    The result of the run.
  """
  if infer_name and self.name is None:
    self._infer_name(inspect.currentframe())
  async with self.iter(
    user_prompt=user_prompt,
    result_type=result_type,
    message_history=message_history,
    model=model,
    deps=deps,
    model_settings=model_settings,
    usage_limits=usage_limits,
    usage=usage,
  ) as agent_run:
    async for _ in agent_run:
      pass
  assert (final_result := agent_run.result) is not None, 'The graph run did not finish properly'
  return final_result

```
  
---|---  
####  iter `async`
```
iter(
  user_prompt: str[](https://docs.python.org/3/library/stdtypes.html#str) | Sequence[](https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence "collections.abc.Sequence")[UserContent],
  *,
  result_type: type[](https://docs.python.org/3/library/functions.html#type)[RunResultDataT[](https://ai.pydantic.dev/api/agent/#pydantic_ai.agent.RunResultDataT "pydantic_ai.agent.RunResultDataT")] | None = None,
  message_history: list[](https://docs.python.org/3/library/stdtypes.html#list)[ModelMessage[](https://ai.pydantic.dev/api/messages/#pydantic_ai.messages.ModelMessage "pydantic_ai.messages.ModelMessage")] | None = None,
  model: Model[](https://ai.pydantic.dev/api/models/base/#pydantic_ai.models.Model "pydantic_ai.models.Model") | KnownModelName[](https://ai.pydantic.dev/api/models/base/#pydantic_ai.models.KnownModelName "pydantic_ai.models.KnownModelName") | None = None,
  deps: AgentDepsT[](https://ai.pydantic.dev/api/tools/#pydantic_ai.tools.AgentDepsT "pydantic_ai.tools.AgentDepsT") = None,
  model_settings: ModelSettings[](https://ai.pydantic.dev/api/settings/#pydantic_ai.settings.ModelSettings "pydantic_ai.settings.ModelSettings") | None = None,
  usage_limits: UsageLimits[](https://ai.pydantic.dev/api/usage/#pydantic_ai.usage.UsageLimits "pydantic_ai.usage.UsageLimits") | None = None,
  usage: Usage[](https://ai.pydantic.dev/api/usage/#pydantic_ai.usage.Usage "pydantic_ai.usage.Usage") | None = None,
  infer_name: bool[](https://docs.python.org/3/library/functions.html#bool) = True
) -> AsyncIterator[](https://docs.python.org/3/library/collections.abc.html#collections.abc.AsyncIterator "collections.abc.AsyncIterator")[AgentRun[](https://ai.pydantic.dev/api/agent/#pydantic_ai.agent.AgentRun "pydantic_ai.agent.AgentRun")[AgentDepsT[](https://ai.pydantic.dev/api/tools/#pydantic_ai.tools.AgentDepsT "pydantic_ai.tools.AgentDepsT"), Any[](https://docs.python.org/3/library/typing.html#typing.Any "typing.Any")]]