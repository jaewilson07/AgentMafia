---
url: https://ai.pydantic.dev/api/agent/
session_id: pydantic_ai_docs
chunk_number: 6
title: Agent Configuration and Instrumentation
summary: This documentation covers the configuration options for the Agent model, including overriding models for testing, defining end strategies for tool calls, and instrumentation settings. It explains how to use OpenTelemetry for automatic instrumentation and how to customize settings if not specified.
embedding: [0.011149152182042599, 0.05990864709019661, -0.004760474432259798, -0.02230985090136528, -0.017032625153660774, 0.04956205189228058, 0.021282119676470757, 0.03575119003653526, -0.013175745494663715, -0.018649280071258545, 0.00807173177599907, -0.015889417380094528, 0.021062716841697693, -0.026420775800943375, 0.0018014165107160807, -0.027691006660461426, -0.033280014991760254, 0.009826958179473877, 0.001709036179818213, 0.01871856488287449, 0.00110712053719908, 0.006888108793646097, -0.0060797808691859245, 0.0076675680465996265, -0.010872011072933674, -0.009405473247170448, -0.03438857942819595, 0.06097102165222168, -0.0008761697681620717, 0.0054995170794427395, -0.00043195023317821324, -0.0070844171568751335, -0.043880660086870193, -0.030370036140084267, 0.011033676564693451, -0.025866493582725525, 0.04397303983569145, 0.0027742970269173384, -0.018302854150533676, 0.019319036975502968, -0.0037327429745346308, -0.048222534358501434, 0.03221764415502548, 0.04665207117795944, -0.020531529560685158, 0.03741403669118881, 0.019769392907619476, 0.006287636701017618, 0.02019665017724037, -0.014191929250955582, -0.02674410678446293, 0.012529083527624607, 0.04041639715433121, 0.014526807703077793, -0.005456213839352131, -0.026882678270339966, 0.02614363469183445, 0.007159476168453693, -0.02291032299399376, -0.013406696729362011, 0.007165249902755022, -0.05977007746696472, 0.00974035169929266, 0.04027782753109932, -0.01964236982166767, 0.0018663714872673154, -0.024041982367634773, 0.04803777486085892, -0.022379135712981224, -0.004575713537633419, -0.0003300071111880243, 0.003536434844136238, -0.03903069347143173, -0.002084331354126334, -0.03524309769272804, -0.00620680395513773, 0.03196359798312187, 0.032402403652668, 0.016120368614792824, -0.01573929935693741, -0.02180175855755806, -0.014503712765872478, -0.004806664306670427, 0.03817617520689964, -0.0408782996237278, -0.017956428229808807, -0.03679046779870987, -0.0239265076816082, 0.0279681459069252, -0.08734560757875443, 0.003103401977568865, 0.00479511683806777, 0.004079169128090143, 0.047067780047655106, 0.07644473016262054, 0.041663531213998795, 0.020912598818540573, -0.010756535455584526, 0.013118008151650429, 0.05173298716545105, 0.06050911918282509, -0.025820303708314896, -0.0263053011149168, 0.03256407007575035, 0.007707984186708927, 0.017171194776892662, 0.009341961704194546, 0.04672135412693024, -0.02256389707326889, 0.004974103532731533, -0.03847641125321388, -0.0014463296392932534, -0.006252993829548359, -0.009203391149640083, -0.0781075730919838, -0.024457694962620735, -0.02094724215567112, -0.020912598818540573, 0.006166387349367142, -0.06549765914678574, -0.007557866163551807, 0.029792658984661102, -0.02347615361213684, -0.01847606711089611, 0.03140931576490402, -0.011062545701861382, -0.06457385420799255, -0.04854586720466614, -0.037783559411764145, -0.006328052841126919, 0.012471345253288746, 0.00490770535543561, -0.016628460958600044, -0.007315367925912142, -0.004136906936764717, -0.0037760462146252394, -0.024411503225564957, 0.019896414130926132, -0.05173298716545105, -0.0015300493687391281, -0.015115732327103615, -0.0015589181566610932, -0.037229277193546295, 0.008002446964383125, -0.050393473356962204, 0.025312211364507675, -0.07639853656291962, 0.02958480268716812, -0.03951568901538849, 0.020831765606999397, -0.011172247119247913, 0.018106546252965927, -0.023199012503027916, 0.010225348174571991, 0.05270298197865486, 0.03729856014251709, -0.008458574302494526, -0.0018995706923305988, 0.019977247342467308, -0.025774113833904266, -0.007205666042864323, 0.034296199679374695, -0.011322365142405033, -0.020820219069719315, -0.016466794535517693, -0.022887228056788445, -0.05168679729104042, -0.010196479968726635, -0.012136466801166534, -0.02018510363996029, 0.01680167391896248, -0.015970250591635704, 0.0059354365803301334, -0.020704742521047592, 0.024411503225564957, -0.056305814534425735, -0.043072331696748734, -0.018556900322437286, -0.01787559501826763, -0.024111267179250717, -0.03916926309466362, -0.0009685500990599394, -0.02346460521221161, -0.015277397818863392, -0.052425842732191086, 0.014607640914618969, -0.006102875806391239, -0.010641059838235378, 0.013764670118689537, 0.052010130137205124, 0.041871387511491776, 0.01614346355199814, 0.05880008265376091, -0.012725391425192356, -0.06101721152663231, -0.018291305750608444, 0.04579755291342735, -0.014041811227798462, 0.001613768981769681, 0.02346460521221161, 0.025104356929659843, 0.022298304364085197, 0.05057823285460472, -0.034642625600099564, 0.016536079347133636, -0.042933762073516846, -0.02155926078557968, 0.009313092567026615, -0.00747125968337059, -0.0007170301978476346, -0.004099377430975437, -0.02337222546339035, 0.01937677524983883, -0.006229898892343044, 0.010999034158885479, 0.014134191907942295, -0.044296372681856155, -0.032679542899131775, 0.0030052477959543467, 0.021362952888011932, -0.0131526505574584, 0.016432153061032295, -0.004460237920284271, -0.029515517875552177, 0.01630512997508049, 0.043695900589227676, -0.03304906561970711, -0.0018273985479027033, 0.017044171690940857, 0.04632873833179474, -0.0027685232926160097, -0.03069336712360382, 0.00913987960666418, 0.018556900322437286, 0.035404764115810394, -0.010490941815078259, 0.034758102148771286, -0.003429620061069727, -0.0007599726086482406, -0.07468950003385544, 0.011928610503673553, -0.008793453685939312, 0.015785489231348038, -0.022690920159220695, -0.006974715273827314, 0.02831457369029522, 0.004359197337180376, -0.04709087684750557, 0.0013683837605640292, 0.020069628953933716, 0.003969467710703611, -0.013464434072375298, -0.029007425531744957, -0.040554966777563095, -0.01170920766890049, 0.018233569338917732, -0.0015358231030404568, -0.005407136399298906, -0.07002429664134979, 0.009145652875304222, 0.03143240883946419, 0.01787559501826763, 0.013406696729362011, 0.020069628953933716, 0.006674479227513075, -0.006512813735753298, -0.00014109653420746326, -0.029954323545098305, 0.015970250591635704, -0.04316471144556999, 0.02427293360233307, -0.012956341728568077, 0.01579703763127327, -0.024896500632166862, -0.030508605763316154, -0.027090532705187798, 0.04748349264264107, 0.010566000826656818, -0.02265627682209015, -0.005975853186100721, -0.046513497829437256, 0.03776046261191368, 0.03953878581523895, 0.03013908490538597, -0.004754700232297182, -0.010190705768764019, -0.005268565844744444, 0.0005268566310405731, -0.01385705079883337, 0.035058338195085526, 0.01842987723648548, 0.0010342267341911793, 0.04279519245028496, -0.015877870842814445, 0.00598162692040205, -0.06097102165222168, -0.010161836631596088, -0.0038135757204145193, 0.0022214583586901426, -0.018106546252965927, 0.04448113217949867, 0.031178362667560577, 0.011397424153983593, -0.004408274311572313, 0.027621719986200333, 0.0289150457829237, -0.03043932095170021, -0.010906653478741646, 0.04503541439771652, -0.028176002204418182, -0.01943451352417469, 0.06549765914678574, -0.027067437767982483, 0.0015978910960257053, 0.024203648790717125, -0.06323433667421341, 0.04311852157115936, -0.003392090555280447, 0.04552040994167328, 0.015000256709754467, -0.06000102683901787, -0.02150152251124382, 0.002416323171928525, -0.01309491228312254, -0.0046738674864172935, 0.021039621904492378, 0.02039295993745327, 0.0014853025786578655, -0.03741403669118881, 0.027737196534872055, -0.018787851557135582, -0.028337668627500534, -0.030254559591412544, 0.025312211364507675, 0.06217196583747864, 0.02009272389113903, 0.009393925778567791, -0.021778663620352745, 0.03711380064487457, 0.04300304502248764, -0.040762823075056076, 0.002928745234385133, -0.06637527048587799, 0.019907962530851364, 0.00401277095079422, 0.04886919632554054, 0.0069920364767313, 0.019746296107769012, -0.018857136368751526, 0.0382685549557209, 0.015104184858500957, -0.010467846877872944, 0.0031842347234487534, 0.0371599905192852, 0.00999439787119627, -0.029284566640853882, -0.03457334265112877, 0.01266765408217907, -0.06789954751729965, 0.010438977740705013, -0.07284189760684967, -0.0007303820457309484, -0.03147859871387482, -0.015000256709754467, -0.024642454460263252, 0.01324503030627966, -0.011276175267994404, -0.0068996562622487545, -0.04588993266224861, 0.03332620486617088, 0.06628289073705673, 0.01615501195192337, -0.01534668356180191, 0.002396114869043231, -0.0026703691110014915, -0.020277483388781548, -0.034504055976867676, -0.008452801033854485, 0.03159407526254654, 0.034850481897592545, 0.05108632519841194, 0.008683751337230206, 0.03300287574529648, -0.0055341594852507114, 0.009902017191052437, 0.048083964735269547, -0.01721738465130329, 0.00787542387843132, -0.01776012033224106, 0.0016022215131670237, 0.04027782753109932, -0.07579806447029114, 0.0015444837044924498, 4.628038368537091e-05, -0.033395491540431976, 0.04006997123360634, -0.007061321754008532, 0.027945050969719887, 0.034250009804964066, -0.00030005566077306867, 0.03965425863862038, 0.004217739682644606, -0.018048807978630066, 0.03503524139523506, 0.007298046723008156, 0.016085725277662277, 0.021478427574038506, 0.014549902640283108, -0.007251856382936239, 0.019064992666244507, 0.07967804372310638, -0.01741369254887104, 0.03307215869426727, -0.020831765606999397, 0.0036172675900161266, -0.03487357869744301, -0.0024235404562205076, -0.01370693277567625, 0.03136312589049339, 0.07492045313119888, -0.02181330695748329, -0.07080952823162079, 0.04441184550523758, -0.001776878023520112, -0.020566172897815704, 0.05833818390965462, 0.011743850074708462, -0.03360334783792496, 0.04385756328701973, -0.006166387349367142, 0.009878922253847122, 0.0027872880455106497, 0.024919595569372177, -0.0005264957435429096, -0.02100497856736183, -0.024088172242045403, -0.005493743345141411, -0.013475981540977955, 0.020912598818540573, -0.025104356929659843, 0.02358008176088333, -0.02235604077577591, 0.026212921366095543, 0.06383480876684189, -0.03766808286309242, 0.0035970592871308327, -0.05972388759255409, -0.0056987120769917965, 0.0371599905192852, -0.014780853874981403, -0.00865488313138485, -0.017887143418192863, -0.01937677524983883, 0.013880145736038685, 0.0048788366839289665, -0.002846469171345234, 0.06637527048587799, 0.024342218413949013, 0.03584356978535652, 0.037275467067956924, 0.061756253242492676, -0.002797391964122653, -0.03332620486617088, 0.012032538652420044, 0.003172687254846096, 0.047622062265872955, -0.00807173177599907, 0.01776012033224106, -0.04138639196753502, 0.029538612812757492, 0.004702736623585224, -0.0289150457829237, -0.029769564047455788, -0.013545266352593899, -0.006628289353102446, -0.024457694962620735, -0.009751899167895317, 0.05270298197865486, -0.00010410830873297527, -0.03628237545490265, 0.025981970131397247, -0.019007254391908646, 0.008077505975961685, 0.056398194283246994, -0.021074263378977776, 0.03653642162680626, -0.024850310757756233, -0.005219488870352507, -0.030600985512137413, 0.02655934728682041, 0.049700621515512466, 0.014653830789029598, -0.0020597928669303656, -0.010156063362956047, 0.09478222578763962, -0.023556984961032867, 0.03491976857185364, 0.050855375826358795, -0.026212921366095543, 0.0014160173013806343, -0.00019306046306155622, 0.006974715273827314, -0.010317728854715824, 0.03903069347143173, -0.055705342441797256, 0.019064992666244507, 0.010935522615909576, 0.0015747960424050689, -0.010508263483643532, 0.05237964913249016, -0.06268005818128586, -0.008851191028952599, -0.0006419711862690747, 0.01494251936674118, -0.0221019946038723, 0.0017696608556434512, -0.015935607254505157, 0.027182914316654205, 0.00769643671810627, 0.006784181110560894, -0.01665155589580536, -0.025173641741275787, -0.03309525549411774, 0.005909454543143511, 0.023083535954356194, 0.005262792110443115, -0.0033459002152085304, -0.049238719046115875, 0.0019313264638185501, -0.03341858834028244, -0.009959755465388298, 0.00031863999902270734, -0.013822407461702824, 0.0024379747919738293, -0.016478342935442924, 0.021374499425292015, 0.004581487271934748, 0.040901392698287964, -0.049746811389923096, -0.016986433416604996, -0.01873011328279972, 0.011847778223454952, -0.04175591096282005, -0.00018160314357373863, -0.008660656400024891, -0.0035017922054976225, 0.04658278450369835, 0.014145739376544952, 0.012760033831000328, -0.01082582026720047, 0.036513328552246094, 0.0011287722736597061, 0.0169517919421196, -0.010721893049776554, 0.03618999570608139, 0.006853466387838125, -0.018741659820079803, 0.0024509658105671406, 0.018141187727451324, -0.021189739927649498, -0.011507125571370125, -0.004183097276836634, 0.01898415945470333, -0.009607555344700813, -0.005176185630261898, 0.016432153061032295, 0.03166336193680763, -0.03099360316991806, -0.014619188383221626, 0.024203648790717125, -0.02236758917570114, 0.02090105041861534, 0.004610355943441391, -0.01741369254887104, 0.037829749286174774, -0.027321483939886093, 0.021917235106229782, -0.006074007134884596, -0.03286430612206459, 0.0073384628631174564, 0.0004088551504537463, -0.017090361565351486, 0.015034900046885014, 0.0035017922054976225, -0.01569310948252678, 0.0010551566956564784, -0.038591884076595306, 0.016870958730578423, -0.019907962530851364, -0.02852242812514305, 0.010017492808401585, 0.005358059424906969, 0.03688284754753113, -0.002168050967156887, -0.052010130137205124, 0.021432237699627876, -0.00527434004470706, 0.028199097141623497, -0.02993122860789299, 0.030762651935219765, 0.03993140161037445, -0.0301852747797966, -0.015623824670910835, 0.04376518353819847, 0.004997198935598135, -0.017529169097542763, 0.031778834760189056, 0.020658552646636963, -0.044388752430677414, -0.012482892721891403, 0.004601695574820042, -0.008891607634723186, -0.005485082510858774, 0.002188259270042181, -0.04704468697309494, 0.02690577320754528, -0.02588958851993084, 0.007777269463986158, 0.03558952361345291, 0.00605668593198061, -0.009353509172797203, 0.012702296487987041, 0.010063682682812214, 0.026882678270339966, 0.008470121771097183, -0.026975058019161224, -0.0021637207828462124, 0.001059486996382475, 0.008452801033854485, 0.045751363039016724, -0.035705000162124634, 0.004298572428524494, 0.039400212466716766, 0.029099805280566216, -0.0673452615737915, -0.02130521461367607, -0.01539287343621254, -0.029954323545098305, -0.017840951681137085, -0.02614363469183445, 0.027691006660461426, -0.0005705207586288452, -0.002896989695727825, 0.0006387234316207469, -0.02013891376554966, 0.01816428452730179, -0.020808670669794083, 0.005482195410877466, 0.002435087924823165, -0.022275209426879883, -0.04300304502248764, -0.032125260680913925, -0.02729838900268078, 0.009001309052109718, 0.0371599905192852, 0.027090532705187798, 0.0010284529998898506, 0.0030023609288036823, -0.005447553005069494, 0.008158338256180286, -0.001853380468674004, 0.014572998508810997, 0.018487615510821342, 0.008516312576830387, 0.011518673039972782, 0.03873045742511749, 0.002052575582638383, 0.043072331696748734, 0.03244859352707863, -0.00951517466455698, -0.019965700805187225, -0.007817685604095459, 0.022979607805609703, 0.03108598291873932, 0.02302579954266548, 0.003706760937348008, 0.025658639147877693, -0.021513070911169052, -0.024804120883345604, 0.004841307178139687, -0.015577633865177631, 0.0010349485091865063, -0.019295942038297653, 0.03254097327589989, 0.04840729758143425, -0.02448078989982605, 0.0335109680891037, 0.007817685604095459, 0.0017350182170048356, -0.0070670959539711475, -0.0009613328729756176, -0.03528928756713867, 0.005037615075707436, 0.05316488444805145, 0.012552178464829922, 0.018695469945669174, 0.003161139553412795, 0.004451577551662922, -0.014873234555125237, -0.0026501608081161976, -0.017044171690940857, -0.00812947005033493, 0.00014687029761262238, 0.03577428683638573, -0.011033676564693451, -0.01524275541305542, -0.008758810348808765, -0.021640093997120857, 0.03064717724919319, -0.00416288897395134, -0.03277192264795303, 0.006553230341523886, -0.015404420904815197, -0.0028103829827159643, -0.00963642355054617, -0.016686197370290756, 0.012482892721891403, 0.034758102148771286, 0.008458574302494526, -0.010046361945569515, -0.04845348745584488, 0.001335906214080751, -0.01635131984949112, 0.07395046204328537, 0.027182914316654205, -0.06300339102745056, 0.009930886328220367, 0.048776816576719284, 0.002953283954411745, 0.02150152251124382, 0.013660741969943047, -0.02933075651526451, 0.011495578102767467, -0.01994260586798191, -0.033695727586746216, -0.010225348174571991, -0.007355784066021442, -0.011570637114346027, -0.009266902692615986, -0.016640007495880127, 0.03332620486617088, -0.004708510357886553, -0.007350010331720114, 0.004408274311572313, -0.011287722736597061, -0.010733440518379211, -0.009232260286808014, 0.041409485042095184, -0.026721011847257614, 0.010104099288582802, -0.053026314824819565, 0.006559004075825214, -0.024388408288359642, 0.024665549397468567, 0.021917235106229782, 0.021882591769099236, -0.01112605631351471, -0.05556677281856537, -0.05214869976043701, 0.0025274683721363544, 0.009376604110002518, -0.01741369254887104, -0.010225348174571991, -0.004624790512025356, -0.02418055385351181, 0.008308456279337406, 0.017944879829883575, 0.01942296512424946, -0.01304872240871191, -0.011160699650645256, -0.05168679729104042, -0.019919510930776596, 0.0021911461371928453, 0.013325863517820835, 0.021062716841697693, -0.04258733615279198, 0.012332774698734283, -0.009832732379436493, 0.001308480859734118, 0.00880500115454197, 0.0014982935972511768, 0.030046705156564713, -0.027598625048995018, -0.006380016915500164, 0.05219488963484764, -0.0026602649595588446, 0.01934213377535343, -0.002254657680168748, -0.014965614303946495, 0.007644472643733025, -0.04508160427212715, -0.021478427574038506, -0.019619273021817207, 0.009503627195954323, 0.031016698107123375, -0.03522000461816788, -0.011997896246612072, -0.055612962692976, 0.017679287120699883, 0.013025627471506596, -0.04734492301940918, -0.01130504347383976, -0.0019544214010238647, 0.013233482837677002, 0.03912307322025299, -0.013337410986423492, -0.005941210314631462, 0.014572998508810997, 0.013776217587292194, -0.003689439734444022, -0.02013891376554966, 0.0217093788087368, 0.000811936566606164, -0.0002886885486077517, -0.02225211262702942, 0.03316454216837883, -0.008383515290915966, -0.028845759108662605, 0.001280333730392158, -0.08328087627887726, 0.022494612261652946, -0.030000513419508934, -0.015231207944452763, 0.0018375025829300284, 0.0119632538408041, 0.02528911642730236, -0.031016698107123375, -0.045197080820798874, -0.0004557670617941767, 0.017552264034748077, -0.012852414511144161, -0.020162008702754974, 0.02397269755601883, 0.03235621377825737, 0.025427687913179398, 0.02225211262702942, -0.01609727367758751, 0.013810859993100166, 0.013926335610449314, 0.024550074711441994, 0.016743935644626617, 0.04612088203430176, 0.012586820870637894, -0.007817685604095459, 0.021039621904492378, 0.009509400464594364, 0.024711739271879196, -0.010531358420848846, 0.009896243922412395, -0.02114355005323887, 0.007915840484201908, 0.0266979169100523, 0.042125433683395386, -0.01573929935693741, 0.026074349880218506, -0.01781785674393177, 0.03284120932221413, 0.017910238355398178, 0.02903052046895027, -0.004298572428524494, -0.00946898479014635, -0.03441167622804642, -0.010121420957148075, -0.031016698107123375, -0.00332569214515388, 0.006414659786969423, -0.02933075651526451, -0.0006910482188686728, 0.02337222546339035, -0.012609915807843208, 0.00576511025428772, 0.009792315773665905, -0.0035883986856788397, 0.000879056635312736, 0.03134002909064293, -0.00835464708507061, -0.0005181959713809192, 0.04337256774306297, 0.009850053116679192, 0.032333116978406906, -0.009607555344700813, -0.04394994676113129, 0.04644421488046646, -0.020935693755745888, -0.003686552867293358, -0.00015841783897485584, 0.00840661022812128, 0.009809636510908604, -0.00016825129569042474, 0.02852242812514305, -0.0027815140783786774, -0.026582442224025726, 0.005138656124472618, -0.001749452669173479, 0.04427327588200569, 0.015773942694067955, 0.009272675961256027, 0.02013891376554966, 0.018083451315760612, -0.024665549397468567, 0.035012148320674896, -0.00792161375284195, 0.007604056503623724, -0.05385773628950119, 0.016870958730578423, 0.022852586582303047, 0.009082142263650894, -0.008943571709096432, 0.012563725933432579, -0.029215281829237938, 0.015658466145396233, -0.027229104191064835, 0.01200944371521473, 0.018256664276123047, -0.05385773628950119, -0.01090087927877903, 0.025058167055249214, -0.009907791391015053, -0.0021146435756236315, -0.006114423740655184, -0.005597671028226614, 0.001976073021069169, -0.020462244749069214, -0.016189653426408768, -0.036721184849739075, -0.04609778895974159, 0.003097628243267536, 0.010594869963824749, 0.05325726419687271, -0.0065185874700546265, -0.004044526722282171, -0.027344578877091408, 0.0022012502886354923, 0.021720927208662033, -0.047714442014694214, -0.011726529337465763, -0.028499333187937737, -0.013545266352593899, -0.021778663620352745, 0.02196342498064041, 0.0003016795380972326, -0.05182536691427231, -0.0060797808691859245, 0.02826838381588459, -0.03836093470454216, -0.018591541796922684, 0.0024567395448684692, -0.005638087633997202, -0.026120539754629135, 0.004763361066579819, 0.03685975447297096, -0.042079243808984756, -0.00284502562135458, -0.025312211364507675, -0.03817617520689964, -0.00739620067179203, -0.017898689955472946, -0.010173384100198746, 0.02750624530017376, -0.007171023637056351, 0.015958702191710472, -0.0015834567602723837, -0.00807173177599907, 0.0025808755308389664, -0.01934213377535343, -0.021847950294613838, 0.011270401068031788, -0.0038078019861131907, 0.0002609022776596248, -0.039700448513031006, -0.03748331964015961, 0.03875355049967766, 0.06739145517349243, 0.035566430538892746, -0.02655934728682041, -0.0017133665969595313, 0.06092483177781105, 0.00538981519639492, 0.047021590173244476, -0.012275037355720997, -0.023741746321320534, 0.008562502451241016, -0.017783215269446373, -0.01654762774705887, 0.017586907371878624, -0.008822321891784668, -0.0010760865407064557, 0.058522943407297134, 0.01044475194066763, -0.01736750267446041, 0.020104270428419113, -0.039192356169223785, 0.024134362116456032, 0.03831474483013153, -0.031270742416381836, 0.016362866386771202, -0.008089053444564342, 0.003317031543701887, 0.020704742521047592, 0.00023275514831766486, 0.005104013718664646, -0.008343098685145378, 0.025127451866865158, -0.01948070339858532, -0.03371882438659668, -0.050393473356962204, 0.009555591270327568, -0.02826838381588459, -0.004517975728958845, 0.005597671028226614, -0.006160613615065813, 0.029192186892032623, 0.016212748363614082, -0.012309679761528969, -0.01539287343621254, -0.06498956680297852, 0.010127194225788116, -0.021686283871531487, -0.011518673039972782, -0.004145567771047354, 0.005467761307954788, -0.015889417380094528, 0.011102961376309395, 0.014215024188160896, 0.007147928699851036, 0.019619273021817207, 0.006853466387838125, 0.010127194225788116, 0.005231036338955164, 0.0003374047519173473, -0.01922665722668171, 0.02715981937944889, -0.007898518815636635, 0.004572826437652111, 0.005525498650968075, 0.004549731500446796, 0.014769306406378746, 0.0215477142482996, 0.025935780256986618, -0.03249478340148926, -0.02115509659051895, 0.026721011847257614, -0.002322499407455325, 0.001958751818165183, 0.033741917461156845, 0.0054619875736534595, -0.016339771449565887, -0.004287024959921837, 0.003103401977568865, 0.033395491540431976, -0.04168662801384926, 0.001967412419617176, -0.02175556868314743, 0.029353851452469826, 0.033441681414842606, -0.027667909860610962, -0.008701073005795479, -0.008366194553673267, 0.03602833300828934, -0.02337222546339035, 0.024319123476743698, 0.0014030263992026448, -0.010768082924187183, 0.019365228712558746, 0.034042153507471085, 0.03321073204278946, -0.01898415945470333, -0.00999439787119627, -0.013822407461702824, 0.035104528069496155, 0.028129812330007553, -0.019411418586969376, -0.013268126174807549, -0.03150169551372528, -0.012482892721891403, -0.009653745219111443, -0.00013802920875605196, -0.0058776987716555595, 0.026721011847257614, -0.017240479588508606, -0.018198926001787186, 0.022379135712981224, -0.02715981937944889, -0.004971216898411512, -0.04360351711511612, -0.004647885449230671, -0.013071817345917225, 0.051409658044576645, 0.0028666772413998842, -0.039400212466716766, -0.004688302055001259, 0.02019665017724037, -0.00456993980333209, 0.027275294065475464, -0.006714895833283663, -0.011772719211876392, 0.017956428229808807, 0.0085567282512784, 0.0026313960552215576, -0.03364953771233559, 0.011801588349044323, 0.03166336193680763, 0.001193727133795619, 0.014088001102209091, 0.004191757645457983, 0.010184932500123978, -0.02160545065999031, -0.07293427735567093, -0.0019269960466772318, 0.03482738509774208, -0.019007254391908646, 0.02088950388133526, -0.00802554190158844, -0.03903069347143173, -0.005222375970333815, -0.04143258184194565, 0.029238376766443253, -0.013060269877314568, 0.00802554190158844, -0.003620154457166791, -0.004232174251228571, -0.02241377905011177, -0.018210474401712418, -0.021108906716108322, 0.007448164746165276, 0.0014954067301005125, -0.04094758257269859, 0.029099805280566216, 0.017044171690940857, -0.03043932095170021, -0.0025447895750403404, -0.03457334265112877, 0.002084331354126334, -0.04997776076197624, -0.016166558489203453, -0.012956341728568077, -0.03406525030732155, -0.029538612812757492, 0.0017927559092640877, -0.0023051779717206955, 0.007575187366455793, 0.01062373910099268, 0.010236895643174648, 0.00584016926586628, 0.0070670959539711475, 0.028707189485430717, 0.049192529171705246, 0.06355766952037811, 0.02418055385351181, -0.005866151303052902, 0.015104184858500957, -0.0009728803997859359, 0.011657243594527245, 0.01837213896214962, 0.00542445806786418, 0.008094826713204384, -0.02115509659051895, -0.02316436916589737, 0.00936505664139986, -0.032402403652668, 0.019064992666244507, 0.012217299081385136, 0.002541902707889676, 0.005395588930696249, -0.01852225698530674, 0.016362866386771202, 0.011206889525055885, 0.03184812143445015, 0.041617341339588165, -0.001786982174962759, -0.024919595569372177, 0.01112605631351471, 0.011893968097865582, 0.030462415888905525, -0.05002395063638687, 0.008123695850372314, 0.03824545815587044, 0.024157457053661346, -0.028938140720129013, 0.011761171743273735, -0.006634063087403774, -0.052010130137205124, 0.017979523167014122, 0.009867374785244465, -0.01549680158495903, -0.014965614303946495, 0.017090361565351486, -0.0174714308232069, 0.0009007082553580403, 0.0053147561848163605, -0.036074522882699966, -0.012736938893795013, 0.006276089232414961, 0.021928781643509865, -0.016686197370290756, 0.032402403652668, 0.023787936195731163, 0.0023354904260486364, -0.016489889472723007, 0.017586907371878624, -0.028476238250732422, -0.014376689679920673, -0.03138621896505356, -0.004004110116511583, 0.05422725901007652, -0.01777166686952114, 0.03549714386463165, -0.016997981816530228, -0.0034238463267683983, 0.008649108931422234, 0.008701073005795479, 0.013464434072375298, -0.03993140161037445, 0.004263930022716522, 0.01888023130595684, -0.01600489392876625, 0.06217196583747864, -0.010860463604331017, -0.0021463993471115828, 0.007390426937490702, 0.0011576410615816712, 0.010502489283680916, -0.0015589181566610932, -0.003986788913607597, -0.023106630891561508, 0.012459797784686089, 0.03083193674683571, 0.025681734085083008, -0.018360592424869537, -0.032471686601638794, -0.020404506474733353, -0.039954494684934616, -0.003957920242100954, 0.015115732327103615, 0.014653830789029598, -0.009099463000893593, 0.011755397543311119, 0.0231759175658226, 0.011010581627488136, 0.021224381402134895, 0.008989761583507061, 0.0008999865385703743, 0.02554316259920597, 0.021732473745942116, 0.023187464103102684, -0.03094741329550743, 0.00996552873402834, -0.007309594191610813, 0.009341961704194546, 0.007165249902755022, 0.014561450108885765, -0.0008610135992057621, 0.027067437767982483, -0.022148186340928078, 0.008464348502457142, 0.007113285828381777, 0.01092974841594696, 0.01715964823961258, -0.012621463276445866, -0.03053170070052147, -0.00963642355054617, -0.014561450108885765, -0.03309525549411774, 0.008758810348808765, 0.05981626734137535, -0.017044171690940857, -0.01528894528746605, 0.0004994312184862792, -0.0009873148519545794, -0.002072783885523677, 0.021940330043435097, -0.0002394310722593218, 0.007938935421407223, 0.010034814476966858, -0.01958463154733181, -0.005713146645575762, -0.00954404380172491, 0.019295942038297653, 0.016062630340456963, 0.014353594742715359, -0.010404335334897041, -0.0013424017233774066, 0.0009800976840779185, 0.022078899666666985, -0.024203648790717125, 0.013891693204641342, -0.017286671325564384, -0.028152907267212868, 0.057368189096450806, -0.006789954844862223, -0.013799312524497509, -0.027667909860610962, -0.007967803627252579, 0.0043130069971084595, -0.001050104619935155, 0.012228847481310368, -0.005851716734468937, 0.0019313264638185501, 0.0032592937350273132, 0.020774027332663536, -0.0360514260828495, 0.021767117083072662, -0.004070508759468794, 0.006016269326210022, -0.01130504347383976, -0.016928697004914284, -0.0032333116978406906, -0.014723116531968117, -0.0052801137790083885, 0.011299270205199718, -0.016894053667783737, 0.006074007134884596, 0.010889331810176373, 0.034550245851278305, 0.006732217036187649, 0.022494612261652946, -0.013268126174807549, 0.034042153507471085, -0.0026689255610108376, -0.009907791391015053, -0.011790040880441666, 0.01200944371521473, 0.0007679115515202284, 0.014954066835343838, 0.001338793197646737, -0.002453852677717805, -0.04473517835140228, -0.01639750972390175, -0.008978214114904404, 0.021132001653313637, 0.015000256709754467, -0.009878922253847122, 0.0018273985479027033, -0.02579720877110958, -0.004344762768596411, 0.005300321616232395, -0.015519896522164345, -0.01998879574239254, -0.02655934728682041, -0.007061321754008532, -0.02397269755601883, 0.031224554404616356, 0.014896329492330551, -0.027529340237379074, -0.00784655474126339, 0.03073955699801445, 0.029561707749962807, 0.002312395256012678, 0.01166301779448986, 0.01355681475251913, -0.01665155589580536, -0.019665464758872986, 0.017148099839687347, 0.00825071893632412, 0.020381411537528038, -0.002692020731046796, 0.014342047274112701, 0.007563639897853136, 0.02225211262702942, 0.01666310243308544, -0.03073955699801445, 0.0185799952596426, -0.022332945838570595, 0.03773736581206322, 0.010537131689488888, 0.007124833296984434, -0.013787765055894852, 0.004454464185982943, 0.021593904122710228, 0.012275037355720997, -0.025912683457136154, -0.0067206695675849915, -0.01151289977133274, -0.014180381782352924, 0.03542785719037056, -0.001050104619935155, -0.011986348778009415, 0.03568190336227417, 0.017552264034748077, 0.030300749465823174, -0.028961235657334328, -0.006951620336622, -0.015531443990767002, -0.03210216760635376, -0.0042754774913191795, 0.04122472554445267, -0.02009272389113903, -0.01741369254887104, 0.044388752430677414, -0.054181065410375595, 0.0041138119995594025, 0.0058603775687515736, 0.013626099564135075, 0.045451126992702484, -0.016870958730578423, -0.01062373910099268, 0.022841038182377815, 0.040300920605659485, 0.020150460302829742, -0.026674821972846985, -0.02997741848230362, 0.011397424153983593, -0.01937677524983883, -0.01494251936674118, -0.029284566640853882, -0.01741369254887104, 0.041409485042095184, -0.016767030581831932, 0.004881723318248987, 0.03249478340148926, 0.029284566640853882, -0.008210302330553532, 0.011905515566468239, -0.014088001102209091, -0.034042153507471085, -0.0037991413846611977, -0.009076368063688278, 0.035266194492578506, -0.0054591004736721516, -0.01973474957048893, 0.0014456078642979264, 0.009272675961256027, 0.02478102594614029, 0.012875509448349476, -0.01762154884636402, 0.009370829910039902, -0.026813393458724022, -0.01982712931931019, 0.046767544001340866, -0.0028897724114358425, -0.014769306406378746, -0.004584374371916056, 0.03231002390384674, -0.002684803446754813, -0.005164638161659241, 0.018094997853040695, -0.015820132568478584, 0.005609218496829271, -0.027021247893571854, 0.02468864433467388, -0.035266194492578506, -0.00576511025428772, -0.007211439777165651, 0.02200961485505104, -0.033788107335567474, -0.03073955699801445, -0.038938309997320175, -0.02427293360233307, -0.010571775026619434, 0.035612620413303375, -0.00015941020683385432, -0.008302683010697365, 0.014088001102209091, -0.02836076356470585, 0.03482738509774208, -0.051455847918987274, 0.02024284191429615, 0.03785284236073494, -0.012575273402035236, -0.0023932280018925667, -0.033280014991760254, 0.008770357817411423, 0.0028695641085505486, -0.014018716290593147, 0.012078728526830673, -0.02831457369029522, 0.002433644374832511, 0.031316932290792465, 0.01319884043186903, 0.025520067662000656, -0.021062716841697693, 0.044850654900074005, 0.01635131984949112, -0.04073973000049591, 0.022887228056788445, 0.03748331964015961, -0.011905515566468239, 0.03598213940858841, 0.021328309550881386, 0.04997776076197624, 0.0004279807908460498, -0.010462072677910328, 0.02644387073814869, -0.025450782850384712, -0.021085811778903008, 0.022483063861727715, 0.0089320233091712, -0.009526722133159637, -0.008117921650409698, -0.022944966331124306, 0.023811031132936478, -0.020762480795383453, 0.02307198941707611, -0.002110313391312957, -0.019804034382104874, -0.031016698107123375, -0.0036547970958054066, -0.00029374059522524476, 0.04461970180273056, 0.03143240883946419, 0.015404420904815197, 0.0072634038515388966, -0.008065958507359028, -0.0016339771682396531, 0.03124764934182167, -0.005242584273219109, 0.018395233899354935, -0.02861480973660946, -0.004122472368180752, 0.005987400654703379, 0.014561450108885765, -0.031155267730355263, 0.027344578877091408, 0.014099548570811749, 0.03210216760635376, 0.006755311973392963, -0.032887399196624756, -0.040347110480070114, -0.00013685641170013696, 0.02988503873348236, -0.032425496727228165, -0.018764756619930267, -0.024111267179250717, -0.0077022104524075985, 0.00605668593198061, -0.011807361617684364, -0.02090105041861534, 0.02427293360233307, -0.03325692191720009, 0.032887399196624756, -0.000219764158828184, -0.009953981265425682, -0.009902017191052437, -0.0342269130051136, -0.011068318970501423, -0.04471208155155182]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-15T11:25:07.015446", "url_path": "/api/agent/", "chunk_size": 4187}
updated_dt: 2025-03-15T11:25:07.016544
---
Useful if you want to
        [override the model][pydantic_ai.Agent.override] for testing.
      end_strategy: Strategy for handling tool calls that are requested alongside a final result.
        See [`EndStrategy`][pydantic_ai.agent.EndStrategy] for more information.
      instrument: Set to True to automatically instrument with OpenTelemetry,
        which will use Logfire if it's configured.
        Set to an instance of [`InstrumentationSettings`][pydantic_ai.agent.InstrumentationSettings] to customize.
        If this isn't set, then the last value set by
        [`Agent.instrument_all()`][pydantic_ai.Agent.instrument_all]
        will be used, which defaults to False.
    """
    if model is None or defer_model_check:
      self.model = model
    else:
      self.model = models.infer_model(model)
    self.end_strategy = end_strategy
    self.name = name
    self.model_settings = model_settings
    self.result_type = result_type
    self.instrument = instrument
    self._deps_type = deps_type
    self._result_tool_name = result_tool_name
    self._result_tool_description = result_tool_description
    self._result_schema: _result.ResultSchema[ResultDataT] | None = _result.ResultSchema[result_type].build(
      result_type, result_tool_name, result_tool_description
    )
    self._result_validators: list[_result.ResultValidator[AgentDepsT, ResultDataT]] = []
    self._system_prompts = (system_prompt,) if isinstance(system_prompt, str) else tuple(system_prompt)
    self._system_prompt_functions: list[_system_prompt.SystemPromptRunner[AgentDepsT]] = []
    self._system_prompt_dynamic_functions: dict[str, _system_prompt.SystemPromptRunner[AgentDepsT]] = {}
    self._function_tools: dict[str, Tool[AgentDepsT]] = {}
    self._default_retries = retries
    self._max_result_retries = result_retries if result_retries is not None else retries
    for tool in tools:
      if isinstance(tool, Tool):
        self._register_tool(tool)
      else:
        self._register_tool(Tool(tool))
  @staticmethod
  definstrument_all(instrument: InstrumentationSettings | bool = True) -> None:
"""Set the instrumentation options for all agents where `instrument` is not set."""
    Agent._instrument_default = instrument
  @overload
  async defrun(
    self,
    user_prompt: str | Sequence[_messages.UserContent],
    *,
    result_type: None = None,
    message_history: list[_messages.ModelMessage] | None = None,
    model: models.Model | models.KnownModelName | None = None,
    deps: AgentDepsT = None,
    model_settings: ModelSettings | None = None,
    usage_limits: _usage.UsageLimits | None = None,
    usage: _usage.Usage | None = None,
    infer_name: bool = True,
  ) -> AgentRunResult[ResultDataT]: ...
  @overload
  async defrun(
    self,
    user_prompt: str | Sequence[_messages.UserContent],
    *,
    result_type: type[RunResultDataT],
    message_history: list[_messages.ModelMessage] | None = None,
    model: models.Model | models.KnownModelName | None = None,
    deps: AgentDepsT = None,
    model_settings: ModelSettings | None = None,
    usage_limits: _usage.UsageLimits | None = None,
    usage: _usage.Usage | None = None,
    infer_name: bool = True,
  ) -> AgentRunResult[RunResultDataT]: ...
  async defrun(
    self,
    user_prompt: str | Sequence[_messages.UserContent],
    *,
    result_type: type[RunResultDataT] | None = None,
    message_history: list[_messages.ModelMessage] | None = None,
    model: models.Model | models.KnownModelName | None = None,
    deps: AgentDepsT = None,
    model_settings: ModelSettings | None = None,
    usage_limits: _usage.UsageLimits | None = None,
    usage: _usage.Usage | None = None,
    infer_name: bool = True,
  ) -> AgentRunResult[Any]:
"""Run the agent with a user prompt in async mode.
    This method builds an internal agent graph (using system prompts, tools and result schemas) and then
    runs the graph to completion. The result of the run is returned.
    Example:
```python
    from pydantic_ai import Agent
    agent = Agent('openai:gpt-4o')
    async def main():
      agent_run = await agent.run('What is the capital of France?')
      print(agent_run.data)
      #> Paris