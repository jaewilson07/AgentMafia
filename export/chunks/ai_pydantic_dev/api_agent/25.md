---
url: https://ai.pydantic.dev/api/agent/
session_id: pydantic_ai_docs
chunk_number: 25
title: API Documentation for Async Context Manager
summary: This section describes the implementation of an asynchronous context manager function 'iter' that accepts parameters including a user prompt, result type, message history, model settings, and dependencies. The function is designed to handle inputs for an agent in the Pydantic API.
embedding: [0.006271915510296822, 0.06950373202562332, -0.015565258450806141, -0.06391900032758713, -0.025218553841114044, 0.017299579456448555, 0.037413340061903, 0.027509165927767754, 0.02275341935455799, 0.007171798963099718, -0.018652131780982018, 0.0025142200756818056, -0.00300779240205884, -0.0466848649084568, -0.006959099322557449, -0.021128173917531967, -0.010040518827736378, 0.005137516651302576, 0.015161673538386822, 0.040336597710847855, 0.047077544033527374, -0.0005886738072149456, 0.005791977513581514, 0.04262721166014671, -0.04502689838409424, 0.031065071001648903, -0.04467785358428955, 0.04014026001095772, -0.017975855618715286, 0.003588626394048333, 0.011082202196121216, -0.012598369270563126, -0.04764474183320999, 0.01769225485622883, 0.03335568308830261, -0.01377639826387167, 0.015467088669538498, 0.006457346025854349, -0.013732767663896084, 0.04629218950867653, 0.06007949635386467, -0.020201021805405617, -0.012991045601665974, 0.03760967776179314, -0.0030568770598620176, -0.01518348976969719, 0.02452046237885952, 0.06487887352705002, 0.019710175693035126, 0.014801720157265663, -0.02777095139026642, 0.025960275903344154, -0.03150137886404991, -0.003414103528484702, -0.04733932763338089, -0.020168298855423927, -0.013765490613877773, 0.02244800329208374, 0.003945853095501661, 0.001559798140078783, 0.03392288088798523, -0.0068336608819663525, -0.003067784709855914, 0.054625656455755234, -0.050698891282081604, 0.02170628122985363, -0.00011427498247940093, 0.05240049213171005, -0.0531858429312706, 0.009756918996572495, 0.023058833554387093, 0.01204207818955183, -0.06697314977645874, -0.030912362039089203, -0.027291012927889824, 0.00276782363653183, 0.05209507420659065, 0.03305026888847351, -0.008235298097133636, 0.002549669938161969, 0.013809122145175934, -0.03726063296198845, 0.03128322213888168, 0.015292566269636154, -0.016121549531817436, -0.048779141157865524, -0.047077544033527374, -0.0044912369921803474, -0.0014302694471552968, -0.05881420522928238, 0.005412935744971037, 0.03667161613702774, -0.004679394420236349, 0.031305037438869476, 0.06396263092756271, 0.049084555357694626, -0.024934954941272736, -0.014419951476156712, 0.019284777343273163, 0.03743515536189079, 0.04094742611050606, -0.03791509196162224, -0.006473707500845194, 0.02668018266558647, 0.007329960353672504, -0.00879704300314188, -0.019284777343273163, 0.039376720786094666, -0.048648249357938766, -0.021902618929743767, -0.05977408215403557, -0.005418389569967985, -0.01063498668372631, 0.026701997965574265, -0.04295444115996361, -0.04585588350892067, -0.00837709754705429, 0.005560189485549927, 0.06479161232709885, -0.014649013057351112, -0.008584343828260899, -0.003888587700203061, -0.018663039430975914, -0.0018215824384242296, 0.02897079661488533, 0.0052302321419119835, -0.021564481779932976, -0.029821595177054405, 0.0043412563391029835, -0.025153107941150665, -0.005737439263612032, -0.0035477227065712214, -0.011878462508320808, -0.017135964706540108, -0.017768608406186104, -0.029581625014543533, -0.0398784764111042, -0.02622206136584282, -0.018139470368623734, 0.026723813265562057, -0.010313211008906364, -0.02000468410551548, -0.02126997336745262, 0.0033459304831922054, 0.044525146484375, 0.07556840032339096, -0.06077758967876434, 0.04498326778411865, -0.01830308511853218, 0.04096924141049385, 0.03361746668815613, 0.004376706201583147, -0.007891706191003323, 0.005731985438615084, 8.930662443162873e-05, 0.01855396293103695, -0.03082510083913803, -0.00331593444570899, 0.037086110562086105, -0.057156238704919815, -0.004134010523557663, 0.019241146743297577, -0.031130516901612282, -0.011725755408406258, -0.0171577800065279, -0.008213482797145844, -0.032330360263586044, -0.005462020169943571, -0.025458522140979767, -0.032701220363378525, 0.009075189009308815, -0.03422829881310463, -0.036846138536930084, 0.019350223243236542, 0.02801091969013214, -0.04912818595767021, -0.07395406067371368, -0.0010907679097726941, -0.015750689432024956, -0.03368291258811951, -0.032635774463415146, -0.01966654509305954, -0.025305815041065216, -0.023691479116678238, -0.058203376829624176, -0.0031741345301270485, 0.0005678810412064195, 0.010787694714963436, -0.018499424681067467, -0.017637716606259346, 0.017768608406186104, 0.0788407027721405, 0.011065840721130371, 0.035755373537540436, 0.004232179373502731, -0.0014888981822878122, 0.020822759717702866, 0.017670439556241035, 0.035580847412347794, 0.02010285295546055, 0.01880483888089657, 0.011583955027163029, 0.027727320790290833, -0.0061192079447209835, 0.025349445641040802, -0.02158629707992077, 0.019895607605576515, -0.0029559810645878315, -0.0015148039674386382, 0.011213093996047974, 0.015139858238399029, -0.025000400841236115, 0.01595793478190899, -0.010820417664945126, -0.00929334294050932, -0.02288431115448475, -0.036191679537296295, 0.016241533681750298, 0.0029996116645634174, 0.028578119352459908, 0.012380215339362621, 0.04624855890870094, 0.007389952428638935, -0.004750294145196676, -0.0002740554336924106, 0.03739152476191521, -0.022578895092010498, -0.036257125437259674, 0.0491718165576458, 0.0609084814786911, -0.024018708616495132, -0.015816135331988335, -0.054931070655584335, -0.04177641123533249, 0.023647848516702652, -0.05815974622964859, -0.015292566269636154, -0.005781069863587618, 0.023233355954289436, -0.02785821259021759, -0.017048701643943787, 0.0077008213847875595, 0.014910797588527203, -0.029843410477042198, 0.024324124678969383, 0.01559798140078783, 0.0015134405111894011, -0.014376320876181126, 0.03981303051114082, 0.035515401512384415, 0.03475186601281166, -0.010242310352623463, -0.039224013686180115, -0.050349846482276917, 0.004417609889060259, 0.031239593401551247, -0.024782247841358185, -0.011234909296035767, -0.011736663058400154, -0.014049090445041656, 0.06422441452741623, 0.008927935734391212, -0.027203751727938652, 0.017321394756436348, 0.01833580806851387, 0.002646475564688444, 0.03760967776179314, -0.025436706840991974, -0.008158943615853786, -0.03416284918785095, 0.005693808663636446, -0.0116712162271142, 0.001175984158180654, -0.05623999238014221, -0.02185898832976818, 0.015139858238399029, 0.021160896867513657, 0.05986134335398674, -0.010056880302727222, -0.05117883160710335, -0.0026505659334361553, 0.044634222984313965, 0.03686795383691788, 0.054189350455999374, 0.00861161295324564, -0.008573436178267002, -0.004973901901394129, 0.026985598728060722, 0.03726063296198845, 0.026462029665708542, 0.04083834961056709, -0.002497858600690961, 0.04258358106017113, 0.016939625144004822, 0.03176316246390343, -0.05017532408237457, 0.015128950588405132, 0.0070299990475177765, -0.0044312444515526295, -0.024280494078993797, 0.0016865999205037951, 0.005014805588871241, 0.01573978178203106, -0.027378274127840996, 0.039660319685935974, 0.0457686223089695, -0.025349445641040802, -0.04014026001095772, 0.01899026893079281, -0.004788470920175314, -0.022775234654545784, 0.0575052835047245, -0.02510947734117508, 0.013798214495182037, -0.003877679817378521, 0.008006236515939236, 0.051527876406908035, -0.037304263561964035, 0.04956449568271637, 0.005396574269980192, -0.025502154603600502, -0.026418399065732956, 0.0010007795644924045, 0.01966654509305954, -0.018161285668611526, -0.0025551237631589174, 0.02644021436572075, -0.00029058739892207086, -0.01636151783168316, 0.01125672459602356, -0.00692637637257576, -0.024193232879042625, 0.003981302957981825, 0.019372038543224335, 0.038176875561475754, -0.007755359634757042, -0.005423843394964933, 0.003160499967634678, 0.043957944959402084, 0.03261395916342735, -0.031130516901612282, 0.003754968522116542, -0.04024933651089668, -0.017670439556241035, 0.01681964099407196, 0.049215447157621384, -0.019492022693157196, -0.008366189897060394, -0.027225567027926445, 0.02238255739212036, 0.024389570578932762, -0.013350998982787132, 0.00932061206549406, 0.018837561830878258, 0.0033950151409953833, 0.00247331615537405, -0.021411774680018425, 0.02962525561451912, -0.039158567786216736, 0.014954428188502789, -0.05733076110482216, -0.013056491501629353, -0.0018706669798120856, 0.008235298097133636, -0.050349846482276917, 0.0009128364035859704, -0.016186995431780815, 0.03850410878658295, -0.007040906697511673, 0.04415428638458252, 0.07727000117301941, 0.03036697953939438, -0.013241922482848167, -0.03143593296408653, -0.015096227638423443, -0.019993776455521584, -0.022131681442260742, -0.007046360522508621, 0.019797436892986298, 0.05977408215403557, 0.030912362039089203, 0.017703162506222725, 0.025371260941028595, 0.025065846741199493, 0.03553721681237221, -0.0024774065241217613, -0.02740008942782879, -0.005213870666921139, -0.038853153586387634, 0.04088198021054268, 0.036409832537174225, -0.05549827218055725, 0.005993769504129887, 0.004976628813892603, -0.06343906372785568, -0.02040826715528965, 0.005445658694952726, -0.010215041227638721, 0.030759654939174652, 0.010313211008906364, -0.008071682415902615, 0.004600313492119312, -0.06448619812726974, 0.04376160725951195, 0.01914297603070736, -0.031828608363866806, 0.0008514806977473199, 0.0017929497407749295, 0.03067239373922348, 0.028163626790046692, 0.05955592915415764, 0.009042466059327126, 0.0045839520171284676, -0.0010559996590018272, -0.014387228526175022, -0.015761597082018852, -0.029756149277091026, -0.05139698460698128, 0.02362603321671486, 0.07377953827381134, -0.04284536466002464, -0.07124896347522736, 0.009255166165530682, 0.023822370916604996, -0.0018161286134272814, 0.05615273118019104, 0.036475278437137604, -0.031457748264074326, -0.052924059331417084, 0.007580836769193411, 0.04310714825987816, 0.05576005578041077, 0.007302691228687763, 0.01651422679424286, -0.020888205617666245, -0.011213093996047974, 0.04555046930909157, -0.014616290107369423, -0.0065118842758238316, -0.011442155577242374, 0.05432024225592613, -0.052269596606492996, 0.02615661360323429, 0.04059838131070137, -0.026287507265806198, -0.0001304660690948367, -0.044481515884399414, -0.013165568932890892, 0.0051020667888224125, -0.03409740328788757, -0.007046360522508621, -0.019775621592998505, -0.003943126183003187, 0.0008487537852488458, -0.04690302163362503, 0.0009837363613769412, 0.06976551562547684, 0.021815357729792595, 0.04179822653532028, 0.0020874571055173874, 0.013165568932890892, 0.00728087592869997, -0.024564092978835106, 0.01932840794324875, 0.0009141998598352075, 0.05305495113134384, -0.012740169651806355, -0.021389959380030632, -0.0021924434695392847, 0.0683256983757019, 0.04454696178436279, -0.01270744577050209, -0.018750300630927086, -0.015576166100800037, -0.007689913734793663, -0.02897079661488533, -0.00970783457159996, 0.0024883144069463015, 0.006680953316390514, -0.025174923241138458, 0.01985197514295578, -0.016306979581713676, 0.032264914363622665, 0.03547177091240883, -0.012881969101727009, -0.0016743286978453398, -0.027727320790290833, -0.023167910054326057, -0.017179595306515694, 0.01564161106944084, 0.017015978693962097, 0.01281652320176363, -0.00627736933529377, -0.008137128315865993, 0.06147567927837372, -0.010874955914914608, -0.03420648351311684, -0.03538450971245766, -0.040052998811006546, -0.029668888077139854, -0.024607723578810692, -0.0019865611102432013, -0.009958711452782154, 0.05113520100712776, -0.038482293486595154, -0.03887496888637543, -0.001557071227580309, 0.0021828992757946253, 0.02371329441666603, 0.027160121127963066, -0.035755373537540436, 0.021749911829829216, 0.000612534349784255, 0.04079471901059151, 0.015358012169599533, 0.016350610181689262, 0.007733544334769249, 0.00802259799093008, -0.00822439044713974, -0.00905882753431797, 0.004267629235982895, -0.011649400927126408, -0.003604987869039178, 0.010340480133891106, 0.01474718190729618, 0.023015202954411507, 0.050480738282203674, -0.050480738282203674, -0.004982082638889551, 0.035013649612665176, -0.0037985993549227715, 0.023364247754216194, -0.001581613440066576, 0.024040523916482925, -0.015685241669416428, 0.007422675844281912, 0.02266615629196167, 0.010416833683848381, -0.050349846482276917, -0.02740008942782879, -0.01749591715633869, 0.036344386637210846, -0.03243943676352501, 0.008846127428114414, -0.024782247841358185, -0.009871449321508408, 0.015543443150818348, -0.01675419509410858, 0.039594873785972595, -0.0005153878591954708, 0.03333386778831482, -0.004968447610735893, 0.023320617154240608, -0.033442944288253784, 0.02912350371479988, -0.01329646073281765, -0.02563304640352726, -0.01352552231401205, 0.017365025356411934, -0.02947254851460457, -0.01899026893079281, -0.004701209720224142, 0.03440282121300697, -0.016383333131670952, -0.006762761157006025, 0.04733932763338089, -0.0010969034628942609, -0.016241533681750298, -0.04088198021054268, -0.0069863684475421906, 0.022557079792022705, -0.0013246012385934591, -0.007422675844281912, -0.022687973454594612, 0.028490858152508736, -0.041296474635601044, 0.012980137951672077, -0.008278928697109222, -0.025153107941150665, 0.039442166686058044, -0.017921317368745804, -0.009631481021642685, -0.0021147262305021286, -0.00861161295324564, 0.040052998811006546, -0.003084146184846759, -0.03824232146143913, 0.02986522577702999, 0.004120375961065292, -0.000573675730265677, -0.0014943520072847605, -0.017299579456448555, 0.00752084469422698, -0.021128173917531967, -0.06134478747844696, -0.0021092724055051804, 0.02489132434129715, 0.014638105407357216, -0.0392676442861557, 0.006904561072587967, 0.04829920455813408, 0.00350954569876194, -0.017648624256253242, 0.05746165290474892, 0.004428517539054155, 0.015314381569623947, 0.013438261114060879, 0.008311651647090912, -0.04965175688266754, -0.0020397359039634466, -0.011442155577242374, -0.003782237647101283, -0.03222128376364708, -0.019372038543224335, -0.010504094883799553, 0.03599534183740616, -0.02770550549030304, -0.0002820657682605088, 0.06684225797653198, -0.00036302118678577244, 0.00853525847196579, 0.02986522577702999, 0.0016170634189620614, 0.008497081696987152, -0.008878850378096104, -0.005437477957457304, -0.03950761258602142, 0.0028332695364952087, -0.01080405618995428, 0.030127009376883507, -0.04821194335818291, 0.020331913605332375, 0.03073783963918686, 0.018913915380835533, -0.06313364952802658, 0.017648624256253242, -0.0301488246768713, -0.02050643600523472, -0.02007013000547886, 0.010291394777595997, 0.03920219838619232, 0.027530981227755547, -0.04288899526000023, 0.013656414113938808, -0.010231402702629566, 0.0013941377401351929, 0.0021433590445667505, -0.0003633620508480817, 0.012794707901775837, -0.03287574648857117, -0.0383513979613781, -0.03571174293756485, 0.003981302957981825, 0.01060771755874157, -0.006479161325842142, 0.014059998095035553, -0.010564086958765984, -0.01728867180645466, -0.015390735119581223, 0.009189719334244728, -0.012336584739387035, 0.016405150294303894, -0.010204133577644825, 0.009849634021520615, -0.06422441452741623, 0.001581613440066576, 0.023364247754216194, -0.007842620834708214, 0.021040912717580795, 0.018652131780982018, -0.029668888077139854, 0.015161673538386822, 0.0011296265292912722, 0.020048314705491066, 0.01960109919309616, 0.0062010157853364944, -0.0017479555681347847, -0.011333078145980835, -0.03610441833734512, 0.026200246065855026, 0.013220107182860374, -0.01462719775736332, -0.03209039196372032, 0.07116169482469559, 0.07495757192373276, 9.092572872759774e-05, -0.021597204729914665, 0.0016020654002204537, 0.025240369141101837, 0.020953651517629623, -0.005271135829389095, -0.014125443994998932, -0.00488664023578167, 0.03291937708854675, 0.01385275274515152, -0.008573436178267002, -0.007580836769193411, 0.015510719269514084, -0.01789950206875801, -0.008491627871990204, -0.02406233921647072, -0.01326373778283596, 0.009838726371526718, 0.04838646575808525, -0.005467473994940519, -0.02182626537978649, -0.001979743828997016, 0.0013075580354779959, 0.03691158443689346, -0.01595793478190899, -0.003561357269063592, 0.0003297868533991277, -0.04413247108459473, 0.006173746194690466, -0.018063116818666458, -0.01407090574502945, 0.012609276920557022, 0.01488898228853941, -0.018095839768648148, 0.0012346128933131695, -0.028839902952313423, 0.01895754598081112, -0.018139470368623734, 0.01614336483180523, -0.014169075526297092, -0.03132685273885727, 0.0432816706597805, 0.038416847586631775, -0.006544607691466808, -0.015750689432024956, 0.00929334294050932, -0.017801333218812943, 0.007858983241021633, -0.037413340061903, -0.015096227638423443, -0.002396962372586131, -0.04158007353544235, 0.008840673603117466, -0.04029296711087227, -0.0009980526519939303, -0.018837561830878258, -0.0038258684799075127, -0.030410610139369965, -0.01012778002768755, -0.0036131686065346003, -0.0340101420879364, 0.002043826272711158, 0.013634598813951015, -0.01589248888194561, 0.01818310096859932, -0.05392756685614586, 0.004949359223246574, -0.019797436892986298, 0.01611064188182354, 0.01765953190624714, 0.008306197822093964, 0.01270744577050209, 0.0017765882657840848, -0.03571174293756485, -0.007275422103703022, -0.0141472602263093, -0.005082978401333094, -0.012685630470514297, -0.00514842476695776, 0.009042466059327126, 0.028185442090034485, 0.002890534931793809, 0.025218553841114044, -0.02377874031662941, 0.022622525691986084, -0.04035841301083565, 0.022840680554509163, -0.009053373709321022, 0.019459299743175507, 0.016219718381762505, -0.026025721803307533, 0.034860942512750626, -0.01582704298198223, 0.03754423186182976, -0.00663186889141798, 0.008240751922130585, 0.012881969101727009, -0.022535264492034912, 0.013787306845188141, 0.024694984778761864, -0.020113760605454445, -0.01641605794429779, -0.01474718190729618, -0.012478385120630264, -0.008791589178144932, -0.05911961942911148, -0.04624855890870094, 0.03139229863882065, 0.012740169651806355, 0.0003906312631443143, -0.01035684160888195, 0.028359966352581978, -0.0599922351539135, -0.023516956716775894, 0.0009237440535798669, -0.009533311240375042, 0.016743287444114685, 0.003367746016010642, 0.0035040918737649918, 0.02325517125427723, 0.03150137886404991, 0.0070681762881577015, -0.001558434683829546, 0.00029416647157631814, -0.038045983761548996, -0.042103640735149384, 0.009009743109345436, -0.00016992118617054075, -0.02266615629196167, 0.019284777343273163, 0.04790652543306351, 0.005606546998023987, -0.024716800078749657, 0.00464667147025466, -0.058552421629428864, 0.011333078145980835, 0.017234133556485176, -0.008458904922008514, 0.011627585627138615, 0.03669343143701553, 0.018652131780982018, 0.007613560184836388, -0.037151556462049484, -0.05772343650460243, -0.029756149277091026, -0.0027323735412210226, -0.04223453253507614, 0.04681576043367386, 0.03150137886404991, 0.0439143143594265, 0.008437089622020721, -0.005617454648017883, -0.007362683303654194, -9.01587845874019e-05, -0.0001410328841302544, 0.006702768616378307, 0.02173900417983532, 0.0009707834688015282, -0.02615661360323429, 0.004829375073313713, 0.003583172569051385, -0.01663421094417572, 0.005211143754422665, -0.0012686994159594178, -0.004731205757707357, 0.001608882681466639, 0.03874407708644867, 0.04105650261044502, -0.039289459586143494, 0.005328401457518339, 0.021749911829829216, 0.04489600658416748, 0.015488903969526291, 0.00010652030323399231, 0.0171577800065279, -0.018532147631049156, -0.0301488246768713, 0.013449168764054775, -0.0014657194260507822, 0.0059010544791817665, -0.007100899238139391, -0.007231791038066149, -0.008000782690942287, -0.0005399301298893988, 1.236700700246729e-05, -0.009855087846517563, 0.029887041077017784, 0.0020615514367818832, -0.017146872356534004, 0.02207714319229126, 0.01504168938845396, -0.016721472144126892, 0.014976243488490582, -0.035515401512384415, 0.03335568308830261, 0.02325517125427723, -0.013231014832854271, -0.001336190733127296, -0.01477990485727787, 0.0042976257391273975, -0.015292566269636154, 0.009440596215426922, -0.01038956455886364, -0.01919751614332199, 0.02600390650331974, -0.011769386008381844, -0.037958722561597824, 0.02152085117995739, 0.012838338501751423, 0.03538450971245766, -0.01459447480738163, 0.003294119145721197, 0.034642789512872696, 0.019022991880774498, 0.01018777210265398, 0.025174923241138458, -0.021848080679774284, 0.044939637184143066, -0.01808493211865425, -0.02251344919204712, 0.02040826715528965, 0.03420648351311684, 0.0039513069204986095, 0.021128173917531967, -0.05117883160710335, -0.0032695767004042864, -0.025240369141101837, 0.006560969166457653, 0.02918894961476326, -0.0534912571310997, -0.05405845865607262, -0.0017138690454885364, -0.0001258643897017464, 0.002474679611623287, 0.00603740056976676, -0.021313605830073357, 0.006948191672563553, -0.007471760269254446, -0.0017602266743779182, -0.020517343655228615, 0.002004286041483283, 0.013514614664018154, -0.02244800329208374, 0.037958722561597824, -0.015532535500824451, 0.008246205747127533, -0.031828608363866806, 0.0047557479701936245, 0.027661874890327454, -0.033748358488082886, -0.021662650629878044, -0.010171410627663136, -0.0020506437867879868, -0.01843397691845894, 0.059294141829013824, 0.009806003421545029, -0.04031478241086006, 0.0009844180895015597, 0.01504168938845396, -0.010045972652733326, -0.033006638288497925, 0.02421504817903042, -0.01818310096859932, -0.00554928183555603, 0.031217778101563454, 0.0377187542617321, -0.02622206136584282, 0.006048308219760656, -0.022578895092010498, -0.026832889765501022, -0.031130516901612282, -0.00834982842206955, -0.04227816313505173, 0.06828206777572632, -0.02044099010527134, 0.024258678779006004, -0.0031795883551239967, -0.008573436178267002, 0.011234909296035767, 0.006937284022569656, -0.03134866803884506, -0.015554350800812244, -0.006500976625829935, -0.007531752344220877, 0.008393459022045135, -0.005175693891942501, 0.0230370182543993, 0.052051443606615067, 0.03577718883752823, -0.0233424324542284, -0.004829375073313713, 0.04450333118438721, -0.004564863629639149, 0.03658435493707657, -0.008104405365884304, 0.012685630470514297, -0.006544607691466808, -0.011109471321105957, -0.034773681312799454, 0.016437873244285583, -0.03887496888637543, 0.02962525561451912, 0.02318972535431385, 0.021542666479945183, -0.010787694714963436, 0.03645346313714981, -0.005573824048042297, 0.021095450967550278, -0.005085705313831568, 0.0027037409599870443, -0.01203116960823536, -0.011387617327272892, 0.012805615551769733, 0.0417327806353569, -0.004373979289084673, -0.027814581990242004, 0.029887041077017784, 0.04083834961056709, -0.008355282247066498, -0.05528011918067932, -0.05676356330513954, 0.010024157352745533, 0.007417222019284964, 0.020211929455399513, -0.03459915891289711, -0.009020650759339333, 0.016710564494132996, 0.008747958578169346, -0.0019374764524400234, -0.0020370089914649725, -0.02423686347901821, 0.01654694974422455, -0.017026886343955994, -0.01617608778178692, 0.014081813395023346, 0.024411385878920555, -0.0016661479603499174, 0.02204442024230957, 0.007662644609808922, -0.007291783578693867, 0.015139858238399029, 0.005268408916890621, -0.02219712734222412, 0.021531758829951286, -0.009031558409333229, 0.0028578119818121195, 0.032941192388534546, -0.025763938203454018, 0.011562139727175236, -0.013896383345127106, 0.0030268810223788023, 0.017114149406552315, -0.036191679537296295, 0.032766666263341904, -0.0541020892560482, -0.02260071039199829, 0.02312427945435047, 0.04162370413541794, -0.002080639824271202, 0.04406702518463135, 0.002616479527205229, -0.018684854730963707, -0.012881969101727009, -0.011856647208333015, 0.010716794990003109, -0.018063116818666458, -0.0159252118319273, -0.002616479527205229, 0.03435919061303139, 0.0037276993971318007, -0.01805220916867256, 0.004294898826628923, 0.0051866015419363976, 0.015052597038447857, -0.01956837624311447, -0.003888587700203061, -0.014081813395023346, -0.007908067665994167, -0.01374367531388998, 0.018510332331061363, 0.02040826715528965, 0.027836397290229797, -0.01022049505263567, -0.01570705883204937, 0.02807636559009552, 0.017048701643943787, -0.02297157235443592, -0.011147648096084595, -0.027989104390144348, -0.00808804389089346, -0.018837561830878258, 0.0007703548180870712, -0.018226731568574905, 0.011267632246017456, -0.042561762034893036, -0.006320999935269356, 0.021226342767477036, -0.0001120593587984331, -0.01749591715633869, -0.051746029406785965, -0.00598286185413599, 0.017234133556485176, 0.012336584739387035, 0.01644878089427948, -0.018935730680823326, 0.005693808663636446, 0.05030621588230133, -0.005759254563599825, 0.028185442090034485, 0.008197120390832424, -0.018728485330939293, -0.006866383831948042, -0.023756925016641617, -0.011758478358387947, -0.04125284403562546, -0.01762680895626545, -0.009958711452782154, -0.011409432627260685, -0.013896383345127106, -0.04555046930909157, -0.013187384232878685, 0.0031714076176285744, -0.060559432953596115, 0.006888199131935835, -0.0008242115145549178, -0.004243087023496628, 0.026505660265684128, 0.030345162376761436, -0.047077544033527374, -0.012369307689368725, -0.030170639976859093, 0.0065336995758116245, 0.00301870028488338, 0.017539547756314278, 0.0017643170431256294, -0.003874952904880047, -0.0002145744947483763, -0.005423843394964933, -0.02844722755253315, 0.002471952699124813, 0.010045972652733326, -0.02093183621764183, 0.027247382327914238, 0.017245041206479073, -0.021597204729914665, 0.04773200303316116, -0.0222625732421875, 0.004270356148481369, -0.03228672966361046, -0.014409043826162815, -0.024651354178786278, -0.01882665418088436, -0.0035722649190574884, 0.013394629582762718, -0.003678614739328623, 0.004564863629639149, 0.025829384103417397, 0.009560580365359783, -0.008589797653257847, 0.015358012169599533, 0.026091167703270912, 0.024694984778761864, 0.05192055180668831, 0.02047371305525303, -0.0245859082788229, 0.030759654939174652, 0.01022049505263567, -0.0020860936492681503, 0.021968064829707146, -0.0035940802190452814, -0.004333075601607561, -0.039747580885887146, -0.011660308577120304, -0.006146477069705725, -0.0063755386509001255, 0.0035340881440788507, 0.00550292432308197, -0.029428917914628983, 0.010242310352623463, 0.004971174523234367, 0.0033813805785030127, -0.004903001710772514, 0.055149227380752563, 0.06540244072675705, -0.02473861537873745, -0.018041301518678665, 0.012129339389503002, 0.006539153400808573, 0.015030781738460064, -0.02585119940340519, 0.017975855618715286, 0.03942035138607025, 0.03846047818660736, -0.04094742611050606, -0.013089215382933617, 0.0033513843081891537, -0.05104793980717659, 0.03392288088798523, 0.035668112337589264, -0.012183877639472485, 0.012663815170526505, 0.039224013686180115, 0.01648150384426117, -0.0029968847520649433, -0.022088050842285156, -0.04786289483308792, -0.015052597038447857, 0.005571097135543823, 0.008742504753172398, -0.02040826715528965, 0.013394629582762718, -0.020135575905442238, 0.0081153130158782, 0.020495528355240822, 0.03228672966361046, -0.010831325314939022, 0.009037012234330177, -0.056109100580215454, 0.008000782690942287, 0.07539387792348862, 0.014081813395023346, 0.022578895092010498, -0.008104405365884304, 0.0036213495768606663, 0.007275422103703022, 0.03531906381249428, -0.011322170495986938, -0.03728244826197624, 0.018466699868440628, 0.013176476582884789, 0.004114922136068344, 0.06439893692731857, -0.014518121257424355, -0.010367749258875847, 0.022208034992218018, -0.0067900302819907665, 0.009129727259278297, 0.026112983003258705, 0.016023380681872368, -0.02844722755253315, 0.03846047818660736, 0.025829384103417397, 0.013350998982787132, -0.026571106165647507, -0.02785821259021759, 0.001636151922866702, -0.016426965594291687, -0.005415662657469511, 0.020615514367818832, 0.023647848516702652, 0.011169463396072388, 0.0537966750562191, 0.036846138536930084, 0.023975078016519547, 0.002915077144280076, 0.012587461620569229, 0.006086484994739294, 0.025131292641162872, -0.0017738613532856107, -0.03830776736140251, -0.04260539636015892, 0.001483444357290864, -0.005361124407500029, 0.024542277678847313, -0.0030814192723482847, 0.00893338955938816, -0.021444497630000114, 0.02993067167699337, -0.011562139727175236, 0.02593846060335636, -0.020877297967672348, 0.009887810796499252, -0.00893338955938816, -0.006670045666396618, -0.0052302321419119835, -0.011496693827211857, -0.011682123877108097, -0.02421504817903042, -0.001955201383680105, -0.0005102748400531709, -0.031959500163793564, -0.01604519598186016, 0.006642776541411877, -0.013154661282896996, 0.01611064188182354, 0.006784576456993818, 0.001608882681466639, 0.02111726626753807, 0.04269265756011009, -0.02940710261464119, -0.008507989346981049, -0.005868331529200077, -0.015379827469587326, 0.0025292180944234133, -0.014681736007332802, -0.031065071001648903, 0.0070299990475177765, 0.021073635667562485, 0.005955592729151249, -0.007886252366006374, 0.0012162062339484692, -0.04825557395815849, -0.02384418621659279, 0.026243876665830612, -0.01617608778178692, -0.016830548644065857, -0.009500588290393353, 6.271915481192991e-05, 0.015783412382006645, 0.0202555600553751, 0.0265929214656353, 0.03920219838619232, -0.008693420328199863, -0.02260071039199829, -0.012369307689368725, 0.007711729034781456, 0.0025892104022204876, -0.025545785203576088, 0.006048308219760656, 0.004873005673289299, -0.006184653844684362, -0.014823535457253456, -0.005028440151363611, -0.020299190655350685, 0.014921705238521099, -0.013700044713914394, 0.030105194076895714, -0.0037713299971073866, 0.001559798140078783, 0.03259214386343956, 0.0055083781480789185, 0.006910014897584915, 0.00475302105769515, 0.023473326116800308, 0.010940401814877987, -0.011638493277132511, 0.0282945204526186, -0.02047371305525303, 0.04243087023496628, -0.008524350821971893, 0.0021651743445545435, -0.01843397691845894, -0.03346475958824158, 0.001682509551756084, 0.020321005955338478, 0.006860930006951094, -0.009696926921606064, 0.0016007019439712167, -0.033006638288497925, -0.013656414113938808, -0.012445662170648575, -0.019252054393291473, -0.00259739113971591, -0.0205609742552042, -0.009544218890368938, 0.0019252053461968899, -0.003700430039316416, 0.038853153586387634, -0.01818310096859932, -0.022404372692108154, 0.021466312929987907, 0.04155825823545456, 0.018128562718629837, -0.008066228590905666, -0.023800555616617203, 0.015139858238399029, 0.0012298407964408398, 0.022491633892059326, 0.001512077054940164, 0.014027275145053864, 0.022033512592315674, -0.03606078773736954, 0.013787306845188141, 0.014910797588527203, -0.011213093996047974, -0.030127009376883507, 0.017299579456448555, 0.012216600589454174, 0.018543055281043053, -0.01252201572060585, 0.03267940506339073, -0.0054047550074756145, -0.01119127869606018, -0.006070123519748449, 0.003536815056577325, -0.052269596606492996, 0.003239580662921071, -0.008993381634354591, 0.019393853843212128, -0.00013881725317332894, -0.027443720027804375, -0.023735109716653824, 0.02689833752810955, 0.026985598728060722, 0.008971566334366798, -0.02371329441666603, 0.016383333131670952, -0.02541489154100418, -0.03542814031243324, -0.030323347076773643, 0.020451897755265236, 0.004477602429687977, -0.0027351004537194967, 0.06064669415354729, -0.018161285668611526, 0.003754968522116542, -0.004003118257969618, -0.024498647078871727, 0.019372038543224335, -0.00175477284938097, -0.010269579477608204, 0.0034413726534694433, 0.0063755386509001255, 0.03950761258602142, -0.024651354178786278, -0.031065071001648903, 0.009042466059327126, 0.00350954569876194, 0.019273869693279266, -0.03265758976340294, -0.013732767663896084, 0.027465535327792168, -0.009784188121557236, 0.003264122875407338, -0.02386600151658058, 0.014114536345005035, -0.0034222842659801245, -0.0061410232447087765, -0.008491627871990204, -0.015434365719556808, -0.016743287444114685, -0.0010198679519817233, 0.02288431115448475, 0.01018777210265398, -0.01570705883204937, 0.03239580616354942, -0.011834831908345222, 0.028774457052350044, -0.014049090445041656, -0.05706897750496864, 0.022022604942321777, 0.0008126220782287419, -0.015347104519605637, 0.010040518827736378, -0.028316335752606392, -0.02219712734222412, -0.007411767728626728, 0.020081037655472755, 0.006620961241424084, 0.004313987214118242, 0.010236856527626514, -0.013547337613999844, 0.006168292369693518, -0.028774457052350044, 0.01656876504421234, -0.06304638832807541, 0.017975855618715286, -0.02742190472781658, 0.0030759654473513365, -0.03669343143701553, -0.03257032856345177, -0.025523969903588295, -0.03972576558589935, -0.004624856170266867, 0.027094675227999687, 0.003389561315998435, 0.0032313999254256487, 0.0035149995237588882, -0.016994163393974304, 0.008109859190881252, -0.010580448433756828, 0.0015761596150696278, 0.0010553179308772087, -0.029647070914506912, 0.010765879414975643, -0.030105194076895714, 0.0337047278881073, 0.012325677089393139, -0.01789950206875801, -0.01086950208991766, -0.027880027890205383, 0.014179983176290989, 0.01564161106944084, 0.014452674426138401, 0.00470666354522109, -0.00256330450065434, 0.029232580214738846, 0.009451503865420818, -0.012641999870538712, 0.007024545222520828, 0.026723813265562057, -0.02111726626753807, 0.005347489845007658, 0.0037958724424242973, 0.021019097417593002, 0.02630932256579399, 0.023516956716775894, 0.008971566334366798, 0.0027582794427871704, 0.0038395030423998833, 0.020244652405381203, 0.010345933958888054, -0.017059609293937683, -0.011638493277132511, 0.00855162087827921, 0.00728087592869997, -0.009429688565433025, 0.013361906632781029, -0.002567394869402051, -0.021749911829829216, -0.045681361109018326, -0.008791589178144932, -0.028796272352337837, 0.043892499059438705, 0.05148424580693245, 0.006942737847566605, 0.0014507212908938527, 0.0006605962989851832, 0.010885863564908504, 0.010176864452660084, -0.024869509041309357, 0.04821194335818291, 0.014103628695011139, -0.008126220665872097, 0.021313605830073357, -0.013165568932890892, -0.021280881017446518, 0.027509165927767754, 0.02089911326766014, 0.010465918108820915, 0.007193614263087511, -0.004668486770242453, -0.01462719775736332, -0.014027275145053864, 0.00043528457172214985, -0.02591664530336857, -0.03298482298851013, -0.015216212719678879, -0.01660148799419403, -0.0063591767102479935, -0.01083677913993597, -0.03728244826197624, 0.015259843319654465, -0.028927164152264595, 0.003356838133186102, -0.013067399151623249, -0.03030153177678585, 0.013754582963883877, 0.008824312128126621, -0.015085319988429546, -0.015979750081896782]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-15T11:17:06.714646", "url_path": "/api/agent/", "chunk_size": 2865}
updated_dt: 2025-03-15T11:17:06.716264
---
```
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
```
| ```
@asynccontextmanager
async defiter(
  self,
  user_prompt: str | Sequence[_messages.UserContent],
  *,
  result_type: type[RunResultDataT] | None = None,
  message_history: list[_messages.ModelMessage] | None = None,
  model: models.Model | models.KnownModelName | None = None,
  deps: AgentDepsT = None,
  model_settings: ModelSettings | None = None,
  usage_limits: _usage.UsageLimits | None = None,
  usage: _usage.Usage | None = None,
  infer_name: bool = True,
) -> AsyncIterator[AgentRun[AgentDepsT, Any]]:
"""A contextmanager which can be used to iterate over the agent graph's nodes as they are executed.
  This method builds an internal agent graph (using system prompts, tools and result schemas) and then returns an
  `AgentRun` object. The `AgentRun` can be used to async-iterate over the nodes of the graph as they are
  executed. This is the API to use if you want to consume the outputs coming from each LLM model response, or the
  stream of events coming from the execution of tools.
  The `AgentRun` also provides methods to access the full message history, new messages, and usage statistics,
  and the final result of the run once it has completed.
  For more details, see the documentation of `AgentRun`.
  Example:
  ```python
  from pydantic_ai import Agent
  agent = Agent('openai:gpt-4o')
  async def main():
    nodes = []
    async with agent.iter('What is the capital of France?') as agent_run:
      async for node in agent_run:
        nodes.append(node)
    print(nodes)
    '''
    [
      ModelRequestNode(
        request=ModelRequest(
          parts=[
            UserPromptPart(
              content='What is the capital of France?',
              timestamp=datetime.datetime(...),
              part_kind='user-prompt',
            )
          ],
          kind='request',
        )
      ),
      CallToolsNode(
        model_response=ModelResponse(
          parts=[TextPart(content='Paris', part_kind='text')],
          model_name='gpt-4o',
          timestamp=datetime.datetime(...),
          kind='response',
        )
      ),
      End(data=FinalResult(data='Paris', tool_name=None, tool_call_id=None)),
    ]
    '''
    print(agent_run.result.data)
    #> Paris