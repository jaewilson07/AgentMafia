---
url: https://ai.pydantic.dev/api/agent/
session_id: pydantic_ai_docs
chunk_number: 44
title: Using Pydantic AI Agent for Query Processing
summary: This document illustrates how to utilize the Pydantic AI Agent, specifically 'openai:gpt-4o', to process a user query about the capital of France. It includes a code example demonstrating the agent's asynchronous operation, starting from the user prompt and iterating through nodes until reaching an 'End' node, while collecting the nodes in a list.
embedding: [0.013728662393987179, 0.04182210937142372, 0.013185068033635616, -0.05847693234682083, 0.021338991820812225, 0.01887546479701996, -0.004155030939728022, 0.0028162840753793716, 0.020182406529784203, 0.012537379749119282, -0.005722203757613897, -0.025884369388222694, -0.05482212454080582, -0.033980462700128555, 0.02257653698325157, -0.014804285950958729, -0.02113080583512783, 0.008234884589910507, 0.0009129791869781911, 0.030048074200749397, 0.04011036455631256, -0.00551401823759079, 0.01133453194051981, 0.016805177554488182, -0.020621908828616142, 0.03374914824962616, -0.007656591944396496, 0.048946671187877655, -0.020830092951655388, 0.009634352289140224, -0.00759876286610961, -0.009767359122633934, -0.0341886505484581, -0.00725178699940443, 0.023293619975447655, -0.02347867377102375, 0.004010458011180162, -0.0022553405724465847, 0.001775357755832374, 0.02071443572640419, 0.013161935843527317, -0.00959965493530035, -0.0042649065144360065, 0.009171717800199986, -0.03425804525613785, -0.021443083882331848, 0.02049468457698822, 0.03277761489152908, 0.03411925211548805, -0.0069395094178617, -0.040688656270504, 0.03708011284470558, -0.022391483187675476, 0.03872246295213699, -0.03937014937400818, 0.009518693201243877, 0.018621016293764114, 0.007060950621962547, 0.001005506026558578, -0.07448406517505646, 0.03897691145539284, 0.01810055412352085, 0.03721890226006508, 0.05297158658504486, -0.03250003606081009, 0.019627245143055916, -0.01619218848645687, 0.05505343899130821, -0.04531499370932579, -0.011854995042085648, 0.050195783376693726, 0.05611749738454819, -0.08345916122198105, -0.013242896646261215, -0.013208199292421341, -0.016539163887500763, 0.028868358582258224, 0.005300050135701895, -0.0048229587264359, -0.005430166143923998, 0.007338530849665403, 0.004955966025590897, -0.0066677117720246315, 0.016169056296348572, 0.03749648109078407, -0.056163761764764786, -0.04834524914622307, -0.041706450283527374, -0.033587224781513214, -0.045037414878606796, -0.023605898022651672, -0.018597884103655815, -0.0017652376554906368, 0.036455556750297546, 0.03967086225748062, 0.03300893306732178, 0.004490440711379051, 0.009327856823801994, 0.0030013376381248236, 0.012884355150163174, 0.008755347691476345, -0.03078828938305378, -0.046887949109077454, 0.014121901243925095, 0.005363662261515856, 0.007564065046608448, -0.005161259789019823, 0.0066040996462106705, -0.015856778249144554, -0.039925310760736465, -0.07813887298107147, 0.010669495910406113, -0.012953750789165497, 0.028359461575746536, -0.07795382291078568, -0.051028523594141006, -0.020702868700027466, 0.00056636513909325, 0.0556548647582531, -0.030973343178629875, -0.012444852851331234, 0.008148140273988247, -0.02782743237912655, 0.02602315880358219, 0.013774925842881203, 0.008443069644272327, -0.03076515719294548, -0.01897955872118473, -0.0029666402842849493, -0.007477321196347475, 0.011166826821863651, -0.02736479789018631, -0.021072976291179657, -0.019118348136544228, -0.03282387927174568, -0.035715341567993164, -0.03516018018126488, 0.006095202174037695, -0.0684235617518425, 0.018378132954239845, 0.01407563779503107, -0.018181513994932175, 0.007292267866432667, 0.014376349747180939, -0.0007770804804749787, 0.049316778779029846, -0.02898401767015457, 0.042608585208654404, 0.0016770480433478951, 0.01089502964168787, 0.04820645600557327, 0.01729094423353672, -0.037889719009399414, -0.02470465376973152, -0.009478213265538216, -0.012514248490333557, 0.02521355077624321, 0.021211765706539154, -0.0016987340059131384, -0.047142401337623596, -0.0427936390042305, 0.023825649172067642, -0.027549851685762405, -0.023663725703954697, -0.009119671769440174, -0.007477321196347475, -0.041613925248384476, -0.032199323177337646, -0.030880816280841827, -0.027272270992398262, 0.017256246879696846, -0.020841659978032112, -0.01939592882990837, -0.01983543112874031, 0.02159344032406807, -0.032338112592697144, -0.059217143803834915, 0.02279628813266754, -0.009350989013910294, -0.030441313982009888, -0.023027604445815086, -0.011623677797615528, -0.046841688454151154, -0.0031112132128328085, -0.06296448409557343, -0.0070551675744354725, -0.0028900164179503918, 0.011432841420173645, -0.008593426086008549, 0.03673313558101654, 0.03812103718519211, 0.04131321236491203, 0.017614787444472313, 0.005687505938112736, -0.02010144479572773, -0.018863899633288383, 0.04707300290465355, -0.014364784583449364, 0.014064071699976921, 0.031459107995033264, 0.00014339845802169293, 0.019823864102363586, 0.019407493993639946, 0.015960872173309326, 0.02301603928208351, -0.06921003758907318, -0.017082758247852325, -0.034489359706640244, 0.0003766129375435412, -0.007546716369688511, -0.003073624335229397, -0.04862282797694206, 0.019060518592596054, -0.011022253893315792, -0.024542730301618576, 0.010704193264245987, -0.06148405373096466, 0.042492929846048355, 0.03162103146314621, 0.037010714411735535, 0.02912280708551407, 0.06481501460075378, 0.029377255588769913, -0.005820513237267733, 0.0019820972811430693, 0.007361662574112415, 0.001178993727080524, -0.020066747441887856, 0.008726432919502258, 0.028868358582258224, -0.012456418946385384, -0.00885365717113018, -0.03543775901198387, -0.03175982087850571, 0.016978666186332703, -0.06745202839374542, 0.024612126871943474, 0.019696639850735664, 0.01579894870519638, -0.04286303371191025, -0.01792706549167633, -0.010172164067626, 0.027896827086806297, 0.03453562408685684, 0.011854995042085648, -0.00363167654722929, 0.003276026574894786, -0.013358555734157562, 0.02477404847741127, 0.05047336220741272, 0.03719576820731163, 0.009761576540768147, -0.002122333273291588, -0.018031157553195953, -0.005291375797241926, -0.015556066296994686, -0.02868330478668213, 0.021871019154787064, 0.00759876286610961, 0.01197065319865942, 0.036548081785440445, 0.024912837892770767, -0.0599573589861393, -0.0026832770090550184, -0.017279377207159996, 0.00872065033763647, 0.02470465376973152, 0.006112550850957632, -0.03407299146056175, -0.06791466474533081, 0.006609882693737745, -0.013936847448348999, 0.025467999279499054, -0.017209982499480247, -0.009067625738680363, 0.04108189418911934, -0.0034408399369567633, 0.03770466521382332, -0.014283822849392891, -0.018008027225732803, 0.006447960622608662, 0.04834524914622307, 0.056256286799907684, 0.0641210675239563, -0.0001033697699313052, -0.009356771595776081, -0.017765143886208534, 0.002237991662696004, 0.03159789741039276, 0.02944665029644966, 0.054035644978284836, 0.004024915397167206, 0.028729569166898727, -0.019997352734208107, 0.02244931273162365, -0.041266947984695435, 0.06671181321144104, -0.0128496577963233, -0.005236438009887934, -0.03083455190062523, -0.02365216054022312, -0.048854146152734756, -0.0074715381488204, -0.02288881503045559, 0.02264593169093132, 0.010999122634530067, 0.013520477339625359, 0.015347881242632866, 0.0071187797002494335, -0.0002501114795450121, -0.018574753776192665, 0.06916377693414688, -0.02056407928466797, 0.003993109334260225, -0.03196800500154495, 0.021894151344895363, 0.05912461876869202, -0.03034878708422184, 0.01768418215215206, 0.007153477519750595, -0.00632073637098074, -0.0556086003780365, 0.041613925248384476, 0.02946978248655796, -0.009859886020421982, -0.0020153492223471403, 0.0066908434964716434, 0.013173501938581467, -0.006702409125864506, 0.03504452109336853, 0.002052938099950552, -0.0427011139690876, 0.020633473992347717, 0.03451249375939369, -0.00035619200207293034, -0.0028972451109439135, -0.02398757077753544, 0.03120465949177742, 0.018493792042136192, 0.055793654173612595, -0.04674915969371796, -0.021975113078951836, -0.023848779499530792, -0.037427086383104324, -0.006286039017140865, 0.051444895565509796, -0.012051614001393318, 0.025051629170775414, -0.04140573740005493, 0.01707119308412075, 0.0363861620426178, 0.02743419259786606, 0.04950183257460594, 0.0029666402842849493, -0.02286568284034729, -0.00019878802413586527, 0.007870560511946678, 0.011097432114183903, -0.04011036455631256, 0.021998245269060135, -0.07587196677923203, -0.0363861620426178, 0.020552514120936394, -0.010033373720943928, -0.03805164247751236, -0.03807477280497551, -0.03837548568844795, 0.030510708689689636, 0.01153115089982748, 0.032731350511312485, 0.05690397694706917, 0.017649484798312187, -0.006870114244520664, -0.04529186338186264, 0.004045155830681324, 0.020841659978032112, -0.02159344032406807, -0.014688627794384956, 0.020355893298983574, 0.03293953835964203, 0.029400387778878212, 0.03534523397684097, 0.008709084242582321, -0.0037357690744102, 0.025560526177287102, -0.023802516981959343, -0.02736479789018631, 0.013948413543403149, -0.01045552734285593, 0.033980462700128555, 0.05375806614756584, -0.04927051439881325, -0.02005518227815628, -0.03495199605822563, -0.03874559327960014, 0.005933280568569899, 0.023617463186383247, 0.025074759498238564, 0.0556086003780365, 0.0017565633170306683, 0.0023999137338250875, 0.013624569401144981, -0.019569415599107742, 0.025514261797070503, 0.0061530317179858685, -0.00972109567373991, 0.027943091467022896, 0.011745119467377663, 0.025861237198114395, 0.03516018018126488, 0.04797514155507088, -0.011195741593837738, -0.008934617973864079, -0.03330964595079422, -0.0004933557356707752, -0.032685089856386185, -0.001891016261652112, -0.0010814068373292685, -0.0030533841345459223, 0.07170826196670532, -0.03324024751782417, -0.057135291397571564, -0.005357879213988781, 0.016782047227025032, -0.028012486174702644, 0.04866909235715866, 0.039092570543289185, -0.03761214017868042, -0.008911486715078354, -0.03601605445146561, 0.0447598360478878, 0.05093599855899811, 0.023594330996274948, -0.015879910439252853, -0.013798058032989502, -0.02139681950211525, 0.047697558999061584, 0.026717111468315125, -0.01342795044183731, 0.02778116799890995, 0.0277580376714468, -0.06888619810342789, 0.04112815856933594, 0.022044507786631584, -0.06361217051744461, -0.009356771595776081, -0.020413722842931747, -0.05912461876869202, 0.022830985486507416, -0.05158368498086929, -0.0067949360236525536, 0.007870560511946678, -0.0513986311852932, 0.006922160275280476, -0.06698939949274063, -0.002905919449403882, 0.08873318880796432, 0.049363043159246445, 0.04022602364420891, -0.00996397901326418, 0.013740228489041328, -0.001549823791719973, -0.038213565945625305, 0.03754274547100067, -0.038606803864240646, 0.006569402292370796, 0.005386793985962868, 0.0033049413468688726, -0.011959088034927845, 0.01843596249818802, 0.04624026268720627, -0.027249138802289963, 0.010530705563724041, -0.008807393722236156, -0.012398590333759785, 0.012040048837661743, -0.003027360886335373, 0.01058853417634964, -0.001360432943329215, -0.01182608027011156, -0.013474213890731335, -0.010848766192793846, 0.009854103438556194, 0.023663725703954697, -0.019500020891427994, 0.014492008835077286, 0.029770495370030403, -0.014885247685015202, -0.016145924106240273, 0.004571401514112949, 0.016643255949020386, 0.012687736190855503, 0.041197553277015686, -0.01060010027140379, 0.03367974981665611, 0.031389713287353516, -0.03754274547100067, -0.007072516717016697, -0.006187729071825743, -0.04286303371191025, -0.01733720675110817, 0.006054721772670746, 0.015151262283325195, 0.0686086118221283, 0.011698856018483639, -0.03886125236749649, 0.028706436976790428, 0.009460864588618279, 0.0022452203556895256, 0.04573136568069458, -0.04455164819955826, 0.00598532659932971, 0.03115839697420597, 0.014781154692173004, -0.0128496577963233, 0.003125670598819852, 0.0005114273517392576, 0.019604112952947617, -0.03127405419945717, 0.0008052721968851984, 0.025814974680542946, -0.006158814299851656, -0.015498237684369087, -0.009906149469316006, 0.0070320358499884605, -0.00025517152971588075, 0.0340961217880249, 0.0014110335614532232, 0.003828295972198248, -0.008049830794334412, 0.017834538593888283, 0.005274027120321989, -0.005473537836223841, 0.02475091628730297, -0.016863007098436356, 0.030510708689689636, 0.042076557874679565, 0.0026442422531545162, -0.05172247439622879, -0.017024928703904152, 0.012710867449641228, 0.03943954408168793, -0.036085449159145355, 0.0021714880131185055, -0.01140971016138792, 0.006910594645887613, 0.004964640364050865, -0.042562324553728104, 0.013451081700623035, -0.007037818897515535, 0.0018476443365216255, 0.014584535732865334, 0.02824380248785019, -0.04512994363903999, 0.01134609803557396, -0.0008139465935528278, -0.015706421807408333, -0.030603235587477684, 0.020968884229660034, -0.00555739039555192, -0.004825850483030081, -0.015949305146932602, 0.032222453504800797, 0.007939955219626427, -0.007442623842507601, 0.051907528191804886, 0.0384911447763443, -0.010709975846111774, -0.017695749178528786, 0.006002675276249647, 0.046795424073934555, 0.03303206339478493, 0.002757009118795395, -0.027087217196822166, -0.0015845212619751692, -0.02983989007771015, 0.0364324226975441, 0.020552514120936394, -0.04318688064813614, 0.03775092959403992, -0.008859439752995968, -0.03289327397942543, 0.0235249362885952, 0.024935970082879066, 0.0021020930726081133, -0.01300001423805952, -0.02694842778146267, 0.012733999639749527, 0.0128496577963233, -0.014838984236121178, 0.0011544162407517433, -0.024959102272987366, -0.0008406926062889397, -0.0181930810213089, -0.0383986197412014, 0.01959254778921604, 0.021697532385587692, -0.022194864228367805, -0.04820645600557327, 0.03030252456665039, 0.018621016293764114, 0.01638880744576454, -0.03083455190062523, 0.0448060967028141, 0.0202980637550354, 0.006598316598683596, -0.0013799503212794662, -0.0016784938052296638, -0.031412843614816666, 0.01944219134747982, -0.001121164415962994, -0.034327439963817596, -0.030695762485265732, -0.02100358158349991, -0.010929726995527744, 0.02613881789147854, -0.051491159945726395, 0.03983278200030327, 0.0427936390042305, -0.04066552594304085, 0.03381854295730591, 0.022460877895355225, -0.0043371934443712234, -0.012225101701915264, -0.014492008835077286, 0.017418168485164642, -0.03159789741039276, -0.006742889992892742, -0.0008949075709097087, 0.015451974235475063, -0.054035644978284836, 0.03030252456665039, 0.03282387927174568, 0.0033222900237888098, -0.06768334656953812, -0.0043140617199242115, -0.016446636989712715, -0.008286930620670319, -0.011132129468023777, 0.006852765567600727, 0.03407299146056175, 0.03846801444888115, -0.028451988473534584, 0.0061298999935388565, 0.000723588396795094, -0.0235018040984869, -0.017418168485164642, 0.007830079644918442, 0.013300726190209389, -0.018470659852027893, -0.02433454617857933, -0.02782743237912655, 0.020945752039551735, 0.002016794867813587, -0.01327759400010109, -0.030672630295157433, -0.021685967221856117, 0.012005350552499294, -0.013809623196721077, 0.0023912391625344753, -0.031435977667570114, 0.008483550511300564, -0.01475802343338728, -0.0069452919997274876, -0.0384448803961277, 0.01097020786255598, 0.03596979007124901, 0.005169934593141079, 0.03775092959403992, -0.0005754009471274912, -0.026254476979374886, 0.03923135995864868, 0.05380432680249214, 0.01795019768178463, 0.015209090895950794, 0.011612111702561378, -0.0035304753109812737, -0.026786506175994873, -0.05324916914105415, 0.06634170562028885, -0.0009086420177482069, -0.004996446892619133, -0.051444895565509796, 0.05611749738454819, 0.050658416002988815, -0.018863899633288383, -0.012757130898535252, -0.0051381285302340984, 0.03768153488636017, 0.023351449519395828, -0.018528489395976067, 0.012514248490333557, -0.011490670964121819, 0.021315859630703926, -0.006164597347378731, 0.004935726057738066, -0.0009621340432204306, 0.019916391000151634, -0.0031227790750563145, -0.03923135995864868, -0.0023030496668070555, -0.0030533841345459223, -0.013890583999454975, 0.009854103438556194, -0.007540933322161436, 0.013115672394633293, -0.013231330551207066, -0.01080828532576561, 0.006008458323776722, -0.02281942032277584, -0.015741121023893356, 0.028336329385638237, -0.042562324553728104, 0.030857684090733528, -0.031435977667570114, -0.012976882047951221, -0.01648133434355259, 0.0138790188357234, -0.02259966917335987, -0.02643953077495098, 0.0035998704843223095, -0.006239775568246841, -0.021234897896647453, 0.02113080583512783, -0.0037386605981737375, -0.014006243087351322, 0.007760684471577406, 0.02523668110370636, -0.012271365150809288, -0.007650808896869421, 0.010420829989016056, -0.00544173177331686, -0.011299834586679935, -0.029793625697493553, -0.006864331196993589, -0.007546716369688511, -0.04230787605047226, 0.039485808461904526, -0.030094338580965996, 3.80859783035703e-05, -0.024612126871943474, 0.010947075672447681, -0.021489346399903297, -0.02997867949306965, -0.003533366834744811, -0.0030476010870188475, -0.006979989819228649, 0.043834567070007324, -0.01829717308282852, 0.005519801285117865, -0.012444852851331234, 0.006268689874559641, 0.0007785261841490865, -0.01300001423805952, 0.04445912316441536, 0.012467985041439533, 0.013208199292421341, -0.01577581837773323, -0.029354123398661613, 0.001977760111913085, -0.025930633768439293, 0.007905257865786552, -0.00040625044493936, 0.024935970082879066, 0.007309616543352604, 0.006951075047254562, 0.00017330700939055532, 0.005759792868047953, -0.03502139076590538, 0.002518463646993041, -0.04561570659279823, 0.00758719677105546, 0.004490440711379051, 0.037010714411735535, 0.02521355077624321, -0.030048074200749397, 0.033957332372665405, -0.04605520889163017, 0.0025285836309194565, 0.0030967560596764088, 0.022322088479995728, -0.007246004417538643, 0.009894583374261856, 0.004585858900099993, 0.03034878708422184, -0.022738458588719368, 0.028937753289937973, -0.00523354671895504, -0.010507573373615742, -0.005071624647825956, -0.059587251394987106, -0.026624584570527077, 0.007234438322484493, 0.0035015607718378305, 0.012282931245863438, -0.002340638544410467, 0.024912837892770767, -0.04880788177251816, 0.0013474214356392622, 0.03710324317216873, -0.038676198571920395, 0.02912280708551407, -0.014850549399852753, 0.0009520139428786933, 0.00630917027592659, -0.0041868374682962894, 0.003383010858669877, 0.024635257199406624, -0.005285592749714851, -0.008153923787176609, -0.03943954408168793, 0.01988169364631176, -0.021917283535003662, -0.0020673954859375954, 0.012502682395279408, 0.06680434197187424, -0.010438178665935993, -0.04661037027835846, 0.01768418215215206, -0.04112815856933594, 0.024866575375199318, 0.018054289743304253, 0.03298579901456833, -0.008552945218980312, 0.016469769179821014, 0.03430430591106415, 0.002900136634707451, -0.02093418687582016, -0.03330964595079422, 0.013381686992943287, 0.006008458323776722, -0.025884369388222694, 0.06305700540542603, 0.008252233266830444, 0.05653386935591698, 0.006118333898484707, -0.015139696188271046, 0.020379025489091873, -0.029400387778878212, -0.000677325006108731, 0.008894138038158417, 0.04006410017609596, -0.00545329786837101, -0.008836308494210243, -0.007870560511946678, 0.008084528148174286, 0.011623677797615528, 0.02014770917594433, 0.015047169290482998, -0.002761346288025379, -0.02602315880358219, 0.04667976498603821, 0.02433454617857933, -0.03490573167800903, -0.027480456978082657, 0.0013206753646954894, 0.024172624573111534, 0.028058748692274094, 0.03321711719036102, -0.019326534122228622, -0.02909967489540577, -0.02117706835269928, -0.0014269365929067135, 0.013821189291775227, 0.003458188846707344, 0.014804285950958729, -0.018713543191552162, 0.00928159337490797, 0.011207307688891888, -0.008859439752995968, -0.02203294262290001, 0.021847888827323914, 0.02734166570007801, 0.008836308494210243, -0.027480456978082657, 0.02012457698583603, -0.013023145496845245, 0.027064086869359016, 0.006384348496794701, 0.04242353141307831, 0.03215305879712105, -0.019106782972812653, -0.0003055914130527526, 0.0030447097960859537, -0.015579198487102985, -0.0067949360236525536, 0.0069684237241744995, 0.005933280568569899, -0.015544501133263111, 0.014133467338979244, 0.00385142769664526, -0.054035644978284836, -0.010935509577393532, 0.026601452380418777, 0.026185082271695137, 0.004296713043004274, -0.007506235968321562, 0.02435767836868763, 0.0079977847635746, -0.002813392784446478, 0.035715341567993164, -0.038699328899383545, 0.04866909235715866, -0.023166395723819733, -0.02291194722056389, -0.02523668110370636, 0.057042766362428665, -0.01016059797257185, 0.011242005042731762, -0.040804315358400345, -0.003941062837839127, -0.028428856283426285, 0.013208199292421341, 0.04325627535581589, -0.04698047786951065, -0.06361217051744461, -0.01770731434226036, -0.03291640430688858, 0.016550729051232338, 0.02516728639602661, 0.00620507774874568, -0.0056932889856398106, 0.025051629170775414, -0.020379025489091873, -0.016550729051232338, -0.005274027120321989, 0.014399481937289238, -0.002207631478086114, 0.018794504925608635, -0.029793625697493553, 0.0033569876104593277, -0.034396834671497345, 0.009784707799553871, 0.03541462868452072, -0.036177974194288254, -0.0007076853653416038, -0.007801164872944355, -0.013011579401791096, -0.006158814299851656, 0.019500020891427994, -0.006800719071179628, -0.051028523594141006, -0.005878342781215906, -0.018725108355283737, -0.03962459787726402, 0.0020211320370435715, 0.011924389749765396, 0.005901474505662918, 0.018447529524564743, 0.033101458102464676, 0.03465128317475319, 0.005482212174683809, 0.012676170095801353, -0.002554606879130006, 0.010576969012618065, -0.018181513994932175, 0.012144140899181366, -0.027503589168190956, 0.056256286799907684, -0.006199295166879892, 0.023733122274279594, 0.013532043434679508, -0.026740241795778275, -0.032176192849874496, -0.012537379749119282, -0.01829717308282852, 0.006563619244843721, -0.0008023807313293219, 0.014850549399852753, 0.0032702437601983547, 0.006974206771701574, 0.04300182685256004, 0.04556944593787193, 0.053202904760837555, 0.005123671144247055, -0.007749118842184544, 0.05176873877644539, -0.020136142149567604, 0.003845644649118185, 0.01704806089401245, 0.006546270567923784, 0.04105876386165619, 0.029284728690981865, 0.012236667796969414, 0.03330964595079422, -0.016180623322725296, 0.018158381804823875, 0.021489346399903297, 0.033101458102464676, 0.023848779499530792, 0.044690441340208054, -0.0025893044658005238, 0.013404818251729012, 0.020864790305495262, -0.01907208375632763, -0.010715758427977562, -0.00567304901778698, 0.01768418215215206, 0.034373704344034195, 0.018597884103655815, -0.026393266394734383, 0.04839150980114937, 0.05297158658504486, 0.004513572435826063, -0.01407563779503107, -0.013312292285263538, 0.002863993402570486, 0.026786506175994873, 0.01349734514951706, -0.01650446653366089, -0.003591196145862341, -0.014133467338979244, 0.010548054240643978, -0.02115393802523613, 0.007766467519104481, -0.002064503962174058, -0.006835416425019503, -0.036524951457977295, 0.0005161259905435145, 0.00884209107607603, 0.010617448948323727, 0.014133467338979244, 0.02365216054022312, 0.013983110897243023, 0.0014580198330804706, 0.020506249740719795, -0.011496453545987606, -0.016492899507284164, 0.0010662266286090016, -0.03280074521899223, -0.0321299284696579, 0.040411073714494705, -0.021026713773608208, 0.024172624573111534, -0.020217103883624077, 0.023594330996274948, 0.012317628599703312, -0.016516031697392464, 0.004169488325715065, -0.018401265144348145, -0.01619218848645687, 0.005467754788696766, 0.02284255065023899, 0.007783816196024418, 0.04577763006091118, 0.008258015848696232, -0.02731853537261486, -0.028752699494361877, 0.010415046475827694, 0.013624569401144981, -0.011213090270757675, 0.0010373120894655585, 0.011479104869067669, 0.008610774762928486, -0.0041637057438492775, -0.008038264699280262, 0.009495561942458153, 0.014017808251082897, 0.025745579972863197, -0.02817440778017044, 0.02729540318250656, -0.02088792249560356, -0.00632073637098074, -0.021628137677907944, 0.00529426708817482, 0.032268717885017395, 0.03960146754980087, -0.03983278200030327, 0.009582305327057838, 0.019153045490384102, 0.025398604571819305, -0.020263366401195526, -0.013613004237413406, -0.011924389749765396, -0.021882586181163788, -0.025745579972863197, 0.0034495145082473755, -0.023629028350114822, 0.0009014133247546852, -0.004475983325392008, 0.004600316286087036, -0.009634352289140224, 0.010426612570881844, -0.012063180096447468, -0.04954809695482254, -0.00783586222678423, 0.026323871687054634, 0.009177501313388348, -0.002408588072285056, -0.0006039541913196445, 0.0009599654586054385, 0.039971575140953064, 0.007425274699926376, 0.037427086383104324, 0.00021667894907295704, -0.020182406529784203, -0.0321299284696579, 0.0057164207100868225, -0.0022220886312425137, -0.013485779985785484, 0.001487657311372459, -0.018331870436668396, 0.01751069538295269, 0.023825649172067642, -0.040457338094711304, -0.013902150094509125, 0.008946184068918228, -0.03240750730037689, -0.011085866019129753, -0.008986664935946465, 0.016180623322725296, 0.013948413543403149, 0.03536836430430412, -0.02986302226781845, -0.013948413543403149, -0.032685089856386185, 0.011745119467377663, 0.003935280255973339, -0.0009657483897171915, -0.017892368137836456, -0.011484887450933456, 0.0017912607872858644, -0.012757130898535252, -0.038629934191703796, 0.005204631946980953, 0.023709990084171295, -0.0298861525952816, 0.0019242680864408612, 0.035692207515239716, -0.030626367777585983, 0.02983989007771015, -0.039925310760736465, 0.016446636989712715, -0.017279377207159996, -0.015833646059036255, -0.024519599974155426, -0.037450216710567474, 0.005360770970582962, -0.002939171390607953, -0.024496467784047127, -0.0022336544934660196, 0.016712650656700134, -0.0001939086796483025, 0.024218887090682983, 0.011479104869067669, 0.018077421933412552, 0.040850576013326645, 0.06948761641979218, 0.005250895395874977, -0.00036450495827011764, 0.018794504925608635, -0.002300158143043518, -0.007980436086654663, -0.0003043263859581202, 0.011698856018483639, -0.0020934187341481447, -0.010866114869713783, -0.02782743237912655, 0.039092570543289185, 0.018621016293764114, 0.009194849990308285, 0.0017247572541236877, 0.015024037100374699, 0.03576160594820976, -0.005039818584918976, 0.007037818897515535, -0.010542270727455616, 0.03347156569361687, 0.04263171926140785, -0.006569402292370796, -0.005363662261515856, 0.0014594655949622393, -0.013682398945093155, 0.0256993155926466, -0.014711759984493256, 0.037866588681936264, 0.029215333983302116, 0.010842983610928059, -0.02734166570007801, 0.00443839468061924, 0.019210875034332275, -0.048067666590213776, 0.006465309299528599, 0.017036495730280876, -0.012699302285909653, -0.009738444350659847, 0.030927078798413277, 0.035645946860313416, 0.01902582123875618, -0.003463971661403775, -0.017938630655407906, 0.0013011579867452383, 0.014237559400498867, 0.028012486174702644, -0.002172933891415596, -0.007101431023329496, -0.017325641587376595, -0.01645820215344429, 0.01327759400010109, 0.010229993611574173, -0.0009122563060373068, 0.0072286552749574184, -0.031042737886309624, 0.02482031099498272, 0.04661037027835846, -0.0031343449372798204, 0.03800537809729576, -0.016596993431448936, -0.013890583999454975, 0.004984880797564983, 0.025930633768439293, -0.008899920620024204, -0.044227804988622665, 0.009877234697341919, -0.014179730787873268, -0.03497512638568878, 0.043325670063495636, -0.029724230989813805, -0.010582751594483852, -0.0016076529864221811, -0.013381686992943287, -0.014607666991651058, 0.021581873297691345, -0.002006674651056528, -0.016782047227025032, 0.03034878708422184, 0.022750023752450943, 0.017152152955532074, -0.027572983875870705, -0.023397712036967278, 0.026740241795778275, -0.03377227857708931, -0.03250003606081009, 0.02521355077624321, 0.025444867089390755, -0.03798224776983261, 0.018470659852027893, 0.023490238934755325, 0.00221919734030962, 0.0032181974966078997, 0.009287376888096333, -0.015810515731573105, -0.0013748903293162584, -0.004016241058707237, -0.011525368317961693, -0.039555203169584274, -0.008182837627828121, 0.024681521579623222, 0.008327411487698555, -0.01197065319865942, 0.0016105443937703967, 0.017348773777484894, -0.010975990444421768, 0.00379359838552773, 0.008460418321192265, -0.00843728706240654, 0.028960885480046272, -0.009651700966060162, 0.007153477519750595, 0.015151262283325195, -0.007112997118383646, 0.00819440372288227, -0.017013363540172577, -0.03129718825221062, 0.001862101606093347, -0.056626394391059875, -7.612678018631414e-05, -0.001117550185881555, -0.027503589168190956, -0.006997338496148586, -0.005626785568892956, 0.013138804584741592, 0.025930633768439293, 0.035738471895456314, -0.0342349112033844, 0.01008541975170374, 0.008477766998112202, 0.001144296140410006, -0.006685060448944569, 0.01860945113003254, -0.013289160095155239, 0.008969315327703953, 0.015556066296994686, -0.013462647795677185, -0.007072516717016697, -0.016342544928193092, 0.0027642378117889166, -0.014827418141067028, 0.03391106799244881, -0.012248233892023563, -0.022044507786631584, 0.007529367692768574, -0.004768020939081907, 0.021489346399903297, 0.02220642939209938, 0.017846103757619858, 0.02907654456794262, -0.021049844101071358, -0.0256993155926466, -0.0038022727239876986, 0.0469110831618309, 0.0003776972589548677, -0.06541644036769867, 0.011201524175703526, -0.012282931245863438, -0.028914621099829674, -0.002641350729390979, 0.02117706835269928, -0.005618111230432987, 0.013971545733511448, 0.00039215455763041973, 0.003400359535589814, 0.030603235587477684, -0.016469769179821014, 0.007569848094135523, -0.008836308494210243, -0.004345867782831192, 0.036918189376592636, -0.009958195500075817, 0.017256246879696846, 0.016770480200648308, 0.018713543191552162, -0.019870128482580185, -0.0027642378117889166, -0.010727324523031712, -0.0026847226545214653, -0.0056932889856398106, -0.037010714411735535, -0.007760684471577406, 0.007616111543029547, -0.004475983325392008, -0.0059564122930169106, -0.014191296882927418, -0.023536501452326775, -0.02205607295036316, -0.0058928001672029495, -0.02946978248655796, 0.025861237198114395, -0.05042710155248642, 0.0009809285402297974, -0.009761576540768147, -0.0028379701543599367, 0.022148599848151207, 0.0015989786479622126, -0.03587726131081581, 0.028359461575746536, 0.02194041572511196, 0.00813079159706831, 0.017129022628068924, -0.05607123300433159, -0.002334855729714036, 0.010172164067626, 0.034049857407808304, -0.0017955980729311705, 0.009570740163326263, -0.00551401823759079, -0.013832755386829376, -0.009264244697988033, 0.010576969012618065, 0.007656591944396496, -0.020089879631996155, 0.026647714897990227, -0.009784707799553871, -0.010964424349367619, -0.0011912824120372534, 0.019962655380368233, -0.01540571078658104, -0.006575184874236584, -0.009050277061760426, 0.0038832337595522404, -0.03243064135313034, -0.004516463726758957, -0.007217089645564556, 0.005357879213988781, -0.004053830169141293, -0.02690216340124607, -0.016539163887500763, 0.06356590241193771, -0.00396708631888032, 0.005349204875528812, -0.012121009640395641, 0.03277761489152908, -0.005638351198285818, -0.0191993098706007, -0.04654097557067871, 0.03583100065588951, 0.005722203757613897, 0.011207307688891888, 0.04619399830698967, -0.031389713287353516, 0.01257207803428173, 0.00533763924613595, -0.015937739983201027, 0.039555203169584274, 0.0045511615462601185, -0.031112132593989372, -0.0065404875203967094, 0.024565862491726875, 0.0035160179249942303, -0.02868330478668213, -0.042122822254896164, 0.008049830794334412, 0.0008826188277453184, 0.0077953822910785675, -0.03192174434661865, 0.0004304664325900376, 0.010021807625889778, -0.02600002847611904, 0.010033373720943928, -0.006783370394259691, -0.011270919814705849, 0.0341886505484581, 0.022923512384295464, -0.0054793208837509155, -0.021605005487799644, -0.06717444956302643, 0.00857029389590025, 0.017938630655407906, -0.0014023591065779328, -0.00530583318322897, 0.02817440778017044, -0.0013907933607697487, 0.03562281280755997, 0.009836754761636257, -0.053202904760837555, 0.00248521170578897, -0.013971545733511448, -0.002848090371116996, 0.014919945038855076, -0.006511572748422623, -0.0026080987881869078, -0.027642378583550453, 0.02866017259657383, -0.0012129683746024966, 0.030071206390857697, 0.03546089306473732, -0.004048047121614218, 0.013948413543403149, -0.00018975220154970884, 0.036571212112903595, -0.0727260559797287, 0.007679723668843508, -0.008408372290432453, 0.025421734899282455, -0.021269595250487328, -0.029238466173410416, -0.04140573740005493, -0.0191761776804924, -0.027665510773658752, 0.026693979278206825, -0.004608990624547005, -0.013902150094509125, 0.0005732323625124991, 0.004857656545937061, 0.0006610605632886291, -0.02685590088367462, 0.01726781204342842, 0.024542730301618576, -0.013242896646261215, 0.004062504507601261, -0.02047155238687992, 0.0062166438437998295, 0.010860332287847996, -0.007112997118383646, -0.010715758427977562, -0.02912280708551407, -0.0004720312135759741, 0.007523584645241499, 0.011051168665289879, 0.004166597034782171, -0.00033053028164431453, 0.038629934191703796, -0.007592979818582535, -0.05056589096784592, 0.03030252456665039, 0.02100358158349991, 0.0037039630115032196, -0.0018592101987451315, 0.015371013432741165, 0.04478296637535095, -0.003073624335229397, 0.008784262463450432, 0.01907208375632763, 0.014029374346137047, 0.011317183263599873, 0.04448225349187851, 0.0011168272467330098, -0.02729540318250656, -0.02606942318379879, 0.023224223405122757, -0.0341423861682415, 0.0031198877841234207, 0.025514261797070503, 0.005476429592818022, -0.03893064707517624, -0.0028379701543599367, -0.00034787904587574303, -0.009414601139724255, 0.055469810962677, 0.022090770304203033, 0.007858994416892529, 0.012155706994235516, 0.010634797625243664, -0.00899823009967804, 0.012306063435971737, -0.03210679441690445, 0.017371904104948044, -0.004886571317911148, 0.0008515355875715613, 0.000496970082167536, 0.012930618599057198, -0.02279628813266754, 0.009229547344148159, 0.01452670618891716, 0.008367891423404217, 0.010351434350013733, -0.025005364790558815, 0.00770285539329052, -0.0007546716369688511, 0.02440394088625908, -0.017013363540172577, -0.010785154066979885, -0.030626367777585983, -0.023432409390807152, -0.02736479789018631, -0.00022842551697976887, -0.044204674661159515, 0.010900812223553658, -0.04399649053812027, -0.0016409048112109303, 0.0018172840354964137, 0.012051614001393318, -0.01951158605515957, -0.0011334532173350453, 0.0008724987274035811, -0.008471984416246414]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-15T11:17:10.755659", "url_path": "/api/agent/", "chunk_size": 4364}
updated_dt: 2025-03-15T11:17:10.755659
---
```python
    from pydantic_ai import Agent
    from pydantic_graph import End
    agent = Agent('openai:gpt-4o')
    async def main():
      async with agent.iter('What is the capital of France?') as agent_run:
        next_node = agent_run.next_node # start with the first node
        nodes = [next_node]
        while not isinstance(next_node, End):
          next_node = await agent_run.next(next_node)
          nodes.append(next_node)
        # Once `next_node` is an End, we've finished:
        print(nodes)
        '''
        [
          UserPromptNode(
            user_prompt='What is the capital of France?',
            system_prompts=(),
            system_prompt_functions=[],
            system_prompt_dynamic_functions={},
          ),
          ModelRequestNode(
            request=ModelRequest(
              parts=[
                UserPromptPart(
                  content='What is the capital of France?',
                  timestamp=datetime.datetime(...),
                  part_kind='user-prompt',
                )
              ],
              kind='request',
            )
          ),
          CallToolsNode(
            model_response=ModelResponse(
              parts=[TextPart(content='Paris', part_kind='text')],
              model_name='gpt-4o',
              timestamp=datetime.datetime(...),
              kind='response',
            )
          ),
          End(data=FinalResult(data='Paris', tool_name=None, tool_call_id=None)),
        ]
        '''
        print('Final result:', agent_run.result.data)
        #> Final result: Paris
```
    Args:
      node: The node to run next in the graph.
    Returns:
      The next node returned by the graph logic, or an [`End`][pydantic_graph.nodes.End] node if
      the run has completed.
    """
    # Note: It might be nice to expose a synchronous interface for iteration, but we shouldn't do it
    # on this class, or else IDEs won't warn you if you accidentally use `for` instead of `async for` to iterate.
    next_node = await self._graph_run.next(node)
    if _agent_graph.is_agent_node(next_node):
      return next_node
    assert isinstance(next_node, End), f'Unexpected node type: {type(next_node)}'
    return next_node
  defusage(self) -> _usage.Usage:
"""Get usage statistics for the run so far, including token usage, model requests, and so on."""
    return self._graph_run.state.usage
  def__repr__(self) -> str:
    result = self._graph_run.result
    result_repr = '<run not finished>' if result is None else repr(result.output)
    return f'<{type(self).__name__} result={result_repr} usage={self.usage()}>'

```
  
---|---  
####  ctx `property`
```
ctx: GraphRunContext[](https://ai.pydantic.dev/api/pydantic_graph/nodes/#pydantic_graph.nodes.GraphRunContext "pydantic_graph.GraphRunContext")[
  GraphAgentState, GraphAgentDeps[AgentDepsT[](https://ai.pydantic.dev/api/tools/#pydantic_ai.tools.AgentDepsT "pydantic_ai.tools.AgentDepsT"), Any[](https://docs.python.org/3/library/typing.html#typing.Any "typing.Any")]
]

```

The current context of the agent run.
####  next_node `property`
```
next_node: (
  AgentNode[AgentDepsT[](https://ai.pydantic.dev/api/tools/#pydantic_ai.tools.AgentDepsT "pydantic_ai.tools.AgentDepsT"), ResultDataT[](https://ai.pydantic.dev/api/result/#pydantic_ai.result.ResultDataT "pydantic_ai.result.ResultDataT")]
  | End[](https://ai.pydantic.dev/api/pydantic_graph/nodes/#pydantic_graph.nodes.End "pydantic_graph.End")[FinalResult[ResultDataT[](https://ai.pydantic.dev/api/result/#pydantic_ai.result.ResultDataT "pydantic_ai.result.ResultDataT")]]
)

```

The next node that will be run in the agent graph.
This is the next node that will be used during async iteration, or if a node is not passed to `self.next(...)`.
####  result `property`
```
result: AgentRunResult[](https://ai.pydantic.dev/api/agent/#pydantic_ai.agent.AgentRunResult "pydantic_ai.agent.AgentRunResult")[ResultDataT[](https://ai.pydantic.dev/api/result/#pydantic_ai.result.ResultDataT "pydantic_ai.result.ResultDataT")] | None

```

The final result of the run if it has ended, otherwise `None`.
Once the run returns an [`End`](https://ai.pydantic.dev/api/pydantic_graph/nodes/#pydantic_graph.nodes.End) node, `result` is populated with an [`AgentRunResult`](https://ai.pydantic.dev/api/agent/#pydantic_ai.agent.AgentRunResult).
####  __aiter__