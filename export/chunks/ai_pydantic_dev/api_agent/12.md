---
url: https://ai.pydantic.dev/api/agent/
session_id: pydantic_ai_docs
chunk_number: 12
title: Context Manager for Overriding Agent Dependencies and Models
summary: This section describes a context manager that allows temporary overriding of agent dependencies and models, useful for testing purposes. It details the parameters `deps` and `model`, which enable substitution of the defaults during an agent run.
embedding: [0.003129534889012575, 0.04331320896744728, -0.03808804973959923, -0.024569349363446236, -0.06336890906095505, 0.04575902596116066, 0.021467609331011772, 0.04435823857784271, 0.025436503812670708, -0.0033546611666679382, -0.006159013602882624, 0.008721563033759594, 0.011639868840575218, -0.03988906368613243, -0.003640933195129037, -0.005953342653810978, -0.03962224721908569, 0.007098429836332798, 0.012873894535005093, 0.02512521855533123, 0.0102724339812994, 0.030172497034072876, 0.0001874316221801564, 0.03204021230340004, -0.008838295936584473, 0.028215842321515083, -0.05154004693031311, 0.0759982243180275, 0.0018802223494276404, -0.007915555499494076, 0.048827413469552994, -0.006987256463617086, -0.032440435141325, -0.00770988455042243, 0.011795511469244957, 0.011617633514106274, 0.010139025747776031, 0.031395405530929565, -0.01259596087038517, 0.03448602929711342, 0.004138434771448374, -0.03819922357797623, 0.01194003690034151, 0.02285727858543396, -0.011084000580012798, 0.0319957435131073, 0.0059088729321956635, 0.04449164867401123, 0.0264370646327734, -0.0040689511224627495, -0.06403595209121704, 0.00713178189471364, -0.0019747198093682528, 0.024547114968299866, -0.006664853077381849, -0.022512640804052353, -0.01609792746603489, -0.009838857688009739, -0.007815498858690262, -0.029149699956178665, 0.049805741757154465, -0.025725554674863815, -0.037043020129203796, 0.06047840043902397, -0.016264688223600388, 0.008882764726877213, -0.041934654116630554, 0.042779576033353806, -0.041845716536045074, 0.005369681399315596, 0.041779011487960815, 0.016898376867175102, -0.046381596475839615, -0.038310397416353226, -0.04776014760136604, 0.025903431698679924, 0.07888873666524887, 0.0757758766412735, 0.08017835021018982, 0.02172330766916275, -0.002191508188843727, -0.022512640804052353, -0.019699949771165848, 0.0227905735373497, -0.0436689630150795, -0.04144549369812012, -0.06074521690607071, 0.00916069932281971, 0.008154578506946564, -0.014585967175662518, 0.02975003607571125, 0.034775082021951675, -0.02184559963643551, 0.04431376978754997, 0.06279081106185913, 0.018754974007606506, -0.04222370684146881, -0.027882320806384087, 0.007087312638759613, 0.032551608979701996, 0.023591022938489914, -0.03677620366215706, -0.08142349123954773, -0.024858402088284492, 0.03570893779397011, 0.032418202608823776, -0.02191230282187462, 0.0036186983343213797, -0.032551608979701996, -0.016531504690647125, -0.018621565774083138, 0.025658851489424706, -0.005366902332752943, 0.0002553517115302384, -0.07195150852203369, -0.02057822048664093, -0.0003262248355895281, -0.031128589063882828, 0.0008518671966157854, -0.045225393027067184, -0.038354866206645966, -0.007204044610261917, 0.016631560400128365, -0.0050861891359090805, 0.002495845779776573, -0.024235829710960388, -0.05278519168496132, -0.03662056103348732, -0.023390911519527435, -0.03664279729127884, 0.007998935878276825, -0.03339652717113495, -0.004938884172588587, -0.002070606919005513, -0.025925667956471443, -0.015608763322234154, -0.05465290695428848, -0.015175187028944492, -0.009599834680557251, 0.04669288173317909, -0.015030661597847939, 0.007821057923138142, -0.013841104693710804, 0.011617633514106274, 0.008404718711972237, 0.031306467950344086, -0.0454699732363224, 0.013785517774522305, -0.07350793480873108, 0.052029211074113846, 0.01194003690034151, 0.01592005044221878, 0.0031184174586087465, -0.010011176578700542, -0.0024888974148780107, 0.0051556723192334175, -0.012006741017103195, -0.008226841688156128, 0.0437801368534565, -0.053274355828762054, -0.012773838825523853, 0.031350936740636826, -0.00860483106225729, -0.02848265878856182, -0.018043464049696922, -0.034708376973867416, 0.015086248517036438, -0.002040034392848611, -0.01486390084028244, 0.024724993854761124, 0.025436503812670708, -0.001420241896994412, -0.012406965717673302, 0.015675468370318413, 0.03419697657227516, -0.0075486828573048115, -0.07368581742048264, -0.029372047632932663, -0.019733302295207977, 0.004722095560282469, 0.03762112185359001, 0.016364743933081627, -0.021189674735069275, -0.028349250555038452, -0.017810000106692314, -0.008399160578846931, 0.01424132939428091, 0.01314071100205183, 0.010450311936438084, 0.038532745093107224, 0.04251275956630707, 0.055453356355428696, 0.0505172535777092, -0.007509772200137377, -0.016320275142788887, -0.007370804902166128, 0.02171219140291214, -0.012351378798484802, 0.039644479751586914, -0.025881197303533554, -0.03095071017742157, 0.013318588957190514, 0.01434138510376215, -0.005667070858180523, 0.02266828343272209, -0.007076195441186428, -0.004394133575260639, 0.016231335699558258, -0.02861606702208519, 0.012229088693857193, 0.00630909763276577, -0.04727098345756531, 0.03528647869825363, 0.015475355088710785, -0.024347003549337387, -0.0005923464777879417, 0.004674846772104502, -0.010528133250772953, -0.00054266577353701, 0.023324206471443176, 0.01249590516090393, 0.031195292249321938, 0.016676029190421104, -0.061234381049871445, -0.008849413134157658, 0.04584796354174614, -0.07119552791118622, 9.006792970467359e-05, 0.0014077348168939352, 0.07026167213916779, 0.006120102945715189, -0.0250362791121006, -0.030172497034072876, 0.008338014595210552, 0.006826054770499468, -0.017876703292131424, -0.019699949771165848, 0.0013264392036944628, 0.025970136746764183, -0.04473622888326645, -0.0009074539411813021, 0.011517577804625034, 0.03855498135089874, -0.00178294547367841, 0.031239762902259827, 0.06314656883478165, -0.012996185570955276, -0.010778273455798626, -0.0060533988289535046, -0.007020608521997929, 0.0319957435131073, -0.00042419650708325207, -0.03464167192578316, -0.01439697202295065, -0.019933413714170456, 0.003493628231808543, 0.013918926008045673, 0.0044052512384951115, -0.023124095052480698, 0.008615948259830475, 0.011773277074098587, 0.01934419386088848, 0.015208538621664047, 0.014563732780516148, 0.046470534056425095, -0.005069512873888016, 0.023124095052480698, -0.024347003549337387, 0.041845716536045074, -0.01150646060705185, 0.05834386870265007, -0.03288513049483299, 0.009327459149062634, 0.0014438661746680737, -0.023524319753050804, -0.0024902871809899807, 0.017732178792357445, 0.08124561607837677, -0.01723189651966095, -0.008704887703061104, -0.05803258344531059, 0.013552052900195122, 0.02630365639925003, 0.019922297447919846, -0.03312971070408821, 0.024658288806676865, -0.024724993854761124, 0.022501522675156593, -0.0006590505945496261, 0.04106750339269638, -0.02843818999826908, -0.013474231585860252, 0.016687147319316864, -0.01309624221175909, 0.04137878865003586, -0.05816598981618881, -0.016664912924170494, 0.00241941399872303, 0.03301853686571121, -0.029216403141617775, 0.004833269398659468, 0.04117867723107338, -0.005063954275101423, -0.01724301464855671, 0.014830549247562885, -0.00806008093059063, -0.02184559963643551, -0.009266314096748829, 0.030617190524935722, -0.00918293371796608, -0.03235149756073952, 0.04927210882306099, -0.025436503812670708, 0.016965080052614212, 0.010161261074244976, -0.0339079275727272, 0.005775464698672295, -0.0008080925908870995, 0.046470534056425095, 0.01586446352303028, -0.03655385598540306, 0.028882883489131927, -0.004741550888866186, -0.018955087289214134, 0.030083557590842247, -0.013652109540998936, 0.020922858268022537, 0.03239596635103226, 0.005647615529596806, 0.03337429463863373, -0.016253570094704628, -0.008788267150521278, -0.01538641657680273, 0.0779104083776474, 0.03339652717113495, 0.0018649359699338675, 0.006770467851310968, 0.015564294531941414, 0.02743762731552124, 0.017754413187503815, -0.004349664319306612, -0.03172892704606056, -0.023190798237919807, -0.051895804703235626, 0.041601136326789856, 0.016887258738279343, 0.0007420832989737391, 0.013418644666671753, 0.02621471881866455, 0.03966671600937843, 0.010344697162508965, -0.0062868632376194, 0.011650986038148403, 0.0013521480141207576, -0.021022913977503777, 0.012040093541145325, -0.016509268432855606, 0.03628703951835632, -0.07968918979167938, -0.01025019958615303, -0.014908370561897755, 0.005077851004898548, -0.011573164723813534, -0.01716519333422184, -0.03226255998015404, -0.009410839527845383, -0.00026143150171265006, -0.011256320402026176, -0.0007511161384172738, 0.04100079834461212, 0.031106354668736458, 0.04340214654803276, -0.017554299905896187, -0.01202897634357214, -0.005528104025870562, -0.0027098548598587513, -0.031306467950344086, -0.028882883489131927, 0.03341876342892647, 0.02077833190560341, 0.053407762199640274, -0.0054919724352657795, -0.008721563033759594, 0.03908861428499222, 0.017843350768089294, 0.03219585493206978, 0.008048963733017445, -0.02988344430923462, -0.012451435439288616, 0.0170651376247406, 0.09783270955085754, -0.09134016931056976, 0.004788799677044153, 0.01722078025341034, -0.027015168219804764, 0.04237934947013855, -0.012418082915246487, -0.006136778742074966, 0.06425829976797104, 0.017776647582650185, 0.03326312080025673, 0.027837852016091347, -0.023435380309820175, 0.03908861428499222, 0.00978327076882124, -0.004599804989993572, 0.0036381538957357407, 0.002110907342284918, 0.0103836078196764, 0.020033469423651695, 0.07964471727609634, -0.03508636727929115, 0.035019662231206894, 0.015219656750559807, -0.011839981190860271, -0.03288513049483299, 0.015586528927087784, -0.042868513613939285, 0.04111197218298912, 0.0710621178150177, -0.027682209387421608, -0.029038526117801666, 0.021400904282927513, -0.016809437423944473, 0.008810502476990223, 0.039488837122917175, 0.019811123609542847, -0.04315756633877754, 0.005250169895589352, -0.0020303064957261086, 0.026036839932203293, -0.0075486828573048115, 0.04678182303905487, 0.023746665567159653, 0.003624257165938616, -0.01155092939734459, 0.013885573484003544, 0.013440879993140697, 0.040578339248895645, 0.0006340365507639945, 0.011139587499201298, -0.012851660139858723, 0.003429703414440155, 0.048427190631628036, -0.015764405950903893, 0.022457053884863853, -0.0023943998385220766, -0.002098400378599763, 0.025770023465156555, 0.021200792863965034, -0.011356376111507416, 2.6316858566133305e-05, -0.0341302752494812, 0.009655420668423176, -0.010778273455798626, 0.02846042439341545, 0.06843842566013336, 0.01325188484042883, 0.042801808565855026, 0.013563171029090881, 0.05411927402019501, 0.013285236433148384, -0.00745974387973547, 0.018065698444843292, -0.0155198248103261, 0.04106750339269638, -0.02403571642935276, 0.02645930089056492, -0.027081871405243874, 0.0477156788110733, 0.0460258424282074, -0.01439697202295065, 0.01941089890897274, 0.004685964435338974, 0.02732645347714424, -0.04918317124247551, -0.01424132939428091, 0.017787765711545944, 0.034775082021951675, -0.042868513613939285, 0.02975003607571125, -0.00803784653544426, 0.03897744044661522, 0.037065256386995316, -0.018076816573739052, -0.007415274623781443, 0.0004888161201961339, -0.04571455717086792, -0.03799911215901375, 0.04266840219497681, 0.05056172236800194, 0.009288548491895199, 0.013374175876379013, -0.008649300783872604, 0.06336890906095505, 0.0017204104224219918, 0.047359924763441086, 0.04242381826043129, -0.026081310585141182, -0.015630997717380524, -0.00023450666049029678, -0.0015355843352153897, -0.0010151532478630543, 0.019922297447919846, -0.00434132618829608, -0.013729930855333805, 0.008871647529304028, 0.020833918824791908, 0.026992933824658394, -0.018565978854894638, -0.07817722856998444, 0.001434138510376215, -0.021445374935865402, 0.040711745619773865, 0.018032345920801163, 0.002629254013299942, -0.009416397660970688, -0.012340261600911617, -0.002684840699657798, -0.012473669834434986, 0.025747789070010185, -0.026726117357611656, -0.009399722330272198, 0.01207344513386488, -0.017532065510749817, -0.0021678837947547436, -0.010005617514252663, -0.026948463171720505, 0.01199562381953001, 0.003287957049906254, -0.014886136166751385, -0.014663788489997387, 0.013807752169668674, 0.013896691612899303, 0.008193489164113998, -0.0022248602472245693, 0.015075130388140678, 0.02410242147743702, -0.010922799818217754, -0.00977771170437336, -0.018721623346209526, 0.006826054770499468, -0.022245824337005615, 0.005425268318504095, -0.022590462118387222, 0.00743195042014122, 0.03219585493206978, 0.04028928652405739, -1.3451563063426875e-05, -0.03306300938129425, 0.03530871495604515, -0.0068649654276669025, -0.007765471003949642, -0.020177995786070824, 0.026970697566866875, -0.011928919702768326, -0.04017811268568039, -0.0012778007658198476, 0.02881617844104767, -0.044180359691381454, -0.012084562331438065, -0.041823484003543854, 0.012662664987146854, 0.00573655404150486, -0.010394725017249584, 0.011028414592146873, 0.02183448150753975, 0.03986682742834091, -0.039399899542331696, 0.0010651813354343176, 0.017432009801268578, 0.027837852016091347, -0.034864019602537155, -0.022012358531355858, 0.01586446352303028, -0.035975754261016846, 0.032462671399116516, 0.004221814684569836, -0.00909955333918333, -0.015430886298418045, -0.001284054247662425, -0.011662103235721588, 0.024591585621237755, -0.023502083495259285, 0.005819934420287609, 0.030283669009804726, -0.034864019602537155, 0.04691522940993309, -0.0023485408164560795, -0.011256320402026176, -0.01821022480726242, 0.027993494644761086, 0.031328700482845306, 0.018688270822167397, -0.0432242676615715, 0.023613257333636284, 0.0038938529323786497, 0.00798225961625576, -0.013074006885290146, 0.005892197135835886, 0.028349250555038452, -0.002235977677628398, -0.006436947267502546, 0.018087932839989662, 0.010144584812223911, -0.007126223295927048, -0.014285799115896225, 0.03352993726730347, -0.02510298229753971, 0.022056829184293747, 0.0018329735612496734, 0.02650376968085766, -0.01943313330411911, -0.016164630651474, -0.034752845764160156, 0.01605345867574215, -0.014041217043995857, 0.01093391701579094, 0.04140102118253708, -0.01259596087038517, -0.0009915289701893926, 0.013040655292570591, -0.013385293073952198, 0.016776084899902344, 0.010150142945349216, -0.016942845657467842, 0.0030628307722508907, -0.009599834680557251, 0.01812128536403179, 0.05349670350551605, -0.016820555552840233, -0.006225717719644308, 0.017465362325310707, 0.02523639053106308, -0.033752284944057465, 0.005344667471945286, 0.015675468370318413, -0.02874947525560856, -0.0008393601747229695, -0.045069750398397446, 0.034975193440914154, 0.006097868084907532, 0.004371899180114269, -0.009249637834727764, 0.0171207245439291, 0.024969574064016342, 0.012818307615816593, 0.020289169624447823, 0.04664841294288635, -0.0148194320499897, -0.006803819909691811, -0.030683893710374832, -0.004480293486267328, -0.004205138888210058, 0.01597563549876213, 0.020255817100405693, 0.0012270777951925993, 0.00047561427345499396, -0.03179562836885452, 0.012996185570955276, -0.016887258738279343, 0.0034046892542392015, 0.00047491941950283945, -0.00137229822576046, -0.0016717719845473766, 0.02419136092066765, 0.016831671819090843, 0.015119600109755993, -0.013496466912329197, -0.004402471706271172, -0.02075609751045704, 0.028327016159892082, 0.021189674735069275, 0.046381596475839615, 0.0045942459255456924, -0.030239200219511986, 0.022212471812963486, -0.018099050968885422, -0.0339079275727272, 0.01489725336432457, -0.004441382363438606, -0.01607569307088852, 0.003563111647963524, 0.03090624138712883, 0.05451950058341026, -0.009260755032300949, 0.0054808552376925945, 0.024613820016384125, 0.02394677884876728, 0.022490404546260834, -0.005775464698672295, -0.036220334470272064, 0.02184559963643551, 0.0053835781291127205, 0.010617071762681007, 0.007587593514472246, 0.01699843257665634, -0.021289730444550514, -0.0014139882987365127, 0.010617071762681007, -0.005141775589436293, -0.0015328050358220935, -0.017587652429938316, 0.021245261654257774, 0.0037743414286524057, -0.018610449507832527, 0.0022721090354025364, 0.008960586972534657, 0.02988344430923462, -0.02977227233350277, -0.023190798237919807, 0.0006701679667457938, -0.04369119927287102, 0.004088406451046467, -0.032551608979701996, -0.011250761337578297, 0.036042459309101105, 0.0005579521530307829, 0.031684454530477524, -0.004383016377687454, -0.03212914988398552, 0.012940598651766777, -0.008260193280875683, 0.019922297447919846, 0.014597084373235703, -0.02414689026772976, 0.020100174471735954, 0.0182435754686594, -0.007170692551881075, 0.019711066037416458, 0.009260755032300949, -0.025525443255901337, -0.008716004900634289, -0.014930604957044125, -0.017898937687277794, -0.008199048228561878, -0.05607593059539795, -0.012451435439288616, -0.004032819997519255, 0.0013396410504356027, 0.002583394991233945, -0.0013160166563466191, -0.015108482912182808, 0.0014424765249714255, -0.002582005225121975, 0.00658703176304698, 0.01495284028351307, 0.037131957709789276, -0.01478607952594757, 0.02863830141723156, -0.054386090487241745, 0.005825493019074202, 0.013318588957190514, 0.015453120693564415, 0.0005464873975142837, 0.03808804973959923, 0.010594837367534637, 0.008471422828733921, -0.031195292249321938, 0.0051445551216602325, -0.011962272226810455, 0.01722078025341034, -0.0023221371229737997, 0.018699387088418007, -0.02954992465674877, 0.0025959019549191, -0.0096276281401515, -0.0045942459255456924, -0.040822919458150864, 0.01609792746603489, 0.005881079938262701, -0.01421909499913454, -0.03757665306329727, 0.012362496927380562, 0.029927914962172508, -0.030283669009804726, 0.015453120693564415, -0.0021261938381940126, 0.023546554148197174, -0.0008852192549966276, 0.020255817100405693, 0.033863458782434464, -0.030105791985988617, -0.012451435439288616, 0.02401348203420639, -0.01723189651966095, -0.012873894535005093, -0.02516968734562397, -0.03172892704606056, -0.039688948541879654, -0.03980012238025665, -0.023679962381720543, -0.002586174290627241, 0.028082434087991714, 0.024547114968299866, -0.005255728494375944, 0.034908488392829895, -0.05118429288268089, -0.03533094748854637, 0.01147310808300972, -0.01205121073871851, -0.009683214128017426, 0.02981674112379551, 0.007365246303379536, 0.010895006358623505, 0.012095680460333824, 0.01371881365776062, 0.031417638063430786, 0.03537541627883911, -0.04088962450623512, -0.03997800126671791, 0.030483782291412354, -0.029305342584848404, -0.0052751838229596615, 0.007604269310832024, 0.04242381826043129, -0.03286289423704147, -0.0251474529504776, -0.011895568110048771, -0.07026167213916779, 0.029438750818371773, 0.016420330852270126, -0.012662664987146854, -0.004877738654613495, -0.00800449401140213, 0.007748795207589865, -0.01718742772936821, -0.025992371141910553, -0.05914431810379028, -0.03308524191379547, -0.028082434087991714, -0.05145110934972763, 0.06172354519367218, 0.021156322211027145, 0.021534312516450882, 0.01207344513386488, 0.001510570291429758, 0.0272819846868515, 0.01937754638493061, -0.005058395676314831, 0.017565418034791946, 0.02388007380068302, -0.001028355211019516, -0.01022796519100666, 0.0091773746535182, -0.016431447118520737, -0.018877265974879265, 0.013963395729660988, 0.012718251906335354, -0.011028414592146873, 0.023390911519527435, 0.011895568110048771, 0.03986682742834091, -0.016398096457123756, 0.012262440286576748, 0.014085686765611172, 0.05718766525387764, 0.025903431698679924, -0.03326312080025673, 0.0432242676615715, 0.023346440866589546, -0.031106354668736458, -0.0015341946855187416, -0.013607639819383621, 0.0006819801055826247, 0.019900061190128326, -0.006475857924669981, -0.031373169273138046, 0.026792820543050766, -0.0031073002610355616, -0.010839419439435005, -0.03759888932108879, 0.009688773192465305, 0.016676029190421104, -0.0062868632376194, 0.03352993726730347, 0.02988344430923462, 0.07804381847381592, -0.010561485774815083, 0.006564796902239323, 0.017921173945069313, -0.022601578384637833, 0.012696017511188984, -0.03099518083035946, 0.013074006885290146, -0.020867271348834038, 0.02536979876458645, 0.004635936114937067, -0.022657165303826332, 0.02508074790239334, -0.003935542888939381, 0.020355872809886932, 0.033730048686265945, -0.0229017473757267, 0.04444717615842819, -0.013574288226664066, 0.010789391584694386, 0.03771006315946579, 0.026592709124088287, -0.018110167235136032, 0.006759350653737783, -0.029460985213518143, 0.007348570507019758, -0.029060760512948036, -0.013529818505048752, 0.03742101043462753, 0.02986120991408825, 0.02737092226743698, -0.006764909252524376, -0.05589805170893669, 0.027993494644761086, -0.03437485545873642, -0.029438750818371773, 0.04918317124247551, -0.046381596475839615, -0.016920611262321472, 0.02081168442964554, -0.01424132939428091, 0.017576534301042557, -0.006486975587904453, 0.0037548861000686884, -0.023368675261735916, -0.006192365661263466, -0.03284066170454025, -0.0318845696747303, -0.0068649654276669025, -0.002110907342284918, -0.007565358653664589, 0.022490404546260834, 0.007915555499494076, 0.017576534301042557, -0.016920611262321472, 0.023413145914673805, 0.032818425446748734, -0.02637036144733429, -0.0433354414999485, -0.030283669009804726, -0.005639277398586273, -0.012751603499054909, 0.034708376973867416, -0.017398657277226448, -0.04093409329652786, -0.025392035022377968, 0.04020034894347191, -0.016798321157693863, -0.007587593514472246, -0.015375299379229546, -0.027081871405243874, -0.010744921863079071, 0.0019274711376056075, 0.020177995786070824, -0.01199562381953001, 0.014085686765611172, -0.025436503812670708, -0.03328535333275795, -0.02528086118400097, -0.04124537855386734, -0.02625918760895729, 0.058788564056158066, 0.0034324827138334513, 0.014152390882372856, -0.00025952071882784367, -0.02405795268714428, 0.010155702009797096, 0.0068760826252400875, -0.020155761390924454, -0.01600898802280426, -0.014574849978089333, 0.0025000148452818394, 0.02181224711239338, -0.04246828705072403, 0.010416959412395954, 0.035064131021499634, 0.006981697864830494, -0.02416912466287613, 0.027237514033913612, 0.040467165410518646, 0.005088968202471733, 0.022623812779784203, -0.012862777337431908, -0.01842145435512066, 0.045314330607652664, 0.0056114839389920235, 0.04111197218298912, 0.03782123327255249, -0.047582272440195084, 0.012607078067958355, 0.02419136092066765, 0.023124095052480698, -0.03459720313549042, 0.03417474403977394, -0.04824931174516678, 0.02650376968085766, 0.02281280793249607, -0.011184057220816612, 0.026948463171720505, -0.008877206593751907, 0.019210785627365112, -0.0018274149624630809, 0.005316874012351036, -0.011272995732724667, -0.023724431172013283, 0.06545897573232651, 0.011739924550056458, -0.03864391893148422, -0.011650986038148403, 0.012684899382293224, -0.008738239295780659, 0.004894414450973272, 0.019977882504463196, -0.008988379500806332, 0.00910511240363121, -0.0013382514007389545, -0.0026195263490080833, -0.003835486713796854, -0.013785517774522305, 0.008921675384044647, -0.012918364256620407, -0.019966766238212585, 0.006664853077381849, 0.018810560926795006, -0.004908311180770397, 0.01549759041517973, -0.009277431294322014, 0.03328535333275795, 0.028971822932362556, 0.01613127999007702, -0.018955087289214134, -0.01027799304574728, -0.0013875846052542329, 0.02734868787229061, 0.012351378798484802, -0.01842145435512066, -0.016687147319316864, -0.01936642825603485, 0.0004353138501755893, 0.04426930099725723, -0.013896691612899303, 0.013829987496137619, -0.028104668483138084, 0.0007955855689942837, 0.02164548635482788, 0.02396901324391365, -0.011067325249314308, 0.027704443782567978, 0.0015578190796077251, -0.014608201570808887, -0.016509268432855606, 0.01374104805290699, 0.012529256753623486, -0.03090624138712883, -0.010439194738864899, 0.0030572721734642982, -0.001026965444907546, 1.8033128071692772e-05, -0.03192903846502304, -0.019755536690354347, 0.011684337630867958, -0.010528133250772953, -0.012284674681723118, 0.009994500316679478, -0.04391354322433472, -0.014196859672665596, 0.003854942275211215, 0.052029211074113846, 0.0010346086928620934, 0.0096276281401515, -0.015164069831371307, -0.010522575117647648, 0.03217361867427826, 0.02966109849512577, -0.02639259584248066, -0.02972780168056488, -0.021356435492634773, 0.00797670055180788, -0.04364672675728798, -0.03430815041065216, -0.016286922618746758, 0.01594228483736515, -0.03893297165632248, -0.004021702334284782, 0.039399899542331696, -0.037243131548166275, -0.011000621132552624, -0.01037804875522852, 0.004872180055826902, 0.022334761917591095, 0.004755447618663311, -0.019021790474653244, -0.005258508026599884, 0.011884449981153011, 0.025770023465156555, -0.02641483023762703, 0.007454185280948877, 0.024858402088284492, -0.014452558942139149, -0.002247094875201583, -0.021278614178299904, 0.01538641657680273, -0.019077377393841743, 0.02988344430923462, 0.023213032633066177, 0.0030934035312384367, -0.018699387088418007, -0.04435823857784271, 0.008693770505487919, -0.0034991868305951357, -0.048516128212213516, -0.003335205838084221, 0.0014925046125426888, 0.013240767642855644, 0.03679843991994858, 0.03106188401579857, -0.04375790059566498, 0.004466396756470203, -0.028415953740477562, 0.015130717307329178, -0.018054582178592682, 0.00398835027590394, 0.024502646178007126, -0.015597646124660969, 0.002247094875201583, -0.017509831115603447, -0.008449188433587551, 0.006003370508551598, 0.009171816520392895, -0.02276833914220333, 0.027193045243620872, 0.005063954275101423, -0.009460867382586002, 0.023791136220097542, -0.018721623346209526, 0.01716519333422184, -0.06639283150434494, 0.008354690857231617, 0.007809940725564957, -0.012996185570955276, -0.013574288226664066, -0.035064131021499634, 0.014497028663754463, 0.008104550652205944, -0.0052168178372085094, -0.008204606361687183, -0.011128470301628113, -0.01946648582816124, -0.0048694005236029625, 0.018654918298125267, 0.05918878689408302, 0.016164630651474, -0.010050087235867977, 0.016431447118520737, 0.01480831392109394, 0.01723189651966095, -0.011739924550056458, 0.0008643742185086012, -0.01267378218472004, -0.04802696406841278, 0.0010318292770534754, 0.046470534056425095, 0.012217970564961433, 0.00910511240363121, 0.02399124763906002, -0.008237958885729313, -0.0053252121433615685, -0.006553679704666138, 0.009327459149062634, -0.004577570129185915, 0.03517530485987663, 0.05727660283446312, -0.01309624221175909, -0.03982235863804817, 0.0016203542472794652, 0.036220334470272064, 0.010161261074244976, -0.020867271348834038, 0.027237514033913612, -0.010344697162508965, 0.0206004548817873, -0.02648153528571129, -0.01085609570145607, -0.011111794039607048, -0.06425829976797104, 0.011050648987293243, 0.031484343111515045, 0.004035599064081907, 0.0027862866409122944, 0.030016852542757988, -0.0206004548817873, -0.01958877593278885, -0.0015161290066316724, -0.02068939432501793, -0.02385783940553665, 0.01713184081017971, -0.016631560400128365, -0.03639821335673332, 0.012662664987146854, 0.003977233078330755, 0.013318588957190514, -0.02070051059126854, 0.03982235863804817, -0.013885573484003544, -0.005389136727899313, -0.04464729130268097, 0.005547559354454279, 0.01851039193570614, 0.019199669361114502, 0.03355216979980469, -0.009772153571248055, 0.026792820543050766, 0.0005173043464310467, 0.006042281165719032, -0.023146329447627068, 0.02745986171066761, -0.0034380413126200438, -0.013930043205618858, -0.04122314602136612, 0.07079530507326126, -0.031306467950344086, -0.023213032633066177, 0.003446379443630576, 0.017898937687277794, -0.013563171029090881, -0.004855503793805838, -0.007993376813828945, -0.027215279638767242, 0.026614943519234657, 0.014741609804332256, 0.023301972076296806, 0.0007386091165244579, -0.02623695321381092, 0.002098400378599763, -0.005853286478668451, -0.008215723559260368, 0.005177907180041075, 0.007215162273496389, -0.030328139662742615, 0.01020017173141241, 0.0286827702075243, 0.04004470631480217, -0.0005013231420889497, 0.015642115846276283, 0.024902870878577232, 0.04440270736813545, 0.009294107556343079, -0.010572602972388268, -0.016286922618746758, 0.02052263356745243, -0.0024680523201823235, 0.00301836128346622, 0.0028877323493361473, 0.010511456988751888, -0.03099518083035946, 0.029305342584848404, -0.019800005480647087, -0.00660926615819335, -0.027748912572860718, -7.882029603933915e-05, 0.011378610506653786, -0.00598669471219182, -0.013674343936145306, -0.009488660842180252, -0.014363620430231094, -0.014430324546992779, -0.010917240753769875, -0.003035037312656641, -0.02177889458835125, -0.021967889741063118, 0.004958339501172304, -0.020389225333929062, -0.0041189794428646564, 0.025636615231633186, 0.011306348256766796, 0.013340823352336884, 0.038176991045475006, -0.017487596720457077, -0.006392478011548519, 0.016409212723374367, -0.0039994679391384125, 0.02276833914220333, -0.02162325195968151, -0.033796753734350204, -0.024524880573153496, 0.008665977045893669, 0.0155198248103261, -0.009355252608656883, 0.0042940774001181126, -0.027837852016091347, -0.0207116287201643, 0.031684454530477524, -0.00972212478518486, -0.011762159876525402, -0.019055142998695374, 0.011061766184866428, 0.003279619151726365, -0.009455308318138123, -0.009972265921533108, 0.04226817563176155, 0.003918867092579603, -0.0075598000548779964, 0.007398598361760378, -0.04231264442205429, 0.009088436141610146, -0.0415344312787056, -0.0025903433561325073, -0.01702066697180271, -0.015286360867321491, -0.02401348203420639, -0.007937789894640446, -0.020355872809886932, 0.00396333634853363, -0.014752727933228016, 0.005603145807981491, 0.026726117357611656, 0.0364871509373188, -0.01613127999007702, 0.015819992870092392, -2.1062172891106457e-05, 0.017665473744273186, -0.03195127099752426, 0.015775524079799652, 0.000755980028770864, 0.023791136220097542, -0.0028793944511562586, 0.017843350768089294, -0.009616510011255741, 0.008949468843638897, -0.010678217746317387, 0.0036381538957357407, -0.034908488392829895, 0.0017092929920181632, -0.018532628193497658, 0.02053375169634819, -0.013885573484003544, -0.023368675261735916, 0.005781023763120174, -0.003713195910677314, -0.024435941129922867, -0.012951715849339962, -0.02505851350724697, -0.010694894008338451, -0.019266372546553612, 0.008627066388726234, 0.025503206998109818, -0.025770023465156555, -0.00401892326772213, 0.001525856670923531, 0.041912421584129333, -0.015130717307329178, -0.01952207274734974, 0.006570355501025915, -0.023568788543343544, 0.0037826793268322945, -0.007215162273496389, -0.012384731322526932, -0.00916069932281971, 0.045069750398397446, -0.02961662784218788, 0.005636497866362333, 0.01022796519100666, 0.011150704696774483, -0.056831907480955124, 0.017376422882080078, 0.024769462645053864, 0.039688948541879654, 0.032707251608371735, -0.02167883887887001, -0.037198662757873535, 0.004455279093235731, -0.011495343409478664, 0.024813931435346603, -0.02983897551894188, -0.005553117953240871, -0.0390663780272007, 0.058877501636743546, -0.0052751838229596615, -0.0023137989919632673, 0.015697702765464783, 0.0500725582242012, 0.024324769154191017, 0.019866710528731346, 0.006120102945715189, -0.02737092226743698, -0.0077321189455688, -0.04940551519393921, 0.006086750887334347, -0.003096182830631733, -0.0003731261531356722, -0.010583720169961452, 0.04651500657200813, -0.01607569307088852, -0.028349250555038452, -0.022501522675156593, 0.002265160670503974, 0.023457614704966545, -0.0017176310066133738, -0.005516986362636089, 0.01197338942438364, 0.001222908846102655, -0.002128973137587309, -0.008482540026307106, -0.012784956023097038, 0.01139528676867485, -0.054475028067827225, -0.0018746636342257261, -0.0031934597063809633, 0.004713757894933224, 0.03226255998015404, -0.012240205891430378, -0.0004568537406157702, 0.022646049037575722, 0.027860086411237717, -0.01832139864563942, 0.008960586972534657, -0.01199562381953001, -0.016475917771458626, -0.020000118762254715, -0.031173057854175568, 0.034819550812244415, 0.030506016686558723, -0.023591022938489914, 0.011406403966248035, -0.012973951175808907, 0.01201785821467638, 0.012395848520100117, -0.035931285470724106, -0.0049666776321828365, 0.009616510011255741, 0.03875509276986122, 0.02530309557914734, -0.032573845237493515, -0.02180112898349762, -0.018732739612460136, 0.00798225961625576, 0.016509268432855606, 0.03559776395559311, -0.0010082049993798137, -0.02056710235774517, 0.018043464049696922, -0.02761550433933735, -0.0008212944376282394, -0.06305762380361557, 0.019844474270939827, -0.016931729391217232, 0.0030934035312384367, -0.033707816153764725, -0.027926791459321976, -0.029327576979994774, -0.02050039917230606, 0.011984506621956825, 0.03161775320768356, 0.012318027205765247, 0.008982821367681026, -0.012462552636861801, 0.010194612666964531, 0.004983353428542614, -0.040556102991104126, 0.015608763322234154, -0.0006969190435484052, -0.017454244196414948, -5.259029057924636e-05, -0.00481381407007575, 0.016309157013893127, 0.04471399262547493, 0.008816060610115528, -0.007115106098353863, -0.011906685307621956, 0.02299068681895733, 0.026103544980287552, 0.023324206471443176, 0.02185671590268612, -0.020066821947693825, 0.04722651466727257, -0.015708819031715393, -0.00396333634853363, -0.011072883382439613, 0.011862215586006641, -0.031195292249321938, 0.013318588957190514, 0.00920516811311245, 0.010022293776273727, 0.03919978812336922, 0.0002734173904173076, 0.024280298501253128, 0.004424706567078829, 0.0062813046388328075, 0.04011141136288643, 0.01377440057694912, -0.02523639053106308, -0.017387541010975838, -0.014797196723520756, 0.03977788984775543, 0.006742674391716719, 0.015530942007899284, -0.005594808142632246, -0.021945655345916748, -0.0010992282768711448, -0.034775082021951675, -0.031484343111515045, 0.004855503793805838, 0.018866147845983505, -0.0230129212141037, -0.0006510599632747471, -0.021067384630441666, 0.014007864519953728, -1.8619395632413216e-05, -0.026948463171720505, 0.011962272226810455, -0.0003793796640820801, -0.035153068602085114, -0.00770988455042243, -0.004747109953314066, -0.005380799062550068, 0.032329261302948, 0.012740486301481724, -0.010394725017249584, 0.003426924115046859, 0.0069372281432151794, -0.01722078025341034, -0.005892197135835886, 0.018677152693271637, -0.04451388120651245, -0.05923325568437576, -0.022434817627072334, -0.029283108189702034, 0.02957215905189514, 0.014574849978089333, -0.02392454445362091, 0.012862777337431908, -0.012851660139858723, 0.02181224711239338, -0.0035130835603922606, -0.04148996248841286, 0.0031517695169895887, -0.014130155555903912, -0.008665977045893669, -0.046337127685546875]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-14T10:14:17.728354", "url_path": "/api/agent/", "chunk_size": 3760}
updated_dt: 2025-03-14T10:14:17.729896
---
)
        if not isinstance(next_node, _agent_graph.AgentNode):
          raise exceptions.AgentRunError('Should have produced a StreamedRunResult before getting here')
        node = cast(_agent_graph.AgentNode[Any, Any], next_node)
    if not yielded:
      raise exceptions.AgentRunError('Agent run finished without producing a final result')
  @contextmanager
  defoverride(
    self,
    *,
    deps: AgentDepsT | _utils.Unset = _utils.UNSET,
    model: models.Model | models.KnownModelName | _utils.Unset = _utils.UNSET,
  ) -> Iterator[None]:
"""Context manager to temporarily override agent dependencies and model.
    This is particularly useful when testing.
    You can find an example of this [here](../testing-evals.md#overriding-model-via-pytest-fixtures).
    Args:
      deps: The dependencies to use instead of the dependencies passed to the agent run.
      model: The model to use instead of the model passed to the agent run.
    """
    if _utils.is_set(deps):
      override_deps_before = self._override_deps
      self._override_deps = _utils.Some(deps)
    else:
      override_deps_before = _utils.UNSET
    # noinspection PyTypeChecker
    if _utils.is_set(model):
      override_model_before = self._override_model
      # noinspection PyTypeChecker
      self._override_model = _utils.Some(models.infer_model(model)) # pyright: ignore[reportArgumentType]
    else:
      override_model_before = _utils.UNSET
    try:
      yield
    finally:
      if _utils.is_set(override_deps_before):
        self._override_deps = override_deps_before
      if _utils.is_set(override_model_before):
        self._override_model = override_model_before
  @overload
  defsystem_prompt(
    self, func: Callable[[RunContext[AgentDepsT]], str], /
  ) -> Callable[[RunContext[AgentDepsT]], str]: ...
  @overload
  defsystem_prompt(
    self, func: Callable[[RunContext[AgentDepsT]], Awaitable[str]], /
  ) -> Callable[[RunContext[AgentDepsT]], Awaitable[str]]: ...
  @overload
  defsystem_prompt(self, func: Callable[[], str], /) -> Callable[[], str]: ...
  @overload
  defsystem_prompt(self, func: Callable[[], Awaitable[str]], /) -> Callable[[], Awaitable[str]]: ...
  @overload
  defsystem_prompt(
    self, /, *, dynamic: bool = False
  ) -> Callable[[_system_prompt.SystemPromptFunc[AgentDepsT]], _system_prompt.SystemPromptFunc[AgentDepsT]]: ...
  defsystem_prompt(
    self,
    func: _system_prompt.SystemPromptFunc[AgentDepsT] | None = None,
    /,
    *,
    dynamic: bool = False,
  ) -> (
    Callable[[_system_prompt.SystemPromptFunc[AgentDepsT]], _system_prompt.SystemPromptFunc[AgentDepsT]]
    | _system_prompt.SystemPromptFunc[AgentDepsT]
  ):
"""Decorator to register a system prompt function.
    Optionally takes [`RunContext`][pydantic_ai.tools.RunContext] as its only argument.
    Can decorate a sync or async functions.
    The decorator can be used either bare (`agent.system_prompt`) or as a function call
    (`agent.system_prompt(...)`), see the examples below.
    Overloads for every possible signature of `system_prompt` are included so the decorator doesn't obscure
    the type of the function, see `tests/typed_agent.py` for tests.
    Args:
      func: The function to decorate
      dynamic: If True, the system prompt will be reevaluated even when `messages_history` is provided,
        see [`SystemPromptPart.dynamic_ref`][pydantic_ai.messages.SystemPromptPart.dynamic_ref]
    Example:
```python
    from pydantic_ai import Agent, RunContext
    agent = Agent('test', deps_type=str)
    @agent.system_prompt
    def simple_system_prompt() -> str:
      return 'foobar'
    @agent.system_prompt(dynamic=True)
    async def async_system_prompt(ctx: RunContext[str]) -> str:
      return f'{ctx.deps} is the best'