---
url: https://ai.pydantic.dev/api/agent/
session_id: pydantic_ai_docs
chunk_number: 9
title: Agent Configuration and Tool Management
summary: This section discusses necessary changes to the `Tool` for copyability, sets initial values for function tools, merges model settings, and establishes usage limits. It also includes the initialization of a tracer for monitoring the agent run and prepares the graph dependencies required for executing agent tasks.
embedding: [0.012827292084693909, 0.060907211154699326, -0.028838980942964554, -0.029534166678786278, -0.00590907596051693, 0.03814549371600151, 0.035387177020311356, 0.042339034378528595, 0.025452755391597748, -0.013287010602653027, -0.007658252026885748, 0.005034487694501877, -0.022593524307012558, -0.029422039166092873, 0.004412184469401836, -0.04366212710738182, -0.05054670572280884, -0.011279943399131298, -0.00278214318677783, -0.00040996316238306463, 0.0047822026535868645, -0.017917843535542488, 0.0013265986926853657, 0.0386837013065815, -0.029735993593931198, 0.0008752888534218073, -0.032292481511831284, 0.05561482906341553, -0.032314907759428024, -0.006284700240939856, -0.009059835225343704, -0.020048249512910843, -0.014643743634223938, -0.05081580951809883, 0.017502974718809128, 0.0191512368619442, 0.034176211804151535, 0.02673099935054779, -0.01860181614756584, 0.022548673674464226, -0.005679216235876083, -0.06965309381484985, 0.01385885663330555, 0.01060157734900713, 0.013062757439911366, 0.011207060888409615, 0.0072097452357411385, 0.01753661222755909, 0.051712822169065475, 0.0027064576279371977, -0.037405457347631454, 0.016269581392407417, 0.028211072087287903, 0.001070108963176608, -0.01879242993891239, -0.03444531559944153, 0.03433318808674812, 0.00909347366541624, -0.04218205437064171, -0.027201931923627853, 0.015125888399779797, -0.02185348980128765, 0.0066771432757377625, 0.029713569208979607, -0.03980496898293495, 0.021965615451335907, 0.01059036422520876, 0.05095035955309868, -0.02039584144949913, 0.006464102771133184, 0.01385885663330555, 0.02164044789969921, -0.029668718576431274, -0.02077707275748253, -0.023927832022309303, 0.018814856186509132, 0.035970237106084824, 0.04034317657351494, 0.013825219124555588, -0.00290688406676054, 0.012165743857622147, -0.027381334453821182, -0.02222350612282753, 0.02919778600335121, -0.019207298755645752, -0.009620469063520432, -0.06723115593194962, -0.037629712373018265, -0.005881044082343578, -0.05767796188592911, 0.029332337900996208, 0.0224253349006176, 0.006615473888814449, 0.01690870337188244, 0.07727770507335663, 0.04978424310684204, -0.02162923477590084, 0.011885427869856358, 0.03747273609042168, 0.05691549926996231, 0.020317353308200836, -0.024353913962841034, -0.05574938282370567, -0.016863852739334106, -0.009435459971427917, 0.0066771432757377625, -0.006828514393419027, 0.017390847206115723, -0.019431551918387413, 0.0047121234238147736, -0.02735890820622444, 0.0220441035926342, -0.02791954204440117, -0.009441065602004528, -0.01892698183655739, -0.048259321600198746, 0.008342224173247814, -0.032942816615104675, -0.005031684413552284, -0.031103938817977905, -0.026843126863241196, 0.007456423714756966, -0.026215216144919395, -0.023748429492115974, 0.04236145690083504, -0.008258129470050335, -0.026237642392516136, -0.034557443112134933, 0.01731235906481743, 0.0039552683010697365, 0.012726377695798874, -0.018220584839582443, -0.010517481714487076, 0.042765114456415176, -0.003641313873231411, 0.012905780225992203, -0.05440386384725571, -0.00825252290815115, -0.03877340257167816, 0.03529747575521469, -0.0383024737238884, -0.003910417668521404, -0.03195610269904137, -0.00297976634465158, -0.029220212250947952, 0.05382080376148224, -0.09535252302885056, 0.01293941866606474, -0.0808657556772232, 0.011369644664227962, 0.00764143280684948, -0.017805716022849083, -0.01385885663330555, 0.025430329144001007, 0.02120315469801426, 0.013892495073378086, -0.020552819594740868, 0.02428663708269596, -0.0005003652768209577, -0.0260806642472744, -0.05104006081819534, -0.0012116688303649426, -0.012670313939452171, -0.022088954225182533, -0.024757569655776024, -0.05978594347834587, 0.008751487359404564, -0.010708097368478775, -0.026260066777467728, -0.024981822818517685, 0.011268731206655502, 0.0011282747145742178, -0.016830213367938995, 0.026192791759967804, 0.03937888890504837, -0.05992049351334572, -0.005668003577739, -0.021360130980610847, -0.00683972705155611, -0.02484727092087269, -0.0029461283702403307, -0.010730522684752941, -0.022324420511722565, -0.0046728793531656265, -0.06283579021692276, -0.0012067633215337992, 0.0036973771639168262, 0.01438585203140974, -0.011661173775792122, 0.011773301288485527, 0.0366654209792614, 0.03937888890504837, 0.04076926037669182, -0.00581376813352108, -0.056601546704769135, -0.010063368827104568, 0.04758656024932861, -0.03529747575521469, 0.01814209669828415, 0.006380007602274418, -0.016561109572649002, -0.0021346115972846746, 0.029623867943882942, -0.01691991463303566, 0.04655499383807182, -0.01777207851409912, 0.010741735808551311, -0.004958802368491888, -0.011549047194421291, -0.010125039145350456, 0.030543306842446327, 0.0001997256331378594, 0.0015837892424315214, 0.013320649042725563, 0.010029731318354607, -0.0049784244038164616, -0.020653733983635902, 0.001316787675023079, -0.00728823384270072, 0.02266080118715763, 0.0031507594976574183, 0.009755020961165428, -0.011885427869856358, -0.020025823265314102, 0.012950630858540535, 0.038481876254081726, -0.005362458061426878, -0.049873944371938705, -0.03197852894663811, 0.049649693071842194, 0.02083313651382923, -0.016381707042455673, 0.01609017699956894, -0.018613027408719063, 0.07696375250816345, -0.004894329234957695, 0.04103836417198181, 0.014677382074296474, 0.02879413031041622, -0.03919948637485504, -0.005819374229758978, 0.02327749691903591, 0.02082192339003086, -0.030745133757591248, 0.008274948224425316, 0.0226159505546093, 0.007265808526426554, -0.015024974010884762, 0.033974383026361465, 0.015619246289134026, 0.023210221901535988, -0.05202677845954895, -0.023142945021390915, -0.04839387163519859, -0.017603887245059013, 0.00550261652097106, 0.005208284128457308, 0.007310659158974886, -0.02569943480193615, -0.010870681144297123, 0.04420033469796181, -0.005197071470320225, -0.006733207032084465, 0.019655806943774223, 0.008202066645026207, 0.011150998063385487, 0.040455304086208344, -0.04406578466296196, 0.04155414551496506, 0.01996976137161255, 0.030274203047156334, 0.02347932569682598, 0.033570725470781326, -0.035970237106084824, -0.05386565625667572, -0.015630459412932396, 0.06216302886605263, 0.035005949437618256, -0.021909551694989204, -0.01836634986102581, -0.055390577763319016, 0.03520777449011803, 0.0036244948860257864, 0.03424348682165146, 0.014912847429513931, -0.00159360037650913, -0.03899765759706497, -0.0004260813584551215, -0.008089940063655376, 0.025206075981259346, -0.04061228036880493, 0.01689749024808407, 0.06494376808404922, 0.01458768080919981, 0.020115526393055916, -0.03144032135605812, 0.013186097145080566, 0.018848493695259094, -0.009222419001162052, 0.0074227857403457165, 0.03146274387836456, 0.016191091388463974, 0.02486969716846943, -0.014767083339393139, 0.01813088357448578, 0.01417281199246645, -0.02323264628648758, -0.030094800516963005, 0.03141789510846138, -0.005920288618654013, -0.009889572858810425, 0.07965479046106339, -0.020440692082047462, -0.0023546600714325905, 0.0448506698012352, -0.03794366866350174, 0.02489212155342102, 0.010517481714487076, 0.031507596373558044, 0.001335008186288178, -0.026417044922709465, 0.016078965738415718, 0.014195237308740616, -0.010859468020498753, -0.02675342559814453, -0.005034487694501877, 0.02549760602414608, -0.015765011310577393, -0.04301179200410843, 0.0718059241771698, -0.01161632314324379, -0.038257621228694916, -0.023905407637357712, 0.004869100637733936, 0.06220787763595581, 0.02489212155342102, -0.002131808316335082, -0.029040809720754623, 0.0539105050265789, 0.03298766911029816, -0.018220584839582443, 0.01939791440963745, -0.054359011352062225, -0.008482382632791996, 0.005401702597737312, 0.04668954759836197, 0.021057389676570892, 0.02897353284060955, -0.005471781827509403, 0.025183651596307755, 0.010074581950902939, 0.018814856186509132, 0.014677382074296474, 0.04467126727104187, -0.015024974010884762, -0.002316817408427596, -0.05727430433034897, 0.0012053617974743247, -0.038661278784275055, 0.013634603470563889, -0.044738542288541794, 0.015047400258481503, 0.0025999373756349087, -0.008162821643054485, -0.01689749024808407, 0.02262716367840767, 0.012670313939452171, 0.005931501276791096, -0.01795148104429245, 0.01754782535135746, 0.07490061968564987, 0.04404335841536522, 0.0053428360261023045, 0.009278482757508755, -0.014217662625014782, -0.004521508235484362, -0.024645444005727768, 0.006985492072999477, 0.02939961478114128, 0.035992663353681564, 0.031103938817977905, 0.006127723027020693, 0.017402060329914093, -0.004835462663322687, 0.0037870784290134907, 0.03509565070271492, 0.008033876307308674, -0.010848255828022957, -0.019453978165984154, -0.007052768021821976, 0.05408990755677223, -0.07629098743200302, -0.0046084062196314335, 0.015843499451875687, -0.025250926613807678, 0.03442288935184479, 0.006178179755806923, 0.04390880465507507, 0.023187795653939247, 0.04036560282111168, 0.03655329719185829, -0.00112126674503088, -0.03038632869720459, 0.0619836263358593, -0.0050064558163285255, -0.005384883377701044, 0.025564881041646004, 0.012176956981420517, 0.008611328899860382, 0.020541606470942497, 0.057812511920928955, -0.0008942102431319654, 0.026596447452902794, -0.018411200493574142, 0.006536985281854868, -0.047810815274715424, 0.0005795547622255981, -0.02590126171708107, 0.02937718853354454, 0.07117801159620285, -0.03200095146894455, -0.08795216679573059, 0.030520880594849586, 0.033974383026361465, -0.012233019806444645, 0.02895110659301281, 0.0189606212079525, -0.04204750433564186, 0.01286092959344387, 0.02184227667748928, 0.008258129470050335, 0.0001956960913958028, 0.018702728673815727, 0.00178561732172966, -0.007125650066882372, 0.007372329011559486, 0.024735145270824432, 0.016841426491737366, 0.024533316493034363, -0.00796099379658699, 0.04646529257297516, -0.011190242134034634, 0.01539499219506979, 0.06732085347175598, -0.012053617276251316, -0.0029573410283774137, -0.03859400004148483, 0.004187931306660175, 0.02630491741001606, 0.004159899428486824, -0.03570113331079483, -0.02832319773733616, -0.028076520189642906, 0.006621079985052347, -0.05059155449271202, -0.024331487715244293, 0.07113315910100937, -0.008768306113779545, 0.043348170816898346, 0.023905407637357712, 0.0461064875125885, -0.011649961583316326, 0.0031367437914013863, 0.02567700855433941, 0.019846420735120773, 0.03787638992071152, 0.009968061000108719, 0.037226054817438126, -0.01594441384077072, 0.06256668269634247, 0.015495906583964825, -0.023950258269906044, -0.008269342593848705, 0.030879685655236244, -0.006082871928811073, -0.02693282812833786, -0.004644847474992275, 0.04978424310684204, -0.011694812215864658, -0.007747953291982412, -0.013073970563709736, -0.012367572635412216, 0.04893207922577858, 0.03195610269904137, -0.004726139362901449, -0.018500901758670807, -0.004252403974533081, -0.03040875494480133, -0.04404335841536522, 0.02325507253408432, 0.05135401710867882, 0.0038235196843743324, 0.022335633635520935, -0.009474704042077065, 0.06023444980382919, 0.021169517189264297, 0.03491624817252159, 0.03166457265615463, -0.008269342593848705, -0.014240087941288948, -0.0346471443772316, 0.012804865837097168, 0.00663229264318943, 0.011717237532138824, -0.037607286125421524, -0.013477626256644726, 0.021315280348062515, 0.0030666645616292953, 0.007602188736200333, 0.015865923836827278, -0.03731575608253479, -0.005623152945190668, -0.020048249512910843, -0.006688356399536133, -0.03327919542789459, 0.006811695639044046, -0.019622167572379112, 0.022189868614077568, 0.01406068541109562, -0.0019019487081095576, -0.0008395484765060246, -0.03182154893875122, -0.038235194981098175, -0.017794502899050713, 0.0011352825677022338, 0.011089327745139599, 0.020519182085990906, -0.059247735887765884, 0.019050322473049164, -0.0165050458163023, -0.007854473777115345, 0.029085660353302956, -0.02142740786075592, 0.023501751944422722, 0.0047121234238147736, 0.01996976137161255, -0.01387006975710392, 0.030655432492494583, -0.05359655246138573, -0.021718936040997505, -0.00958122406154871, 0.0207882858812809, -0.034602291882038116, -0.011313581839203835, -0.02161802351474762, -0.013006694614887238, 0.027650438249111176, 0.007058374118059874, 0.026439469307661057, -0.011313581839203835, 0.026215216144919395, -0.008370256051421165, 0.019229725003242493, -0.001604813034646213, 0.052923791110515594, -0.0026209610514342785, -0.02079949900507927, -0.012468486092984676, 0.03361557796597481, -0.03038632869720459, -0.011268731206655502, -0.008387075737118721, 0.023501751944422722, -0.020137950778007507, -0.004759777337312698, 0.04520947486162186, 0.022559886798262596, -0.02628249302506447, -0.019835209473967552, 0.040477730333805084, 0.013623391278088093, 0.0246902946382761, 0.012591825798153877, 0.02386055700480938, 0.014542830176651478, -0.03902008384466171, 0.010467025451362133, 0.006542591378092766, -0.04348272457718849, 0.03278584033250809, 0.007523700129240751, -0.014374639838933945, 0.01612381637096405, 0.015170739032328129, -0.003958071582019329, 0.01635928265750408, -0.060279302299022675, 0.03258401155471802, -0.01733478344976902, 0.02569943480193615, -0.033570725470781326, -0.023165371268987656, 0.0296014416962862, -0.007663858123123646, -0.051084913313388824, -0.001501095830462873, -0.021943191066384315, 0.01937549002468586, -0.03101423755288124, 0.008672998286783695, 0.024578167125582695, -0.019543679431080818, -0.003164775436744094, 0.01996976137161255, 0.012625463306903839, 0.005920288618654013, 0.049649693071842194, 0.009211206808686256, -0.02650674618780613, 0.011190242134034634, -0.014150386676192284, -0.022705651819705963, -0.016471408307552338, -0.03361557796597481, -0.014677382074296474, 0.04036560282111168, -0.002239730441942811, 0.0010981406085193157, 0.06220787763595581, 0.012816078960895538, 0.007932961918413639, 0.018254222348332405, 0.007260202430188656, 0.01818694733083248, 0.0031619721557945013, -0.02509395033121109, -0.03767456114292145, 0.0033890288323163986, -0.029713569208979607, 0.04204750433564186, -0.05032245069742203, 0.01955489255487919, 0.026820700615644455, 0.022346846759319305, -0.04101593792438507, 0.006419252138584852, -0.01398219633847475, -0.014744658023118973, -0.004210356622934341, 0.004925164394080639, 0.020642520859837532, 0.017469335347414017, -0.018646666780114174, 0.0010981406085193157, -0.0165050458163023, 0.02531820349395275, -0.011694812215864658, 0.014083110727369785, 0.008308586664497852, -0.02099011279642582, -0.04830417037010193, -0.06207332760095596, 0.019880060106515884, -0.01222180761396885, 0.008274948224425316, 0.023501751944422722, -0.01438585203140974, 0.0024289439897984266, -0.015551969408988953, 0.002968553686514497, 0.007153681945055723, 0.006492134649306536, 0.002822789130732417, 0.019521255046129227, -0.004664469510316849, 0.015495906583964825, 0.009328939020633698, 0.045366451144218445, 0.04263056069612503, -0.013623391278088093, -0.03348102420568466, 0.008914071135222912, 0.030363904312253, 0.014228874817490578, -0.02648431994020939, -0.0010581954848021269, 0.02037341706454754, -0.0506364069879055, -0.037427883595228195, -0.006284700240939856, -0.031059088185429573, -0.025811560451984406, -0.020541606470942497, 0.05359655246138573, 0.054179608821868896, -0.015608033165335655, 0.0033385716378688812, -0.004168309271335602, -0.009071048349142075, 0.021573172882199287, -0.02572185918688774, -0.0228626299649477, 0.006015595979988575, 0.025744285434484482, 0.0070079173892736435, 0.0035544156562536955, 0.040275901556015015, -0.003994512837380171, -0.011605110950767994, 0.013713092543184757, -0.007512487005442381, -0.003714196151122451, 0.010870681144297123, 0.019880060106515884, 0.008308586664497852, -0.036620572209358215, -0.028076520189642906, -0.016987191513180733, 0.014823146164417267, 0.00264759105630219, -0.01630321890115738, 0.007377935107797384, -0.03870612755417824, 0.011907853186130524, 0.004103836137801409, -0.04494037106633186, 0.006206211633980274, 0.017895417287945747, 0.018287859857082367, -0.014924060553312302, -0.00779841048642993, 0.006396826822310686, -0.01649383455514908, 0.012490911409258842, 0.00595953268930316, -0.04691380262374878, 0.010837042704224586, 0.0592028833925724, -0.0064472840167582035, 0.03372770547866821, 0.002895671408623457, -0.03327919542789459, 0.003125531133264303, -0.040096499025821686, -0.03875098004937172, -0.036598145961761475, -0.044962797313928604, 0.00719292601570487, 0.006363188847899437, -0.005070928949862719, 0.004703714046627283, -0.01041096169501543, -0.002770930528640747, 0.002633575350046158, -0.002490613842383027, -0.01539499219506979, 0.02386055700480938, 0.03718120604753494, -0.0004068095877300948, 0.022683225572109222, -0.058440424501895905, 0.0050597162917256355, -0.0056063337251544, 0.03958071768283844, 0.016404133290052414, 0.014912847429513931, -0.019106386229395866, 0.010567938908934593, -0.057633109390735626, 0.004201947245746851, -0.015092250891029835, -0.0024373535998165607, 0.00978865846991539, 0.009132717736065388, 0.003952465485781431, 0.015350141562521458, 0.010405355133116245, 0.006974279414862394, -0.02531820349395275, -0.01346641406416893, -0.052520133554935455, 0.022683225572109222, -0.013623391278088093, 0.017278721556067467, -0.002796158893033862, -0.057857364416122437, 0.010943563655018806, -0.014228874817490578, 0.02776256389915943, -0.005289576016366482, -0.017480548471212387, 0.012524549849331379, -0.02158438414335251, -0.010242771357297897, 0.02124800533056259, -0.023344773799180984, -0.004196340683847666, -0.0013434176798909903, -0.014542830176651478, -0.010517481714487076, -0.05933743715286255, -0.018613027408719063, -0.0016370494849979877, 0.03040875494480133, 0.03814549371600151, 0.011207060888409615, -0.03103666380047798, -0.07943053543567657, 0.00030204124050214887, 0.011111753061413765, -0.0077703786082565784, -0.003360997186973691, -0.004658863414078951, 0.0008171231602318585, 0.024802420288324356, -0.028861405327916145, 0.025946112349629402, 0.01162753626704216, -0.002859230153262615, -0.02917536161839962, -0.03401923179626465, 0.010719310492277145, 0.0072377766482532024, 0.021057389676570892, -0.0027386939618736506, 0.05099521204829216, -0.021270429715514183, -0.013376712799072266, -0.01689749024808407, -0.07288233935832977, 0.01709931716322899, -0.01634806953370571, -0.025004249066114426, 0.001774404663592577, 0.018915770575404167, -0.00019867444643750787, -0.03202337771654129, -0.041105639189481735, -0.01334307435899973, 0.008549658581614494, -0.019880060106515884, -0.02486969716846943, 0.029242636635899544, 0.011728450655937195, 0.0440882071852684, -0.007355509791523218, -0.01628079265356064, -0.010607183910906315, -0.012502124533057213, 0.02120315469801426, -0.0030442392453551292, 0.02675342559814453, 0.024353913962841034, -0.02323264628648758, 0.002784946234896779, 0.013791580684483051, 0.015350141562521458, 0.005735279526561499, 0.0027274813037365675, -0.01893819496035576, 0.025587307289242744, 0.006587442010641098, 0.029848121106624603, 0.00012684329703915864, 0.022761715576052666, 0.005785736255347729, 0.010416568256914616, 0.022694438695907593, -0.002500424860045314, 0.003383422503247857, -0.016224730759859085, 0.006183786317706108, 0.0104221748188138, -0.021135877817869186, -0.011717237532138824, 0.009401821531355381, -0.018243009224534035, -0.021943191066384315, 0.015652883797883987, -0.01568652130663395, -9.714725456433371e-05, 0.029040809720754623, 0.012928205542266369, 0.002314014360308647, 0.013354286551475525, -0.0018711138982325792, 0.0077815912663936615, 0.046375591307878494, -0.02000339888036251, 0.05521117523312569, -0.0038038974162191153, -0.0370466522872448, 0.006206211633980274, -0.02426421269774437, -0.019083959981799126, -0.014632531441748142, 0.0024359519593417645, 0.008039482869207859, -0.020507968962192535, 0.044985223561525345, -0.023569026961922646, -0.015204377472400665, -0.006637899205088615, -0.00856647826731205, 0.03991709649562836, -0.0026840323116630316, 0.0006349172908812761, 0.030520880594849586, -0.006172573659569025, -0.025407904759049416, 0.006424858700484037, -0.04348272457718849, 0.005236315540969372, -0.02303081937134266, 0.01854575239121914, 0.03444531559944153, 0.0075965821743011475, -0.025587307289242744, -0.007176107261329889, -0.04348272457718849, 0.014262513257563114, -0.020721009001135826, 0.030655432492494583, 0.05382080376148224, -0.06220787763595581, -0.03238218277692795, 0.025632157921791077, -0.012289083562791348, 0.03695695102214813, -0.00168190011754632, -0.023613877594470978, 0.0007028941181488335, 0.010971595533192158, -0.012535762041807175, -0.035387177020311356, -0.03298766911029816, 0.012591825798153877, -0.00714246928691864, 0.044805821031332016, -0.00021041271975263953, -0.0025368661154061556, -0.041329894214868546, 0.013365499675273895, 0.02675342559814453, -0.058440424501895905, -0.012120893225073814, -0.03632904216647148, 0.023815706372261047, -0.04287724196910858, 0.021326493471860886, 0.0010455813026055694, -0.05386565625667572, -0.026596447452902794, 0.024107234552502632, -0.018848493695259094, -0.03188882768154144, 0.009306513704359531, -0.036598145961761475, -0.04101593792438507, 0.03123849257826805, 0.05099521204829216, -0.019016684964299202, 0.00126142508815974, -0.013533690012991428, -0.01938670128583908, -0.02162923477590084, -0.0060996911488473415, 0.0031311374623328447, 0.056197889149188995, 0.009362577460706234, 0.021662874147295952, 0.000767366960644722, -0.01757024973630905, 0.0028045685030519962, 0.017828142270445824, -0.01938670128583908, -0.033346474170684814, -0.0019341851584613323, 0.007708708755671978, -0.01143692061305046, -0.015787435695528984, 0.02241412177681923, 0.02527335286140442, -0.007170500699430704, -0.008914071135222912, -0.017043255269527435, 0.05247528478503227, 0.012647888623178005, 0.05548027902841568, 0.014015834778547287, -0.012883354909718037, -0.00571005092933774, -0.01215453166514635, 0.0025719054974615574, 0.00815160945057869, -0.013320649042725563, -0.026461895555257797, 0.0632394477725029, 0.0031479564495384693, -0.0070471614599227905, 0.031171215698122978, -0.024398764595389366, 0.00719292601570487, 0.011863002553582191, -0.011448133736848831, 0.008723455481231213, -0.010349292308092117, 0.026887977495789528, 0.02814379520714283, 0.002452770946547389, -0.020081887021660805, -0.00837586261332035, 0.0720750242471695, 0.0037478341255337, -0.020507968962192535, -0.04162142053246498, 0.0077928039245307446, -0.021528322249650955, 0.016448983922600746, -0.01326458528637886, 0.0064584966748952866, 0.012289083562791348, 0.014318576082587242, -0.034759268164634705, -0.009609255939722061, -0.04041045531630516, 0.011638748459517956, -0.005687625613063574, -0.009805478155612946, 0.02123679220676422, 0.00099652586504817, 0.01233393419533968, -0.011986341327428818, 0.011840577237308025, -0.005802555475383997, 0.020922837778925896, 0.0068733650259673595, 0.015047400258481503, -0.0012368974275887012, 0.011683599092066288, -0.013477626256644726, 0.02874927967786789, -0.010741735808551311, 0.004902739077806473, 0.00311431847512722, 0.026394618675112724, 0.02081071026623249, 0.011874214746057987, 0.015417417511343956, -0.03610479086637497, 0.016617173328995705, 0.029691142961382866, 0.02670857310295105, 0.00504570035263896, 0.032763414084911346, 0.009216812439262867, -0.007411573082208633, -0.007697496097534895, -0.0016118210041895509, 0.020306140184402466, -0.03424348682165146, -0.009244844317436218, -0.016785362735390663, 0.021337706595659256, 0.054762668907642365, -0.024331487715244293, -0.004409381654113531, -0.008112365379929543, 0.02323264628648758, -0.044805821031332016, 0.005236315540969372, 0.0013553311582654715, -0.015226802788674831, 0.014733444899320602, 0.02383813075721264, 0.03101423755288124, -0.0018570980755612254, 0.029220212250947952, -0.027874691411852837, 0.023748429492115974, 0.03789881616830826, -0.024959398433566093, -0.002748505212366581, -0.003952465485781431, 0.0031731848139315844, -0.012894568033516407, -0.00877951830625534, -0.01244606077671051, 0.026574021205306053, -0.030117224901914597, -0.021786212921142578, 0.011896640062332153, -0.01976793259382248, 0.016067752614617348, -0.04529917612671852, -0.008325405418872833, -0.003537596669048071, 0.008644966408610344, 0.022761715576052666, -0.04552343115210533, 0.01305154524743557, 0.036822400987148285, -0.021931977942585945, 0.016774151474237442, 0.016000475734472275, -0.02017158828675747, -0.01356732752174139, -0.0183327104896307, 0.03998437151312828, -0.017301145941019058, -0.008672998286783695, 0.01772722788155079, 0.0037085898220539093, 0.005684822332113981, 0.010321260429918766, 0.027829840779304504, -0.021561959758400917, -0.07525942474603653, -0.015260440297424793, 0.02017158828675747, 0.01753661222755909, 0.040275901556015015, 0.0029713569674640894, -0.005808161571621895, -0.01716659404337406, -0.0404328778386116, 0.033346474170684814, -0.0031227278523147106, -0.002926506334915757, -0.014352214522659779, -0.004207553341984749, -0.02610309049487114, 0.0038263227324932814, -0.010579152032732964, 0.030700283125042915, -0.00561474310234189, -0.044559139758348465, 0.01233393419533968, 0.005780130159109831, -0.04509734734892845, 0.003198413411155343, -0.04500764608383179, -0.010405355133116245, -0.03222520649433136, 0.0020421070512384176, -0.0032236420083791018, -0.009155143052339554, -0.01161632314324379, 0.003279705299064517, 0.001670687459409237, 0.02388298138976097, 0.023187795653939247, 0.006637899205088615, -0.03691210225224495, 0.011145391501486301, 0.03348102420568466, 0.03330162167549133, 0.07019130140542984, 0.002206092234700918, -0.015439842827618122, 0.001889334525913, 0.0021458242554217577, -0.011078115552663803, -0.00826373603194952, 0.014307363890111446, 0.0017057270742952824, -0.03220278024673462, -0.012378784827888012, 0.012165743857622147, -0.011134178377687931, 0.0208443496376276, 0.06521287560462952, 0.009014984592795372, 0.004529917612671852, 0.003960874862968922, 0.00786008033901453, 0.0003460159059613943, 0.03816791996359825, 0.03141789510846138, -0.025856411084532738, -0.024331487715244293, 0.0016398526495322585, -0.007686283439397812, 0.011162210255861282, -0.029534166678786278, 0.022526249289512634, 0.029332337900996208, 0.027291633188724518, -0.012995481491088867, -0.008527233265340328, -0.00990078505128622, -0.07225442677736282, 0.016247155144810677, 0.00728823384270072, -0.01976793259382248, -0.00958122406154871, -0.0005171842640265822, -0.0005304993246681988, 0.004790612030774355, 0.001353929634205997, -0.02162923477590084, -0.01837756112217903, 0.025026673451066017, 0.018063606694340706, -0.028682002797722816, 0.026641298085451126, 0.014778295531868935, 0.020877987146377563, -0.020732222124934196, 0.0362841933965683, -0.022088954225182533, -0.003980496898293495, -0.022772926837205887, -0.029018383473157883, 0.05283408984541893, -0.021539533510804176, 0.04137474298477173, 0.0019986580591648817, 0.001796829979866743, 0.006828514393419027, 0.01834392361342907, 0.004468248225748539, -0.0003032676177099347, -0.008482382632791996, 0.03126091882586479, -0.04799021780490875, 0.06548197567462921, -0.016482621431350708, -0.00906544178724289, 0.0013630399480462074, -0.026237642392516136, 0.017615100368857384, 0.0015067021595314145, 0.017816929146647453, -0.022784139961004257, 0.019252149388194084, 0.013354286551475525, 0.009749414399266243, -0.00550261652097106, -0.023165371268987656, -0.035185351967811584, -0.03285311535000801, 0.006738813128322363, 0.025744285434484482, 0.031305767595767975, -0.0016146241687238216, 0.03141789510846138, 0.009872754104435444, 0.0007172603509388864, 0.025004249066114426, -0.008033876307308674, -0.0022187065333127975, 0.0101082194596529, 0.009099079295992851, 0.015675310045480728, -0.052744388580322266, 0.01813088357448578, -0.011952703818678856, 0.026058239862322807, 0.009356970898807049, 0.01162753626704216, -0.023546602576971054, 0.034804120659828186, -0.030094800516963005, 0.0032376577146351337, 0.013443988747894764, -0.00663229264318943, 0.004947589710354805, 0.004880313761532307, -0.022929904982447624, -0.007467636372894049, 0.0014884816482663155, -0.011448133736848831, 0.011134178377687931, 0.038437023758888245, -0.014296150766313076, -0.01529407873749733, -0.012905780225992203, -0.002079949714243412, -0.010708097368478775, 0.03527505323290825, 0.0038851893041282892, 0.006907003000378609, -0.0006843231385573745, -0.02879413031041622, 0.013331861235201359, -0.0036945738829672337, 0.00930090807378292, -0.022963542491197586, 0.018299072980880737, -0.032292481511831284, 0.0021346115972846746, 0.002999388612806797, -0.008331011980772018, -0.013421563431620598, 0.028457749634981155, -0.047631412744522095, -0.0185233261436224, 0.06099691241979599, 0.007417179644107819, -0.0075797634199261665, -0.015664096921682358, -0.004675682168453932, 0.0072377766482532024, 0.00318720075301826, 0.019823996350169182, -0.00845995731651783, 0.004529917612671852, 0.006267881020903587, 0.006307125557214022, -0.021348919719457626, -0.0012803464196622372, -0.02345690131187439, 0.003714196151122451, -0.022167444229125977, -0.006497740745544434, -0.0006482323515228927, 0.004328089766204357, -0.016146240755915642, 0.007540518883615732, -0.012771228328347206, 0.00978305283933878, -0.0035796440206468105, 0.042540859431028366, -0.002534062834456563, 0.004311270546168089, 0.0003770259500015527, 0.02325507253408432, 0.0025803151074796915, 0.012670313939452171, -0.031507596373558044, 0.04175597429275513, 0.0011219675652682781, 0.012199382297694683, 0.01736842282116413, -0.02978084422647953, -0.02327749691903591, 0.01367945410311222, -0.018624240532517433, -0.00013385122292675078, 0.02020522765815258, -0.0058866506442427635, -0.025004249066114426, -0.013735517859458923, -0.01417281199246645, -0.011593897826969624, 0.017906630411744118, -0.007473242934793234, -0.034557443112134933, -0.018624240532517433, 0.005216693505644798, 0.009323333390057087, 0.006940640974789858, -0.01937549002468586, -0.021763788536190987, 0.013006694614887238, 0.03330162167549133, 0.0007603589911013842, 0.022772926837205887, -0.01959974318742752, 0.014004621654748917, -0.006974279414862394, 0.0074339983984827995, 0.022279569879174232, 0.01222180761396885, 0.02814379520714283, -0.0033245559316128492, 0.008504807949066162, 0.02118072845041752, -0.008897251449525356, -0.055166322737932205, 0.025811560451984406, -0.0012116688303649426, 0.01498012337833643, 0.02020522765815258, 0.006015595979988575, -0.0024667868856340647, -0.01417281199246645, 0.007411573082208633, -0.006480921991169453, -0.03327919542789459, -0.014957698062062263, 0.000966391758993268, 0.00011379105853848159, 0.027852267026901245, -0.003061058232560754, 0.01060157734900713, 0.048035066574811935, 0.0183887742459774, 0.03166457265615463, 0.0003108011151198298, -0.0015291274758055806, -0.02262716367840767, -0.04280996322631836, -0.025766709819436073, 0.02365872822701931, -0.020732222124934196, -0.012412423267960548, 0.04323604702949524, -0.032157931476831436, 0.0012670314172282815, -0.013130033388733864, -0.008117971010506153, 0.027493460103869438, 0.009328939020633698, -0.017088105902075768, -0.011795726604759693, 0.03159729763865471, 0.014251300133764744, -0.027650438249111176, -0.015002548694610596, -0.004656060133129358, -0.010965988971292973, 0.0167517252266407, -0.027650438249111176, -0.03161972388625145, 0.029422039166092873, 0.007731134071946144, -0.005625955760478973, 0.0031451531685888767, 0.016617173328995705, -0.01735720969736576, -0.007114437408745289, -0.0022523445077240467, -0.058261021971702576, 0.003562825033441186, 0.0013034725561738014, 0.03269613906741142, -0.009710170328617096, -0.020687371492385864, 0.00978305283933878, -0.0032909179572016, 0.011055690236389637, -0.006155754439532757, -0.03278584033250809, 0.021102240309119225, -0.04449186474084854, -0.031530022621154785, 0.029422039166092873, -0.031731847673654556, -0.026775849983096123, 0.002555086510255933, 0.008000237867236137, 0.007714315317571163, -0.003907614853233099, 7.71308914409019e-05, -0.01334307435899973, 0.020664947107434273, -0.0279643926769495, 0.016998404636979103, -0.03343617543578148, -0.022515036165714264, -0.01716659404337406, 0.026170365512371063, -0.008286161348223686, -0.04982909560203552, -0.02081071026623249, -0.016594747081398964, 0.018086032941937447, 5.7508721511112526e-05, 0.000848658790346235, -0.013802793808281422, -0.006761238444596529, -0.02980327047407627, 0.02839047461748123, -0.04020862653851509, 0.019622167572379112, 0.03188882768154144, -0.014184024184942245, -0.006856546271592379, -0.025654584169387817, 0.02980327047407627, 0.0208443496376276, 0.02220108173787594, 0.0033189496025443077, -0.0022523445077240467, 0.008785124868154526, -0.0037618500646203756, 0.007663858123123646, 0.01856817677617073, -0.027650438249111176, 0.018848493695259094, 0.019274575635790825, -0.02655159682035446, 0.00473454874008894, 0.05615304037928581, -0.01794026792049408, 0.013354286551475525, 0.028098944574594498, 0.04911148548126221, 0.017200231552124023, 0.0224253349006176, 0.01215453166514635, -0.007417179644107819, -0.0003335768706165254, -0.004897132515907288, -0.013443988747894764, -0.035005949437618256, -0.011941490694880486, 0.01674051210284233, 0.011863002553582191, -0.030072374269366264, 0.028838980942964554, -0.010024124756455421, -0.03919948637485504, -0.010242771357297897, -0.028480175882577896, -0.031933676451444626, 0.05305834114551544, 0.03078998439013958, 0.03605993837118149, 0.008835582062602043, 0.012266658246517181, 0.004171112086623907, 0.03940131515264511, -0.0066771432757377625, 0.05628759041428566, 0.00026174570666626096, 0.0015795845538377762, 0.031530022621154785, -0.0030890898779034615, -0.03919948637485504, 0.048438724130392075, 0.004504689015448093, 0.035566579550504684, 0.008633754216134548, -0.03697937726974487, -0.01398219633847475, -0.007355509791523218, 0.020698584616184235, -0.027089804410934448, -0.01817573420703411, -0.02424178645014763, -0.011649961583316326, 0.016819002106785774, -0.0092616630718112, -0.03980496898293495, 0.013701879419386387, -0.042294181883335114, 0.008538446389138699, -0.0031451531685888767, 0.01428493857383728, -0.0010273606749251485, -0.0059258947148919106, -0.011717237532138824, -0.015069825574755669]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-14T10:14:17.170061", "url_path": "/api/agent/", "chunk_size": 3701}
updated_dt: 2025-03-14T10:14:17.171850
---
Requires some changes to `Tool` to make them copyable though.
    for v in self._function_tools.values():
      v.current_retry = 0
    model_settings = merge_model_settings(self.model_settings, model_settings)
    usage_limits = usage_limits or _usage.UsageLimits()
    if isinstance(model_used, InstrumentedModel):
      tracer = model_used.options.tracer
    else:
      tracer = NoOpTracer()
    agent_name = self.name or 'agent'
    run_span = tracer.start_span(
      'agent run',
      attributes={
        'model_name': model_used.model_name if model_used else 'no-model',
        'agent_name': agent_name,
        'logfire.msg': f'{agent_name} run',
      },
    )
    graph_deps = _agent_graph.GraphAgentDeps[AgentDepsT, RunResultDataT](
      user_deps=deps,
      prompt=user_prompt,
      new_message_index=new_message_index,
      model=model_used,
      model_settings=model_settings,
      usage_limits=usage_limits,
      max_result_retries=self._max_result_retries,
      end_strategy=self.end_strategy,
      result_schema=result_schema,
      result_tools=self._result_schema.tool_defs() if self._result_schema else [],
      result_validators=result_validators,
      function_tools=self._function_tools,
      run_span=run_span,
      tracer=tracer,
    )
    start_node = _agent_graph.UserPromptNode[AgentDepsT](
      user_prompt=user_prompt,
      system_prompts=self._system_prompts,
      system_prompt_functions=self._system_prompt_functions,
      system_prompt_dynamic_functions=self._system_prompt_dynamic_functions,
    )
    async with graph.iter(
      start_node,
      state=state,
      deps=graph_deps,
      infer_name=False,
      span=use_span(run_span, end_on_exit=True),
    ) as graph_run:
      yield AgentRun(graph_run)
  @overload
  defrun_sync(
    self,
    user_prompt: str | Sequence[_messages.UserContent],
    *,
    message_history: list[_messages.ModelMessage] | None = None,
    model: models.Model | models.KnownModelName | None = None,
    deps: AgentDepsT = None,
    model_settings: ModelSettings | None = None,
    usage_limits: _usage.UsageLimits | None = None,
    usage: _usage.Usage | None = None,
    infer_name: bool = True,
  ) -> AgentRunResult[ResultDataT]: ...
  @overload
  defrun_sync(
    self,
    user_prompt: str | Sequence[_messages.UserContent],
    *,
    result_type: type[RunResultDataT] | None,
    message_history: list[_messages.ModelMessage] | None = None,
    model: models.Model | models.KnownModelName | None = None,
    deps: AgentDepsT = None,
    model_settings: ModelSettings | None = None,
    usage_limits: _usage.UsageLimits | None = None,
    usage: _usage.Usage | None = None,
    infer_name: bool = True,
  ) -> AgentRunResult[RunResultDataT]: ...
  defrun_sync(
    self,
    user_prompt: str | Sequence[_messages.UserContent],
    *,
    result_type: type[RunResultDataT] | None = None,
    message_history: list[_messages.ModelMessage] | None = None,
    model: models.Model | models.KnownModelName | None = None,
    deps: AgentDepsT = None,
    model_settings: ModelSettings | None = None,
    usage_limits: _usage.UsageLimits | None = None,
    usage: _usage.Usage | None = None,
    infer_name: bool = True,
  ) -> AgentRunResult[Any]:
"""Synchronously run the agent with a user prompt.
    This is a convenience method that wraps [`self.run`][pydantic_ai.Agent.run] with `loop.run_until_complete(...)`.
    You therefore can't use this method inside async code or if there's an active event loop.
    Example:
```python
    from pydantic_ai import Agent
    agent = Agent('openai:gpt-4o')
    result_sync = agent.run_sync('What is the capital of Italy?')
    print(result_sync.data)
    #> Rome