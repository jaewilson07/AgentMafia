---
url: https://ai.pydantic.dev/api/models/groq/
session_id: pydantic_ai_docs
chunk_number: 4
title: Processing Streamed Responses in Groq
summary: This section describes how to handle streamed responses in the Groq API. It details the implementation of checking for tool calls in a message, constructing ToolCallPart objects, and processing the streamed response using a PeekableAsyncStream to ensure valid content is returned. It also addresses error handling for cases where responses may end prematurely.
embedding: [0.0009653322631493211, 0.03595687448978424, -0.00433488842099905, -0.04133695736527443, 0.0008392365998588502, -0.046358365565538406, 0.005172723904252052, -0.016016950830817223, 0.021968664601445198, -0.006831582169979811, 0.036629386246204376, -0.039050422608852386, 0.020533977076411247, 0.022013498470187187, -0.018337110057473183, -0.016902422532439232, -0.01842677779495716, 0.022842928767204285, 0.020959898829460144, 0.07245176285505295, 0.024031030014157295, 0.006736310198903084, -0.023672357201576233, 0.018830284476280212, -0.0012448442867025733, -0.0004774121625814587, -0.018146565183997154, 0.07536596804857254, -0.024815624579787254, -0.04317515343427658, 0.02035463973879814, -0.014391717500984669, -0.020769355818629265, -0.06949271261692047, 0.01649891585111618, -0.029276609420776367, -0.016420455649495125, 0.04431841894984245, 0.009700958617031574, 0.018729407340288162, 0.012923403643071651, -0.013595913536846638, -0.022405795753002167, 0.025757139548659325, 0.007352777756750584, 0.031226888298988342, -0.029321443289518356, 0.039140090346336365, -0.02528638206422329, 0.03575512394309044, -0.0227756779640913, 0.038602083921432495, 0.00717344181612134, -0.024905292317271233, -0.011477506719529629, -0.002286534523591399, -0.0550113320350647, -0.004228407517075539, 0.0022613154724240303, 0.018494028598070145, -0.03196664899587631, -0.03582237288355827, -0.0026157842949032784, -0.005167119670659304, -0.02885068580508232, -0.02983703278005123, -0.04272681102156639, -0.003412988968193531, -0.024860458448529243, 0.026788320392370224, -0.03196664899587631, 0.01520993746817112, -0.03952118009328842, -0.020724521949887276, -0.025353632867336273, 0.012486271560192108, -0.011791344732046127, 0.013920960016548634, 0.013057905249297619, -0.015546193346381187, -0.02730391174554825, -0.02015288732945919, -0.023493021726608276, -0.02425519935786724, -0.03907284140586853, -0.025555385276675224, -0.0586877204477787, -0.035284366458654404, -0.031383808702230453, 0.006153468042612076, -0.021172860637307167, 0.03434285148978233, -0.02947836183011532, 0.03389451280236244, 0.06276761740446091, 0.01965971291065216, 0.0009849471971392632, 0.008563295938074589, 0.011645633727312088, 0.01564706861972809, 0.06890987604856491, 0.018247442319989204, -0.06514381617307663, -0.015378065407276154, 0.07204825431108475, -0.03358067199587822, 0.019547628238797188, 0.021228903904557228, -0.03609137982130051, -0.01619628630578518, -0.0013632341288030148, -0.004491807427257299, -0.02918693982064724, 0.015221145935356617, -0.0033653529826551676, -0.01362953893840313, -0.020825397223234177, 0.0030094829853624105, 0.0005355562316253781, 0.018012063577771187, -0.05393531545996666, -0.03263916075229645, 0.001693884958513081, -0.027102159336209297, -0.016980880871415138, -0.040238525718450546, 0.0026872383896261454, -0.08191173523664474, -0.06599566340446472, 0.0016532541485503316, 0.0044077434577047825, -0.006041382905095816, 0.00985787808895111, -0.07361744344234467, -0.010194133035838604, -0.003003878751769662, -0.0336703397333622, -0.011690468527376652, -0.021172860637307167, -0.005097066517919302, 0.0014129718765616417, -0.017406804487109184, -0.04429600015282631, -0.013898543082177639, -0.024322450160980225, -0.0044105458073318005, -0.03949876129627228, 0.024120697751641273, -0.05285929888486862, -0.039879851043224335, 0.004898115526884794, 0.015445316210389137, -0.048286229372024536, 0.00606379983946681, 0.027281494811177254, 0.013338117860257626, 0.003093546722084284, 0.02364994026720524, 0.05384564772248268, -0.052231620997190475, -0.007823534309864044, -0.0207357294857502, -0.018841492012143135, 0.009291848167777061, -0.023941360414028168, -0.049362245947122574, -0.004550652112811804, 0.0007460659253410995, -0.040081605315208435, -0.005707929842174053, 0.006271156948059797, 0.001255352282896638, -0.03680872172117233, 0.044811591506004333, 0.009392725303769112, -0.02009684406220913, -0.06828219443559647, -0.04998992010951042, -0.009011635556817055, -0.021453073248267174, -0.025891641154885292, 0.007621781900525093, -0.03680872172117233, -0.04559618979692459, -0.05043826252222061, 0.0264744833111763, 0.013057905249297619, -0.03337892144918442, 0.019132914021611214, 0.026205478236079216, -0.015355648472905159, 0.03142864257097244, 0.03297541290521622, 0.006086216773837805, -0.017070548608899117, -0.03757090121507645, 0.07254143059253693, -0.0168351698666811, -0.014615886844694614, 0.00898921862244606, 0.024456951767206192, 0.017171425744891167, 0.04617903009057045, -0.04774821922183037, 0.035194698721170425, -0.031832147389650345, 0.008260666392743587, 0.0443408340215683, -0.02873860113322735, -0.04774821922183037, 0.0022711227647960186, -0.03595687448978424, 0.01629716344177723, 0.034298017621040344, -0.0006416867836378515, -0.006388846319168806, -0.04543926939368248, 0.003368155099451542, -0.058553218841552734, 0.007330360822379589, -0.03443251922726631, 0.06451614201068878, 0.037615735083818436, 0.012542313896119595, -0.03851241618394852, 0.010827413760125637, -0.009880295023322105, -0.03364792466163635, 0.003931382205337286, -0.002230491954833269, -0.012284519150853157, 0.009218993596732616, 0.02163241058588028, -0.003704410046339035, 0.010653682053089142, -0.07290010154247284, 0.029568029567599297, -0.014302048832178116, 0.040238525718450546, -0.024187948554754257, -0.00763299036771059, -0.011813761666417122, 0.03286333009600639, -0.01732834428548813, 0.029859449714422226, 0.02019772119820118, 0.008927572518587112, -0.018583696335554123, 0.007862764410674572, 0.0693582147359848, 0.04039544239640236, -0.06998588889837265, 0.0031327763572335243, 0.00637203361839056, -0.015333231538534164, -0.027102159336209297, 0.0032700805459171534, 0.014100296422839165, -0.055100999772548676, -0.01531081460416317, 0.04149387776851654, 0.06294695287942886, -0.038983169943094254, 0.03333408758044243, 0.02577955648303032, 0.012542313896119595, 0.017003297805786133, -0.0195027943700552, 0.017507681623101234, 0.009168555028736591, 0.012732858769595623, 0.016129035502672195, 0.027034908533096313, 0.01605057530105114, -0.06182609871029854, -0.009656124748289585, 0.02681073732674122, 0.004858885891735554, 0.013125156052410603, -0.034746356308460236, -0.005326841026544571, 0.023089515045285225, 0.06711651384830475, 0.030016370117664337, -0.02093748189508915, -0.006500931456685066, 0.03624829649925232, -0.03730189800262451, 0.0035727100912481546, 0.01155596598982811, -0.0036903994623571634, 0.0476137176156044, 0.008585712872445583, -0.015691904351115227, 0.03115963749587536, 0.03416351601481438, -0.009992379695177078, -0.0027474842499941587, -0.0011944060679525137, 0.0015958105213940144, -0.0011551763163879514, 0.027685001492500305, 0.009280639700591564, 0.028761018067598343, -0.00891075935214758, 0.01393216848373413, 0.012262101285159588, -0.02183416299521923, 0.00583962956443429, 0.004503015894442797, 0.055639006197452545, 0.03871416673064232, -0.046358365565538406, -0.038153741508722305, -0.02479320764541626, -0.0024952928069978952, -0.008411981165409088, -0.00044623849680647254, 0.03328925371170044, -0.00795243214815855, -0.008613734506070614, 0.031832147389650345, 0.003113161539658904, 0.0018732210155576468, -0.0027474842499941587, 0.023941360414028168, -0.01783272810280323, 0.00038249013596214354, 0.0028609703294932842, 0.03438768535852432, 0.013820083811879158, -0.008316708728671074, -0.01974938064813614, 0.05886705592274666, 0.012340561486780643, 0.0008994823438115418, -0.02557780221104622, -0.02968011423945427, 0.03586720675230026, 0.0171377994120121, -0.018381943926215172, -0.03266157582402229, -0.04543926939368248, 0.017698224633932114, -0.006007757503539324, 0.0025513353757560253, 0.021621201187372208, 0.04236814007163048, -0.03436527028679848, -0.01553498487919569, 0.023784441873431206, -0.005083055701106787, -0.015030601993203163, -0.0112869618460536, 0.021318571642041206, 0.0006847694749012589, 0.0038725375197827816, 0.008159790188074112, 0.007599364500492811, 0.005710732191801071, -0.001528559485450387, 0.02553296834230423, -0.010238966904580593, -0.02568988688290119, -0.018202608451247215, 0.07227242738008499, 0.023044681176543236, -0.034006595611572266, -0.03521711379289627, -0.019132914021611214, 0.0009779417887330055, -0.0038613290525972843, -0.014907307922840118, -0.015501358546316624, -0.0710170716047287, -0.017911186441779137, 0.001793360454030335, 0.049272578209638596, -0.008210227824747562, 0.005990944802761078, 0.050303760915994644, -0.021710868924856186, -0.015097852796316147, 0.0017359168268740177, -0.008327917195856571, 0.04232330620288849, 0.01407787948846817, 0.029657697305083275, -0.046851541846990585, 0.01911049708724022, -0.01256473083049059, -0.06666817516088486, -0.002664821455255151, 0.024232782423496246, 0.031182054430246353, 0.057566870003938675, 0.02153153344988823, 0.017518889158964157, 0.022192835807800293, -0.007896389812231064, 0.019626088440418243, 0.040866199880838394, 0.017944812774658203, 0.009521623142063618, -0.021710868924856186, 0.019883884117007256, -0.008961197920143604, -0.012710441835224628, 0.032414987683296204, 0.016969673335552216, 0.04676187410950661, -0.017261093482375145, 0.022383378818631172, 0.0002809130819514394, 0.022383378818631172, -0.059001557528972626, -0.028335094451904297, 0.030554378405213356, 0.023986196145415306, 0.00122873205691576, 0.014515010640025139, -0.03472394123673439, 0.014044253155589104, 0.020264972001314163, -0.006523348391056061, 0.03111480362713337, 0.01753009855747223, -0.061512261629104614, 0.025757139548659325, -0.003575512208044529, -0.027146993204951286, -0.03189939633011818, 0.07038939744234085, 0.0008070121984928846, 0.01679033599793911, 0.0018227826803922653, 0.001328207552433014, 0.0252415481954813, -0.029814615845680237, 0.003267278429120779, 0.00575556606054306, -0.03586720675230026, 0.014638304710388184, 0.0394090935587883, -0.0307785477489233, -0.01350624579936266, -0.014873682521283627, 0.02044430933892727, -0.027729835361242294, -0.01971575617790222, 0.021015942096710205, -0.018146565183997154, 0.024613872170448303, 0.00706135667860508, -0.027976421639323235, -0.042659562081098557, 0.03559820353984833, 0.05308346822857857, 0.043533824384212494, -0.04436325281858444, 0.042749229818582535, -0.00041121194954030216, 0.006769935600459576, 0.008776257745921612, -0.019536420702934265, -0.02044430933892727, -0.033804845064878464, 0.012900986708700657, -0.00921338889747858, 0.0396108478307724, -0.012340561486780643, 0.04095586761832237, -0.030935466289520264, 0.011068396270275116, 0.005595844704657793, -0.062005434185266495, 0.013876126147806644, 0.030688880011439323, 0.006590599659830332, 0.05021408945322037, 0.006775539834052324, -0.041314538568258286, -0.007313547655940056, 0.0342755988240242, -0.023874109610915184, 0.0636194571852684, 0.007773096673190594, -0.054742325097322464, 0.015770362690091133, 0.04617903009057045, -0.03304266557097435, 0.01600574143230915, -0.032033901661634445, -0.01017731986939907, 0.01225089281797409, -0.016611000522971153, -0.021464282646775246, 0.03398418053984642, 0.03082338161766529, 0.030487127602100372, -0.054742325097322464, -0.014940934255719185, -0.003830505767837167, 0.01778789423406124, -0.0003210185095667839, 0.05545967072248459, 0.0042452202178537846, 0.02934386022388935, 0.02741599641740322, 0.06899954378604889, 0.0005429118173196912, -0.013001862913370132, -0.0032448614947497845, 0.02079177275300026, 0.03378242626786232, 0.023134348914027214, 0.01803448051214218, -0.019883884117007256, -0.008905155584216118, 0.018236232921481133, 0.005901276599615812, 0.0008378355414606631, 0.018706990405917168, 0.005424915347248316, -0.010933893732726574, -0.000361824466381222, -0.02512946166098118, -0.018931161612272263, -0.025017376989126205, 0.004797238856554031, 0.04088861867785454, -0.004287252202630043, 0.015064227394759655, 0.009661729447543621, -0.01086664292961359, -0.02093748189508915, -0.020802980288863182, 0.009101304225623608, 0.005727544892579317, 0.008109351620078087, -0.0365397185087204, -0.005735951010137796, -0.022248877212405205, -0.020119262859225273, 0.016028158366680145, 0.009644916281104088, 0.028178175911307335, -0.0002443103294353932, 0.009700958617031574, -0.009241410531103611, 0.0055594174191355705, -0.03176489472389221, 0.0068035610020160675, -0.01896478608250618, 0.010681702755391598, 0.012318144552409649, -0.031204471364617348, 0.0414714589715004, -0.01867336593568325, -0.019121704623103142, 0.02459145523607731, 0.010513575747609138, 0.04050752893090248, 0.013663164339959621, -0.020802980288863182, 0.042345721274614334, 0.034791190177202225, 0.025600219145417213, 0.0049905856139957905, 0.014167547225952148, -0.006584995426237583, -0.01773185096681118, 0.002556939609348774, -0.02533121593296528, 0.0027474842499941587, -0.002432245062664151, 0.010042818263173103, 0.006125446408987045, -0.0706135630607605, -0.027528082951903343, -0.008563295938074589, -0.031540725380182266, 0.004004237707704306, -0.01902082934975624, -0.018807867541909218, -0.002266919706016779, -0.014918516390025616, 0.0158039890229702, -0.01974938064813614, -0.037413980811834335, 0.02835751138627529, -0.03319958597421646, -0.00575556606054306, 0.02335851825773716, -0.030487127602100372, -0.024860458448529243, -0.002331368625164032, -0.013920960016548634, -0.043287236243486404, -3.2114985515363514e-05, 0.06308145076036453, -0.00736959045752883, -0.012699233368039131, 0.01496335119009018, -0.03337892144918442, -0.0026536129880696535, 0.02276446856558323, -0.018583696335554123, -0.044923678040504456, 0.034499771893024445, 0.013752833008766174, -0.01674550212919712, -0.02430003322660923, -0.032280486077070236, 0.011281358078122139, -0.01792239584028721, 0.002956242533400655, -0.01851644553244114, 0.05438365414738655, -0.00109282904304564, -0.011589591391384602, 0.04940707981586456, 0.009734584018588066, -0.0019460762850940228, 0.006551369559019804, 0.01965971291065216, 0.035284366458654404, -0.0023145556915551424, 0.007750679273158312, 0.05039342865347862, 0.048824235796928406, -0.015153895132243633, 0.0388038344681263, 0.02425519935786724, -0.03436527028679848, 0.031787313520908356, 0.047389548271894455, -0.023986196145415306, 0.0017331147100776434, -0.04218880459666252, 0.022461839020252228, 0.01397700235247612, -0.0034914484713226557, -0.028514429926872253, 0.0010753157548606396, 0.0037884737830609083, -0.018706990405917168, 0.04129212349653244, 0.0213409885764122, -0.005789191462099552, 0.013685581274330616, -0.03712255880236626, -0.021856579929590225, 0.0039566014893352985, 0.016880005598068237, -0.02573472261428833, -0.011813761666417122, 0.011802553199231625, -0.0034101868513971567, 0.02000717632472515, -0.049227744340896606, 0.0052651939913630486, -0.0046179029159247875, 0.04142662510275841, -0.007918806746602058, 0.03743639960885048, 0.014010627754032612, 0.011925846338272095, 0.019827840849757195, -0.007694636937230825, 0.00023310181859415025, -0.0032000273931771517, 0.01782151870429516, -0.03131655603647232, 0.028066089376807213, -0.012721650302410126, 0.007571343332529068, -0.04411666467785835, 0.0034241974353790283, 0.023694774135947227, -0.027595333755016327, -0.009325474500656128, -0.04044027626514435, 0.024524202570319176, 0.03532920032739639, -0.02315676584839821, 0.038153741508722305, 0.012766484171152115, -0.008725819177925587, 0.009818647988140583, -0.01508664432913065, -0.08280842006206512, 0.01323724165558815, -0.026250312104821205, 0.041561126708984375, 0.011001145467162132, -0.030800964683294296, 0.04030577465891838, -0.010653682053089142, -0.031675226986408234, -0.0014711159747093916, -0.007851555943489075, -0.016162659972906113, -0.015602235682308674, 0.00472718570381403, -0.02844717912375927, -0.0063047828152775764, 0.002166043035686016, 0.024434534832835197, -5.534198135137558e-05, -0.0041807712987065315, -0.03275124356150627, -0.008355938829481602, 0.010804996825754642, -0.026653818786144257, 0.022641174495220184, -0.004788832738995552, 0.012990654446184635, 0.03189939633011818, 0.021991081535816193, 0.008798674680292606, 0.0007397611625492573, -0.06456097215414047, 0.02335851825773716, -0.008507253602147102, -0.029568029567599297, -0.011488715186715126, 0.04662736877799034, 0.0033429358154535294, 0.03091304935514927, -0.010390281677246094, 0.004595485981553793, 0.011970680207014084, -0.030016370117664337, -0.002520512090995908, -0.007745075039565563, -0.06119842454791069, -0.030711296945810318, -0.004662737250328064, 0.0019236592343077064, 0.027236660942435265, 0.01902082934975624, 0.017373178154230118, -0.023672357201576233, -0.00901724025607109, -0.01822502538561821, -0.02622789517045021, 0.008933176286518574, -0.029859449714422226, 0.029904285445809364, -0.008114955388009548, 0.004463786259293556, -0.005256787873804569, -0.024434534832835197, 0.003314914647489786, -0.009588873945176601, -0.0064504933543503284, -0.02533121593296528, -0.05339730530977249, -0.02692282386124134, 0.0014003622345626354, 0.019771797582507133, -0.002587763126939535, 0.01570311188697815, -0.007380798924714327, -0.023201599717140198, 0.017025714740157127, -0.0034354059025645256, 0.024031030014157295, -0.041359372437000275, -0.022484255954623222, -0.0036287526600062847, 0.009532831609249115, 0.017552515491843224, 0.05640118569135666, -0.04460984095931053, 0.03887108713388443, -0.018191399052739143, 0.021845370531082153, -0.020522767677903175, -0.030016370117664337, 0.009549643844366074, -0.0316079780459404, -0.002547132084146142, 0.014515010640025139, 0.013640747405588627, -0.03571029007434845, -0.023470604792237282, -0.006439284887164831, 0.012643191032111645, -0.012654399499297142, 0.008557691238820553, 0.007347173523157835, 0.023403353989124298, 0.03389451280236244, -0.05097626894712448, 0.023089515045285225, -0.0923580601811409, -0.00028879407909698784, 0.024434534832835197, -0.014212381094694138, 0.0050578368827700615, 0.001437490456737578, -0.044968511909246445, 0.004276043735444546, 0.0074704671278595924, -0.05680469051003456, 0.022159209474921227, 0.030800964683294296, 0.025308798998594284, 0.0034970527049154043, 0.024434534832835197, -0.0054305195808410645, -0.010530387982726097, -0.0076161776669323444, -0.006400054786354303, -0.03344617038965225, 0.010435115545988083, -0.007005313877016306, -0.02947836183011532, 0.016532540321350098, 0.007392007391899824, -0.0392073430120945, 0.020769355818629265, 0.0014318862231448293, 0.03245982155203819, -0.02598130889236927, -0.022708425298333168, 0.01742922142148018, -0.000973738671746105, 0.0195027943700552, -0.06218477338552475, 0.026384815573692322, -0.0017639381112530828, 0.004542245529592037, -0.0034157910849899054, -0.05819454416632652, 0.008210227824747562, -0.016723085194826126, 0.023448187857866287, -0.005962923169136047, 0.043332070112228394, 0.05384564772248268, 0.014458968304097652, -0.0036651804111897945, 0.005587438587099314, 0.009112512692809105, -0.010507971048355103, -0.003275684779509902, -0.024434534832835197, 0.02020893059670925, 0.04676187410950661, 0.029612863436341286, -0.0550113320350647, -0.01619628630578518, -0.00433488842099905, 0.02811092510819435, -0.002101594116538763, 0.0044077434577047825, 0.0656818225979805, -0.024905292317271233, -0.016476498916745186, -0.016465289518237114, -0.01635320484638214, 0.001278469804674387, -0.03481360897421837, -0.02005201019346714, -0.01813535764813423, 0.011724093928933144, 0.008737027645111084, 0.012822526507079601, -0.02573472261428833, 0.004214397165924311, 0.011034770868718624, 0.03579995781183243, 0.006439284887164831, 0.025062210857868195, 0.016969673335552216, -0.007139815948903561, -0.03315475210547447, 0.011225314810872078, -0.016263537108898163, -0.016319580376148224, -0.006719497032463551, 0.00012075409904355183, -0.011847387067973614, -0.008608129806816578, 0.015826405957341194, -0.020164096727967262, 0.01813535764813423, -0.009118116460740566, -0.023470604792237282, 0.010087652131915092, -0.02696765772998333, -0.013338117860257626, 0.027281494811177254, -0.018112940713763237, 0.012699233368039131, 0.022786885499954224, -0.017709434032440186, -0.0238068588078022, 0.02528638206422329, -0.010048422031104565, -0.005766774527728558, 0.027595333755016327, 0.015882447361946106, 0.011006749235093594, 0.0052595897577703, 0.01116366870701313, 0.017305927351117134, 0.02434486709535122, -0.026339981704950333, -0.031832147389650345, 0.07868368923664093, -0.011600799858570099, -0.012262101285159588, 0.026138227432966232, 0.0009933535475283861, 0.025219131261110306, -0.0035362825728952885, 0.0002688289387151599, 0.001520153135061264, 0.0020987919997423887, -0.010110069066286087, 0.03156314417719841, 0.008613734506070614, -0.02306709811091423, 0.0016140243969857693, -0.0005145402974449098, -0.029993953183293343, 0.0373467318713665, -0.023134348914027214, 0.04599969461560249, -0.005256787873804569, -0.026384815573692322, -0.0676993578672409, -0.021419448778033257, -0.00207357294857502, -0.009493601508438587, 0.04357865825295448, 0.007890786044299603, -0.0394090935587883, -0.03391692787408829, -0.0028525639791041613, 0.021643618121743202, 0.010905873030424118, -0.002767099067568779, 0.02163241058588028, -0.0201080534607172, 0.002359389793127775, 0.012609565630555153, -0.04400458186864853, 0.011645633727312088, -0.006584995426237583, -0.023874109610915184, -0.04653770104050636, -0.016039367765188217, -0.03106996975839138, 0.04523751512169838, -0.028088506311178207, -0.023986196145415306, -0.024950126186013222, -0.015198729000985622, 0.01288977824151516, -0.00418637553229928, -0.013450202532112598, 0.0392073430120945, -0.0607500821352005, 0.02409828081727028, 0.01553498487919569, -0.01096752006560564, 0.021867787465453148, 0.012385395355522633, 0.01936829276382923, -0.005693919491022825, 0.016633417457342148, 0.05200745165348053, -0.0066578504629433155, 0.05936022847890854, -0.001005262602120638, -0.020332222804427147, 0.002520512090995908, -0.0011796948965638876, -0.0016000136965885758, 0.004290054552257061, 0.008871530182659626, 0.001178994309157133, 0.011270149610936642, 0.0336703397333622, -0.0453496016561985, 0.03259432688355446, 0.002582158660516143, 0.007868369109928608, 0.041762880980968475, 0.031630393117666245, -0.015366856940090656, 0.014896099455654621, 0.03947634622454643, 0.030935466289520264, 0.018213815987110138, -0.0336703397333622, 0.0035474910400807858, 0.03526194766163826, -0.029030021280050278, -0.02474837377667427, -0.03665180131793022, 0.024232782423496246, 0.018953578546643257, -0.01793360337615013, -0.014716763980686665, 0.0020147282630205154, -0.026541734114289284, -0.01309153065085411, -0.007190254516899586, -0.011690468527376652, -0.0015944094629958272, -0.004931740928441286, -0.017272302880883217, 0.026003725826740265, -0.03149589151144028, 0.008540879003703594, -0.02177811972796917, 0.0009989577811211348, -0.00025166591512970626, 0.028469596058130264, -0.0006665556575171649, 0.006730705965310335, 0.027281494811177254, -0.031675226986408234, -0.029209356755018234, -0.00041506486013531685, 0.04440808668732643, -0.05034859478473663, -7.70584520068951e-05, -0.029657697305083275, 0.012721650302410126, 0.06451614201068878, 0.011264544911682606, 0.032325319945812225, 0.006954875774681568, -0.028088506311178207, 0.02696765772998333, 0.007352777756750584, 0.013371743261814117, 0.0033821656834334135, 0.00033625506330281496, -0.0030010766349732876, 0.005046628415584564, 0.015635861083865166, -0.002502298215404153, -0.0032448614947497845, 0.011836178600788116, -0.021699661388993263, -0.012732858769595623, 0.013046696782112122, -0.006590599659830332, -0.0030543168541043997, 0.011724093928933144, -0.007840347476303577, 0.029299026355147362, 0.0020539581310003996, 0.0301732886582613, -0.007694636937230825, -0.028671348467469215, 0.023448187857866287, 0.0025163087993860245, 0.035149864852428436, -0.020477933809161186, -0.0013730415375903249, -0.028536846861243248, 0.03115963749587536, 0.03967810049653053, -0.0476137176156044, -0.022103166207671165, 0.0005681309849023819, 0.012598357163369656, 0.008283083327114582, -0.04093345254659653, 0.0041975839994847775, -0.014313257299363613, -0.029276609420776367, 0.030554378405213356, -0.01553498487919569, 0.02573472261428833, -0.03165281191468239, -0.006764331366866827, 0.008456815034151077, 0.002621388528496027, 0.027819503098726273, -0.014234798029065132, -0.027191827073693275, 0.02582439035177231, -0.002596169477328658, 0.024613872170448303, 0.0008581509464420378, 0.03245982155203819, 0.018550071865320206, 0.00679235253483057, -0.0320114828646183, 0.0034550209529697895, 0.03591204062104225, 0.019390709698200226, 0.021161653101444244, -0.028290260583162308, -0.04864490032196045, 0.007111794780939817, -0.017305927351117134, -0.0363379642367363, 0.005663095973432064, 0.03557578846812248, 0.009443162940442562, 0.03985743597149849, 0.029074855148792267, 0.01609540916979313, -0.01886390894651413, -0.009992379695177078, 0.006601808127015829, -0.033109914511442184, 0.040126439183950424, 0.006046987138688564, 0.017597349360585213, 0.024524202570319176, -0.04174046218395233, -0.015097852796316147, 0.0021156049333512783, 0.005699523724615574, 0.0065793911926448345, 0.06684751063585281, 0.02701249159872532, 0.022786885499954224, -0.012463854625821114, -0.026093393564224243, -0.025219131261110306, -0.05102110281586647, -0.030464710667729378, -0.01496335119009018, -0.0111356470733881, -0.022562716156244278, 0.0042480225674808025, -0.0529489666223526, -0.018090523779392242, -0.00456746481359005, -0.0070333355106413364, 0.01481764018535614, -0.006562578026205301, -0.018931161612272263, -0.012844943441450596, 0.07047906517982483, -0.0010872246930375695, 0.005094264168292284, 0.04810689389705658, 0.008047704584896564, 0.041067954152822495, 0.018359526991844177, 0.018729407340288162, 0.0029001999646425247, -0.02470353990793228, -0.00159300840459764, 0.037458814680576324, 0.027841920033097267, 0.010776975192129612, -0.004438566975295544, -0.014402925968170166, 0.006103029474616051, 0.011690468527376652, 0.008215832524001598, 0.015232355333864689, 0.026317564770579338, 0.014515010640025139, 0.0026325969956815243, -0.006119842175394297, -0.0012749671004712582, 0.01742922142148018, 0.003595127258449793, -0.025645053014159203, 0.037660568952560425, 0.03956601396203041, -0.011522340588271618, -0.009560852311551571, -0.015299606136977673, -0.020780563354492188, -0.00840077269822359, 0.018101731315255165, -0.01902082934975624, -0.007845952175557613, 0.025600219145417213, -0.008468023501336575, 0.0097513971850276, 0.0048308647237718105, -0.008355938829481602, -0.013293283991515636, -0.001766740228049457, 0.012934612110257149, 0.00606379983946681, -0.011937054805457592, -0.005256787873804569, -0.015927281230688095, -0.0010858236346393824, -0.012609565630555153, 0.006119842175394297, -0.03398418053984642, -0.0069492715410888195, -0.01296823751181364, 0.0023341707419604063, 0.02577955648303032, 0.02182295359671116, 0.0014697149163112044, 0.0007278521079570055, 0.01481764018535614, -0.007767492439597845, 0.008804278448224068, -0.003712816396728158, -0.02144186571240425, 0.0350826121866703, -0.015938490629196167, -0.02302226424217224, 0.013226033188402653, -0.013427785597741604, 0.0426819771528244, 0.0125198969617486, -0.002737676724791527, -0.01753009855747223, -0.0038921525701880455, 0.005262392107397318, -0.021621201187372208, 0.02544330060482025, -0.0031832146923989058, 0.0022417004220187664, -0.05142460763454437, 0.008636151440441608, -0.013595913536846638, -0.03553095459938049, 0.022484255954623222, 0.03546370193362236, -0.029859449714422226, 0.007397611625492573, 0.008075726218521595, 0.037862323224544525, -0.010726536624133587, -0.01768701709806919, 0.020421892404556274, -0.003922976087778807, 0.01133179571479559, 0.02389652654528618, -0.005862046964466572, 0.029299026355147362, 0.026452066376805305, 0.016734294593334198, 0.03564303740859032, 0.034454938024282455, 0.034298017621040344, -0.06330562382936478, -0.012990654446184635, -0.041852548718452454, -0.003312112530693412, 0.013719206675887108, 0.009544040076434612, 0.018684573471546173, -0.0019783007446676493, -0.004889709409326315, 0.03057679533958435, -0.02074693888425827, -0.01778789423406124, -0.013069113716483116, -0.004046269226819277, 0.015613444149494171, -0.05913605913519859, 0.04729988053441048, 0.02000717632472515, 0.028761018067598343, -0.008737027645111084, -0.024636289104819298, 0.012587148696184158, 0.014212381094694138, -0.02306709811091423, -0.01486247405409813, -0.01596090756356716, 0.0009183966903947294, 0.02676590345799923, 0.014582261443138123, -0.015456524677574635, -0.0554148368537426, -0.0022599142976105213, -0.009835461154580116, -0.018236232921481133, -0.021867787465453148, 0.0307785477489233, -0.025555385276675224, 0.022977430373430252, 0.00034238473745062947, -0.006125446408987045, -0.015815196558833122, 0.01064247265458107, 0.012531105428934097, -0.0277074184268713, 0.01729471981525421, 0.01699209026992321, -0.01131498347967863, 0.02696765772998333, -0.028133342042565346, -0.03575512394309044, 0.015994533896446228, -0.011393442749977112, -0.005422112997621298, -0.018236232921481133, -0.014234798029065132, 0.0017989646876230836, 0.017799101769924164, -0.016420455649495125, 0.0056406790390610695, -0.011712885461747646, 0.025645053014159203, 0.018494028598070145, 0.03174247965216637, 0.02568988688290119, 0.02163241058588028, -0.016902422532439232, -0.0346791073679924, 0.012318144552409649, -0.008871530182659626, 0.012800109572708607, 0.006243135780096054, -0.0005068344762548804, -0.0006623524241149426, 0.03777265176177025, -0.012138808146119118, -0.016969673335552216, -0.015815196558833122, -0.0125198969617486, 0.02849201299250126, -0.025420883670449257, 0.011981889605522156, 0.017899978905916214, 0.008019683882594109, 0.0019068465335294604, -0.015243563801050186, 0.0033513421658426523, 0.004029456526041031, 0.004687956068664789, -0.01926741562783718, 0.009185368195176125, 0.02681073732674122, 0.016364414244890213, 0.011993098072707653, 0.008966801688075066, 0.04277164489030838, 0.015927281230688095, -0.021004734560847282, -0.00864175520837307, -0.0322132371366024, 0.025107044726610184, -0.020522767677903175, -0.009420746006071568, -0.001124352915212512, 0.00487850047647953, -0.03239257261157036, -0.00030648248502984643, -0.010244571603834629, -4.763613469549455e-05, 0.009964358992874622, 0.00560705317184329, 0.024882875382900238, -0.0018003657460212708, 0.020959898829460144, 0.010334239341318607, 0.012228475883603096, -0.04360107332468033, 0.0013996617635712028, -0.015557401813566685, 0.00583962956443429, -0.028873102739453316, 0.018112940713763237, 0.007767492439597845, 0.03564303740859032, -0.010468740947544575, 0.02099352516233921, -0.0007572744507342577, -0.003177610458806157, -0.023179182782769203, 0.024681122973561287, 0.013764041475951672, -0.016162659972906113, 0.00411071814596653, -0.010692911222577095, -0.04198705032467842, -0.005018606781959534, -0.014436551369726658, -0.02873860113322735, 0.01262077409774065, 0.001334512373432517, -0.0222712941467762, 0.00471877958625555, 0.01670066826045513, -0.008383959531784058, 0.0010171716567128897, 0.04851039871573448, 0.0428837314248085, 0.023694774135947227, 0.020029593259096146, -0.0040378631092607975, -0.01625232771039009, 0.01911049708724022, -0.012867361307144165, 0.008019683882594109, -0.04221121966838837, 0.014952142722904682, 0.04449775442481041, -0.0054949684999883175, -0.01469434704631567, 0.03127172216773033, 0.012295727618038654, -0.02084781415760517, 0.00433488842099905, -0.015097852796316147, -0.03174247965216637, 0.008479231968522072, 0.03575512394309044, 0.005069045349955559, 0.011348608881235123, -0.004598288331180811, -0.003712816396728158, -0.014290840364992619, 0.020758146420121193, -0.021845370531082153, 0.0013268064940348268, -0.003981820307672024, -0.02725907787680626, 0.002474276814609766, -0.007588156033307314, 0.004155552480369806, 0.029074855148792267, -0.023224016651511192, 0.033468589186668396, 0.0057051279582083225, -0.0058003999292850494, -0.011836178600788116, 0.0029982745181769133, 0.03465668857097626, -0.02618306130170822, 0.010182924568653107, -0.03111480362713337, -0.002576554426923394, 0.01742922142148018, -0.008585712872445583, -0.03582237288355827, 0.012362978421151638, -0.014156338758766651, -0.0227756779640913, 0.0012210262939333916, 0.006321595516055822, -0.030509544536471367, 0.02335851825773716, 0.014537427574396133, -0.0059292977675795555, -0.011057187803089619, -0.03974534943699837, 0.00925822276622057, 0.007823534309864044, -0.012878569774329662, 0.014851265586912632, 0.0020623644813895226, 0.014279631897807121, -0.004085499327629805, -0.020141679793596268, -0.02147549018263817, 0.03490327671170235, -0.007425632793456316, 0.026295145973563194, 0.02651931717991829, 0.022876553237438202, -0.023874109610915184, 0.01634199731051922, -0.007879577577114105, -0.007492884062230587, -0.01605057530105114, 0.04508059844374657, -0.05151427909731865, 0.008137373253703117, 0.036629386246204376, -0.02128494530916214, 0.008697797544300556, -0.028805851936340332, -0.00411071814596653, 0.02790917083621025, 0.020814189687371254, -0.006058195605874062, 0.0019166539423167706, -0.01680154539644718, -0.005884463898837566, -0.017552515491843224, 0.007571343332529068, 0.009644916281104088, 0.05196261778473854, -0.04035060852766037, -0.00690443767234683, -0.012060348875820637, -0.02651931717991829, -0.0227756779640913, -0.004065884277224541, 0.026631401851773262, -0.01723867654800415, 0.006226323079317808, -0.010961915366351604, -0.03586720675230026, -0.0174404289573431, -0.03384967893362045, 0.003743639914318919, -0.009039657190442085, 0.029321443289518356, 0.01296823751181364, 0.021553950384259224, -0.030397458001971245, -0.007016522344201803, -0.02795400470495224, 0.013382951728999615, 0.023336101323366165, 0.002320159925147891, -0.013203616254031658, 0.024322450160980225, 0.014974559657275677, -0.043937329202890396, 0.011258941143751144, -0.04860006645321846, -0.004895313642919064, -0.021352197974920273, -0.004867292009294033, 0.03149589151144028, 0.037369146943092346, 0.014044253155589104, 0.005990944802761078, 0.010945103131234646, -0.012206058949232101, 0.010810600593686104, 0.0031523914076387882, 0.018191399052739143, -0.03259432688355446]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-15T11:17:46.008727", "url_path": "/api/models/groq/", "chunk_size": 4998}
updated_dt: 2025-03-15T11:17:46.010301
---
if choice.message.tool_calls is not None:
      for c in choice.message.tool_calls:
        items.append(ToolCallPart(tool_name=c.function.name, args=c.function.arguments, tool_call_id=c.id))
    return ModelResponse(items, model_name=response.model, timestamp=timestamp)
  async def_process_streamed_response(self, response: AsyncStream[chat.ChatCompletionChunk]) -> GroqStreamedResponse:
"""Process a streamed response, and prepare a streaming response to return."""
    peekable_response = _utils.PeekableAsyncStream(response)
    first_chunk = await peekable_response.peek()
    if isinstance(first_chunk, _utils.Unset):
      raise UnexpectedModelBehavior('Streamed response ended without content or tool calls')
    return GroqStreamedResponse(
      _response=peekable_response,
      _model_name=self._model_name,
      _timestamp=datetime.fromtimestamp(first_chunk.created, tz=timezone.utc),
    )
  def_get_tools(self, model_request_parameters: ModelRequestParameters) -> list[chat.ChatCompletionToolParam]:
    tools = [self._map_tool_definition(r) for r in model_request_parameters.function_tools]
    if model_request_parameters.result_tools:
      tools += [self._map_tool_definition(r) for r in model_request_parameters.result_tools]
    return tools
  def_map_message(self, message: ModelMessage) -> Iterable[chat.ChatCompletionMessageParam]:
"""Just maps a `pydantic_ai.Message` to a `groq.types.ChatCompletionMessageParam`."""
    if isinstance(message, ModelRequest):
      yield from self._map_user_message(message)
    elif isinstance(message, ModelResponse):
      texts: list[str] = []
      tool_calls: list[chat.ChatCompletionMessageToolCallParam] = []
      for item in message.parts:
        if isinstance(item, TextPart):
          texts.append(item.content)
        elif isinstance(item, ToolCallPart):
          tool_calls.append(self._map_tool_call(item))
        else:
          assert_never(item)
      message_param = chat.ChatCompletionAssistantMessageParam(role='assistant')
      if texts:
        # Note: model responses from this model should only have one text item, so the following
        # shouldn't merge multiple texts into one unless you switch models between runs:
        message_param['content'] = '\n\n'.join(texts)
      if tool_calls:
        message_param['tool_calls'] = tool_calls
      yield message_param
    else:
      assert_never(message)
  @staticmethod
  def_map_tool_call(t: ToolCallPart) -> chat.ChatCompletionMessageToolCallParam:
    return chat.ChatCompletionMessageToolCallParam(
      id=_guard_tool_call_id(t=t, model_source='Groq'),
      type='function',
      function={'name': t.tool_name, 'arguments': t.args_as_json_str()},
    )
  @staticmethod
  def_map_tool_definition(f: ToolDefinition) -> chat.ChatCompletionToolParam:
    return {
      'type': 'function',
      'function': {
        'name': f.name,
        'description': f.description,
        'parameters': f.parameters_json_schema,
      },
    }
  @classmethod
  def_map_user_message(cls, message: ModelRequest) -> Iterable[chat.ChatCompletionMessageParam]:
    for part in message.parts:
      if isinstance(part, SystemPromptPart):
        yield chat.ChatCompletionSystemMessageParam(role='system', content=part.content)
      elif isinstance(part, UserPromptPart):
        yield cls._map_user_prompt(part)
      elif isinstance(part, ToolReturnPart):
        yield chat.ChatCompletionToolMessageParam(
          role='tool',
          tool_call_id=_guard_tool_call_id(t=part, model_source='Groq'),
          content=part.model_response_str(),
        )
      elif isinstance(part, RetryPromptPart):
        if part.tool_name is None:
          yield chat.ChatCompletionUserMessageParam(role='user', content=part.model_response())
        else:
          yield chat.ChatCompletionToolMessageParam(
            role='tool',
            tool_call_id=_guard_tool_call_id(t=part, model_source='Groq'),
            content=part.model_response(),
          )
  @staticmethod
  def_map_user_prompt(part: UserPromptPart) -> chat.ChatCompletionUserMessageParam:
    content: str | list[chat.ChatCompletionContentPartParam]
    if isinstance(part.content, str):
      content = part.content
    else:
      content = []
      for item in part.content:
        if isinstance(item, str):
          content.append(chat.ChatCompletionContentPartTextParam(text=item, type='text'))
        elif isinstance(item, ImageUrl):
          image_url = ImageURL(url=item.url)
          content.append(chat.ChatCompletionContentPartImageParam(image_url=image_url, type='image_url'))
        elif isinstance(item, BinaryContent):
          base64_encoded = base64.b64encode(item.data).decode('utf-8')
          if item.is_image:
            image_url = ImageURL(url=f'data:{item.media_type};base64,{base64_encoded}')
            content.append(chat.ChatCompletionContentPartImageParam(image_url=image_url, type='image_url'))
          else:
            raise RuntimeError('Only imag