---
url: https://ai.pydantic.dev/examples/chat-app/
session_id: pydantic_ai_docs
chunk_number: 4
title: Streaming Responses in a Chat Application
summary: This code snippet demonstrates how to handle streaming responses in a chat application using TypeScript. It fetches responses as newline-delimited JSON, decodes the data chunk by chunk, updates the chat messages in real-time, and manages user input states, including enabling/disabling input fields based on response status.
embedding: [-0.008326898328959942, -0.01902076043188572, -0.0035203290171921253, 0.019403444603085518, 0.021458594128489494, -0.008582020178437233, -0.012989960610866547, 0.02541298419237137, -0.0009203879744745791, -0.0038835236337035894, 0.05042911320924759, -0.009297778829932213, 0.0023173580411821604, 0.011204106733202934, 0.010516694746911526, 0.020310545340180397, -0.029650844633579254, 0.002955162897706032, 0.00779539393261075, 0.03240049257874489, 0.01631363295018673, -0.01127497386187315, 0.03183355554938316, 0.018000273033976555, -0.011395448818802834, 0.0007848544628359377, -0.013287602923810482, 0.0721711739897728, 0.011515922844409943, -0.03517848625779152, 0.004237859509885311, -0.03432808071374893, 0.03313751146197319, -0.016894744709134102, 0.003529187524691224, 0.01622859202325344, 0.02939572185277939, 0.003865806618705392, -0.006732385605573654, -0.022521601989865303, -0.0124017633497715, -0.044986508786678314, 0.011530096642673016, 0.0032315452117472887, -0.003212056588381529, 0.023258620873093605, -0.049408625811338425, -0.0018691228469833732, 0.008830055594444275, 0.056410305202007294, -0.05493626743555069, 0.016200246289372444, 0.003592967987060547, 0.08169572800397873, -0.0285594891756773, -0.05833789333701134, -0.05133621394634247, 0.056920550763607025, -0.00014129151531960815, 0.011055286042392254, 0.04688575118780136, -0.03577377274632454, -0.022337347269058228, -0.0029817381873726845, -0.019176669418811798, 0.00650206720456481, -0.031521737575531006, -0.006356789264827967, 0.003819742938503623, 0.05816781148314476, 0.05493626743555069, 0.018893200904130936, 0.01886485330760479, -0.049040116369724274, -0.0052300007082521915, -0.0007361331954598427, 0.011827738955616951, 0.0323154516518116, 0.0016547495033591986, -0.020834961906075478, 0.0236696507781744, 0.023357834666967392, -0.040479354560375214, -0.05643865093588829, -0.0323154516518116, -0.014967156574130058, -0.057005591690540314, -0.0015803389251232147, -0.035887159407138824, 0.0020799527410417795, -0.03208867460489273, 0.013776587322354317, -0.09133367240428925, 0.04424948990345001, 0.049862176179885864, 0.009120610542595387, -0.030642984434962273, -0.008688321337103844, 0.0009549357346259058, 0.00620088167488575, 0.11384110152721405, -0.07676336914300919, -0.05624022334814072, 0.008461546152830124, -0.009893063455820084, 0.009489119984209538, 0.00621859822422266, -0.01544905360788107, -0.043994367122650146, -0.014109662733972073, -0.06026548147201538, 0.0169089175760746, 0.005375278647989035, 0.030047699809074402, 0.023046018555760384, -0.053093720227479935, 0.00331658567301929, -0.01254349760711193, -0.016781358048319817, 0.007285149767994881, -0.019729433581233025, 0.03021778166294098, -0.003176623024046421, -0.0019577068742364645, -0.008985963650047779, -0.034611549228429794, -0.001108186086639762, -0.03194694221019745, -0.03478163108229637, 0.00973715540021658, 0.04011084511876106, -0.017986100167036057, 0.056325264275074005, -0.037162769585847855, -0.022861763834953308, 0.038353338837623596, -0.031748514622449875, 0.004351247102022171, -0.023542089387774467, 0.043852634727954865, 0.007044201251119375, -0.06026548147201538, 0.005056376103311777, -0.006767819169908762, -0.010353700257837772, -0.02403816021978855, -0.019346751272678375, 0.00010176089563174173, -0.06372380256652832, -0.01788688637316227, -0.004758733790367842, 0.046857405453920364, -0.044759735465049744, 0.029367374256253242, 0.03189024701714516, -0.029424069449305534, 0.04277545213699341, 0.03892027586698532, -0.04892672598361969, -0.022578295320272446, -0.01744750887155533, -0.04246363788843155, -0.004556762054562569, -0.03710607439279556, -0.0017415619222447276, 0.005995366722345352, 0.0044256579130887985, -0.011367102153599262, -0.08623123168945312, 0.024831872433423996, -0.016256939619779587, -0.034469813108444214, -0.04801962524652481, 0.011707263998687267, -0.012047426775097847, 0.001716758357360959, 0.016554582864046097, -0.0759129598736763, -0.0006998137687332928, 0.01652623526751995, 0.023853905498981476, 0.07075382769107819, -0.02225230634212494, -0.02569645270705223, -0.04155653715133667, -0.03781474754214287, 0.014952982775866985, 0.022138919681310654, 0.0025831100065261126, -0.007207196205854416, -0.016880571842193604, 0.011678917333483696, 0.06304347515106201, 0.01624276675283909, 0.02443501725792885, -0.05453941226005554, 0.0645742118358612, -0.013804933987557888, 0.003879980184137821, 0.018241221085190773, 0.02892799861729145, 0.025143688544631004, 0.0390620119869709, -0.04291718825697899, 0.0033892246428877115, -0.040025804191827774, -0.02508699521422386, 0.0029037841595709324, 0.006470176856964827, -0.048444829881191254, 0.049125153571367264, 0.004553218837827444, 0.020905829966068268, 0.01722073368728161, -0.05281025171279907, -0.017263254150748253, -0.04784954711794853, 0.01722073368728161, -0.03472493588924408, -0.0005049289320595562, -0.07058374583721161, 0.03923209011554718, 0.07863426208496094, -0.036935992538928986, 0.02539881132543087, 0.02607913687825203, 0.0774436965584755, 0.002490982646122575, -0.02321610040962696, 0.044221144169569016, 0.029367374256253242, -0.020834961906075478, -0.016937265172600746, -0.03254222497344017, 0.0315500870347023, -0.043710898607969284, 0.04351247102022171, 0.004595738835632801, 0.014081316068768501, 0.03495171293616295, 0.0046701496466994286, -0.006413483060896397, 0.019630219787359238, 0.01577504351735115, 0.04064943641424179, 0.017036478966474533, -0.03894862160086632, -0.031181575730443, 0.029197294265031815, 0.06412065774202347, 0.03583046421408653, -0.03058629110455513, 0.013358470983803272, 0.000810100871603936, 0.009545814245939255, -0.044164448976516724, -0.0027638215105980635, -0.0007813110714778304, -8.808573329588398e-05, -0.0009035569964908063, -0.008461546152830124, 0.02306019328534603, -0.018397130072116852, 0.04705583304166794, -0.024534231051802635, -0.04342743009328842, 0.036794260144233704, 0.023783037438988686, 0.00819225050508976, -0.03651079162955284, 0.014967156574130058, -0.009439513087272644, 0.04487312212586403, 0.023783037438988686, -0.015491574071347713, -0.0055205561220645905, -0.020934175699949265, 0.01834043674170971, -0.01774515211582184, 0.03988407179713249, -0.005594966933131218, -0.04481642693281174, 0.0031411894597113132, -0.007476491387933493, -0.0036461183335632086, 0.055559899657964706, -0.013500205241143703, -0.03988407179713249, 0.0070760915987193584, -0.032343797385692596, 0.03444146737456322, -0.041528187692165375, 0.012621451169252396, -0.024364149197936058, 0.04484477639198303, 0.04019588604569435, 0.03203198313713074, 0.015420706942677498, 0.02134520560503006, 0.01266397163271904, 0.0074127111583948135, 0.0017096715746447444, 0.016894744709134102, -0.01750420220196247, -0.012047426775097847, 0.02059401385486126, -0.031096534803509712, 0.010204879567027092, 0.007759960368275642, -0.05116613209247589, -0.014981329441070557, 0.04337073862552643, -0.047225914895534515, -0.03645409643650055, -0.04022423177957535, -0.026702767238020897, 0.06117258220911026, 0.013918321579694748, 0.022039704024791718, -0.05867805704474449, 0.0112678874284029, -0.02209639921784401, 0.008780448697507381, -0.030331168323755264, -0.034668244421482086, -0.03149339184165001, -0.006165448110550642, -0.004723300226032734, 0.03282569348812103, 0.04447626695036888, 0.01870894618332386, -0.037843093276023865, 0.027538999915122986, 0.0236838236451149, 0.013252169825136662, -0.03940217196941376, -0.05748748779296875, 0.002824058523401618, 0.006193794775754213, 0.07761377841234207, -0.003022486809641123, -0.02006959542632103, -0.019105801358819008, -0.008093036711215973, 0.01781601831316948, -0.027000410482287407, -0.01513723749667406, 0.010431654751300812, -0.0045355018228292465, 0.03469659015536308, -0.030076047405600548, 0.043625857681035995, 0.023102713748812675, -0.023712171241641045, 0.01359941903501749, -0.029509108513593674, 0.0034175715409219265, -0.016880571842193604, -0.019431790336966515, 0.012812793254852295, -0.04169826954603195, 0.005403625313192606, -0.008468632586300373, 0.022379867732524872, 0.012189161032438278, 0.041074641048908234, -0.021288512274622917, -0.01975778117775917, 0.01946013793349266, -0.032428838312625885, 0.02660355344414711, 0.010502521879971027, -0.001959478482604027, -0.0021082996390759945, -0.05453941226005554, -0.05998201295733452, -0.04694244638085365, 0.002645118860527873, 0.020551493391394615, 0.020268024876713753, 0.03183355554938316, -0.015406533144414425, -0.009425340220332146, -0.02524290233850479, -0.04552510008215904, 0.03597220033407211, 0.015817562118172646, -0.007908781059086323, -0.02661772631108761, 0.0018903830787166953, 0.02232317440211773, -0.023712171241641045, -0.06258992850780487, 0.02225230634212494, 0.025228729471564293, 0.035065099596977234, -0.003355562686920166, 0.014371871948242188, 0.02803507074713707, 0.0062256851233541965, 0.04320065677165985, 0.04028092697262764, -0.008298550732433796, 0.03274065628647804, 0.015519920736551285, 0.01323090959340334, -0.00025910825934261084, 0.003745332360267639, 0.015009677037596703, -0.017334122210741043, 0.03931713104248047, -0.00913478434085846, 0.025682279840111732, -0.03988407179713249, 0.021444419398903847, 0.00796547532081604, 0.029962658882141113, -0.030756372958421707, 0.016058512032032013, 0.02396729215979576, -0.02871539629995823, -0.05658038705587387, -0.04246363788843155, -0.00973006896674633, -0.015987643972039223, 0.05235670134425163, 0.05884813889861107, -0.05201653763651848, 0.017263254150748253, -0.036340709775686264, -0.04943697154521942, -0.010630082339048386, 0.04589360952377319, 0.03186190128326416, 0.024236587807536125, -0.0022642076946794987, -0.004383137449622154, 0.029820924624800682, 0.009404079988598824, -0.012621451169252396, 0.002898469101637602, -0.0013128152349963784, -0.024449190124869347, 0.03410130366683006, -0.031521737575531006, 0.030019354075193405, -0.014499432407319546, -0.023839732632040977, 0.01018361933529377, -0.012075773440301418, -0.026334257796406746, 0.00773870013654232, -0.014626993797719479, 0.003979194443672895, -0.03767301142215729, -0.046715669333934784, 0.02863035537302494, 0.019743606448173523, 0.06207968294620514, -0.01454195287078619, 0.031748514622449875, 0.017702631652355194, -0.030614638701081276, -0.023641303181648254, -0.004854404367506504, -0.015973471105098724, 0.024449190124869347, 0.03191859647631645, 0.0180427934974432, 0.0360572412610054, -0.008256031200289726, -0.008355244994163513, 0.0006812111241742969, 0.03254222497344017, -0.04892672598361969, -0.027907511219382286, 0.048955075442790985, 0.015690002590417862, -0.022960977628827095, 0.04521328583359718, 0.009871803224086761, -3.1973297154763713e-05, -0.007788307033479214, -0.01288366038352251, 0.01348603144288063, 0.0714341551065445, -0.0033130424562841654, -0.034384772181510925, -0.043597511947155, 0.018893200904130936, 0.012075773440301418, 0.02585236169397831, 0.027624040842056274, -0.018212875351309776, 0.03208867460489273, -0.022379867732524872, -0.02508699521422386, -0.01856721192598343, 0.05161968246102333, -0.046262118965387344, 0.008780448697507381, -0.03353436663746834, -0.05547485873103142, 0.032882388681173325, 0.013443510979413986, -0.01975778117775917, 0.004050061572343111, -0.02269168384373188, -0.01544905360788107, 0.02841775491833687, 0.006016626954078674, -0.011211194097995758, -0.0036850953474640846, -0.026844501495361328, -0.023868078365921974, 0.022521601989865303, -0.017830191180109978, 0.00951038021594286, -0.047991279512643814, -0.012897833250463009, 0.011076546274125576, 0.010545042343437672, 0.00973006896674633, -0.021373553201556206, -0.004634716082364321, -0.014556126669049263, -0.007320583797991276, -0.046403855085372925, -0.03744623810052872, 0.022337347269058228, 0.01744750887155533, -0.010601735673844814, 0.05164802819490433, -0.00437959423288703, -0.001915186527185142, -0.005265434272587299, -0.06139935553073883, -0.01510889083147049, -0.010977331548929214, -0.021742062643170357, 0.0360855869948864, 0.00768200634047389, -0.02901303954422474, -0.013209649361670017, -0.020494800060987473, 0.050854314118623734, 0.012508063577115536, 0.026660246774554253, -0.03668087348341942, 0.015463226474821568, 0.006870576646178961, -0.02134520560503006, 0.004595738835632801, -0.04620542749762535, 0.016653796657919884, 0.038438379764556885, 0.01668214239180088, -0.020480625331401825, 0.0006803252617828548, -0.019219189882278442, 0.05207323282957077, 0.011437969282269478, 0.04269041121006012, -0.013641939498484135, -0.04036596789956093, 0.0047268434427678585, 0.02391059882938862, 0.03500840440392494, -0.01720656082034111, 0.028276020660996437, -0.009071003645658493, -0.023173579946160316, -0.021175123751163483, 0.029820924624800682, 0.02539881132543087, -0.025653932243585587, 0.0008087721071206033, -0.012947441078722477, -0.014386044815182686, -0.04748103767633438, -0.005442602094262838, 0.00985054299235344, 0.020905829966068268, 0.03444146737456322, -0.047764506191015244, 0.05380239337682724, 0.01982864737510681, -0.004641802981495857, -0.010509608313441277, 0.011799391359090805, 0.029962658882141113, 0.0010072003351524472, -0.01325925625860691, 0.03736119717359543, 0.01894989423453808, -0.021883796900510788, -0.00019499557674862444, -0.01591677777469158, -0.04013919085264206, 0.019431790336966515, 0.04064943641424179, -0.029707537963986397, -0.017759324982762337, -0.010077318176627159, 0.010814337059855461, 0.010056057944893837, 0.013911235146224499, -0.05343388393521309, 0.00655876100063324, -0.001006314530968666, -0.01893572136759758, 0.025738973170518875, 0.010190705768764019, -0.04909680783748627, -0.012245855294167995, -0.009978104382753372, -0.018283741548657417, 0.0049181850627064705, 0.05363231152296066, 0.013960842043161392, -0.03268396109342575, -0.008617453277111053, 0.037616319954395294, 0.035887159407138824, 0.02006959542632103, 0.013464771211147308, -0.03225875645875931, -0.023017672821879387, 0.024151546880602837, -0.01078599039465189, 0.026263391599059105, 0.022904284298419952, 0.025809841230511665, 0.01134584192186594, -0.02922563999891281, -0.007462318055331707, 0.040621090680360794, -0.0035982830449938774, -0.009659201838076115, -0.016710489988327026, -0.004305183421820402, 0.03140835091471672, 0.03733285143971443, -0.014612819999456406, 0.020182983949780464, 0.0019577068742364645, -0.02878626435995102, 0.008801707997918129, 0.0014067143201828003, 0.012862400151789188, -0.012593104504048824, 0.03537691384553909, 0.025838186964392662, -0.003468950279057026, 0.01999872922897339, -0.025965748354792595, -0.023088539019227028, -0.017532549798488617, -0.016483714804053307, -0.0020710944663733244, -0.031294964253902435, 0.02389642596244812, -0.029509108513593674, 0.02646181918680668, -0.02878626435995102, 0.030302822589874268, -0.040989600121974945, 0.02704293094575405, 0.011891518719494343, 0.01705065183341503, -0.017546722665429115, 0.028871305286884308, 0.03597220033407211, -0.0013314178213477135, 0.03852342069149017, -0.01841130293905735, -0.0006581792840734124, -0.051676373928785324, 0.005329214967787266, 0.018524691462516785, -0.011629310436546803, 0.01781601831316948, -0.06525453180074692, -0.007285149767994881, 0.014797074720263481, -0.01600181683897972, 0.010226139798760414, -0.0010160587262362242, 0.017645936459302902, 0.010807250626385212, -0.004064234904944897, -0.0420951284468174, 0.01893572136759758, -0.00597410649061203, 0.0026964975986629725, 0.0076465727761387825, -0.00868123397231102, 0.02651851251721382, 0.044079408049583435, -0.03469659015536308, -0.018666425719857216, -0.009971017949283123, 0.00938990619033575, 0.008773361332714558, -0.016398673877120018, -0.03486667200922966, 0.005718984641134739, -0.005959933158010244, 0.061512745916843414, -0.018071141093969345, -0.05672211945056915, -0.0023350748233497143, -0.020636534318327904, 0.01577504351735115, -0.013641939498484135, -0.015321492217481136, 0.02571062743663788, 0.006083950866013765, -0.01017653290182352, -0.06117258220911026, -0.0007733384845778346, 0.012912007048726082, -0.014825422316789627, -0.014364784583449364, 0.0060343435034155846, -0.021090084686875343, 0.014754554256796837, 0.04368255287408829, -0.00021138362353667617, 0.05833789333701134, -0.022153092548251152, 0.02616417594254017, 0.03636905550956726, -0.024803526699543, -0.029140599071979523, 0.0003487996000330895, -0.026943715289235115, 0.012082860805094242, -0.004315813537687063, -0.011331668123602867, -0.003837459720671177, -0.05235670134425163, 0.016044337302446365, -0.0033502476289868355, 0.030076047405600548, -0.039487212896347046, -0.015420706942677498, 0.041443150490522385, 0.011700177565217018, 0.016781358048319817, -0.04566683620214462, 0.012649798765778542, -0.038806889206171036, 0.0003740460379049182, -0.0005625085323117673, -0.021883796900510788, -0.016625449061393738, -0.0026114569045603275, -0.021912144497036934, 0.017603415995836258, 0.0028010266833007336, 0.016030164435505867, -0.02847444824874401, 0.019403444603085518, 0.02457675151526928, -0.022053878754377365, -0.002216372173279524, -0.0028949258849024773, -0.004315813537687063, -0.03373279422521591, 0.007341843564063311, -0.022294826805591583, 0.0029604779556393623, 0.014867941848933697, 0.07245464622974396, -0.02562558650970459, -0.04186835139989853, -0.0028594923205673695, 0.013663199730217457, -0.0014758098404854536, -0.025738973170518875, 0.009340299293398857, -0.008574933744966984, -0.018879026174545288, -0.0008242743206210434, 0.021132605150341988, -0.020112115889787674, 0.011310407891869545, -0.03943052142858505, -0.0118348253890872, -0.037758052349090576, -0.0014456912176683545, -0.011289147660136223, -0.02171371504664421, 0.03849507123231888, -0.024151546880602837, -0.015519920736551285, -0.11928369849920273, -0.05697724223136902, 0.035745423287153244, -0.014867941848933697, -0.0013163585681468248, -0.012267115525901318, 0.004372507333755493, 0.02751065418124199, -0.003961477428674698, -0.03132330998778343, 0.01982864737510681, 0.011884432286024094, -0.014570299535989761, -0.029934313148260117, 0.02029637061059475, -0.001545791164971888, 0.023853905498981476, -0.008348158560693264, -0.019049108028411865, -0.007398537360131741, -0.026036616414785385, 0.0002602155727799982, -0.0383249931037426, 0.04473138600587845, -0.04237859696149826, -0.011537183076143265, 0.02351374365389347, 0.019502658396959305, 0.018297916278243065, 0.007788307033479214, 0.025058647617697716, 0.002747876336798072, 0.00561622716486454, -0.005311497952789068, -0.010948984883725643, 0.0026982692070305347, -0.012118293903768063, 0.0012640940258279443, 0.018368782475590706, -0.033335939049720764, 0.03478163108229637, -0.019403444603085518, -0.00481188390403986, -0.006002453155815601, 0.010835597291588783, 0.0037382456939667463, -0.004085495136678219, 0.012642711400985718, -0.036028891801834106, -0.0064063966274261475, 0.005481579340994358, -0.013252169825136662, -0.008780448697507381, -0.04161322861909866, -0.0019931404385715723, 0.05510634928941727, -0.039940763264894485, 0.026858676224946976, 0.014130922965705395, -0.014669514261186123, -0.028842957690358162, -0.005609140265733004, 0.004280379973351955, -0.03274065628647804, 0.02532794326543808, -0.03651079162955284, -0.010474175214767456, -0.001980738714337349, -0.01254349760711193, -0.0019399900920689106, 0.010162359103560448, 0.03673756495118141, -0.002265979303047061, -0.020679054781794548, 0.009751329198479652, 0.0031075275037437677, 0.021359378471970558, 0.02824767306447029, 0.022450733929872513, 0.016115205362439156, 0.047310955822467804, -0.018680598586797714, 0.043852634727954865, 0.036567483097314835, 0.004882751498371363, -0.016341980546712875, 0.01594512350857258, 0.011976559646427631, 0.0071540456265211105, 0.019148321822285652, 0.02967919036746025, -0.005566619802266359, -0.037984829396009445, -0.0027071277145296335, 0.005045745987445116, -0.002987053245306015, 0.0015971699031069875, 0.023924773558974266, -0.0026309455279260874, -0.037474583834409714, 0.016795530915260315, -0.003176623024046421, -0.03225875645875931, -0.015378186479210854, -0.014556126669049263, 0.020268024876713753, -0.010871031321585178, 0.006668605376034975, 0.006491437088698149, 0.017164040356874466, -0.006211511790752411, -0.007405624259263277, -0.0008880548411980271, 0.0017619362333789468, -0.013996275141835213, 0.009219825267791748, 0.06361041218042374, -0.02052314579486847, -0.019573524594306946, -0.0075898789800703526, 0.015534094534814358, 0.04033761844038963, -0.00561622716486454, -0.014308091253042221, -0.03897697106003761, 0.019488485530018806, -0.05275355651974678, -0.023428702726960182, 0.0061583612114191055, -0.009907237254083157, 0.03472493588924408, -0.0037028121296316385, 0.013167128898203373, 0.023357834666967392, 0.026872849091887474, 0.011338754557073116, 0.029424069449305534, 0.014442739076912403, -0.029849272221326828, 0.0020037705544382334, 0.010148185305297375, 0.01007023174315691, -0.0016538636991754174, -0.008950529620051384, 0.006998137570917606, -0.00422722939401865, 0.012019080109894276, 0.03600054606795311, -0.024661792442202568, 0.0018336892826482654, 0.04402271658182144, -0.004978422075510025, -0.018822332844138145, 0.026206696406006813, 0.025639759376645088, 0.056778814643621445, -0.03217371553182602, -0.036794260144233704, -0.033704448491334915, 0.0026982692070305347, 0.0028417755383998156, 0.023797212168574333, 0.023485396057367325, -0.031606778502464294, 0.00468077976256609, -0.0413297601044178, -0.005180393811315298, -0.015831736847758293, -0.02569645270705223, -0.0008946986054070294, -0.027524827048182487, 0.005800481885671616, 0.0360572412610054, -0.01961604505777359, 0.025682279840111732, 0.030331168323755264, 0.05445437133312225, -0.003993367776274681, -0.004120928701013327, 0.019970381632447243, -0.01525062508881092, 0.010821424424648285, 0.0037240723613649607, 0.01982864737510681, 0.024633444845676422, 0.0076465727761387825, -0.004673692863434553, 0.022734204307198524, -0.009574160911142826, -0.010353700257837772, 0.022138919681310654, 0.014967156574130058, 0.0199136883020401, 0.004252032842487097, -0.0019187298603355885, -0.009255258366465569, 0.030642984434962273, 0.01134584192186594, -0.008468632586300373, 0.006250488571822643, 0.002379366895183921, 0.019743606448173523, -0.004588652402162552, -0.025838186964392662, 0.0037772227078676224, 0.04867160692811012, -0.010481261648237705, 0.0225357748568058, -0.016427021473646164, 0.034469813108444214, -0.050542499870061874, 0.011189933866262436, -0.009120610542595387, -0.013478945009410381, -0.00890800915658474, 0.03183355554938316, -0.007026484701782465, 0.002466179197654128, -0.01322382315993309, -0.0199278611689806, -0.017376642674207687, 0.020537320524454117, 0.0054107122123241425, -0.0005222028121352196, -0.026263391599059105, 0.025951575487852097, -0.010977331548929214, 0.0032634353265166283, -0.0028382320888340473, 0.011374188587069511, -0.004946531727910042, 0.004599282518029213, 0.008390679024159908, 0.004935901612043381, 0.0495787039399147, -0.034384772181510925, 0.00021680939244106412, 0.010389134287834167, 0.02967919036746025, -0.0014173443196341395, 0.0019949122797697783, 0.017376642674207687, -0.0009939126903191209, -0.023797212168574333, 0.007823741063475609, -0.007391450926661491, -0.009808022528886795, 0.027751602232456207, -0.00890800915658474, 0.017901059240102768, -0.0011914550559595227, 0.031068189069628716, 0.01289074681699276, -0.00033041840652003884, 0.0191624965518713, -0.03200363367795944, 0.0028772091027349234, 0.025285422801971436, -0.0023084995336830616, 0.015959298238158226, 0.017929406836628914, 0.017419161275029182, -0.0014448054134845734, -0.02787916362285614, 0.016625449061393738, -0.020849134773015976, -0.015548267401754856, -0.0013376186834648252, 0.03395957127213478, 0.023726344108581543, -0.01254349760711193, 0.04073447734117508, 0.004609912633895874, 0.02848862111568451, 0.016483714804053307, -0.022720029577612877, -0.03217371553182602, -0.03500840440392494, -0.000738790724426508, 0.007944215089082718, -0.03296742960810661, -0.004570935387164354, -0.013287602923810482, -0.014010448940098286, 0.042577024549245834, -0.014641167595982552, -0.009524554014205933, -0.05278190225362778, 0.023102713748812675, 0.02658938057720661, 0.021883796900510788, 0.000353228795574978, -0.02999100647866726, -0.0274397861212492, 0.006618998013436794, -0.023853905498981476, -0.009552900679409504, 0.03897697106003761, 0.02111843042075634, 0.027538999915122986, -0.026631901040673256, 0.015193931758403778, 0.0084544587880373, 0.0018779812380671501, -0.0020498342346400023, -0.026206696406006813, 0.007944215089082718, -0.019559351727366447, 0.01750420220196247, -0.013790760189294815, -0.006572934333235025, 0.011069459840655327, 0.037758052349090576, -0.04646054655313492, 0.02779412269592285, 0.036794260144233704, 0.0033980831503868103, -0.026348430663347244, -0.0018673512386158109, -0.00193467503413558, -0.036794260144233704, 0.019417617470026016, -0.002900240942835808, 0.035887159407138824, 0.035943854600191116, 0.019205015152692795, 0.02510116808116436, -0.0010603507980704308, 0.007816653698682785, 0.012089947238564491, 0.027397265657782555, -0.028743743896484375, -0.004457547795027494, 0.009170218370854855, -0.052725210785865784, -0.006948530673980713, -0.05867805704474449, 0.010495434515178204, -0.017787670716643333, -0.007837913930416107, 0.007299323566257954, -0.01536401268094778, -0.0025476764421910048, 0.030784718692302704, -0.019630219787359238, -0.030926452949643135, 0.0027531913947314024, 0.00021215873130131513, -0.05244174227118492, -0.01465534046292305, 0.0789177343249321, 0.011905692517757416, -0.012479716911911964, 0.017249081283807755, 0.028814610093832016, -0.017022306099534035, 0.008248943835496902, 0.01968691311776638, 0.0036461183335632086, 0.005300867836922407, -0.021841276437044144, 0.015321492217481136, -0.005283151287585497, 0.001354449661448598, 0.03943052142858505, -0.019176669418811798, -0.01954517886042595, -0.011048199608922005, 0.012869486585259438, -0.007724526803940535, 0.01774515211582184, 0.024222414940595627, 0.021245991811156273, -0.009722982533276081, -0.0041563622653484344, 0.004822514019906521, 0.015888430178165436, -0.011019852012395859, 0.03659583255648613, 0.046262118965387344, 0.016256939619779587, -0.008596193045377731, -0.024250762537121773, 0.009637941606342793, -0.016852224245667458, 0.006675691809505224, -0.047452688217163086, -0.023655477911233902, -0.0036354882176965475, -0.0368509516119957, -0.025214556604623795, -0.00785208772867918, 0.0009877118282020092, -0.0046595195308327675, 0.0018079999135807157, 0.009999364614486694, -0.0019647935405373573, 0.007246172986924648, -0.0068599465303123, -0.03818325698375702, 0.008057602681219578, 0.007951301522552967, -0.0027283879462629557, -0.007604052312672138, -0.004308726638555527, -0.015491574071347713, -0.013663199730217457, 0.008348158560693264, 0.03523518145084381, -0.007313496898859739, -0.008667061105370522, 0.04297387972474098, 0.002122473204508424, 0.00527606438845396, 0.005775678437203169, 0.004698496311903, 0.011019852012395859, 0.006041430402547121, -0.012607278302311897, 0.01751837693154812, -0.0390620119869709, 0.018879026174545288, 0.03330759331583977, -0.012912007048726082, 0.018893200904130936, 0.01923336274921894, -0.008922182954847813, 0.012004906311631203, 0.0031429610680788755, 0.03395957127213478, -0.0018177441088482738, -0.02410902827978134, 0.01743333600461483, 0.009928497485816479, 0.002969336463138461, 0.03676591068506241, 0.0027549630030989647, -0.018014445900917053, -0.007462318055331707, 0.010318267159163952, 0.03801317512989044, -0.004142188932746649, 0.029934313148260117, 0.008156816475093365, 0.004585109185427427, 0.014981329441070557, -0.01228837575763464, -0.011204106733202934, 0.0009053287212736905, -0.04028092697262764, 0.01006314530968666, 0.010240312665700912, 0.007618226110935211, -0.011898606084287167, 0.010800164192914963, 0.003553990973159671, -0.011962386779487133, -0.006303639151155949, 0.0014527780003845692, 0.006480806972831488, 0.0008774247253313661, -0.040082499384880066, -0.008447372354567051, -0.00807177647948265, 0.016667969524860382, -0.014910462312400341, -0.0009939126903191209, 0.018964067101478577, -0.006523327436298132, -0.02134520560503006, 0.018694771453738213, -0.0011214737314730883, 0.023584609851241112, -0.01654040813446045, -0.0021614502184093, 0.023088539019227028, 0.0026575205847620964, 0.004709126427769661, 0.017078999429941177, 0.0065835644491016865, 0.006969790905714035, 0.029027212411165237, 0.01393958181142807, 0.01525062508881092, 0.0025476764421910048, -0.0016281743301078677, 0.012784445658326149, -0.02157198078930378, 0.00473747355863452, -0.027538999915122986, 0.013351383619010448, 0.027978377416729927, 0.009283605962991714, 0.0002165879268432036, 0.028658702969551086, 0.008036342449486256, 0.020083770155906677, -0.007837913930416107, 0.00973006896674633, 0.019063280895352364, -0.028587834909558296, -0.024860220029950142, -0.0007179735112003982, 0.006151274312287569, 0.013471857644617558, -0.003348476020619273, 0.0012446055188775063, -0.022875938564538956, -0.012904920615255833, -0.005460319109261036, -0.029735883697867393, -0.029792578890919685, -0.00868123397231102, -0.029849272221326828, 0.028885478153824806, 0.017830191180109978, -0.0077812206000089645, 2.5717048629303463e-05, -0.010141098871827126, 0.007426884490996599, 0.01111906673759222, -0.0069095538929104805, -0.01134584192186594, 0.00013110435975249857, 0.04373924806714058, -0.010304093360900879, -0.03883523494005203, 0.019786126911640167, 0.003118157619610429, 0.0010258029215037823, -0.013960842043161392, -0.011140326969325542, 0.009326125495135784, -0.00868123397231102, -0.013188389129936695, 0.011884432286024094, -0.011253714561462402, 0.0060237133875489235, -0.017674284055829048, -0.04390932619571686, -0.02644764631986618, 0.025682279840111732, -0.008518239483237267, 0.008319810964167118, -0.012621451169252396, -0.0049181850627064705, 0.006027257069945335, -0.023131059482693672, 0.009269432164728642, 0.013393904082477093, -0.014152183197438717, -0.03486667200922966, -0.004854404367506504, 0.03617062792181969, -0.015690002590417862, 0.024775179103016853, -0.04728260636329651, -0.0006081293104216456, 0.012011993676424026, 0.01041039451956749, 0.006491437088698149, 0.0172916017472744, 0.02344287559390068, 0.013308863155543804, 0.03690764680504799, 0.002102984581142664, 0.02899886481463909, 0.02749648131430149, 0.014527780003845692, -0.041811659932136536, -0.029140599071979523, 0.025894882157444954, 0.013422250747680664, -0.02532794326543808, -0.01788688637316227, 0.009722982533276081, 0.0029587063472718, 0.0010364330373704433, -0.03849507123231888, 0.018000273033976555, 0.032797347754240036, 0.012529323808848858, -0.01127497386187315, 0.02531377039849758, 0.03254222497344017, -0.027071276679635048, 0.004319356754422188, -0.022280653938651085, 0.03914704918861389, -0.011324581690132618, -0.0266885943710804, 0.008333984762430191, -0.009319039061665535, -0.0005864262348040938, -0.00016653796774335206, 0.03259892016649246, 0.0018372326157987118, 0.0323154516518116, -0.01383328065276146, 0.018014445900917053, -0.0019399900920689106, 0.012082860805094242, -0.007908781059086323, -0.016639621928334236, -0.0255547184497118, 0.012337982654571533, 0.013755327090620995, -0.02141607366502285, 0.016965612769126892, -0.011452142149209976, 0.03622732311487198, -0.025115342810750008, 0.00947494711726904, -0.007175305858254433, 0.014896289445459843, -0.0039331307634711266, 0.011771044693887234, -0.0027159862220287323, -0.01818452775478363, 0.012989960610866547, -0.0022394040133804083, 0.0017309318063780665, -0.019034935161471367, -0.007253259886056185, 0.023641303181648254, -0.035802118480205536, 0.02810593880712986, -0.030529597774147987, 0.010382046923041344, -0.032343797385692596, -0.014924636110663414, 0.0038445466198027134, -0.012316722422838211, 0.027312226593494415, 0.027709081768989563, 0.014145096763968468, -0.014301004819571972, -0.023017672821879387, 0.002893154276534915, -0.0013916549505665898, 0.004967791959643364, -0.002483895979821682, 0.0027655931189656258, 0.01705065183341503, 0.03203198313713074, 0.019729433581233025, 0.007196566089987755, -0.009637941606342793, -0.001477581448853016, -0.0018230591667816043, 0.0029321310576051474, -0.013124608434736729, 0.03282569348812103, -0.010169445537030697, 0.00039287013350985944, 0.0050953528843820095, -0.0012844683369621634, -0.0027106711640954018, -0.026093309745192528, 0.03410130366683006, 0.024080680683255196, -0.01795775257050991, 0.02260664291679859, 0.023953119292855263, 0.012217508628964424, 0.016568755730986595, -0.023953119292855263, -0.018397130072116852, 0.006303639151155949, -0.002219915622845292, 0.02420824207365513, 0.032343797385692596, 0.017078999429941177, -0.0001983174734050408, 0.044447917491197586, -0.003936673980206251, -0.007689093239605427, 0.0012578931637108326, 0.007433970924466848, -0.010431654751300812, 0.007894608192145824, -0.004461091477423906, 0.0330524705350399, -0.007047744933515787, 0.02328696846961975, -0.01184191182255745, -0.011508836410939693, 0.018241221085190773, 0.0022057420574128628, -0.009056830778717995, -0.03710607439279556, -0.01773097738623619, -0.04141480103135109, -0.02080661430954933, 0.002359878271818161, 0.013471857644617558, -0.024817699566483498, -0.0046595195308327675, -0.0037205289117991924, -0.010488348081707954, -0.0001798255689209327, -0.0009000136633403599, 0.014095489867031574, 0.014386044815182686, -0.025427157059311867, 0.014697860926389694, 0.001839004340581596, 0.024562576785683632, 0.0018124290509149432, 0.015066370368003845, -0.009049743413925171, -0.019134148955345154, -0.008022168651223183, -0.00040881524910219014, -0.014067142270505428, 0.008142643608152866, 0.0030472902581095695, 0.026929542422294617, -0.003098668996244669, 0.020253850147128105, -0.028913823887705803, 0.019573524594306946, -0.00856784638017416, -0.009028483182191849, 0.002177395159378648, -0.03928878530859947, -0.028828784823417664, -0.04566683620214462, -0.01584590971469879, -0.043172307312488556, 0.013904147781431675, 0.0034530051052570343, 0.03387453034520149, 0.003791396040469408, 0.02405233308672905, -0.01706482656300068, 0.0020728660747408867, -0.014329351484775543, -0.0229326318949461]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-14T10:15:00.369180", "url_path": "/examples/chat-app/", "chunk_size": 3023}
updated_dt: 2025-03-14T10:15:00.370692
---
```
// BIG FAT WARNING: to avoid the complexity of npm, this typescript is compiled in the browser
// there's currently no static type checking
import{marked}from'https://cdnjs.cloudflare.com/ajax/libs/marked/15.0.0/lib/marked.esm.js'
constconvElement=document.getElementById('conversation')
constpromptInput=document.getElementById('prompt-input')asHTMLInputElement
constspinner=document.getElementById('spinner')
// stream the response and render messages as each chunk is received
// data is sent as newline-delimited JSON
asyncfunctiononFetchResponse(response:Response):Promise<void>{
lettext=''
letdecoder=newTextDecoder()
if(response.ok){
constreader=response.body.getReader()
while(true){
const{done,value}=awaitreader.read()
if(done){
break
}
text+=decoder.decode(value)
addMessages(text)
spinner.classList.remove('active')
}
addMessages(text)
promptInput.disabled=false
promptInput.focus()
}else{
consttext=awaitresponse.text()
console.error(`Unexpected response: ${response.status}`,{response,text})
thrownewError(`Unexpected response: ${response.status}`)
}
}
// The format of messages, this matches pydantic-ai both for brevity and understanding
// in production, you might not want to keep this format all the way to the frontend
interfaceMessage{
role:string
content:string
timestamp:string
}
// take raw response text and render messages into the `#conversation` element
// Message timestamp is assumed to be a unique identifier of a message, and is used to deduplicate
// hence you can send data about the same message multiple times, and it will be updated
// instead of creating a new message elements
functionaddMessages(responseText:string){
constlines=responseText.split('\n')
constmessages:Message[]=lines.filter(line=>line.length>1).map(j=>JSON.parse(j))
for(constmessageofmessages){
// we use the timestamp as a crude element id
const{timestamp,role,content}=message
constid=`msg-${timestamp}`
letmsgDiv=document.getElementById(id)
if(!msgDiv){
msgDiv=document.createElement('div')
msgDiv.id=id
msgDiv.title=`${role} at ${timestamp}`
msgDiv.classList.add('border-top','pt-2',role)
convElement.appendChild(msgDiv)
}
msgDiv.innerHTML=marked.parse(content)
}
window.scrollTo({top:document.body.scrollHeight,behavior:'smooth'})
}
functiononError(error:any){
console.error(error)
document.getElementById('error').classList.remove('d-none')
document.getElementById('spinner').classList.remove('active')
}
asyncfunctiononSubmit(e:SubmitEvent):Promise<void>{
e.preventDefault()
spinner.classList.add('active')
constbody=newFormData(e.targetasHTMLFormElement)
promptInput.value=''
promptInput.disabled=true
constresponse=awaitfetch('/chat/',{method:'POST',body})
awaitonFetchResponse(response)
}
// call onSubmit when the form is submitted (e.g. user clicks the send button or hits Enter)
document.querySelector('form').addEventListener('submit',(e)=>onSubmit(e).catch(onError))
// load messages on page load
fetch('/chat/').then(onFetchResponse).catch(onError)

```

© Pydantic Services Inc. 2024 to present