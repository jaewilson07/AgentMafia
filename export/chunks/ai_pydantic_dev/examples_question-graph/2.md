---
url: https://ai.pydantic.dev/examples/question-graph/
session_id: pydantic_ai_docs
chunk_number: 2
title: Asynchronous CLI for Question Graph Interaction
summary: This function allows interaction with a question graph through a command-line interface. It checks for existing history, creates a new question state if none exists, and processes nodes in the question graph asynchronously, handling answers and termination conditions accordingly. The interaction history is saved to a JSON file.
embedding: [0.02163369581103325, 0.005053377710282803, -0.006704515311866999, -0.004812084138393402, 0.02348131500184536, 0.012147409841418266, -0.02323312684893608, 0.010940941981971264, -0.007100926246494055, 0.08245347440242767, 0.001895878347568214, -0.01792466826736927, 0.03369837626814842, -0.048148415982723236, 0.007852383889257908, 0.002038931008428335, -0.011251176707446575, -0.0075490428134799, 0.0015753025654703379, 0.018007397651672363, 0.03273320198059082, -0.008783087134361267, 0.05352581664919853, 0.002493941690772772, -0.04892055690288544, 0.003179905004799366, -0.012257715687155724, 0.043322544544935226, -0.021344143897294998, 0.021757788956165314, 0.0020061840768903494, -0.014863686636090279, -0.03394656255841255, 0.00903816893696785, -0.04676959663629532, 0.047183241695165634, -0.008376335725188255, -0.024915289133787155, 0.017979821190238, 0.014408675953745842, 0.0012331827310845256, -0.08532141894102097, 0.01078927144408226, -0.0023905301932245493, -0.007107820361852646, -0.0057358937337994576, -0.024432701990008354, 0.07208473980426788, 0.029148267582058907, 0.028458857908844948, -0.04831387475132942, 0.020530639216303825, 0.0005881531978957355, 0.042357370257377625, -0.046107761561870575, -0.03833121433854103, -0.006156434305012226, -0.016725094988942146, 0.014946416020393372, -0.00952075608074665, 0.02124762535095215, -0.06546640396118164, -0.017469657585024834, 0.05625588074326515, -0.018627867102622986, 0.03813817724585533, -0.008665887638926506, 0.04106127843260765, 0.006838950328528881, 0.006573527120053768, 0.017180105671286583, 0.040895819664001465, -0.019496522843837738, -0.046879902482032776, 0.005925481673330069, -0.00918294582515955, 0.0428813211619854, 0.018862266093492508, -0.001338317757472396, -0.029120691120624542, -0.01361585408449173, -0.028086576610803604, 0.00515334215015173, -0.02007562853395939, 0.0062081399373710155, -0.03298138827085495, -0.06568701565265656, 0.020323816686868668, -0.05625588074326515, -0.0798061341047287, -0.02582531049847603, -0.03720058128237724, -0.0503821074962616, 0.03204379230737686, 0.06976832449436188, 0.02517726458609104, 0.05002361163496971, -0.02508074790239334, -0.004222637973725796, -0.044398024678230286, 0.015139450319111347, -0.07886853814125061, -0.036704204976558685, 0.013526230119168758, 0.019620617851614952, 0.03278835490345955, 0.0077627599239349365, 0.07820670306682587, -0.015442791394889355, -0.028376128524541855, -0.07986129075288773, -0.01709737628698349, -0.017180105671286583, 0.01665615290403366, -0.0037572861183434725, -0.0019113901071250439, -0.033339884132146835, -0.07043015956878662, 0.03267804905772209, -0.006221928168088198, -0.03049951232969761, -0.009824097156524658, -0.00623571639880538, -0.00010195732465945184, -0.0012081916211172938, 0.011885433457791805, -0.015897801145911217, -0.023564044386148453, -0.012547267600893974, 0.020296240225434303, -0.009872355498373508, -0.017304198816418648, 0.03833121433854103, -0.05636618658900261, -0.0049568600952625275, 0.03618025407195091, -0.04437044635415077, -0.005615246947854757, -0.03044435940682888, 0.02177157811820507, 0.031933486461639404, -0.01729041151702404, -0.03267804905772209, 0.015704767778515816, -0.0053463769145309925, 0.04825872182846069, -0.0355735719203949, 0.04599745571613312, -0.03532538563013077, 0.01018259022384882, 0.05261579528450966, 0.02898280881345272, -0.02406042069196701, 0.018862266093492508, 0.027990058064460754, 0.0016752670053392649, 0.03686966374516487, 0.019992899149656296, -0.008700357750058174, -0.009293250739574432, -0.03717300295829773, 0.0063184453174471855, -0.051953960210084915, -0.04409468546509743, -0.04335011914372444, -0.015442791394889355, 0.0051464480347931385, 0.02819688245654106, -0.02361919730901718, -0.007514572236686945, -0.03910335153341293, -0.026928367093205452, 0.014422464184463024, -0.00013325008330866694, 0.04721082001924515, -0.01651827059686184, -0.029451608657836914, -0.02275053970515728, -0.007383584510535002, -0.012257715687155724, -0.02275053970515728, 0.006335680838674307, -0.04563896358013153, -0.0056186942383646965, -0.06706583499908447, 0.01001023780554533, -0.00888649933040142, 0.012664467096328735, -0.0001613650965737179, 0.025439240038394928, -0.03998579829931259, 0.029120691120624542, 0.026583662256598473, -0.01842104271054268, 0.010044707916676998, -0.032567743211984634, 0.1094232052564621, -0.008955439552664757, -0.007617983967065811, 0.00568763492628932, -0.00022728995827492326, 0.02878977544605732, 0.025356510654091835, -0.04765203967690468, 0.027148978784680367, -0.002659400226548314, -0.021716425195336342, -0.03471870347857475, -0.015470367856323719, -0.05708317458629608, 0.021399296820163727, -0.020061839371919632, 0.04889297857880592, 0.042936474084854126, -0.024970442056655884, -0.013305619359016418, -0.03049951232969761, 0.028238246217370033, 0.045418351888656616, 0.0037021334283053875, -0.0005635929410345852, 0.05178850144147873, 0.0580759234726429, 0.03345018997788429, 0.040123678743839264, 0.0444255992770195, 0.030609818175435066, -0.030223747715353966, 0.003950321115553379, 0.05559404939413071, 0.02017214521765709, 0.00031648241565562785, -0.0057186586782336235, -0.010210166685283184, 0.029947983101010323, -0.062046926468610764, -0.008121253922581673, -0.01598053053021431, 0.0223093181848526, -0.027162766084074974, -0.014905051328241825, 0.01890362985432148, 0.032760776579380035, -0.01694570481777191, 0.015373850241303444, -0.002828305820003152, -0.014918839558959007, -0.026238957419991493, 0.033974140882492065, 0.012809243984520435, -0.0029248232021927834, -0.021606119349598885, -0.015125662088394165, -0.026873214170336723, -0.032815929502248764, -0.04701778292655945, -0.00695270299911499, -0.024184513837099075, -0.00038283815956674516, -0.006904444191604853, 0.000962589168921113, 0.012409385293722153, -0.021123532205820084, 0.03311927244067192, -0.018765749409794807, 0.0070802439004182816, 0.017621327191591263, -0.01919318363070488, -0.03984791785478592, -0.0262527447193861, -0.016159778460860252, 0.02444648928940296, 0.015180815011262894, 0.024584371596574783, -0.0129333371296525, -0.012781667523086071, 0.03369837626814842, 0.0355735719203949, -0.003850356675684452, -0.0223093181848526, 0.0014184616738930345, 0.009389768354594707, 0.02878977544605732, 0.038110602647066116, -0.0113959526643157, 0.03935154154896736, -0.03309169411659241, -0.003691792255267501, 0.04417741298675537, -0.011230493895709515, 0.031740449368953705, -0.027728082612156868, 0.013326301239430904, 0.012443856336176395, 0.014325946569442749, -0.016738882288336754, 0.0052636475302278996, 0.053222477436065674, 0.016476906836032867, 0.01329872477799654, 0.024970442056655884, -0.02742474153637886, 0.0002824427792802453, 0.007686925120651722, 0.016490694135427475, 0.040950972586870193, -0.006639021448791027, 0.004594919737428427, 0.037007544189691544, 0.01186475157737732, -0.009417344816029072, 0.0266388151794672, 0.022088706493377686, 0.05261579528450966, -0.00025228108279407024, -0.01342281885445118, 0.011230493895709515, -0.024804983288049698, 0.04787265136837959, -0.0513472817838192, 0.01973092369735241, -0.019400006160140038, 0.04889297857880592, 0.01915181800723076, -0.03830363601446152, -0.010561766102910042, 0.01598053053021431, -0.021123532205820084, 0.011361481621861458, 0.030141018331050873, -0.0228884220123291, -0.021854307502508163, 0.01690434105694294, 0.036759357899427414, 0.023991478607058525, -0.012492114678025246, -0.023743290454149246, 0.03400171548128128, 0.041530076414346695, 0.06899618357419968, -0.05479433014988899, -0.007142290938645601, -0.05358096957206726, -0.009272568859159946, -0.014560345560312271, 0.028762198984622955, 0.028707046061754227, 0.028514010831713676, 0.019069088622927666, -0.0062184808775782585, 0.017952244728803635, 0.0436534620821476, 0.0453907735645771, 0.029203420504927635, 0.027024883776903152, 0.018048761412501335, -0.015801284462213516, -0.009686214849352837, -0.015497943386435509, 0.02488771267235279, -0.038993045687675476, -0.02406042069196701, -0.03083042986690998, 0.01642175391316414, -0.04856206104159355, -0.028569163754582405, -0.030334053561091423, -0.009906826540827751, 0.05606284737586975, 0.01705601066350937, 0.03954457491636276, -0.010341154411435127, 0.006232269108295441, 0.024294819682836533, -0.05912382900714874, 0.012037103995680809, -0.022640233859419823, 0.0263492614030838, 0.00825913529843092, 0.049279049038887024, 0.0018924312898889184, -0.012112938798964024, -0.022736752405762672, -0.00551528250798583, -0.007680031005293131, 0.04652140662074089, 0.0071629732847213745, -0.0036366393323987722, -0.021371720358729362, 0.0074456315487623215, 0.060723260045051575, -0.04417741298675537, 0.024818770587444305, -0.005167130380868912, -0.011575198732316494, 0.03744876757264137, -0.0010737566044554114, 0.01997910998761654, 0.05713832750916481, 0.04023398458957672, 0.025563335046172142, -0.027342012152075768, -0.011850963346660137, 0.019937746226787567, 0.021109743043780327, -0.008734828792512417, 0.012009527534246445, -0.018283162266016006, -0.012188774533569813, -0.0012874737149104476, 0.035628724843263626, -0.03469112515449524, 0.012002633884549141, -0.016352811828255653, 0.010761694982647896, -0.07125744968652725, -0.019951533526182175, -0.037779685109853745, 0.016187354922294617, 0.024529218673706055, -0.016145989298820496, -0.052091844379901886, 0.012078468687832355, -0.03270562365651131, -0.004122673533856869, 0.053415510803461075, 0.04643867909908295, -0.02459816075861454, 0.07087138295173645, -0.04969269409775734, 0.01493262778967619, -0.0028541586361825466, 0.004967201501131058, 0.020475486293435097, 0.061881471425294876, 0.022929787635803223, 0.0033005517907440662, 0.001130632939748466, -0.04489440098404884, -0.06965801864862442, 0.03871728479862213, -0.02542545273900032, 0.010809953324496746, 0.015111873857676983, -0.04023398458957672, -0.009920614771544933, -0.029727373272180557, -0.04348800331354141, -0.009858567267656326, -0.02284705825150013, 0.028431281447410583, -0.039627306163311005, -0.032953813672065735, 0.021054590120911598, -0.009858567267656326, 0.0041019911877810955, 0.07666242867708206, 0.028031423687934875, 0.023246916010975838, -0.008004053495824337, 0.010637600906193256, 0.030471935868263245, 0.0012090533273294568, 0.05802077054977417, -0.036511171609163284, 0.009569015353918076, 0.031685296446084976, 0.00910711009055376, -0.008652099408209324, 0.01832452602684498, -0.039241235703229904, -0.014960204251110554, 0.005470470990985632, -0.018545137718319893, -0.035628724843263626, -0.026418203487992287, 0.031023463234305382, 0.05305701866745949, 0.02069609798491001, -0.0020010133739560843, -0.03146468847990036, 0.00010335768456570804, -0.0005778120248578489, -0.011940586380660534, 0.017524810507893562, 0.04792780429124832, -0.017690269276499748, -0.018627867102622986, -0.016339024528861046, 0.044784095138311386, 0.005308459512889385, 0.01502914447337389, 0.010189484804868698, -0.01715252920985222, 0.03849667310714722, -0.016090836375951767, -0.019468946382403374, -0.020447909832000732, 0.009996449574828148, -0.01222324464470148, -0.020034262910485268, -0.006738985888659954, -0.01792466826736927, 0.011313223280012608, 0.010120543651282787, -0.06386697292327881, 0.04340527206659317, -0.020916709676384926, 0.050740599632263184, -0.004884472116827965, 0.010934047400951385, -0.04938935488462448, 0.016476906836032867, 0.014436252415180206, -0.037007544189691544, 0.017511021345853806, -0.0025232417974621058, 0.0055463057942688465, -0.001383129390887916, -0.0058358581736683846, -0.026280321180820465, -0.043570730835199356, 0.012112938798964024, 0.0048637897707521915, -0.008148829452693462, 0.0011909563327208161, 0.031878333538770676, -0.047128088772296906, -0.007521466352045536, -0.030720124021172523, 0.001833831425756216, 0.016573423519730568, -0.02206113003194332, 0.046107761561870575, -0.03775211051106453, -0.0060013169422745705, -0.02382601983845234, 0.0006411515641957521, -0.023894961923360825, -0.005311906337738037, -0.004636284429579973, 0.0010634154314175248, 0.0014563793083652854, -0.010637600906193256, -0.007686925120651722, 0.005487706046551466, -0.00881755817681551, -0.032953813672065735, 0.008583158254623413, 0.006266739685088396, 0.017745422199368477, -0.031244074925780296, -0.015704767778515816, -0.04028913751244545, 0.027755659073591232, -0.0044742729514837265, -0.008603841066360474, -0.03025132417678833, -0.007252596318721771, -0.008100571110844612, 0.016104625537991524, -0.013946770690381527, 0.03163014352321625, -0.00778344227001071, -0.012209456413984299, 0.022626446560025215, 0.03551841899752617, -0.005542858969420195, -0.000626501627266407, 0.022130070254206657, 0.020930496975779533, -0.006087493151426315, -0.012912655249238014, -0.030085865408182144, 0.019400006160140038, -0.03229197859764099, -0.022102493792772293, 0.009217415936291218, -0.009789626114070415, 0.006611444987356663, -0.029065538197755814, -0.061164483428001404, 0.012043998576700687, 0.006849291268736124, -0.02821066975593567, 0.015001568011939526, 0.008217770606279373, 0.004822425078600645, -0.031216498464345932, -0.016987070441246033, -0.019496522843837738, 0.01607704907655716, -0.039572153240442276, 0.02878977544605732, -0.04175068810582161, -0.007907535880804062, 0.020544426515698433, -0.0063081043772399426, -0.05435311049222946, 0.02250235341489315, 0.021744001656770706, -0.006614891812205315, -0.011878539808094501, 0.025053171440958977, 8.03055299911648e-05, 0.008658993989229202, 0.02446027845144272, 0.013140160590410233, -0.004581131506711245, -0.010906470939517021, -0.03935154154896736, -0.019606828689575195, -0.035683877766132355, -0.012616208754479885, -0.020640945062041283, 0.0002934302610810846, -0.005325694568455219, 0.046300794929265976, 0.04588714987039566, -0.03347776457667351, -0.007100926246494055, 0.03083042986690998, 0.02821066975593567, -0.005987528711557388, -0.002419830299913883, 0.00916226301342249, -0.015249756164848804, 0.007056114729493856, -0.018186643719673157, -0.011988845653831959, -0.057358939200639725, 0.03565630316734314, 0.024860136210918427, -0.007183655630797148, -0.03515992686152458, -0.016352811828255653, 0.012271503917872906, 0.0267353318631649, -0.017910879105329514, 0.016380388289690018, 0.05680740997195244, 0.006563186179846525, -0.03830363601446152, 0.006621785927563906, 0.03265047073364258, 0.013505548238754272, -0.031878333538770676, 0.001658031833358109, 0.007824807427823544, -0.005380847491323948, -0.02626653201878071, -0.03306411951780319, -0.006325339432805777, -0.0023371009156107903, 0.006811373867094517, -0.026707755401730537, -0.04117158427834511, -0.02542545273900032, -0.05967535823583603, 0.028183093294501305, -0.01988259330391884, 0.00305581116117537, -0.003829674329608679, 0.002705935388803482, -0.026335474103689194, 0.04955481365323067, -0.008569370023906231, 0.026294108480215073, 0.023164186626672745, -0.0029179290868341923, -0.002819688292220235, 0.04641110077500343, 0.044398024678230286, 0.025646064430475235, -0.000744994031265378, -0.008658993989229202, 0.026818061247467995, -0.013284936547279358, -0.010513506829738617, 0.025342723354697227, -0.02947918511927128, 0.029837679117918015, -0.022143859416246414, 0.03469112515449524, 0.0644185021519661, -0.03413959965109825, 0.005942716728895903, -0.018007397651672363, 0.007142290938645601, 0.022102493792772293, -0.020006686449050903, -0.01715252920985222, -0.01186475157737732, 0.03298138827085495, 0.0009574185824021697, 0.018186643719673157, 0.040702786296606064, 0.04599745571613312, 0.016104625537991524, -0.03469112515449524, 0.009762049652636051, -0.036456018686294556, -0.0008208291255868971, 0.007748971693217754, -0.0038813799619674683, -0.03025132417678833, -0.001559790805913508, 0.02494286559522152, 0.02361919730901718, -0.022957364097237587, -0.017910879105329514, 0.0007027676329016685, -0.021937036886811256, 0.027879752218723297, -0.01890362985432148, -0.010451460257172585, -0.01967577077448368, -0.016628576442599297, -0.007431843318045139, -0.03146468847990036, 0.017511021345853806, 0.02007562853395939, -0.023467527702450752, -0.0002746869286056608, 0.019179394468665123, -0.03049951232969761, -0.01588401384651661, 0.008072994649410248, 0.0044915080070495605, -0.005408423952758312, -0.06248814985156059, -0.006545951124280691, 0.010120543651282787, 0.0150980856269598, -0.017524810507893562, -0.008962334133684635, -0.034167174249887466, -0.001842449069954455, -0.023315856233239174, -0.01569097861647606, -0.005470470990985632, 0.018627867102622986, -0.019455159083008766, -0.00037098891334608197, 0.005477365106344223, -0.0012133622076362371, -0.03083042986690998, 0.029782526195049286, -0.011540728621184826, 0.027107613161206245, -0.008789981715381145, 0.01161656342446804, -0.006721750367432833, -0.022860845550894737, 0.03356049582362175, -0.0011668269289657474, 0.03838636726140976, 0.008652099408209324, -0.0113959526643157, 0.04525289312005043, -0.04266070947051048, 0.01005849614739418, -0.01607704907655716, 0.004046838730573654, -0.002538753440603614, -0.01700085774064064, 0.05280882865190506, 0.00942423939704895, 0.010334260761737823, -0.0012555884895846248, -0.04106127843260765, -0.02186809480190277, 0.0031368169002234936, 0.037145428359508514, 0.02142687328159809, 0.0006635574391111732, 0.037007544189691544, -0.00022685907606501132, 0.019220760092139244, 0.004222637973725796, 0.008121253922581673, 0.021592330187559128, 0.014001923613250256, 0.003179905004799366, 0.01107882335782051, 0.018159067258238792, -0.014367311261594296, -0.002300906926393509, -0.04351557791233063, 0.010678965598344803, -0.048451755195856094, -0.03151983767747879, -0.00713539682328701, -0.007514572236686945, 0.02532893419265747, -0.005005118902772665, 0.027645353227853775, -0.11560031771659851, 0.0026318237651139498, -0.0041743796318769455, -0.006663150619715452, 0.011471787467598915, 0.00028201189707033336, 0.020765038207173347, -0.00227677752263844, 0.009589697234332561, -0.011258070357143879, -0.014477616176009178, 0.004357072990387678, -0.01096162386238575, -0.0296170674264431, 0.03411202132701874, 0.010334260761737823, -0.0037814155220985413, -0.00022082673967815936, 0.039875492453575134, -0.03744876757264137, -0.027217919006943703, -0.01122360024601221, -0.023743290454149246, 0.028431281447410583, 0.010851318016648293, -0.0032419520430266857, -0.012850608676671982, 0.046300794929265976, 0.010589342564344406, 0.042991627007722855, 0.01349176000803709, -0.02878977544605732, 0.01578749530017376, -0.004236426204442978, -0.011106399819254875, 0.022833269089460373, -0.004267449956387281, 0.03215409815311432, 0.010575554333627224, -0.023067669942975044, -0.03292623534798622, -0.043846495449543, 0.01515323854982853, 0.0033660458866506815, 0.0511542446911335, -0.0030247876420617104, -0.020958073437213898, 0.025494392961263657, -0.02094428613781929, -0.029203420504927635, -0.048644792288541794, 0.03049951232969761, -0.006373598240315914, -0.004653519485145807, 0.036069948226213455, 0.052974287420511246, -0.041088853031396866, -0.00027404059073887765, 0.007707607466727495, 0.011713081039488316, 0.003240228397771716, 0.030747700482606888, 0.0027473000809550285, -0.05578708276152611, 0.00803852453827858, -0.0257701575756073, -0.03163014352321625, -0.02465331368148327, -0.007259490434080362, -0.021261414512991905, 0.021468237042427063, -0.006232269108295441, 0.005797940772026777, -0.030471935868263245, -0.0018924312898889184, 0.022323105484247208, 0.02498422935605049, -0.013326301239430904, 0.0021871542558073997, -0.004363967105746269, -0.015277332626283169, -0.008721040561795235, -0.0013159118825569749, 0.040206409990787506, 0.0133194075897336, -0.028376128524541855, 0.0228884220123291, -0.030582241714000702, 0.004215743858367205, 0.02761777676641941, 0.008983016014099121, 0.003093728795647621, 0.031795602291822433, -0.02236447110772133, -0.023495104163885117, 0.020875344052910805, 0.007886854000389576, 0.006377045530825853, 0.007300855126231909, -0.027603989467024803, 0.00290414085611701, 0.017979821190238, -0.010796165093779564, -0.0069837262853980064, -0.013602065853774548, 0.03786241263151169, -0.0444255992770195, 0.015208391472697258, -0.015401426702737808, 0.014063970185816288, 0.027824601158499718, 0.0004127844294998795, 0.011588986963033676, 0.00113838876131922, -0.027066249400377274, 0.02498422935605049, 0.02455679513514042, 0.008348759263753891, -0.013064325787127018, -0.018048761412501335, -0.008569370023906231, 0.0129333371296525, -0.023164186626672745, 0.024639524519443512, -0.00942423939704895, -0.027245495468378067, -0.00522228330373764, -0.023798443377017975, -0.009375980123877525, 0.035435691475868225, -0.0071629732847213745, 0.03267804905772209, -0.06739675253629684, 0.048975709825754166, -0.011099506169557571, 0.003224716754630208, -0.0006480456795543432, 0.02026866376399994, -0.025122111663222313, 0.007721395697444677, 0.004336390644311905, -0.001338317757472396, 0.03844152018427849, -0.046879902482032776, -0.01957925222814083, -0.03143711015582085, 0.058241382241249084, -0.0077627599239349365, -0.019951533526182175, 0.0375039204955101, -0.009975766763091087, 0.007590407505631447, 0.01030668430030346, -0.002711106091737747, -0.0036504275631159544, 0.07329810410737991, -0.001651137717999518, -0.033532917499542236, -0.015470367856323719, -0.02294357493519783, -0.00981720257550478, 0.01895878277719021, -0.012078468687832355, 0.012657573446631432, 0.001985501730814576, -0.02196461334824562, 0.005570435430854559, -0.008403911255300045, -0.03951700031757355, 0.03284350782632828, -0.0019062195206061006, 0.03546326607465744, 0.00010933616431429982, -0.030471935868263245, 0.025976980105042458, 0.03915850445628166, 0.07158836722373962, 0.00011235233978368342, -0.016297658905386925, 0.037476345896720886, -0.011285646818578243, 0.03502204269170761, -0.030664971098303795, 0.043763767927885056, 0.06259845942258835, 0.018862266093492508, 0.010030919685959816, 0.022736752405762672, 0.009844779036939144, -0.005518729332834482, 0.04100612550973892, 0.012257715687155724, -0.0032092051114887, 0.030554665252566338, 0.018186643719673157, 0.03656632453203201, 0.0588480643928051, 0.02956191450357437, -0.0013951940927654505, -0.007907535880804062, -0.027686718851327896, 0.0580759234726429, 0.005411870777606964, -0.0224058348685503, -0.018352102488279343, 0.025797734037041664, -0.012147409841418266, -0.014615498483181, -0.015373850241303444, 0.02630789764225483, -0.015994319692254066, -0.010589342564344406, 0.03882759064435959, -0.015084297396242619, -0.04111643135547638, -0.0017545492155477405, 0.0027266177348792553, -0.0005916001973673701, -0.03830363601446152, -0.003843462560325861, -0.025535758584737778, -0.022474776953458786, 0.006635574158281088, 0.010148120112717152, -0.06546640396118164, -0.00825913529843092, -0.005704870447516441, 0.014015711843967438, -0.012340444140136242, -0.008059206418693066, 0.011492470279335976, 0.017304198816418648, 0.0025318593252450228, -0.0262527447193861, 0.010589342564344406, -0.004288132302463055, 0.022640233859419823, 0.0018976018764078617, 0.028293399140238762, 0.02040654607117176, 0.003276422619819641, -0.030609818175435066, -0.016835398972034454, -0.017897091805934906, 0.01439488772302866, 0.0066803861409425735, 0.027052460238337517, 0.03458082303404808, -0.024956652894616127, -0.025466816499829292, -0.03182318061590195, 0.024336183443665504, 0.012561055831611156, 0.01385714765638113, 0.011423529125750065, -0.03932396322488785, 0.006473562680184841, 0.01709737628698349, 0.002468088874593377, 0.03000313602387905, -0.009755156002938747, -0.009555227123200893, -0.0029179290868341923, -0.046935055404901505, -0.006756220944225788, -0.02011699229478836, -0.021357931196689606, 0.003929638769477606, 0.05391188710927963, 0.0257701575756073, -0.0029903172980993986, -7.707392069278285e-05, 0.011588986963033676, 0.025453029200434685, -0.014532769098877907, -0.0020010133739560843, -0.03761422634124756, 0.02738337777554989, -0.02572879195213318, -0.012243927456438541, 0.001023774268105626, 0.01738692820072174, -0.0025887356605380774, 0.021799154579639435, -0.006914785597473383, 0.00903816893696785, 0.011540728621184826, -0.04106127843260765, -0.004984436556696892, -0.008072994649410248, 0.042991627007722855, -0.01567719131708145, -0.017759209498763084, -0.01671130582690239, 0.04271586239337921, -8.429118315689266e-05, 0.0032798696774989367, 0.005891011096537113, -0.012257715687155724, -0.030527088791131973, -0.007859277538955212, 0.01578749530017376, -0.02050306275486946, -0.02967222034931183, 0.005866881925612688, -0.014229428954422474, 0.0131746307015419, -0.044067107141017914, 0.01777299866080284, 0.04784507676959038, -0.007576619274914265, 0.019813653081655502, -0.01371237076818943, -0.012581738643348217, 0.044701363891363144, -0.010113649070262909, -0.014022605493664742, 0.011885433457791805, -0.04969269409775734, 0.03907577693462372, -0.051898807287216187, 0.009810308925807476, -0.0018924312898889184, 0.0024284478276968002, -0.007797230500727892, -0.00893475767225027, 0.010699648410081863, 0.015759918838739395, 0.03993064537644386, -0.01349176000803709, -0.0013486589305102825, 0.0010418713791295886, -0.002521518152207136, 0.00821087695658207, -0.008755510672926903, 0.014339734800159931, -0.04914116859436035, 0.012754091061651707, 0.0031057933811098337, -0.03011344186961651, -0.01611841283738613, -0.0016416582511737943, -0.0036711099091917276, 0.010327366180717945, 0.026473356410861015, -0.023012517020106316, 0.015718555077910423, -0.006352915894240141, 0.006639021448791027, 0.042743440717458725, 0.06872042268514633, 0.017028434202075005, 0.005418764892965555, -0.00362285110168159, 0.005670399870723486, -0.015608249232172966, -0.0003352257772348821, 0.010044707916676998, -0.022571293637156487, -0.036759357899427414, -0.03242986276745796, 0.00695270299911499, -0.009251886047422886, -0.0004800019378308207, 0.01748344488441944, -0.017180105671286583, -0.002781770657747984, 0.04748658090829849, 0.015015356242656708, -0.015111873857676983, 0.03736604005098343, 0.03868970647454262, 0.020861556753516197, 0.008838240057229996, 0.01573234423995018, -0.008493535220623016, 0.0033608751837164164, -0.005873776040971279, 0.03113376908004284, 0.020061839371919632, 0.005291223991662264, -0.024956652894616127, 0.014312158338725567, 0.0023250363301485777, -0.025315146893262863, 0.011609669774770737, 0.006280527915805578, 0.04150250181555748, -0.003971003461629152, 0.05371885001659393, 0.009100216440856457, 0.015442791394889355, -0.013719265349209309, -0.017511021345853806, -0.00042743439553305507, 0.022323105484247208, -0.002506006509065628, 0.012685149908065796, 0.017428291961550713, 0.03331230580806732, 0.00305753480643034, -0.016145989298820496, 0.024432701990008354, -0.033008966594934464, 0.0003903785836882889, -0.026073498651385307, 0.021413084119558334, 0.031188922002911568, 0.013119478709995747, 0.03761422634124756, -0.04161280766129494, -0.0175937507301569, 0.031933486461639404, 0.01349176000803709, -0.0020079074893146753, -0.06127478927373886, -0.017331775277853012, 0.024929076433181763, -0.028320975601673126, 0.00905885174870491, -0.0010961623629555106, -0.02152338996529579, 0.029837679117918015, 0.009748261421918869, 0.008824451826512814, 0.04925147444009781, 0.027934905141592026, -0.0007842042250558734, 0.015208391472697258, 0.017552386969327927, 0.01802118495106697, -0.02513590082526207, -0.006087493151426315, -0.01556688454002142, 0.003048917045816779, 0.014560345560312271, 0.023798443377017975, 0.003476351499557495, -0.00400892086327076, 0.01569097861647606, 0.016256295144557953, -0.0026542297564446926, 0.017180105671286583, 0.013140160590410233, -0.04150250181555748, 0.014436252415180206, 0.013291831128299236, 0.021151108667254448, -0.034856583923101425, -0.004264002665877342, -0.021606119349598885, 0.01684918813407421, -0.015139450319111347, -0.010465248487889767, 0.018503772094845772, -0.003262634389102459, 0.012161198072135448, -0.026363050565123558, -0.011685504578053951, 0.03127165138721466, 0.017704056575894356, -0.0001424063229933381, -0.017979821190238, 0.006404621992260218, 0.0006902720779180527, -0.0003261772508267313, -0.026666391640901566, 0.004419120028614998, -0.03259531781077385, -0.025839097797870636, 0.00025443549384362996, 0.00293516437523067, -0.012257715687155724, 0.0034591162111610174, 0.0019062195206061006, -0.0012262886157259345, -8.348328265128657e-05, -0.02055821567773819, -0.003936532884836197, -0.014215640723705292, 0.0032953813206404448, 0.012685149908065796, -0.004339837934821844, 0.010747906751930714, -0.01592537760734558, 0.008748617023229599, -0.02319176308810711, -0.021854307502508163, -0.020958073437213898, 0.00998955499380827, -0.021757788956165314, 0.0444255992770195, -0.012112938798964024, -0.03951700031757355, 0.03780725970864296, 0.007018196862190962, 0.017800575122237206, 0.013291831128299236, 0.025149688124656677, 0.04370861500501633, -0.002802453003823757, -0.0008221218013204634, 0.00539463572204113, 0.018986359238624573, 0.0009229480638168752, -0.022240376099944115, -0.002419830299913883, 0.012926443479955196, -0.009127792902290821, -0.018145279958844185, -0.004277790896594524, 0.012457644566893578, -0.027824601158499718, -0.02640441432595253, -0.0038710390217602253, 0.0296170674264431, 0.0026318237651139498, 0.033201999962329865, -0.011637246236205101, -0.012857502326369286, -0.009934403002262115, 0.00305753480643034, 0.010678965598344803, -0.00611506961286068, 0.021206261590123177, 0.001124600530602038, -0.018820902332663536, 0.009031275287270546, -0.004012368153780699, -0.000721726450137794, -0.004419120028614998, -0.008652099408209324, -0.005522176623344421, 0.02572879195213318, 0.009803414344787598, 0.000321006664307788, 0.010706542059779167, -0.03270562365651131, 0.018131490796804428, -0.005691082216799259, 0.00983788538724184, -0.017511021345853806, -0.007714501582086086, -0.006863079499453306, 0.010878894478082657, 0.05374642834067345, -0.005591117776930332, 0.0215371772646904, 0.003912403713911772, 0.018972571939229965, -0.0052291774190962315, -0.002888629212975502, -0.026804272085428238, 0.016794035211205482, -0.034222327172756195, 0.05187123268842697, -0.0011892328038811684, 0.0150980856269598, -0.013746841810643673, -0.0009979214519262314, -0.007659348659217358, -0.008169512264430523, -0.011561410501599312, -0.000657525088172406, 0.007852383889257908, 0.01493262778967619, 0.0011504534631967545, -0.021151108667254448, 0.009858567267656326, 0.013188418932259083, 0.004326049704104662, -0.02152338996529579, -0.005794493481516838, -0.0031678404193371534, -0.028141729533672333, 0.0017855727346614003, 0.04594230279326439, 0.016738882288336754, -0.013457288965582848, -0.0351875014603138, 0.01502914447337389, -0.02415693737566471, -0.014891263097524643, -0.006532162893563509, 0.014836110174655914, -0.02090292051434517, -0.0052636475302278996, -0.048589639365673065, 0.014160487800836563, 0.013919194228947163, -0.0006277942447923124, 0.016573423519730568, -0.013919194228947163, 0.021371720358729362, 0.003171287477016449, -0.017841938883066177, 0.02713518962264061, -0.0031350934877991676, -0.0009315657080151141, -0.015291120857000351, 0.007542148698121309, 0.02859674021601677, -0.015167026780545712, -0.028458857908844948, -0.03902062401175499, -0.011795810423791409, 0.03463597595691681, -0.02669396810233593, 0.03893789276480675, 0.012774772942066193, 0.013843359425663948, 0.02967222034931183, -0.007211232092231512, -0.009858567267656326, 0.0263492614030838, -0.014119123108685017, -0.009920614771544933, -0.013574489392340183, -0.019841229543089867, 0.017800575122237206, -0.008397017605602741, 9.845641034189612e-05, -0.02031002752482891, -0.01347107719630003, 0.017166316509246826, 0.006828608922660351, -0.0065390570089221, -3.813973989963415e-06, 0.006380492355674505, -0.01493262778967619, 0.021550966426730156, -0.0008053174242377281, -0.00040158152114599943, -0.009913720190525055, 0.011878539808094501, 0.0185589250177145, 0.020723674446344376, -0.007025090977549553, -0.002375018550083041, -0.014946416020393372, 0.02415693737566471, 0.016794035211205482, 0.03240228444337845, 0.0012823031283915043, 0.010568659752607346, -0.010368730872869492, 0.03375352919101715, -0.010292896069586277, -0.022088706493377686, -0.00024409433535765857, -0.02650093287229538, -0.02353646792471409, 0.038855165243148804, 0.0007988542201928794, -0.00023095245705917478, 0.013822676613926888, -0.012871290557086468, 0.017221469432115555, -0.015484156087040901, 0.004750037100166082, 0.019565464928746223, -0.012685149908065796, -0.010644495487213135, -0.0373108871281147, 0.04335011914372444, 0.01208536233752966, 0.02133035473525524, -0.006394280586391687, -0.004694884177297354, 0.01632523536682129, 0.02859674021601677, -0.002256095176562667, -0.023564044386148453, -0.016973281279206276, 0.020392756909132004, 0.025411663576960564, -0.013105690479278564, 0.005449788644909859, 0.005205047782510519, -0.031547416001558304, -0.003905509365722537, 0.0111546590924263, 0.024998018518090248, -0.03367079794406891, 0.023274492472410202, -0.0017373140435665846, 0.020241087302565575, -0.0029782524798065424, 0.031685296446084976, 0.02834855206310749, -0.014257005415856838, -0.014973991550505161, -0.021413084119558334, -0.014725804328918457, -0.0451977401971817, 0.020337603986263275, -0.028514010831713676, -0.00874172244220972, -0.013498653657734394, 0.016435541212558746, -0.006435645278543234, 0.014422464184463024, 0.01042388379573822, 0.0219232477247715, -0.020572002977132797, 0.01300917286425829, 0.009031275287270546, 0.007976477034389973, -0.04715566709637642, 0.03863455355167389, -0.010099860839545727, -0.006735538598150015, 0.002454300643876195, -0.012919548898935318, -0.02225416526198387, 0.04075793921947479, -0.0020458251237869263, 0.016780247911810875, -0.011037458665668964, -0.00867278128862381, 0.007293961010873318, 0.0013202207628637552, 0.020916709676384926, -0.0035504631232470274, -0.00444324966520071, -0.03298138827085495, -0.003967556171119213, -0.012664467096328735, -0.00825913529843092, -0.018779536709189415, -0.0009082980686798692, -0.013946770690381527, 0.02226795256137848, -0.04244009777903557, 0.006349469069391489, -0.014408675953745842, -0.023150397464632988, -0.015870224684476852, -0.015994319692254066]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-15T11:18:04.195341", "url_path": "/examples/question-graph/", "chunk_size": 2063}
updated_dt: 2025-03-15T11:18:04.196852
---
async defrun_as_cli(answer: str | None):
  history_file = Path('question_graph_history.json')
  history = (
    question_graph.load_history(history_file.read_bytes())
    if history_file.exists()
    else []
  )
  if history:
    last = history[-1]
    assert last.kind == 'node', 'expected last step to be a node'
    state = last.state
    assert answer is not None, 'answer is required to continue from history'
    node = Answer(answer)
  else:
    state = QuestionState()
    node = Ask()
  debug(state, node)
  with logfire.span('run questions graph'):
    while True:
      node = await question_graph.next(node, history, state=state)
      if isinstance(node, End):
        debug([e.data_snapshot() for e in history])
        print('Finished!')
        break
      elif isinstance(node, Answer):
        print(state.question)
        break
      # otherwise just continue
  history_file.write_bytes(question_graph.dump_history(history, indent=2))

if __name__ == '__main__':
  importasyncio
  importsys
  try:
    sub_command = sys.argv[1]
    assert sub_command in ('continuous', 'cli', 'mermaid')
  except (IndexError, AssertionError):
    print(
      'Usage:\n'
      ' uv run -m pydantic_ai_examples.question_graph mermaid\n'
      'or:\n'
      ' uv run -m pydantic_ai_examples.question_graph continuous\n'
      'or:\n'
      ' uv run -m pydantic_ai_examples.question_graph cli [answer]',
      file=sys.stderr,
    )
    sys.exit(1)
  if sub_command == 'mermaid':
    print(question_graph.mermaid_code(start_node=Ask))
  elif sub_command == 'continuous':
    asyncio.run(run_as_continuous())
  else:
    a = sys.argv[2] if len(sys.argv) > 2 else None
    asyncio.run(run_as_cli(a))

```

The mermaid diagram generated in this example looks like this:
```
---
title: question_graph
---
stateDiagram-v2
 [*] --> Ask
 Ask --> Answer: ask the question
 Answer --> Evaluate: answer the question
 Evaluate --> Congratulate
 Evaluate --> Castigate
 Congratulate --> [*]: success
 Castigate --> Ask: try again
```

© Pydantic Services Inc. 2024 to present