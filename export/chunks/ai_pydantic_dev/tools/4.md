---
url: https://ai.pydantic.dev/tools/
session_id: pydantic_ai_docs
chunk_number: 4
title: Dynamic Function Tools in Pydantic
summary: This section explains the 'prepare' function in dynamic tools, which allows customization of tools at each run step. The 'prepare' method can be registered using specific decorators and requires a function type 'ToolPrepareFunc' that accepts context and tool definition.
embedding: [-0.039293743669986725, 0.04556622728705406, -0.003576871007680893, -0.03478377312421799, -0.005420384928584099, -0.007283338811248541, -0.0029807258397340775, 0.039656613022089005, -0.0034569939598441124, 0.02747451700270176, 0.04279285669326782, -0.03685732185840607, 0.04611053317785263, -0.032217759639024734, -0.0019617711659520864, 0.010127987712621689, -0.0007698858389630914, 0.03263246640563011, -0.00695934658870101, 0.06816790252923965, 0.04157464578747749, 0.014657394960522652, 0.023547733202576637, 0.022925669327378273, 0.024804823100566864, 0.029936855658888817, -0.02179817669093609, 0.05126848444342613, -0.0063210828229784966, 0.005812415387481451, 0.018934089690446854, -0.020696604624390602, -0.023625491186976433, -0.021564902737736702, -0.01132027804851532, -0.0049667963758111, 0.044451694935560226, 0.018726734444499016, -0.02140938676893711, 0.019258080050349236, -0.02226472645998001, -0.045903176069259644, 0.035302162170410156, 0.0483655147254467, -0.0090652946382761, 0.004098497796803713, -0.0064960382878780365, 0.018791532143950462, 0.002242024289444089, -0.02196665294468403, -0.02523249201476574, 0.012389451265335083, -0.001186620444059372, 0.010413100942969322, -0.03504296764731407, -0.02643774263560772, -0.02365141175687313, 0.034446824342012405, -0.007192621007561684, 0.0008245594799518585, -0.009045855142176151, -0.02524545229971409, 0.010484378784894943, 0.04367411136627197, -0.04730282351374626, -0.012894879095256329, -0.0414968878030777, 0.015681209042668343, -0.04191159829497337, 0.005805935710668564, 0.006013290490955114, 0.032036323100328445, -0.05655603110790253, 0.007412935607135296, -0.0020249495282769203, -0.008346032351255417, -0.0025805956684052944, 0.04849511384963989, 0.02420867793262005, -0.018065789714455605, -0.008436749689280987, -0.015758967027068138, -0.001397215179167688, 0.0027636513113975525, -0.047250982373952866, -0.07221132516860962, -0.03408395126461983, -0.02713756449520588, -0.001593230408616364, -0.022860871627926826, 0.005478703882545233, -0.03582054749131203, 0.0048728385008871555, 0.010549177415668964, 0.0829937756061554, 0.04022683948278427, 0.012033060193061829, -0.03644261136651039, -0.005699018016457558, 0.020800283178687096, 0.04600685462355614, 0.022951588034629822, -0.05759280547499657, 0.008877378888428211, 0.05961451679468155, 0.011780346743762493, 0.00828771386295557, 0.0003187270776834339, -0.03040340356528759, 0.041704241186380386, -0.0846007764339447, -0.020126380026340485, 0.014709234237670898, 0.02387172542512417, -0.04458129033446312, -0.0025724959559738636, -0.0032771783880889416, 0.015149863436818123, -0.008035000413656235, -0.03245103359222412, -0.03815329074859619, -0.03869759663939476, 0.036727726459503174, -0.0276559516787529, 0.006486318539828062, 0.02541392669081688, -0.0013988352147862315, -0.010115028358995914, -0.06205093488097191, -0.02607487142086029, 0.007523092906922102, 0.03131058067083359, -0.0009193271398544312, 0.004309092648327351, -0.01010206900537014, -0.036727726459503174, -0.04681035503745079, 0.0021237670443952084, -0.02021709643304348, 0.0397602915763855, 0.018921129405498505, -0.04248182103037834, -0.0005317517789080739, 0.013905733823776245, -0.01656246744096279, 0.051035210490226746, -0.02453267015516758, -0.004441929515451193, -0.036390773952007294, 0.0501539520919323, 0.020268935710191727, 0.00093876663595438, -0.015240580774843693, -0.007879483513534069, -0.03558727353811264, 0.025945274159312248, 0.01372429821640253, 0.022005531936883926, 0.04110809788107872, -0.031336501240730286, 0.013192951679229736, 0.018895210698246956, -0.04572174325585365, 0.00479184091091156, -0.013879814185202122, -0.03094770945608616, 0.025323210284113884, -0.011890504509210587, -0.07444038987159729, -0.03597606346011162, 0.010309423319995403, -0.006573796272277832, -0.023431096225976944, 0.02352181449532509, 0.04255957901477814, -0.005167671479284763, -0.0672866478562355, -0.027578193694353104, -0.012674564495682716, -0.03812737017869949, -0.022925669327378273, -0.002404020167887211, -0.05650419369339943, 0.004075818695127964, -0.05562293529510498, -0.06313955038785934, -0.0004300992877688259, -0.021033557131886482, 0.011294359341263771, 0.038464322686195374, -0.0007488263654522598, 0.009356887079775333, 0.033980272710323334, 0.0011080524418503046, 0.018000992015004158, -0.04108217731118202, 0.059873711317777634, -0.015616411343216896, 0.014268605038523674, -0.02488258108496666, 0.011106443591415882, 0.04870246723294258, 0.026696935296058655, 0.0014190847286954522, 0.023042306303977966, -0.023716209456324577, 0.021720418706536293, 0.04097849875688553, -0.0207225251942873, -0.048287756741046906, -0.0007666459423489869, -0.04940228909254074, 0.016484709456562996, 0.02900375798344612, -0.013944612815976143, 0.008838499896228313, -0.02556944452226162, 0.019245121628046036, 0.013322548009455204, 0.0432334840297699, -0.01547385472804308, 0.018947048112750053, 0.0483395978808403, -0.0056083002127707005, -0.019102564081549644, 0.03263246640563011, -0.04183384031057358, -0.060184743255376816, -0.01884337142109871, 0.05248669534921646, 0.0362611785531044, 0.009220810607075691, 0.01798803173005581, -0.04909125715494156, 0.026722855865955353, -0.0500761941075325, -0.01261624600738287, -0.03753122687339783, -0.00462012505158782, -0.03346188738942146, -0.03006645105779171, -0.02350885421037674, -0.003904102835804224, -0.0020411491859704256, 0.01639399118721485, 0.016536548733711243, 0.018182426691055298, -0.008035000413656235, 0.03491337224841118, 0.0063826413825154305, 0.08962912857532501, -0.052071984857320786, 0.011255480349063873, -0.04528111219406128, -0.0396825335919857, -0.023288540542125702, -0.005507863126695156, -0.030792193487286568, -0.04261142015457153, -0.002514177467674017, 0.008410830982029438, -0.0038814235012978315, -0.0414191298186779, 0.007088943384587765, -0.0380236953496933, 0.034135788679122925, 0.05113888904452324, 0.010257584974169731, 0.021487144753336906, -0.03403211385011673, 0.05982187017798424, 0.05238301679491997, 0.04458129033446312, -0.01469627395272255, -0.02799290418624878, -0.03232143446803093, 0.0020508689340204, 0.03934558108448982, 0.007834125310182571, -0.012208016589283943, -0.02229064516723156, 0.018908169120550156, 0.020774362608790398, 0.028200257569551468, -0.019970862194895744, 0.016990136355161667, -0.018052831292152405, 0.009045855142176151, -0.017715878784656525, 0.010153907351195812, 0.015771927312016487, 0.03162161260843277, 0.042041193693876266, 0.007030624896287918, -0.011884024366736412, -0.011378596536815166, 0.02542688697576523, -0.004435449838638306, 0.007393496111035347, -0.045851338654756546, 0.02057996764779091, 0.005209790542721748, 0.021707460284233093, -0.0061072479002177715, 0.009110652841627598, -0.0063826413825154305, 0.029288871213793755, -0.022925669327378273, 0.022498000413179398, -0.005242189392447472, 0.01527945976704359, 0.029962774366140366, -0.03434314578771591, -0.017923234030604362, -0.0006192295695655048, -0.005954972002655268, -0.003891143249347806, -0.019815346226096153, 0.02538800798356533, -0.0011080524418503046, -0.008035000413656235, -0.024428991600871086, 0.010270544327795506, -0.009985431097447872, 0.0074712540954351425, 0.02433827519416809, 0.009305048733949661, -0.024752983823418617, 0.026722855865955353, 0.029314789921045303, -0.030273806303739548, -0.06148070842027664, -0.011689629405736923, 0.025362089276313782, 0.04577358067035675, -0.0058221351355314255, 0.007225020322948694, 0.027578193694353104, 0.0345245823264122, 0.03734979033470154, -0.04185975715517998, 0.004681683611124754, -0.041211772710084915, -0.05738545209169388, 0.022731274366378784, 0.02038557268679142, 0.004205415491014719, 0.008994015865027905, -0.02744859643280506, 0.03421355038881302, 0.04541071131825447, -0.030869951471686363, 0.007885963656008244, 0.0466807596385479, -0.03164753317832947, -0.02317190356552601, -0.013659500516951084, -0.021720418706536293, -0.0013307968620210886, 0.018389781937003136, -0.01745668612420559, 0.013789096847176552, -0.0005937152309343219, -0.013529903255403042, -0.04979108273983002, 0.050698257982730865, 0.005673098843544722, 0.004257253836840391, -0.02485666051506996, 0.010562136769294739, 0.02781146764755249, 0.05645235627889633, -0.02055404894053936, 0.0066677541472017765, -0.019141443073749542, -0.017353007569909096, -0.0008909778553061187, 0.017715878784656525, 0.039319660514593124, -0.03247695043683052, 0.05686706304550171, -0.006920467596501112, -0.016199596226215363, 0.009058814495801926, 0.027863306924700737, 0.044477611780166626, 0.009473524056375027, 0.008106278255581856, -0.03309901803731918, -0.015642330050468445, 0.04937637224793434, -0.09273945540189743, -0.007983161136507988, -0.019115524366497993, -0.0013680559350177646, 0.00712782284244895, 0.018713774159550667, 0.02796698361635208, 0.0500761941075325, -0.008715382777154446, -0.027085725218057632, -0.001303257537074387, -0.017741799354553223, -0.0023635211400687695, -0.015059145167469978, 0.07107087224721909, 0.02503809705376625, -0.0017949152970686555, -0.0018143547931686044, -0.00017434815526939929, 0.05443064495921135, 0.012519048526883125, 0.03146609663963318, 0.008177556097507477, -0.008682983927428722, -0.04056379199028015, 0.007983161136507988, 0.009480004198849201, 0.035846468061208725, 0.0036060302518308163, -0.01608295924961567, -0.08423790335655212, 0.04354451596736908, -0.03582054749131203, -0.010076149366796017, 0.04473680630326271, 0.01708085462450981, -0.08257906138896942, 0.03250287100672722, -0.038256969302892685, -0.005537022370845079, -0.019983822479844093, 0.0587332583963871, -0.010335342958569527, -0.005997090600430965, -0.03812737017869949, -0.039993565529584885, 0.026295185089111328, 0.02747451700270176, -0.011391556821763515, 0.010419581085443497, -0.052408937364816666, -0.0005216270219534636, 0.03468009829521179, -0.0638652890920639, 0.012389451265335083, -0.058111194521188736, -0.04108217731118202, 0.012382972054183483, -0.003243159269914031, 0.003537992015480995, 0.015331298112869263, -0.0032463991083204746, 0.004668723791837692, 0.03405803069472313, 0.010562136769294739, 0.027681870386004448, 0.017236370593309402, 0.07127822935581207, 0.006499278359115124, 0.07164109498262405, 0.026671016588807106, -0.031517934054136276, 0.058318547904491425, -0.009162492118775845, 0.021564902737736702, -0.007050064392387867, -0.005595340859144926, -0.016471749171614647, -0.03727203235030174, 0.016497669741511345, 0.022070331498980522, -0.010011350736021996, -0.0053879860788583755, 0.01356878224760294, 0.01398349180817604, 0.0016847581136971712, 0.0009217570768669248, -0.018195386976003647, 0.014683314599096775, 0.02157786302268505, -0.0414191298186779, 0.0030001653358340263, 0.05077601596713066, -0.0033273971639573574, 0.03812737017869949, 0.013970532454550266, 0.016536548733711243, -0.0005937152309343219, 0.008592266589403152, -0.002582215704023838, -0.009246730245649815, 0.05562293529510498, -0.014786992222070694, 0.023573653772473335, 0.05645235627889633, 0.01898592710494995, 0.012946717441082, -0.011858104728162289, 0.020074540749192238, -0.010620455257594585, -0.01883041113615036, 0.015564572997391224, 0.05165727436542511, 0.020955799147486687, -0.0006637784535996616, 0.0396825335919857, 0.0033695162273943424, 0.0037583063822239637, 0.07485509663820267, -0.06853077560663223, 0.014139007776975632, 0.0014806431718170643, 0.04046011343598366, -0.010225185193121433, 0.020333733409643173, 0.0011436915956437588, 0.0017706159269437194, 0.0008642484899610281, -0.00975863728672266, 0.003706467803567648, -0.011261959560215473, 0.003946221899241209, 0.02731900103390217, 0.04097849875688553, -0.006674233824014664, 0.010678774677217007, -0.01811762899160385, -0.05862957984209061, -0.00540094543248415, -0.0017155372770503163, 0.0037647862918674946, 0.015344258397817612, -0.0025417166762053967, -0.06961938738822937, -0.009596641175448895, 0.007911883294582367, 0.009596641175448895, 0.003218859899789095, -0.004918197635561228, -0.014540757983922958, 0.03177712857723236, 0.012564407661557198, -0.02334037981927395, 0.015085064806044102, 0.03125874325633049, 0.028796402737498283, 0.03421355038881302, 0.010562136769294739, -0.019115524366497993, 0.05119072645902634, -0.011845145374536514, 0.026139669120311737, -0.007160221692174673, 0.024273475632071495, -0.005841574631631374, -0.02607487142086029, -0.0005224369815550745, -0.01660134643316269, -0.03939741849899292, 0.022355442866683006, -0.015240580774843693, 0.024156838655471802, 0.017884355038404465, 0.007147262338548899, 0.03727203235030174, 0.041056256741285324, -0.010289983823895454, -0.003508832771331072, -0.03540584072470665, -0.00196501100435853, 0.009259689599275589, -0.018739692866802216, 0.0038036652840673923, 0.03193264454603195, -0.0022809032816439867, -0.0026583538856357336, -0.04872838780283928, -0.04738058149814606, -0.02349589578807354, 0.005096393171697855, -0.020268935710191727, 0.015305379405617714, 0.005251909140497446, -0.03784225881099701, -0.023094145581126213, 0.006343761924654245, 0.005724937655031681, -0.018623055890202522, -0.030144209042191505, -0.007011185400187969, -0.0017398366471752524, 0.010607495903968811, 0.021824097260832787, -0.053653065115213394, -0.025439847260713577, 0.013776137493550777, 0.006777911446988583, -0.04294837266206741, 0.005961451679468155, 0.035017047077417374, -0.04525519534945488, 0.020152298733592033, 0.024817781522870064, -0.02038557268679142, -0.023223742842674255, 0.030481161549687386, -0.0033160573802888393, -0.06853077560663223, 0.006359961815178394, 0.007380536291748285, -0.002953186398372054, -0.010516778565943241, -0.031051388010382652, -0.03141425922513008, 0.008566346950829029, -0.020476290956139565, 0.011106443591415882, 0.056089483201503754, -0.03296941891312599, -0.003871703753247857, -0.004953836556524038, -0.010011350736021996, -0.0022080049384385347, 0.021214991807937622, 0.006836229935288429, 0.021357549354434013, 0.018571218475699425, 0.007166701834648848, 0.0640208050608635, -0.02677469328045845, 0.015953363850712776, 0.03076627478003502, -0.00795724242925644, -0.02196665294468403, 0.008022040128707886, 0.020852120593190193, -0.01866193488240242, -0.00839139148592949, -0.06231012940406799, 0.028252096846699715, 0.014670355245471, 0.018687855452299118, -0.016705024987459183, -0.0032447793055325747, 0.02161674201488495, -0.009739197790622711, 0.0016717984108254313, 0.016873499378561974, -0.018195386976003647, 0.02520657330751419, -0.04191159829497337, -0.015849685296416283, 0.004684923216700554, 0.005378266330808401, -0.013387346640229225, -0.0070824637077748775, -0.016873499378561974, -0.02677469328045845, 0.03128466010093689, -0.03382475674152374, -0.013659500516951084, -0.015292419120669365, -0.002873808378353715, -0.0015227621188387275, 0.013231830671429634, 0.04681035503745079, 0.010445499792695045, 0.0224720798432827, 0.005812415387481451, -0.046525243669748306, 0.012810640968382359, 0.013620620593428612, -0.0077758063562214375, 0.022873830050230026, 0.00384254427626729, 0.04911717772483826, -0.05248669534921646, -0.043777789920568466, 0.02490849979221821, -0.018052831292152405, -0.023379258811473846, -0.03247695043683052, 0.012953197583556175, 0.06459103524684906, -0.01469627395272255, 0.03442090377211571, 0.02832985483109951, 0.00505427410826087, -0.0033160573802888393, -0.01511098351329565, -0.04237814620137215, 0.02814842015504837, -0.02299046702682972, 0.0020994676742702723, 0.023366298526525497, 0.010853730142116547, 0.01689941994845867, -0.036209337413311005, -0.04634380713105202, -0.01573304831981659, 0.01641991175711155, -0.01495546754449606, -0.014450040645897388, -0.01829906553030014, -0.01656246744096279, 0.010069669224321842, 0.02611375041306019, 0.05888877436518669, -0.023469975218176842, -0.012603286653757095, 0.022899750620126724, -0.01793619431555271, -0.015564572997391224, -0.0172622911632061, -0.01527945976704359, 0.022044410929083824, 0.017184533178806305, 0.03768674284219742, 0.008054439909756184, -0.01932287961244583, -0.006888068746775389, -0.018713774159550667, -0.005462503992021084, 0.008397870697081089, -0.013128153048455715, 0.00914953276515007, 0.04608461260795593, 0.026476621627807617, -0.03763490170240402, -0.005598580464720726, -0.00029301020549610257, -0.01762516051530838, -0.038256969302892685, 0.016821661964058876, -0.0011542212450876832, -0.04992067813873291, 0.020994678139686584, -0.02175929769873619, -0.01692533865571022, 0.032399192452430725, 0.03400619328022003, 0.006402080878615379, 0.019750548526644707, 0.002731251996010542, 0.023120064288377762, 0.0010383941698819399, 0.04885798320174217, -0.03766082227230072, 0.01641991175711155, -0.04937637224793434, 0.009881754405796528, 0.0023068226873874664, 0.005157951731234789, 0.007374056614935398, 0.003188080620020628, -0.0397602915763855, -0.008903298527002335, -0.02830393612384796, -0.0005268919048830867, 0.014009411446750164, -0.01389277447015047, 0.009700318798422813, 0.03644261136651039, -0.0073870159685611725, -0.0011436915956437588, -0.005792975891381502, -0.023262621834874153, -0.009791036136448383, 0.02381988801062107, 0.0345245823264122, -0.011158281937241554, -0.037220194935798645, -0.006359961815178394, 0.0027636513113975525, -0.03872351720929146, 0.018908169120550156, 0.011417475529015064, 0.0010294843232259154, -0.0328398235142231, 0.006337282247841358, 0.03304717689752579, -0.02677469328045845, 0.019620951265096664, 0.00725093949586153, 0.005566181614995003, -0.029159273952245712, -0.016147758811712265, -0.02365141175687313, 0.020255975425243378, -0.04268917813897133, -0.009259689599275589, 0.009570721536874771, 0.005323187448084354, 0.024066120386123657, -0.009013455361127853, 0.009019935503602028, -0.134573295712471, -0.010458460077643394, 0.03820512816309929, 0.0011582712177187204, -0.010847249999642372, 0.02661917731165886, -0.008844980038702488, 0.017689960077404976, -0.039656613022089005, -0.029496226459741592, -0.016705024987459183, 0.012227456085383892, -0.008320112712681293, 0.001173660741187632, 0.04092666134238243, -0.01408716943114996, 0.013542862609028816, -0.0007038724725134671, 0.008035000413656235, -0.015603451989591122, -0.008682983927428722, 0.018273144960403442, -0.0432075634598732, -0.004305853042751551, -0.017651081085205078, 0.009486484341323376, -0.024428991600871086, 0.027422677725553513, 0.038775354623794556, 0.009959512390196323, -0.031155064702033997, -0.01695125736296177, -0.014540757983922958, 0.011339717544615269, -0.04782120883464813, 0.042741015553474426, 0.003502352861687541, 0.030533000826835632, 0.051372162997722626, 0.01626439578831196, 0.03265838697552681, -0.0061914860270917416, 0.032580628991127014, 0.002531996928155422, 0.003725907299667597, 0.018091710284352303, -0.018428660929203033, 0.013970532454550266, -0.010827810503542423, 0.003991580568253994, 0.01625143550336361, 0.036546289920806885, 0.014644435606896877, 0.011099963448941708, 0.05655603110790253, 0.03229551762342453, -0.008093318901956081, 0.004827479831874371, -0.008864419534802437, 0.031025467440485954, 0.02783738635480404, -0.011385076679289341, 0.018441621214151382, 0.014631476253271103, -0.006175286136567593, 0.0014482439728453755, -0.007892443798482418, 0.01399645209312439, -0.01901184767484665, -0.020839162170886993, -0.0155386533588171, 0.011741467751562595, 0.0069528669118881226, -0.015253540128469467, -0.020631806924939156, 0.02209625020623207, -0.01140451617538929, 0.0004406290245242417, 0.0005268919048830867, -0.012240415439009666, 0.04613645002245903, -0.02330150082707405, 0.011734987609088421, 0.05411961302161217, -0.0302219670265913, 0.0037485866341739893, -0.013776137493550777, 0.0032010404393076897, 0.0024056402035057545, 0.0036611089017242193, 0.020243017002940178, 0.012208016589283943, 0.023444056510925293, -9.547637455398217e-05, -0.05598580837249756, 0.009654959663748741, -0.056244999170303345, 0.01106108445674181, -0.008670024573802948, 0.02300342731177807, 0.00661267526447773, 0.05453432351350784, -0.026982048526406288, -0.0021075676195323467, -0.028951918706297874, 0.0216037817299366, -0.014748113229870796, -0.0036060302518308163, -0.030299726873636246, 0.024947378784418106, 0.01502026617527008, -0.009538322687149048, -0.010620455257594585, 0.0125320078805089, -0.03094770945608616, -0.008644104935228825, 0.0828382596373558, 0.00479184091091156, -0.03144017606973648, 0.007892443798482418, 0.01450187899172306, 0.06412448734045029, 0.01883041113615036, -0.004147097002714872, -0.017016056925058365, -0.0034569939598441124, -0.027422677725553513, 0.002698852913454175, -0.04279285669326782, -0.00924025010317564, 0.03950109705328941, 0.03646853193640709, -0.007121342699974775, 0.011605391278862953, -0.00036185848875902593, -0.009667919017374516, 0.056037645787000656, -0.03996764495968819, -0.02038557268679142, -0.0008642484899610281, -0.009227290749549866, -0.021901855245232582, 0.04763977602124214, -0.0024623386561870575, -0.011650750413537025, -0.006554356776177883, 0.01746964454650879, -0.006016530096530914, 0.012104338966310024, 0.008670024573802948, -0.029055597260594368, -0.0013251269701868296, -0.00505103450268507, 0.027733709663152695, -0.007879483513534069, 0.03182896971702576, -0.013776137493550777, -0.0449441596865654, -0.021733378991484642, -0.018234265968203545, -0.04626604914665222, 0.023379258811473846, 0.006220645271241665, -0.03250287100672722, 0.007276859134435654, -0.02404020167887211, -0.003052004147320986, -0.002033049473538995, 0.00621416512876749, 0.002475298475474119, -0.024312354624271393, 0.038075532764196396, -0.013147592544555664, -0.022044410929083824, 0.030636677518486977, 0.047924887388944626, 0.0037323872093111277, -0.008099798113107681, 0.004688163287937641, 0.04268917813897133, 0.028925999999046326, 0.003936502151191235, 0.00306334369815886, -0.019296959042549133, 0.017003096640110016, -0.022238805890083313, 0.023042306303977966, -0.003972141072154045, 0.028459452092647552, 0.0018937329296022654, 0.04388146847486496, -0.0029337469022721052, -0.02693020924925804, 0.008650585077702999, 0.00041167225572280586, 0.026696935296058655, 0.058836936950683594, -0.0259323138743639, 0.008209955878555775, 0.005595340859144926, -0.013400306925177574, 0.030869951471686363, -0.00768508855253458, -0.005627740174531937, 0.02352181449532509, 0.039812128990888596, 0.015149863436818123, -0.038256969302892685, -0.05671154707670212, 0.012868959456682205, 0.009765117429196835, -0.005378266330808401, 0.015175782144069672, -0.00018690284923650324, -0.020255975425243378, 0.015979282557964325, -0.014450040645897388, 0.007821165025234222, -0.025699039921164513, -0.026528459042310715, 0.009765117429196835, -0.010134467855095863, -0.01233761291950941, -0.017845476046204567, -0.0008699183235876262, -0.004788600839674473, 0.013905733823776245, 0.009739197790622711, 0.05038722604513168, -0.010328862816095352, -0.02054108865559101, 0.004160056356340647, 0.00035315120476298034, -0.004224854987114668, 0.03890495002269745, -0.027863306924700737, 0.035639114677906036, -0.003440794302150607, -0.03211408108472824, 0.03768674284219742, 0.00014468264998868108, -0.0022274446673691273, 0.03506888821721077, -0.016186637803912163, 0.004678443539887667, 0.041211772710084915, 0.02778554894030094, 0.041056256741285324, 0.022744234651327133, 0.0006257094210013747, 0.029833177104592323, 0.01588856428861618, 0.0142556456848979, -0.02555648423731327, 0.01863601617515087, -0.038982708007097244, 0.02488258108496666, 0.0449700802564621, -0.015305379405617714, 0.004986235871911049, 0.021513065323233604, 0.03468009829521179, 0.030869951471686363, 0.0010294843232259154, -0.02936662919819355, -0.0015422016149386764, 0.01356878224760294, 0.011151802726089954, 0.040667466819286346, 0.020605886355042458, -0.006700153462588787, 0.025115855038166046, 0.0017349767731502652, 0.04458129033446312, 0.007179661188274622, -0.011035165749490261, -0.012408890761435032, -0.014670355245471, 0.014981387183070183, -0.009713278152048588, -0.019983822479844093, -0.01295967772603035, 0.030351564288139343, 0.01932287961244583, 0.007328697480261326, -0.03867167606949806, -0.0267487745732069, -0.036701805889606476, 0.005922572687268257, -0.007652689702808857, 0.015422016382217407, 0.01675686240196228, 0.008598745800554752, -0.007970201782882214, -0.004953836556524038, 0.006810310296714306, 0.009337447583675385, -0.01572008803486824, -0.033073097467422485, 0.013581741601228714, 0.010575097054243088, 0.015175782144069672, -0.005501382984220982, -0.009609600529074669, 0.015201701782643795, 0.01330958865582943, 0.0008448089938610792, -0.030118290334939957, 0.003923542331904173, -0.009272648952901363, -0.03817921131849289, -0.014799951575696468, 0.013542862609028816, 0.006259524263441563, -0.002648634137585759, 0.03040340356528759, -0.028537210077047348, 0.017819557338953018, -0.03893087059259415, -0.004224854987114668, -0.009032894857227802, 0.024610428139567375, 0.02693020924925804, 0.010840769857168198, 0.0029499465599656105, -0.01183866523206234, -0.012026580981910229, -0.006301643326878548, -0.0024558589793741703, -0.043259404599666595, 0.020683644339442253, 0.026541419327259064, 0.02507697604596615, -0.011009246110916138, -0.02297750860452652, -0.019620951265096664, -0.06790871173143387, -0.008436749689280987, -0.004989475943148136, -0.027500435709953308, -0.0003112347621936351, -0.0038036652840673923, -0.019646871834993362, -0.015305379405617714, 0.0005852104513905942, -0.017845476046204567, -0.017689960077404976, -0.0048890383914113045, 0.0021351068280637264, -0.003181600710377097, 0.075891874730587, -0.014139007776975632, -0.004484048578888178, 0.02125387080013752, 0.005119072739034891, 0.011294359341263771, -0.0016458790050819516, -0.006913987919688225, -0.0048890383914113045, -0.02196665294468403, -0.021811136975884438, 0.018934089690446854, 0.011871065013110638, 0.025530565530061722, 0.013335508294403553, 0.0031394818797707558, -0.01951727457344532, 0.022342484444379807, -0.006444199476391077, 0.023703251034021378, 0.015162822790443897, 0.004195695742964745, -0.0033338770736008883, -0.04427025839686394, 0.016186637803912163, 0.01676982268691063, 0.019141443073749542, -0.04074522480368614, 0.021694499999284744, 0.03714243695139885, -0.012169137597084045, 0.0010319143766537309, -0.0011258720187470317, -0.006719592958688736, -0.03955293446779251, 0.017897315323352814, 0.01846753992140293, 0.0007739357533864677, 0.004911717958748341, -0.013179992325603962, -0.007892443798482418, -0.00854690745472908, -0.0008334692684002221, -0.01638103276491165, -0.0017333568539470434, -6.920265150256455e-05, 0.010873169638216496, -0.027889225631952286, 0.004030459560453892, 0.006790870800614357, -0.0060392096638679504, -0.004406290128827095, 0.0023991602938622236, -0.02107243612408638, 0.018273144960403442, -0.04556622728705406, 0.004921437706798315, 0.03537992015480995, -0.00018163798085879534, 0.033410049974918365, 0.00384254427626729, 0.005336147267371416, -0.0020557288080453873, 0.03149201720952988, 0.0009039374999701977, -0.006249804515391588, 0.017029015347361565, -0.035509515553712845, -0.015460895374417305, 0.04419250041246414, 0.004305853042751551, -0.011534112505614758, 0.0063826413825154305, -0.014903629198670387, -0.012292253784835339, 0.025660160928964615, 0.02523249201476574, -0.04092666134238243, 0.013620620593428612, 0.006502517964690924, 0.021655621007084846, -0.04883206635713577, -0.013581741601228714, 0.007108382880687714, -0.03986396640539169, -0.014540757983922958, -0.008086838759481907, 0.008857939392328262, -0.014139007776975632, 0.01919328235089779, 0.0049570766277611256, 0.013283669017255306, 0.009791036136448383, 0.008106278255581856, 0.030118290334939957, -0.01544793602079153, 0.0030844032298773527, -0.026035992428660393, -0.015797846019268036, 0.011858104728162289, 0.0344986617565155, -0.02003566175699234, 0.002081648213788867, 0.007814685814082623, -0.011274919845163822, 0.00027701311046257615, -0.016355112195014954, -0.009661439806222916, -0.015460895374417305, 0.006693673320114613, 0.005666619166731834, -0.025828637182712555, -0.009227290749549866, 0.01674390397965908, -0.010503818280994892, -0.0008739682380110025, -0.038412485271692276, 0.023457016795873642, -0.028951918706297874, -0.02541392669081688, 0.03268430754542351, -0.014320443384349346, -0.004859879147261381, -0.004571526311337948, -0.006913987919688225, 0.025336168706417084, 0.006978786550462246, -0.040667466819286346, 0.029314789921045303, -0.011760907247662544, -0.004678443539887667, -0.004195695742964745, 0.002817109925672412, -0.03387659788131714, -0.024973299354314804, -0.03229551762342453, -0.0023311220575124025, -0.051942385733127594, -0.011728508397936821, 0.0040855384431779385, -0.025789758190512657, 0.0022501240018755198, -0.0030358044896274805, -0.02179817669093609, 0.015460895374417305, 0.02385876700282097, -0.003311197506263852, -0.00678439112380147, -0.02952214516699314, 0.010588056407868862, 0.007801725994795561, 0.006771431304514408, 0.004075818695127964, -0.03439498320221901, -0.01476107258349657, -0.027681870386004448, 0.03385067731142044, -0.0012708583381026983, -0.02108539454638958, -0.009797516278922558, 0.028278015553951263, 0.006593235768377781, 0.006855669431388378, 0.036883242428302765, 0.026541419327259064, 0.026204468682408333, 0.0054333447478711605, 0.01969870924949646, 0.017054935917258263, 0.004892278462648392, 0.01673094369471073, -0.0065381573513150215, 0.0276559516787529, -0.00773692736402154, 0.018687855452299118, -0.007225020322948694, 0.0267487745732069, -0.0026389143895357847, 0.009006976149976254, -0.010127987712621689, -0.007432375103235245, -0.009343927726149559, 0.01174794789403677, 0.006188245955854654, -0.021202031522989273, -0.00019814132247120142, -0.0066256350837647915, -0.02331445924937725, -0.018713774159550667, 0.004228094592690468, -0.010996286757290363, -0.012415370903909206, -0.016860540956258774, -0.022005531936883926, -0.011346197687089443, 0.0250510573387146, -0.03988988697528839, -0.02035965397953987, -0.005925812758505344, 0.02472706511616707, 0.018610097467899323, -0.004399810452014208, -0.0026696936693042517, -0.007672129198908806, -0.01330958865582943, 0.010912048630416393, 0.004762681666761637, 0.018195386976003647, 0.010069669224321842, 0.00932448823004961, 0.005203310400247574, 0.009596641175448895, -0.0018256945768371224, -0.05391225963830948, 0.039138227701187134, 0.013017996214330196, 0.024273475632071495, 0.0069269477389752865, 0.011715548112988472, -0.05925164371728897, -0.0259193554520607, 0.007898923009634018, 0.021564902737736702, -0.015357217751443386, -0.0032010404393076897, -0.02231656387448311, 0.02972950041294098, 0.010678774677217007, 0.0008140297140926123, 0.03683140501379967, 0.019776467233896255, -0.0029110675677657127, -0.007199100684374571, -0.018052831292152405, -0.0028268296737223864, -0.017651081085205078, -0.013646540232002735, 0.01443708036094904, -0.004743242170661688, -0.016108879819512367, -0.04364819452166557, 0.02625630609691143, -0.0259193554520607, -0.00021363218547776341, -0.01408716943114996, 0.017340049147605896, 0.011158281937241554, 0.0027442118152976036, 0.03180304914712906, -0.0032091401517391205, -0.015551612712442875, 0.022174008190631866, 0.0051482319831848145, 0.008715382777154446, 0.014618515968322754, -0.020255975425243378, -0.016173677518963814, -0.014061249792575836, -0.009194890968501568, 0.03094770945608616, -0.018623055890202522, -0.002211245009675622, 0.020087499171495438, -0.004701123107224703, 0.016873499378561974, -0.004234574735164642, -0.014942508190870285, 0.012240415439009666, -0.009376326575875282, 0.016316233202815056, 0.010899088345468044, 0.012292253784835339, 0.0006487938808277249, -0.003479673294350505, 0.004856639076024294, 0.04403698444366455, -0.010432540439069271, -0.0021156673319637775, 0.02695612981915474, -0.015758967027068138, 0.0009768357267603278, -0.03330637142062187, -0.017482604831457138, -0.03475785627961159, -0.012577367015182972, 0.015940403565764427, -0.010419581085443497, 0.041730161756277084, 0.013076314702630043, 0.005637459922581911, 0.011430435813963413, -0.017923234030604362, 0.019776467233896255, -0.0024428991600871086, 0.006836229935288429, 0.032191839069128036, 0.03527624160051346, -0.011637790128588676, -0.022407282143831253, -0.010976847261190414, -0.006327562499791384, -0.011812745593488216, 0.03491337224841118, 0.0020557288080453873, -0.008566346950829029, 0.032943498343229294, 0.00033695160527713597, 0.009512403048574924, -0.04546254873275757, 0.012726402841508389, 0.0064960382878780365, 0.01132027804851532, 0.020942838862538338, -0.007788766175508499, -0.011022205464541912, 0.038256969302892685, 0.009227290749549866, -0.0032399194315075874, 0.0046298447996377945, 0.0073870159685611725, 0.021733378991484642, -0.007918362505733967, 0.04022683948278427, -0.018765613436698914, 0.00349587295204401, -0.004121177364140749, -0.0015632611466571689, -0.018610097467899323, 0.045358870178461075, 0.009667919017374516, 0.007458294276148081, 0.05681522563099861, 0.034602340310811996, 0.010899088345468044, -0.0031718809623271227, 0.0008172696689143777, -0.006304882932454348, 0.0051903510466217995, 0.01898592710494995, -0.009123613126575947, -0.004565046168863773, -0.01492954883724451, -0.019906064495444298, 0.049998436123132706, -0.0030001653358340263, 0.032217759639024734, -0.023884685710072517, -0.017223412171006203, -0.008559866808354855, 0.012052499689161777, -0.016860540956258774, -0.01953023485839367, 0.02383284643292427, -0.022420242428779602, -0.03439498320221901, -0.017197491601109505, -0.024428991600871086, -0.01398349180817604, 0.005932292435318232, -0.005828614812344313, 0.0013947852421551943, 0.017728839069604874, 0.025893434882164, -0.0013008276000618935, -0.012311693280935287, 0.036338936537504196, -0.021824097260832787, 0.006881588604301214, -0.003447274211794138, -0.021214991807937622, -0.013555822893977165, 0.004480808507651091, 0.025621281936764717, -0.053653065115213394, -0.014475959353148937, -0.03351372480392456, -0.03504296764731407, -0.009188411757349968, 0.02174633927643299, -0.02227768488228321, 0.012110818177461624, -0.016679104417562485, 0.03162161260843277, -0.0045002480037510395, -0.003254499053582549, -0.008294194005429745, 0.0023635211400687695, -0.04421842098236084, -0.00093876663595438]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-16T00:35:05.025798", "url_path": "/tools/", "chunk_size": 3749}
updated_dt: 2025-03-16T00:35:05.027328
---
```

_(This example is complete, it can be run "as is")_
## Dynamic Function tools
Tools can optionally be defined with another function: `prepare`, which is called at each step of a run to customize the definition of the tool passed to the model, or omit the tool completely from that step.
A `prepare` method can be registered via the `prepare` kwarg to any of the tool registration mechanisms:
  * [`@agent.tool`](https://ai.pydantic.dev/api/agent/#pydantic_ai.agent.Agent.tool) decorator
  * [`@agent.tool_plain`](https://ai.pydantic.dev/api/agent/#pydantic_ai.agent.Agent.tool_plain) decorator
  * [`Tool`](https://ai.pydantic.dev/api/tools/#pydantic_ai.tools.Tool) dataclass


The `prepare` method, should be of type [`ToolPrepareFunc`](https://ai.pydantic.dev/api/tools/#pydantic_ai.tools.ToolPrepareFunc), a function which takes [`RunContext`](https://ai.pydantic.dev/api/tools/#pydantic_ai.tools.RunContext) and a pre-built [`ToolDefinition`](https://ai.pydantic.dev/api/tools/#pydantic_ai.tools.ToolDefinition), and should either return that `ToolDefinition` with or without modifying it, return a new `ToolDefinition`, or return `None` to indicate this tools should not be registered for that step.
Here's a simple `prepare` method that only includes the tool if the value of the dependency is `42`.
As with the previous example, we use [`TestModel`](https://ai.pydantic.dev/api/models/test/#pydantic_ai.models.test.TestModel) to demonstrate the behavior without calling a real model.
tool_only_if_42.py```
fromtypingimport Union
frompydantic_aiimport Agent, RunContext
frompydantic_ai.toolsimport ToolDefinition
agent = Agent('test')

async defonly_if_42(
  ctx: RunContext[int], tool_def: ToolDefinition
) -> Union[ToolDefinition, None]:
  if ctx.deps == 42:
    return tool_def

@agent.tool(prepare=only_if_42)
defhitchhiker(ctx: RunContext[int], answer: str) -> str:
  return f'{ctx.deps}{answer}'

result = agent.run_sync('testing...', deps=41)
print(result.data)
#> success (no tool calls)
result = agent.run_sync('testing...', deps=42)
print(result.data)
#> {"hitchhiker":"42 a"}

```

_(This example is complete, it can be run "as is")_
Here's a more complex example where we change the description of the `name` parameter to based on the value of `deps`
For the sake of variation, we create this tool using the [`Tool`](https://ai.pydantic.dev/api/tools/#pydantic_ai.tools.Tool) dataclass.
customize_name.py```
from__future__import annotations
fromtypingimport Literal
frompydantic_aiimport Agent, RunContext
frompydantic_ai.models.testimport TestModel
frompydantic_ai.toolsimport Tool, ToolDefinition

defgreet(name: str) -> str:
  return f'hello {name}'

async defprepare_greet(
  ctx: RunContext[Literal['human', 'machine']], tool_def: ToolDefinition
) -> ToolDefinition | None:
  d = f'Name of the {ctx.deps} to greet.'
  tool_def.parameters_json_schema['properties']['name']['description'] = d
  return tool_def

greet_tool = Tool(greet, prepare=prepare_greet)
test_model = TestModel()
agent = Agent(test_model, tools=[greet_tool], deps_type=Literal['human', 'machine'])
result = agent.run_sync('testing...', deps='human')
print(result.data)
#> {"greet":"hello a"}
print(test_model.last_model_request_parameters.function_tools)
"""
[
  ToolDefinition(
    name='greet',
    description='',
    parameters_json_schema={
      'properties': {
        'name': {
          'title': 'Name',
          'type': 'string',
          'description': 'Name of the human to greet.',
        }
      },
      'required': ['name'],
      'type': 'object',
      'additionalProperties': False,
    },
    outer_typed_dict_key=None,
  )
]
"""

```

_(This example is complete, it can be run "as is")_
Â© Pydantic Services Inc. 2024 to present