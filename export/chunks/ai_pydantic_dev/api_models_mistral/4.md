---
url: https://ai.pydantic.dev/api/models/mistral/
session_id: pydantic_ai_docs
chunk_number: 4
title: Mistral API Tool Choice and Response Handling
summary: This section describes how to handle tool parameters and responses in the Mistral API. It outlines two modes of operation: Json Mode and Stream Mode, detailing how to generate user output format messages and ensure valid responses from the model.
embedding: [-1.0940357242361642e-05, 0.049478646367788315, -0.026438452303409576, -0.06619808077812195, 0.008110511116683483, -0.033144351094961166, -0.032736558467149734, -0.01815802790224552, -0.032306112349033356, 0.02155628800392151, -0.0007377053261734545, -0.050022367388010025, 0.020321587100625038, 0.012097801081836224, -0.00262232287786901, -0.01583588495850563, 0.002779492409899831, 0.034843478351831436, -0.02399170584976673, 0.051472291350364685, 0.04356567561626434, 0.02526038885116577, -0.014204720966517925, 0.030969463288784027, 0.0074988240376114845, 0.01333250105381012, -0.03126398101449013, 0.06538249552249908, -0.020536810159683228, 0.015314819291234016, -0.0011086818994954228, -0.017081912606954575, -0.011055667884647846, -0.03912528604269028, 0.03459427133202553, -0.014850390143692493, 0.04250088706612587, 0.027344655245542526, -0.02025362104177475, 0.038173772394657135, -0.03765270486474037, -0.01634562388062477, -0.017263153567910194, 0.051834773272275925, 0.0014810743741691113, -0.006530320271849632, -0.0024424984585493803, 0.0477568618953228, 0.020638758316636086, 0.011735320091247559, -0.014952338300645351, 0.019030248746275902, -0.006003590300679207, 0.007668736856430769, 0.025736145675182343, -0.05523303151130676, -0.046578798443078995, -0.022711696103215218, -0.010217431001365185, 0.02282497100532055, -0.04352036491036415, -0.03550047427415848, 0.008257768116891384, 0.001632580067962408, -0.00226975348778069, -0.002707279287278652, -0.0326232835650444, -0.0050690690986812115, -0.013785602524876595, 0.001393286045640707, -0.025011183694005013, -0.014034808613359928, -0.025781456381082535, -0.018871663138270378, -0.005329602397978306, -0.02152230404317379, 0.006213149521499872, 0.017093241214752197, 0.011197262443602085, -0.022224612534046173, -0.05101919174194336, -0.0001399126776959747, -0.0050690690986812115, 0.01297002099454403, -0.037698015570640564, -0.0622560977935791, -0.03441303223371506, -0.01764829084277153, -0.009430168196558952, -0.036180127412080765, -0.03171708062291145, -0.030810877680778503, -0.0034464006312191486, 0.06316230446100235, 0.08110510557889938, -0.030561672523617744, 0.0008877950604073703, -0.025781456381082535, 0.0021635580342262983, 0.0050690690986812115, 0.03751677647233009, 0.016334297135472298, -0.010738497599959373, 0.02768447995185852, 0.06202954798936844, 0.02381046488881111, 0.037199605256319046, -0.0018109886441379786, -0.030856188386678696, 0.008693878538906574, -0.06660587340593338, -0.006796517409384251, 0.017376428470015526, 0.010296723805367947, -0.022077353671193123, -0.024399496614933014, -0.021692218258976936, 0.008756179362535477, 0.002000724896788597, -0.006371735129505396, -0.015054285526275635, -0.034662239253520966, 0.029700780287384987, 0.0081558208912611, -0.003794722259044647, 0.029587505385279655, -0.03640667721629143, -0.029157059267163277, -0.050747327506542206, 0.04030334949493408, -0.014397289603948593, 0.02956485003232956, -0.02526038885116577, -0.050566088408231735, -0.02018565684556961, -0.002313647884875536, -0.011576734483242035, -0.00389950186945498, -0.02902112901210785, 0.01490702759474516, 0.00372675689868629, -0.015790576115250587, -0.07526010274887085, -0.01870175078511238, -0.06184830889105797, -0.007849977351725101, -0.009503796696662903, -0.014725787565112114, -0.060353074222803116, 0.0031207341235131025, 0.010585575364530087, 0.0007525727269239724, 0.014884373173117638, 0.00960008054971695, 0.025600215420126915, -0.01873573288321495, 0.031105393543839455, 0.013615689240396023, 0.010965048335492611, -0.04191185534000397, 0.0012488600332289934, 0.009617071598768234, -0.028794579207897186, 0.008172811940312386, -0.01384223997592926, -0.031649116426706314, -0.00865989550948143, 0.0003996493760496378, -0.028703957796096802, -0.024218257516622543, -0.004075078293681145, 0.012709487229585648, -0.02967812493443489, 0.01848652772605419, 0.01906423084437847, -0.014578529633581638, -0.07843180745840073, -0.06619808077812195, 0.00622447719797492, -0.02478463388979435, -0.05858597904443741, 0.013887550681829453, -0.050203606486320496, -0.03704101964831352, -0.024512773379683495, -0.005117211025208235, 0.015473403967916965, -0.00956609845161438, 0.021046549081802368, 0.016651468351483345, 0.0026421460788697004, -0.0016863858327269554, 0.022519126534461975, 0.006790853571146727, -0.054915860295295715, -0.012324351817369461, 0.04861775413155556, -0.010126810520887375, -0.0045564984902739525, 0.03101477399468422, 0.017602980136871338, 0.04329381510615349, 0.04632959142327309, -0.050928570330142975, 0.02648376300930977, 0.020502828061580658, -0.023719845339655876, 0.026211902499198914, -0.0374714657664299, -0.03427710384130478, -0.02362922579050064, -0.02264373004436493, -0.006983421742916107, 0.00293949362821877, 0.003222682047635317, 0.020321587100625038, -0.03554578498005867, -0.01380825787782669, -0.0019327596528455615, 0.04003148525953293, -0.045060910284519196, 0.04293133318424225, 0.02757120504975319, 0.014771097339689732, -0.03287249058485031, 0.05120043084025383, -0.000319294718792662, -0.07458045333623886, 0.008999722078442574, 0.006485010497272015, 0.004380921833217144, 0.025418974459171295, -0.0032934790942817926, -0.024512773379683495, 0.04934271425008774, -0.062165480107069016, 0.03620278090238571, -0.0028941836208105087, 0.026619693264365196, -0.04055255278944969, -0.007917942479252815, -0.02097858302295208, 0.017954133450984955, 0.006139520555734634, 0.006609613075852394, 0.013944188132882118, 0.009775657206773758, -0.03235142305493355, 0.03751677647233009, -0.003902333788573742, 0.07847712188959122, -0.05464399978518486, 0.015450749546289444, 0.005530666094273329, -0.011435139924287796, 0.01152009703218937, -0.021839475259184837, -0.026211902499198914, -0.07766153663396835, -0.029949985444545746, 0.029179714620113373, 0.0036446324083954096, -0.05845005065202713, 0.043543022125959396, -0.018849007785320282, 0.0344356894493103, -0.010166456922888756, -0.016209693625569344, 0.0017656785203143954, -0.04043927788734436, 0.015246854163706303, 0.03749411925673485, 0.030992118641734123, 0.023719845339655876, 0.0033897629473358393, -0.018452543765306473, 0.02804696187376976, 0.026211902499198914, 0.007034395355731249, -0.022892935201525688, -0.004471541848033667, 0.01938140206038952, 0.020083708688616753, 0.010534602217376232, -0.015677299350500107, 0.03180770203471184, 0.04632959142327309, -0.017852185294032097, -0.011066995561122894, -0.03065229393541813, -0.00397596275433898, 0.028182892128825188, 0.007578116841614246, -0.004822695627808571, -0.02938360907137394, -0.003024450270459056, 0.013185244053602219, 0.019449366256594658, 0.005468364339321852, -0.0018520510056987405, 0.006552975624799728, 0.029723435640335083, 0.035749681293964386, 0.015665972605347633, -0.004870837554335594, 0.01819201186299324, 0.03434506803750992, -0.038536254316568375, 0.040348656475543976, -0.0028559532947838306, 0.021941423416137695, -0.007272273302078247, -0.04055255278944969, -0.014918355271220207, -0.026143936440348625, -0.017229171469807625, -0.02981405518949032, 0.018894318491220474, 0.03615747392177582, -0.007062714081257582, -0.01750103197991848, -0.008167148567736149, -0.005822349805384874, 0.023244088515639305, -0.001052752253599465, 0.025373663753271103, -0.018577147275209427, -0.01297002099454403, 0.0023632056545466185, 0.047847483307123184, 0.004848182201385498, -0.038649529218673706, -0.020740704610943794, 0.0023193114902824163, 0.04734906926751137, 0.007782012224197388, -0.01175797451287508, 0.019483350217342377, 0.03554578498005867, 0.02804696187376976, -0.034798167645931244, -0.0007964668911881745, -0.0465334877371788, -0.007782012224197388, 0.017455721274018288, -0.022326558828353882, 0.00478304922580719, 0.021046549081802368, -0.007997235283255577, 0.02949688583612442, 0.05518772080540657, 0.025283044204115868, -0.011701337061822414, -0.01674208790063858, -0.06674180179834366, -0.020627429708838463, -0.007566789165139198, 0.04218371585011482, -0.008999722078442574, 0.000505136966239661, -0.02949688583612442, -0.008642904460430145, -0.025124458596110344, -0.018056081607937813, -0.011259563267230988, 0.06760269403457642, -0.03294045478105545, 0.026370488107204437, -0.06615276634693146, -0.05604861304163933, 0.004972785245627165, -0.0032793194986879826, -0.017602980136871338, -0.005697747226804495, 0.0006715100607834756, -0.07154466956853867, -0.006281114649027586, 0.02503383904695511, 0.0519707016646862, -0.011667354963719845, 0.05423620715737343, -0.009101669304072857, -0.020740704610943794, -0.03792456537485123, 0.01311727799475193, -0.0021324073895812035, 0.01924547180533409, 5.6947381381178275e-05, -0.015326146967709064, -0.003922156989574432, -0.001713288715109229, -0.04218371585011482, -0.012584884651005268, 0.0164815541356802, 0.023244088515639305, 0.031286634504795074, -9.920437150867656e-05, 0.023561259731650352, 0.05731729418039322, -0.04019007086753845, 0.026098625734448433, 0.02587207593023777, -0.01750103197991848, 0.011984525248408318, -0.012822763063013554, 0.028001651167869568, -0.026098625734448433, -0.0040495917201042175, 0.042229026556015015, 0.006502001546323299, 0.05613923445343971, -0.0413907915353775, 0.019800519570708275, 0.00587898725643754, -0.018090063706040382, -0.08264564722776413, 0.027480585500597954, 0.05405496805906296, 0.05731729418039322, -0.020310258492827415, -0.022598419338464737, -0.03905731812119484, 0.01927945390343666, 0.0028828561771661043, -0.017942804843187332, 0.059990592300891876, 0.017727581784129143, -0.06542780995368958, 0.02920236997306347, -0.024739323183894157, -0.007606435567140579, -0.03674650192260742, 0.052740976214408875, -0.011599389836192131, -0.03697305545210838, 0.0007518647471442819, 0.0016198366647586226, -0.00916963443160057, 0.015711283311247826, 0.005573144182562828, 0.06696835160255432, 0.020412206649780273, 0.013094623573124409, 0.04698659107089043, -0.05228787288069725, 0.01583588495850563, -0.05396434664726257, -0.040711138397455215, 0.0034492325503379107, -0.03076556883752346, 0.0011108057806268334, 0.009316892363131046, -0.020559465512633324, -0.020786015316843987, 0.013796930201351643, -0.04041662439703941, 0.09261387586593628, 0.03244204446673393, 0.013309846632182598, 0.0026817924808710814, 0.03930652514100075, -0.01568862795829773, -0.015054285526275635, 0.017818203195929527, -0.033461518585681915, -0.019664589315652847, -0.001990813296288252, -0.026075972244143486, -0.016005799174308777, -0.011457795277237892, 0.019573969766497612, 0.0335521399974823, -0.01731979101896286, 0.010262740775942802, -0.005304115358740091, -0.039555732160806656, 0.028907854110002518, 0.0015462076989933848, 0.0501582995057106, 0.03348417580127716, 0.01852050982415676, -0.029768746346235275, -0.037698015570640564, 0.027729790657758713, -0.02630252204835415, 0.11028482019901276, -0.022337887436151505, -0.016866689547896385, 0.00818980298936367, 0.027820410206913948, 0.009107333607971668, -0.019834503531455994, -0.01956264302134514, -0.010166456922888756, 0.022167973220348358, 0.029292989522218704, -0.003140557324513793, 0.016685450449585915, 0.014499236829578876, -0.0036729511339217424, -0.04019007086753845, -0.0015348801389336586, 0.005122874863445759, 0.04879899322986603, 0.021069204434752464, 0.05423620715737343, 0.018135374411940575, 0.0018492190865799785, -0.01287940051406622, 0.06293574720621109, -0.029836710542440414, -0.025351010262966156, -0.0232667438685894, 0.028545372188091278, 0.03434506803750992, 0.01641358993947506, -0.059990592300891876, -0.005785535555332899, -0.007368557620793581, -0.008807153441011906, -0.02376515604555607, -0.009028040803968906, -0.012777452357113361, 0.0006396513781510293, 0.020298931747674942, -0.0006237220368348062, -0.0038400322664529085, 0.005128538701683283, -0.024648703634738922, 0.016470227390527725, 0.03337090089917183, 0.010308051481842995, 0.008320069871842861, -0.00654164794832468, -0.02282497100532055, -0.026506418362259865, -0.007883960381150246, -0.0028375459369271994, 0.0034917108714580536, 0.03883076831698418, -0.009617071598768234, -0.008693878538906574, -0.03151318430900574, -0.0019667421001940966, -0.005505179055035114, 0.03318965807557106, 0.016538191586732864, -0.006683242041617632, 0.0320342518389225, 0.006383062340319157, 0.03368807211518288, -0.01906423084437847, 0.030516361817717552, -0.027276689186692238, 0.013978170230984688, 0.018124045804142952, -0.03402789682149887, 0.012720814906060696, 0.019222816452383995, -0.0027993156109005213, 0.05817818641662598, 0.003469055751338601, 0.012222403660416603, 0.02344798482954502, -0.010602567344903946, 0.051653530448675156, 0.002072937786579132, 0.023651881143450737, -0.002224443480372429, -0.020027071237564087, 0.011893905699253082, 0.0032849833369255066, -0.007300592493265867, -0.021624252200126648, -0.007345902267843485, -0.028635993599891663, 0.021001238375902176, -0.007153334561735392, -0.05033953860402107, -0.0028885197825729847, 0.007866968400776386, -0.005595799069851637, 0.012494264170527458, -0.012913382612168789, -0.01898493804037571, 0.0029621487483382225, -0.005488187540322542, -0.021386373788118362, -0.024399496614933014, -0.05423620715737343, 0.03608950600028038, -0.02478463388979435, -0.029519539326429367, 0.006247132085263729, -0.026868898421525955, -0.020752033218741417, 0.026619693264365196, -0.010211767628788948, -0.020989911630749702, -0.020989911630749702, 0.044403914362192154, -0.00675687100738287, 0.018860336393117905, 0.02786572091281414, -0.00431295670568943, 0.005315443035215139, 0.02938360907137394, 0.001908688573166728, -0.051109809428453445, 0.016107745468616486, 0.008121837861835957, 0.004525347612798214, -0.04236495867371559, -0.006847491022199392, 0.0281149260699749, -0.001554703339934349, -0.021794166415929794, -0.009951233863830566, 0.0299273319542408, -0.009152643382549286, -0.045060910284519196, 0.022768333554267883, 0.03631605580449104, -0.009492469020187855, 0.011293546296656132, -0.009413176216185093, 0.044222671538591385, -0.0050803967751562595, -0.01079513505101204, 0.0377659797668457, -0.0036021540872752666, 0.015847213566303253, 0.029655471444129944, 0.020536810159683228, -0.037267569452524185, 0.04619366303086281, 0.05736260488629341, -0.008778834715485573, -0.023425329476594925, -0.0562298521399498, 0.03241938725113869, 0.028635993599891663, -0.0016297482652589679, -0.018645113334059715, 0.013151261024177074, 0.007844313979148865, -0.018214667215943336, 0.0489802360534668, 0.017365101724863052, 0.012924710288643837, 0.016945982351899147, -0.014601184986531734, -0.0016099250642582774, -0.00707404175773263, 0.01202983595430851, -0.018067408353090286, 0.021828148514032364, 0.01916617900133133, -0.00694943917915225, 0.022530455142259598, -0.03674650192260742, 0.008484318852424622, -0.015326146967709064, 0.012822763063013554, -0.01275479793548584, 0.036180127412080765, 0.007827321998775005, 0.006671914365142584, 0.014080118387937546, 0.019687244668602943, -0.006332088727504015, 0.008948747999966145, -0.0038032177835702896, -0.03645198792219162, 0.013241881504654884, 0.008031218312680721, 0.006190494634211063, -0.03935183584690094, -0.004635791294276714, 0.02435418777167797, -0.022700367495417595, -0.0017699263989925385, -0.07942863553762436, 0.0018718740902841091, 0.06157644838094711, 0.020876634865999222, 0.03441303223371506, 0.019302109256386757, 0.0014145252062007785, 0.020117690786719322, -0.006077219266444445, -0.05024891719222069, 0.02065008506178856, -0.011259563267230988, 0.028568027541041374, 0.005768544040620327, -0.04098299890756607, 0.05718136578798294, 0.0031660443637520075, -0.0253963191062212, 0.01362701691687107, 0.0002559313434176147, -0.0223605427891016, -0.018418561667203903, 0.001990813296288252, -0.019653262570500374, 0.008778834715485573, -0.007663073483854532, 0.046148352324962616, -0.0025232071056962013, -0.026030661538243294, -0.010132474824786186, -0.01793147809803486, 0.014986320398747921, -0.04938802495598793, 0.007045723032206297, 0.015847213566303253, 0.06162175536155701, 0.014080118387937546, 0.012426299042999744, 0.0018916972912847996, 0.03214752674102783, -0.0185884740203619, 0.02587207593023777, 0.026642348617315292, -0.05355655774474144, -0.022235939279198647, 0.03994086757302284, 0.025169769302010536, 0.013989497907459736, 0.0075384704396128654, 0.012528247199952602, -0.005683587398380041, -0.03221549093723297, 0.0016977133927866817, -0.004287469666451216, -0.00613385671749711, -0.000625491957180202, 0.012856745161116123, -0.020389551296830177, 0.0341411717236042, 0.021023893728852272, -0.018905645236372948, -0.008761843666434288, -0.022700367495417595, 0.00120071810670197, -0.02424091100692749, 0.02181681990623474, -0.030312467366456985, 0.01351374201476574, -0.011803285218775272, 0.005414558574557304, 0.0028998474590480328, 0.0068361638113856316, -0.019404057413339615, -0.02333470992743969, 0.0007146962452679873, -0.03298576548695564, -0.0526050440967083, -0.009339547716081142, 0.014589857310056686, 0.028568027541041374, -0.012618866749107838, 0.025826765224337578, -0.03332559019327164, -0.0023971882183104753, 0.01938140206038952, 0.039442457258701324, 0.02967812493443489, -0.06148582696914673, -0.02399170584976673, -0.0244901180267334, -0.01583588495850563, 0.014839062467217445, 0.040960345417261124, -0.016572175547480583, 0.009333883412182331, -0.025351010262966156, 0.0020035565830767155, -0.046148352324962616, -0.004593312740325928, -0.018361924216151237, -0.046238973736763, -0.0028970155399292707, 0.009441494941711426, 0.027186069637537003, -0.055822063237428665, -0.013581707142293453, 0.0027285185642540455, 0.014091446064412594, -0.010138138197362423, -0.011599389836192131, 0.0046103042550385, 0.002792235929518938, 0.01181461289525032, -0.05731729418039322, 0.011452131904661655, -0.08568143099546432, -0.020344242453575134, 0.002472233260050416, -0.021499650552868843, 0.0027129431255161762, 0.0005603586905635893, -0.028681302443146706, 0.018633784726262093, -0.009849286638200283, -0.021794166415929794, -0.010087164118885994, -0.010506282560527325, 0.034254446625709534, 0.046578798443078995, 0.027231378480792046, -0.026098625734448433, -0.005884651094675064, -0.00587898725643754, -0.007306256331503391, -0.010172121226787567, 0.016005799174308777, 0.02369718998670578, -0.008229449391365051, 0.0005426594289019704, -0.05881252884864807, -0.03287249058485031, 0.01155974343419075, 0.030788224190473557, 0.029338300228118896, 0.0006527488585561514, -0.051834773272275925, 0.03482082486152649, -0.011333192698657513, 0.007311919704079628, -0.04526480659842491, 0.02641579695045948, 0.017806874588131905, -0.002956485142931342, -0.023380018770694733, -0.023561259731650352, 0.041979823261499405, -0.029949985444545746, 0.015711283311247826, 0.02134106494486332, 0.0526050440967083, 0.005233318544924259, -0.025305699557065964, -0.01738775707781315, 0.008693878538906574, 0.020989911630749702, -0.023833120241761208, 0.016458898782730103, -0.0106535404920578, -0.00994557049125433, 0.05731729418039322, 0.023198779672384262, -0.0353645458817482, -0.00806520041078329, -0.020876634865999222, 0.03765270486474037, 0.0017614307580515742, -0.0014237287687137723, 0.01649288274347782, -0.024648703634738922, 0.009101669304072857, -0.024694012477993965, -0.0402127280831337, -0.02399170584976673, -0.037335533648729324, -0.002186213154345751, -0.003655959852039814, 0.010846109129488468, 0.00853529293090105, 0.0213070809841156, 0.01311727799475193, 0.00013619584206026047, 0.012596212327480316, 0.04213840886950493, 0.005210663191974163, 0.026914209127426147, 0.014578529633581638, 0.008286087773740292, -0.012007180601358414, 0.00914698000997305, -0.04256885498762131, 0.011157616041600704, 0.0035256934352219105, 0.018509183079004288, 0.01728580892086029, -0.01753501407802105, 0.012097801081836224, 0.020627429708838463, 0.031037429347634315, -0.020208312198519707, -0.029519539326429367, 0.0024892245419323444, -0.01001919899135828, -0.0006644303794018924, 0.0008785914396867156, 0.0024467462208122015, 0.013536397367715836, 0.044041432440280914, -0.007147670723497868, 0.012494264170527458, 0.012369661591947079, 0.008036881685256958, 0.013094623573124409, 0.006768198683857918, 0.0030924153979867697, 0.04304460808634758, -0.015813229605555534, 0.009067687205970287, 0.009532115422189236, 0.04304460808634758, -0.019109541550278664, 0.00028000236488878727, 0.08663293719291687, -0.02333470992743969, -0.006881473585963249, 0.035885609686374664, 0.012188420630991459, 0.03930652514100075, -0.0024396665394306183, -0.007776348385959864, 0.010664868168532848, 0.019993089139461517, -0.01743306778371334, -0.0005939872935414314, 0.007725374773144722, 0.002942325547337532, -0.012743470259010792, 0.0562298521399498, -0.013921532779932022, 0.027843065559864044, -0.04229699447751045, 0.010376016609370708, 0.000437525799497962, -0.02738996408879757, -0.05011298879981041, -0.025464285165071487, -0.013615689240396023, 0.010755488649010658, 0.05142698064446449, 0.00799157191067934, -0.025351010262966156, -0.03903466463088989, 0.008201130665838718, 0.03522861376404762, 0.03699570894241333, 0.006247132085263729, -9.938136645359918e-05, -0.005601462908089161, 0.013060640543699265, 0.05931094288825989, -0.03697305545210838, 0.01338913943618536, -0.010081500746309757, -0.017489705234766006, 0.0009125740616582334, -0.010761152021586895, -0.025554904714226723, 0.023017538711428642, -0.028930509462952614, -0.0078103309497237206, 0.001591517822816968, -0.020061053335666656, 0.0012828425969928503, 0.016583502292633057, -0.007657409645617008, 0.06814641505479813, -0.028794579207897186, 0.016096418723464012, 0.0002460197720210999, -0.02616659179329872, 0.02123911678791046, 0.01659482903778553, 0.03511533886194229, 0.002916838740929961, -0.01797678880393505, 0.03751677647233009, 0.006524656433612108, 0.07163529098033905, -0.019834503531455994, -0.01674208790063858, -0.018667766824364662, -0.026461107656359673, 0.0005614206311292946, 0.02816023677587509, 0.0012736390344798565, -0.006620940752327442, 0.02369718998670578, 0.021726200357079506, -0.018180683255195618, 0.03076556883752346, 0.011871250346302986, 0.017999444156885147, 0.03796987608075142, 0.004887828603386879, -0.016187038272619247, 0.008178476244211197, -0.0027171908877789974, 0.023244088515639305, 0.01137850247323513, -0.018124045804142952, -0.007311919704079628, 0.000166992555023171, -0.024558082222938538, -0.012086473405361176, -0.042953990399837494, 0.010919737629592419, 0.003670119447633624, 0.007521479390561581, 0.010183448903262615, -0.0022074521984905005, 0.0008722197380848229, -0.02514711394906044, -0.035273924469947815, -0.01338913943618536, -0.012097801081836224, -0.02671031281352043, -0.007940597832202911, -0.02195275016129017, -0.014204720966517925, -0.005980935413390398, 0.010172121226787567, 0.0016821380704641342, 9.796542872209102e-05, 0.030788224190473557, 0.03833235800266266, 0.0004134548071306199, 0.005159689579159021, -0.008999722078442574, -0.017161205410957336, -0.022587092593312263, 0.0676933154463768, 0.007793339900672436, 0.0413907915353775, -0.008172811940312386, -0.023244088515639305, 0.02405967190861702, 0.030267156660556793, 0.027480585500597954, -0.00018885114695876837, -0.006366071291267872, 0.031943630427122116, -0.011893905699253082, 0.018849007785320282, 0.018645113334059715, 0.019879812374711037, 0.017840858548879623, 0.005856332369148731, 0.0015985975041985512, 0.019834503531455994, 0.024807287380099297, 0.014805080369114876, -0.02394639514386654, -0.016674121841788292, 0.03348417580127716, 0.01580190286040306, 0.02707279473543167, 0.014986320398747921, 0.020163001492619514, -0.0024056839756667614, 0.0024340027011930943, 0.029292989522218704, -0.015178889036178589, -0.013559051789343357, 0.015371456742286682, 0.014408616349101067, 0.014419944025576115, -0.02816023677587509, 0.0033671080600470304, 0.0013040817575529218, 0.03257797285914421, 0.04739437997341156, -0.030742913484573364, -0.03783394768834114, -0.020196983590722084, -0.003463391913101077, 0.02123911678791046, -0.04007679596543312, 0.000756112567614764, -0.0006637223996222019, 0.01684403605759144, 0.01916617900133133, -0.02489790879189968, 0.01869042217731476, -0.027843065559864044, 0.016617484390735626, -0.04395081102848053, -0.0036871107295155525, 0.016753414645791054, -0.02684624306857586, -0.013434449210762978, -0.018033426254987717, -8.800959039945155e-05, 0.02689155377447605, 0.0001628332247491926, 0.030788224190473557, 0.023096831515431404, 0.02394639514386654, -0.03171708062291145, -0.0032396733295172453, 0.00429313350468874, 0.0064736828207969666, 0.004726411309093237, -0.014329323545098305, 0.001587269944138825, -0.03307638317346573, -0.015076940879225731, -0.022983556613326073, -0.004261982627213001, 0.006892801262438297, 0.03287249058485031, 0.007714047096669674, 0.011678682640194893, -0.012958693318068981, 0.0020970087498426437, -0.03119601495563984, 0.008665559813380241, -0.014974992722272873, 0.014861717820167542, 0.019902467727661133, 0.010370352305471897, 0.004174194298684597, -0.009560434147715569, -0.024195602163672447, -0.004171362612396479, -0.020842652767896652, -0.0024991361424326897, 0.052740976214408875, 0.02906643971800804, -0.001751519157551229, 0.00840502604842186, -0.011265227571129799, -0.030085917562246323, -0.03579499199986458, -0.03094680793583393, -0.006252795923501253, -0.012709487229585648, -0.03978228196501732, 0.013049312867224216, -0.03101477399468422, -0.021975405514240265, 0.015088268555700779, 0.014068790711462498, 0.02967812493443489, 0.018849007785320282, 0.018146701157093048, -0.01949467696249485, 0.057815708220005035, 0.021386373788118362, 0.022292576730251312, 0.0326232835650444, 0.002262673806399107, 0.011072659865021706, 0.00037699431413784623, 0.01380825787782669, -0.0008509805775247514, -0.025283044204115868, -0.014272686094045639, 0.014510564506053925, -0.0004467294202186167, 0.005255973432213068, 0.009837958961725235, 0.004740570671856403, 0.0010017782915383577, 0.006388726178556681, -0.0023702853359282017, 0.033031072467565536, 0.0022527622058987617, -0.007023067679256201, 0.007323247380554676, -0.015564024448394775, -0.011486114002764225, 0.01848652772605419, 0.0041543710976839066, -0.007906614802777767, 0.049116164445877075, 0.04066582769155502, -0.026257211342453957, -0.012131783179938793, 0.00021752394968643785, -0.0231194868683815, -0.019075559452176094, 0.004522515926510096, 0.0068304999731481075, -0.00033097623963840306, -0.007929270155727863, -0.03579499199986458, 0.013785602524876595, -0.015360129065811634, 0.01942671276628971, 0.022009389474987984, -0.00350587023422122, 0.04666941985487938, 0.0058393413200974464, -0.029179714620113373, -0.025826765224337578, 0.016187038272619247, 0.005176680628210306, -0.017580324783921242, -0.010013535618782043, -0.028907854110002518, 0.00844467245042324, -0.010296723805367947, 0.002710111206397414, 0.02142035774886608, 0.028182892128825188, 0.016436245292425156, 0.006394390016794205, 0.008580602705478668, 0.010874427855014801, 0.021941423416137695, 0.04725845158100128, -0.026687657460570335, 0.02888519875705242, -0.006847491022199392, -0.013830912299454212, 0.043610986322164536, 0.0009437247645109892, 0.023130813613533974, 0.0024934723041951656, -0.0170705858618021, 0.0037550758570432663, 0.007317583542317152, 0.0015178888570517302, -0.026936864480376244, 0.01634562388062477, -0.009826631285250187, 0.0102004399523139, -0.008478655479848385, -0.04395081102848053, -0.0009833710500970483, -0.040529899299144745, 0.0009529283852316439, -0.028069617226719856, -0.015439421869814396, 0.007883960381150246, -0.01656084693968296, 0.036293402314186096, -0.004678269382566214, -0.007770685013383627, -0.006977757904678583, -0.01071017887443304, 0.02883988805115223, 0.02308550290763378, -0.005779871717095375, 0.013162588700652122, 0.025192424654960632, 0.008167148567736149, -0.015405438840389252, 0.03642933443188667, 0.03971431776881218, -0.03631605580449104, -0.006337752565741539, -0.044154707342386246, -0.01308329589664936, 0.009186625480651855, 0.02757120504975319, 0.013502414338290691, 0.00833139754831791, -0.022802315652370453, 0.0010506282560527325, -0.001136292703449726, -0.0272087249904871, -0.0009762913687154651, 0.0064566913060843945, -0.014827735722064972, -0.053103454411029816, 0.039193250238895416, 0.011531424708664417, 0.03162645921111107, -0.004681101068854332, -0.03350682929158211, 0.012290368787944317, -0.03318965807557106, -0.03917059302330017, 0.011033013463020325, 0.0007674400694668293, 0.008699541911482811, 0.023425329476594925, 0.022621074691414833, -0.012380989268422127, -0.026687657460570335, -0.014929682947695255, -0.018429890275001526, -0.04211575165390968, -0.004004281479865313, 0.013321174308657646, -0.008835472166538239, 0.012890728190541267, -0.028137581422924995, -0.011871250346302986, -0.0006506249192170799, -0.014034808613359928, -0.00956609845161438, -0.0008906269795261323, 0.01516756135970354, 0.017602980136871338, -0.0004538091307040304, -0.007334575057029724, -0.001789749599993229, -0.045740559697151184, -0.005975271575152874, -0.025554904714226723, -0.02101256512105465, -0.0025586055126041174, -0.037743326276540756, 0.02612128108739853, 0.0353645458817482, 0.005508010741323233, 0.019256798550486565, -0.001272931112907827, 0.002911174902692437, 0.016855362802743912, 0.011701337061822414, 0.034186482429504395, 0.006558638997375965, -0.021103186532855034, -0.03785660117864609, 0.0034832151141017675, 0.024739323183894157, 0.005782703403383493, 0.01670810580253601, 0.010715842247009277, -0.0016198366647586226, 0.007895288057625294, -0.034798167645931244, -0.021544959396123886, -0.0005440753884613514, -0.006705896928906441, 0.018418561667203903, 0.012834089808166027, 0.01921148970723152, 0.009214945137500763, -0.030425742268562317, -0.010863100178539753, -0.02430887706577778, -0.012607540003955364, 0.009588752873241901, 0.0010442566126585007, -0.0038853425066918135, -0.03094680793583393, 0.02137504704296589, 0.01761430688202381, -0.004884996917098761, -0.021794166415929794, 0.02203204296529293, 0.00019663882267195731, 0.055051788687705994, -0.007311919704079628, -0.020752033218741417, 0.011780629865825176, -0.02689155377447605, -0.010642213746905327, -0.01447658147662878, 0.027639171108603477, -0.02290426380932331, 0.0012198332697153091, -0.0054315500892698765, 0.0004201805277261883, -0.0012998338788747787, 0.007889623753726482, 0.012936037965118885, 0.014861717820167542, 0.02228124998509884, -0.02051415480673313, 0.02471666783094406, -0.0495692677795887, -0.025011183694005013, -0.002138070994988084, 0.008574939332902431, 0.006898465100675821, 0.0024481620639562607, 0.01728580892086029, 0.0471678301692009, -0.03753942996263504, -0.013547724112868309, 0.0253963191062212, -0.011276555247604847, -0.004109061323106289, -0.011202925816178322, 0.01956264302134514, 0.036905087530612946, -0.01898493804037571, -0.025532249361276627, 0.003072592196986079, 0.02417294681072235, -0.02122778818011284, -0.03710898384451866, 0.007793339900672436, -0.022836297750473022, 0.018939627334475517, 0.0050690690986812115, 0.02185080386698246, 0.02210000902414322, -0.007946261204779148, 0.040348656475543976, 0.0036644556093961, -0.014317996799945831, 0.00701174046844244, -0.02623455598950386, 0.008818481117486954, 0.025713490322232246, -0.011072659865021706, 0.0007447850075550377, -0.0185884740203619, 0.006626604590564966, 0.0326232835650444, 0.04281805828213692, 0.0007044306839816272, 0.03207956254482269, -0.010551593266427517, 0.03395993262529373, 0.02612128108739853, -0.030992118641734123, -0.024467462673783302, 0.0007900951313786209, 0.03160380572080612, 0.010308051481842995, -0.026732968166470528, 0.00820679496973753, 0.021352391690015793, 0.005649604834616184, 0.03978228196501732, -0.002945157466456294, -0.012290368787944317, 0.0030527689959853888, -0.027299344539642334, -0.030357778072357178, -0.014102773740887642, -0.015643317252397537, -0.00795192550867796, -0.01559800747781992, 0.033891964703798294, -0.015178889036178589, -0.012335678562521935, 0.012233731336891651, 0.016458898782730103, 0.030629638582468033, -0.03640667721629143, 0.03246469795703888, -0.0459444560110569, 0.0023688694927841425, 0.03862687200307846, 0.012460282072424889, -0.015246854163706303, -0.007793339900672436, -0.02381046488881111, -0.023176124319434166, -0.05033953860402107, 0.016934655606746674, -0.019585296511650085, 0.00581668596714735, 0.017942804843187332, -0.004545170813798904, -0.019845830276608467, -0.04569525271654129, 0.0098945964127779, 0.019755210727453232, -0.01649288274347782, 0.020095035433769226, 0.0003332771302666515, 0.005530666094273329, -0.01469180453568697, -0.008019890636205673, 0.0004300920991227031, 0.017331119626760483, -0.0017274481942877173, 0.024399496614933014, -0.008835472166538239, 0.02137504704296589, -0.03504737466573715, -0.0017670944798737764, -0.013253209181129932, -0.04091503471136093, 0.0009621320059522986, 0.037811290472745895, -0.01278878003358841, -0.015960488468408585, 0.021114513278007507, -0.010138138197362423, 0.012550901621580124, -0.010727169923484325, -0.025645526126027107, -0.019868485629558563, 0.008416353724896908, 0.011525760404765606, -0.016141729429364204, -0.012822763063013554, 0.008399362675845623, -0.007651745807379484, 0.031082740053534508, -0.02246248908340931, 0.041504066437482834, -0.014453927055001259, -0.010857436805963516, 0.014193393290042877, -0.01725182682275772, 0.011236908845603466, 0.001866210368461907, -0.008008562959730625, -0.02974609099328518, -0.006026245187968016, 0.00985495001077652, -0.016390934586524963, -0.01840723492205143, -0.03341621160507202, -0.005564648658037186, 0.0004208885075058788, 0.028250856325030327, 0.02109185792505741, 0.027639171108603477, 0.01041566301137209, 0.023833120241761208, -0.001475410652346909, 0.007396876346319914, -0.021658234298229218, -0.015473403967916965, -0.040348656475543976, 0.03289514407515526, 0.02260974794626236, -0.001864794408902526, 0.0010003624483942986, -0.020559465512633324, -0.006077219266444445, -0.030992118641734123, -0.012143110856413841, 0.01938140206038952, 0.053601864725351334, 0.005845004692673683, -0.008812817744910717, -0.01039867103099823, -0.02127309888601303, 0.003964635077863932, 0.008121837861835957, -0.010676195845007896, -0.007866968400776386]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-14T10:07:30.551977", "url_path": "/api/models/mistral/", "chunk_size": 5000}
updated_dt: 2025-03-14T10:07:33.663802
---
t_parameters.result_tools:
      # Json Mode
      parameters_json_schemas = [tool.parameters_json_schema for tool in model_request_parameters.result_tools]
      user_output_format_message = self._generate_user_output_format(parameters_json_schemas)
      mistral_messages.append(user_output_format_message)
      response = await self.client.chat.stream_async(
        model=str(self._model_name),
        messages=mistral_messages,
        response_format={'type': 'json_object'},
        stream=True,
      )
    else:
      # Stream Mode
      response = await self.client.chat.stream_async(
        model=str(self._model_name),
        messages=mistral_messages,
        stream=True,
      )
    assert response, 'A unexpected empty response from Mistral.'
    return response
  def_get_tool_choice(self, model_request_parameters: ModelRequestParameters) -> MistralToolChoiceEnum | None:
"""Get tool choice for the model.
    - "auto": Default mode. Model decides if it uses the tool or not.
    - "any": Select any tool.
    - "none": Prevents tool use.
    - "required": Forces tool use.
    """
    if not model_request_parameters.function_tools and not model_request_parameters.result_tools:
      return None
    elif not model_request_parameters.allow_text_result:
      return 'required'
    else:
      return 'auto'
  def_map_function_and_result_tools_definition(
    self, model_request_parameters: ModelRequestParameters
  ) -> list[MistralTool] | None:
"""Map function and result tools to MistralTool format.
    Returns None if both function_tools and result_tools are empty.
    """
    all_tools: list[ToolDefinition] = (
      model_request_parameters.function_tools + model_request_parameters.result_tools
    )
    tools = [
      MistralTool(
        function=MistralFunction(name=r.name, parameters=r.parameters_json_schema, description=r.description)
      )
      for r in all_tools
    ]
    return tools if tools else None
  def_process_response(self, response: MistralChatCompletionResponse) -> ModelResponse:
"""Process a non-streamed response, and prepare a message to return."""
    assert response.choices, 'Unexpected empty response choice.'
    if response.created:
      timestamp = datetime.fromtimestamp(response.created, tz=timezone.utc)
    else:
      timestamp = _now_utc()
    choice = response.choices[0]
    content = choice.message.content
    tool_calls = choice.message.tool_calls
    parts: list[ModelResponsePart] = []
    if text := _map_content(content):
      parts.append(TextPart(content=text))
    if isinstance(tool_calls, list):
      for tool_call in tool_calls:
        tool = self._map_mistral_to_pydantic_tool_call(tool_call=tool_call)
        parts.append(tool)
    return ModelResponse(parts, model_name=response.model, timestamp=timestamp)
  async def_process_streamed_response(
    self,
    result_tools: list[ToolDefinition],
    response: MistralEventStreamAsync[MistralCompletionEvent],
  ) -> StreamedResponse:
"""Process a streamed response, and prepare a streaming response to return."""
    peekable_response = _utils.PeekableAsyncStream(response)
    first_chunk = await peekable_response.peek()
    if isinstance(first_chunk, _utils.Unset):
      raise UnexpectedModelBehavior('Streamed response ended without content or tool calls')
    if first_chunk.data.created:
      timestamp = datetime.fromtimestamp(first_chunk.data.created, tz=timezone.utc)
    else:
      timestamp = datetime.now(tz=timezone.utc)
    return MistralStreamedResponse(
      _response=peekable_response,
      _model_name=self._model_name,
      _timestamp=timestamp,
      _result_tools={c.name: c for c in result_tools},
    )
  @staticmethod
  def_map_mistral_to_pydantic_tool_call(tool_call: MistralToolCall) -> ToolCallPart:
"""Maps a MistralToolCall to a ToolCall."""
    tool_call_id = tool_call.id or None
    func_call = tool_call.function
    return ToolCallPart(func_call.name, func_call.arguments, tool_call_id)
  @staticmethod
  def_map_pydantic_to_mistral_tool_call(t: ToolCallPart) -> MistralToolCall:
"""Maps a pydantic-ai ToolCall to a MistralToolCall."""
    return MistralToolCall(
      id=t.tool_call_id,
      type='function',
      function=MistralFunctionCall(name=t.tool_name, arguments=t.args),
    )
  def_generate_user_output_format(self, schemas: list[dict[str, Any]]) -> MistralUserMessage:
"""Get a message with an example of the expected output format."""
    examples: list[dict[str, Any]] = []
    for schema in schemas:
      typed_dict_definition: dict[str, Any] = {}
      for key, value in schema.get('properties', {}).items():
        typed_dict_definition[key] = self._get_python_type(value)
      examples.append(typed_dict_definition)
    example_schema = examples[0] if len(examples) == 1 else examples
    return MistralUserMessage(content=self.json_mode_schema_prompt.format(schema=example_schema))
  @classmethod
  def_get_python_type(cls, value: dict[str, Any]) -> str:
"""Return a string representa