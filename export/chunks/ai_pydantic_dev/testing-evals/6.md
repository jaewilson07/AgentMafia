---
url: https://ai.pydantic.dev/testing-evals/
session_id: pydantic_ai_docs
chunk_number: 6
title: SqlSystemPrompt Class Overview
summary: The SqlSystemPrompt class is designed to create a customizable system prompt using a list of examples and a specified database type. It allows for dependency injection to modify inputs and logic during evaluations. By default, it loads examples from a file if none are provided.
embedding: [-0.01915556564927101, 0.023609457537531853, 0.040991123765707016, -0.01610547862946987, 0.016730809584259987, -0.01352758053690195, 0.019193850457668304, 0.014497483149170876, 0.017368903383612633, 0.023443553596735, 0.023660505190491676, -0.06513658165931702, -0.010853969492018223, -0.04507492110133171, 0.0008678070735186338, 0.010994349606335163, 0.0008821641677059233, 0.022652316838502884, -0.024298598989844322, -0.011511205695569515, 0.07269160449504852, -0.005146223586052656, 0.030296675860881805, 0.0019398040603846312, -0.012921391986310482, -0.01170263346284628, -0.007427407428622246, 0.052196044474840164, 0.012723582796752453, -0.041961025446653366, 0.02896944247186184, -0.020827369764447212, 0.01371900923550129, 0.009781972505152225, 0.004220988135784864, -0.005245128180831671, 0.019321469590067863, 0.014612339437007904, 0.002742206444963813, -0.002228541299700737, 0.013757294975221157, -0.009111974388360977, 0.020023372024297714, -0.014242245815694332, -0.027386970818042755, 0.03532485291361809, -0.0074593122117221355, -0.0003679007350001484, 0.03259381279349327, -0.03335952386260033, -0.042088642716407776, 0.04349244758486748, -0.020074419677257538, -0.009864924475550652, 0.017368903383612633, -0.05173661559820175, -0.03910236433148384, 0.018274996429681778, -0.012379013001918793, -0.03022010624408722, 0.023762600496411324, -0.022435365244746208, 0.012608726508915424, 0.04433473199605942, 0.0016351144295185804, 0.006026792339980602, -0.001633519190363586, 0.02731039933860302, -0.011345301754772663, -0.007306169718503952, 0.03892369940876961, 0.022511936724185944, -0.009794734418392181, -0.04007226973772049, 0.004517701454460621, -0.020699750632047653, 0.0579899325966835, 0.0543145127594471, -0.0007046944228932261, -0.03231305256485939, 0.0014293292770162225, -0.010215875692665577, -0.010228637605905533, 0.017445474863052368, -0.015748146921396255, -0.019857468083500862, -0.05737736076116562, -0.026442592963576317, 0.01518662367016077, -0.049847859889268875, -0.04198654741048813, 0.05242575705051422, 0.022716127336025238, 0.012883106246590614, 0.07468245923519135, 0.035426948219537735, 0.01435710210353136, 0.002000422915443778, 0.006821218878030777, 0.03381895273923874, -0.0005204449407756329, -0.032389622181653976, -0.038055893033742905, -0.01845366321504116, 0.049439478665590286, 0.01004359032958746, 0.014752720482647419, 0.012966059148311615, -0.02494945377111435, -0.022830983623862267, -0.05120061710476875, 0.013399962335824966, -0.015173861756920815, -0.025345072150230408, -0.011409110389649868, -0.012902249582111835, -0.028178205713629723, -0.06534076482057571, 0.03468675911426544, -0.03119000792503357, -0.06125697121024132, -0.016986047849059105, -0.03358924016356468, -0.0016462811036035419, 0.02261403203010559, 0.011466539464890957, -0.015135576017200947, -0.025587547570466995, -0.0079761678352952, 0.021146416664123535, 0.019193850457668304, 0.01033073291182518, 0.03698389604687691, 0.0011118778493255377, -0.026314973831176758, 0.008493023924529552, -0.04681053385138512, -0.013680723495781422, -0.011262348853051662, 0.02771877869963646, 0.003077205503359437, -0.009048164822161198, -0.027974016964435577, 0.044436827301979065, -0.02331593446433544, -0.03935760259628296, -0.03593742102384567, 0.039434175938367844, -0.025587547570466995, 0.028765251860022545, 0.03619265928864479, 0.015543956309556961, -0.06227792054414749, 0.0061225066892802715, -0.002873015822842717, -0.000913271214812994, -0.011530348099768162, 0.032798003405332565, -0.014293293468654156, -0.0435434952378273, -0.0033372286707162857, 0.02355840988457203, 0.006463886704295874, 0.002829944482073188, -0.02413269318640232, -0.0270551610738039, -0.015403575263917446, -0.026672305539250374, -0.05916402488946915, -0.030832674354314804, -0.014599577523767948, -0.05446765571832657, 0.025727927684783936, -0.00020159764972049743, 0.04696367681026459, -0.024183740839362144, 0.005104747600853443, -0.03815798833966255, -0.03938312828540802, -0.03649894520640373, -0.03757094219326973, -0.0377240851521492, -0.031011341139674187, 0.004284797236323357, 0.009954257868230343, -0.03854084387421608, 0.015199385583400726, 0.0451514907181263, -0.027897445484995842, 0.008716356009244919, 0.07539711892604828, 0.03290009871125221, 0.026161830872297287, -0.0128256781026721, 0.001193234696984291, -0.05513127148151398, 0.0507667139172554, 0.015352528542280197, -0.012079108506441116, 0.0188620425760746, 0.04078693315386772, 0.03231305256485939, 0.05086880922317505, -0.008027215488255024, 0.022703364491462708, -0.034737806767225266, 0.015863003209233284, -0.02593211829662323, -0.045559871941804886, 0.004354987759143114, 0.02257574535906315, -0.010675303637981415, 0.06967980414628983, 0.007893215864896774, -0.021133655682206154, 0.01228329911828041, -0.047882530838251114, 0.04926081374287605, -0.004096559714525938, -0.003212800482288003, 0.0014851625310257077, 0.035299330949783325, -0.013910437002778053, -0.06426876783370972, -0.0076826452277600765, 0.026799924671649933, 0.018211185932159424, -0.04433473199605942, 0.006955218501389027, 0.0026768019888550043, 0.007574168965220451, -0.0167563334107399, -0.008161215111613274, -0.018070805817842484, 0.037213608622550964, -0.04760177060961723, 0.032798003405332565, -0.01707538031041622, -0.006617029197514057, -0.012270537205040455, -0.00997340027242899, -0.002695944858714938, 0.033614762127399445, -0.005391889717429876, 0.016705285757780075, 0.04979681223630905, -0.009405497461557388, -0.019487373530864716, 0.0426756888628006, 0.030169058591127396, 0.010413684882223606, -0.009233212098479271, 0.006352220196276903, -0.060950685292482376, -0.014535768888890743, -0.011453777551651001, -0.03629475459456444, -0.014969672076404095, -0.03591189906001091, 0.007893215864896774, -0.044972825795412064, 0.041782356798648834, -0.019908515736460686, 0.027795350179076195, 0.006052316166460514, -0.025179166346788406, 0.037647511810064316, -0.048444055020809174, -0.005471651442348957, -0.03218543156981468, 0.013693485409021378, 0.0310368649661541, 0.03022010624408722, -0.04397739842534065, -0.035580091178417206, -0.0011078896932303905, 0.0019398040603846312, 0.06283944100141525, 0.021682415157556534, 0.015161099843680859, -0.07600969076156616, 0.0010959254577755928, 0.009718162938952446, 0.045253586024045944, 0.010139305144548416, 0.004795272368937731, -0.008646165952086449, -0.012672536075115204, -0.009456545114517212, 0.008907784707844257, -0.03481437638401985, 0.019780896604061127, 0.021235749125480652, -0.007184932008385658, -0.0008741880301386118, -0.0025842783506959677, 0.012978820130228996, 0.0343804731965065, -0.0054142228327691555, 0.014727196656167507, 0.028331348672509193, 0.021044321358203888, -0.005024985875934362, -0.01498243398964405, -0.03218543156981468, 0.030245628207921982, 0.027361446991562843, -0.024081645533442497, 0.02452831156551838, 0.015416337177157402, -0.018632328137755394, 0.058296218514442444, -0.0021631368435919285, -0.004795272368937731, -0.0003888381761498749, -0.04474311321973801, 0.053855087608098984, -0.029173631221055984, 0.042471498250961304, -0.03131762519478798, -0.06600438803434372, -0.018070805817842484, 0.04492177814245224, 0.003965750802308321, -0.06671904772520065, -0.030883722007274628, 0.005627984181046486, 0.0030086105689406395, 0.005423794034868479, 0.027642207220196724, -0.007982549257576466, -0.013106439262628555, 0.0015074957627803087, 0.017241284251213074, 0.0015449837082996964, -0.01956394501030445, -0.009609687142074108, 0.04382425919175148, -0.01828775741159916, 0.022920316085219383, -0.07345731556415558, 0.024438979104161263, -0.04479416087269783, -0.03601399436593056, 0.010388161055743694, 0.03119000792503357, 0.018657851964235306, 0.03726465627551079, 0.014191198162734509, 0.014791006222367287, 0.0010137709323316813, 0.0030341343954205513, 0.030960293486714363, 0.03565666079521179, 0.014663387089967728, -0.047754913568496704, -0.06840361654758453, 0.022971363738179207, -0.018070805817842484, -0.0006089804228395224, -0.02715725637972355, -0.03422733396291733, 0.011670729145407677, -0.03106238879263401, -0.030041439458727837, 0.01609271578490734, -0.011013492941856384, -0.025574784725904465, 0.021414415910840034, 0.01734337955713272, 0.005251509137451649, 0.01650109700858593, -0.027795350179076195, -0.010056352242827415, -0.016258621588349342, -0.016016146168112755, -0.024783549830317497, 0.006604267284274101, 0.0021376130171120167, 0.08264586329460144, 0.015148337930440903, -0.006374553311616182, -0.0357842817902565, 0.0018887566402554512, 0.0329766683280468, 0.03305324167013168, 0.04147607460618019, 0.026442592963576317, -0.03509514033794403, 0.004144417122006416, 0.037213608622550964, -0.07442721724510193, 0.009080070070922375, -0.05273204296827316, 0.01707538031041622, 0.05188975855708122, 0.0038508938159793615, 0.011874918825924397, 0.060644399374723434, 0.01634795404970646, 0.002405612263828516, -0.02302241139113903, -0.034584663808345795, -0.00129931780975312, -0.008186738938093185, -0.00867168977856636, 0.015224909409880638, 0.013080915436148643, 0.021580319851636887, 0.0033372286707162857, 0.03588637337088585, 0.009609687142074108, 0.01776452176272869, -0.02067422680556774, 0.02884182333946228, -0.0765201672911644, 0.00581941194832325, 0.037928275763988495, 0.047372058033943176, 0.06753581017255783, -0.012883106246590614, -0.04765281826257706, 0.017841093242168427, -0.008639785461127758, -0.01149844378232956, 0.0275911595672369, 0.03649894520640373, -0.006891408935189247, 0.026646781712770462, -0.016590429469943047, -0.011338920332491398, 0.014829291962087154, -0.003905131947249174, 0.017432712018489838, -0.028535539284348488, -0.021414415910840034, 0.03616713732481003, 0.011409110389649868, 0.015977859497070312, 0.00020977322128601372, -0.003614799352362752, -0.04627453535795212, 0.014497483149170876, 0.040531694889068604, -0.04675948619842529, -0.003541418584063649, -0.02868868038058281, -0.011204920709133148, 0.06870990246534348, 0.0016718048136681318, -0.007810263894498348, -0.03065400943160057, -0.02634049765765667, -0.0028315396048128605, -0.007701787631958723, -0.053855087608098984, 0.046912629157304764, 0.004039131570607424, 0.0354524701833725, -0.01610547862946987, 0.0387960821390152, 0.041399501264095306, -0.015263195149600506, -0.00019671223708428442, 0.028663156554102898, 0.03869398683309555, 0.0026417069602757692, 0.019104517996311188, 0.021567558869719505, 0.003314895322546363, 0.029148109257221222, -0.0061225066892802715, 0.0029703250620514154, -0.012474726885557175, -0.020010611042380333, -0.019181089475750923, 0.017100904136896133, 0.021822795271873474, -0.008001691661775112, -0.016424525529146194, 0.045125968754291534, -0.021184701472520828, 0.07463140785694122, 0.027284875512123108, -0.006406458094716072, 0.017522046342492104, 0.001180472900159657, -0.02646811679005623, -0.0329766683280468, 0.02784639783203602, 0.004597463179379702, -0.0028889679815620184, 0.04658082127571106, -0.013463771902024746, 0.026417069137096405, 0.03629475459456444, 0.01801975816488266, 0.018810994923114777, -0.020316895097494125, -0.016284145414829254, -0.0014285317156463861, 0.013476533815264702, -0.011626062914729118, 0.059010881930589676, -0.0011198540451005101, -0.029173631221055984, 0.001351162907667458, -0.0038732271641492844, 0.026570210233330727, 0.02329041063785553, -0.034890949726104736, -0.026263926178216934, -0.013731771148741245, 0.014344340190291405, -0.00415398832410574, 0.02192489057779312, -0.008218643255531788, 0.018134616315364838, -0.03218543156981468, 0.024324122816324234, 0.008824832737445831, -0.03221095725893974, -0.041807882487773895, -0.011243206448853016, 0.012238631956279278, -0.023226602002978325, 0.0015489718643948436, -0.027922969311475754, 0.004868653137236834, -0.025740688666701317, -0.013999770395457745, 0.02731039933860302, 0.01156863383948803, 0.03468675911426544, -0.031547341495752335, 0.017266808077692986, -0.00216792244464159, 0.014561292715370655, -0.03453361615538597, -0.022001462057232857, -0.037085991352796555, 0.025064310058951378, -0.001103104092180729, -0.017381666228175163, 0.0003278205113019794, -0.012634250335395336, 0.03453361615538597, 0.0065787434577941895, -0.002364136278629303, -0.022422604262828827, 0.0275911595672369, 0.002006803872063756, 0.006699981167912483, -0.020189275965094566, 0.018262233585119247, 0.014127388596534729, -0.031394198536872864, -0.020189275965094566, 0.012966059148311615, -0.024630406871438026, -0.0034233713522553444, 0.0023753028362989426, 0.03231305256485939, 0.0011334135197103024, 0.00041396310552954674, -0.014701672829687595, 0.05120061710476875, -0.00016939386841841042, -0.033334001898765564, 0.0401998870074749, -0.0096990205347538, 0.014956910163164139, -0.0159523356705904, -0.002279588719829917, 0.027361446991562843, -0.03325742855668068, -0.01623309776186943, -0.03688180074095726, -0.028510015457868576, 0.026391545310616493, -0.009233212098479271, -0.01745823584496975, 0.0024614455178380013, 0.04650425165891647, -0.004498558584600687, -0.025421641767024994, -0.02316279150545597, 0.01004359032958746, 0.011173016391694546, -0.03185362368822098, -0.023469077423214912, -0.0016686143353581429, -0.003646703902631998, -0.03989360108971596, -0.020138228312134743, 0.02077632211148739, 0.016807381063699722, 0.010866731405258179, -0.03754541650414467, 0.028943918645381927, 0.024349644780158997, -0.027540113776922226, 0.011409110389649868, 0.025881070643663406, 0.01220034621655941, 0.01545462291687727, -0.008780165575444698, 0.04007226973772049, 0.01073911227285862, -0.0063011725433170795, -0.01707538031041622, -0.013872151263058186, -0.04078693315386772, -0.015301480889320374, -0.009086450561881065, 0.028739728033542633, 0.0037009420339018106, 0.028892870992422104, 0.03412523865699768, -0.04548329859972, -0.023979552090168, -0.017509283497929573, 0.00731255067512393, 0.019053470343351364, 0.019614992663264275, -0.009405497461557388, -0.0073699792847037315, -0.036396849900484085, -0.006687219254672527, 0.008371786214411259, -0.036116089671850204, 0.03897474706172943, 0.0368562787771225, 0.0020403037779033184, 0.009890448302030563, 0.040429599583148956, 0.013642437756061554, -0.03119000792503357, 0.009533115662634373, -0.03218543156981468, 0.006776552181690931, 0.04063379019498825, 0.009341687895357609, -0.00014885523705743253, -0.003235133830457926, 0.012098251841962337, -0.038745034486055374, -0.005675841122865677, 0.0032271575182676315, -0.030322199687361717, -0.03961284086108208, -0.010566827841103077, 0.035146187990903854, 0.011555871926248074, 0.016973285004496574, 0.007012647110968828, -0.02331593446433544, -0.036932848393917084, -0.023098982870578766, 0.0053312708623707294, -0.04813776910305023, 0.02469421550631523, -0.00943740177899599, -0.00474741542711854, 0.012627868913114071, 0.03968941047787666, 0.010764636099338531, 0.03621818497776985, 0.020597657188773155, -0.0019477802561596036, -0.06125697121024132, 0.012474726885557175, 0.021018797531723976, 0.0065245055593550205, -0.008097405545413494, -0.0023019220679998398, -0.003720084670931101, -0.022945839911699295, -0.010815683752298355, 0.02092946507036686, -0.010286066681146622, -0.015697099268436432, -0.03233857452869415, 0.006438362877815962, 0.04175683483481407, -0.0140125323086977, 0.0025619452353566885, 0.009322545491158962, 0.005937459412962198, 0.06411562860012054, 0.015748146921396255, -0.015977859497070312, -0.03358924016356468, 0.001231520320288837, -0.0005539448466151953, -0.002684778068214655, -0.042343880981206894, 0.02192489057779312, -0.003499942598864436, -0.03325742855668068, -0.024860121309757233, 0.025574784725904465, 0.014637863263487816, -0.01268529798835516, -0.035835329443216324, -0.002212588908150792, -0.014586815610527992, -0.02562583237886429, 0.026697829365730286, -0.022639555856585503, -0.0231755543500185, 0.025345072150230408, -0.039306554943323135, 0.023188315331935883, -0.002601826097816229, 0.0049707479774951935, -0.03090924583375454, 0.005982126109302044, 0.024706978350877762, -0.04951605200767517, -0.01897689886391163, 0.020495561882853508, 0.0037679418455809355, -0.02940334565937519, -0.007669883314520121, -0.06431981921195984, -0.01800699718296528, 0.04272673651576042, -0.008193119429051876, 0.013106439262628555, -0.003933846019208431, -0.03517170995473862, 0.02677440084517002, -0.020572133362293243, 0.004559177439659834, -0.03200676664710045, -0.05283413827419281, 0.003573323367163539, -0.014510245062410831, -0.002909705974161625, -0.0012339132372289896, -0.00279165874235332, -0.03677970543503761, 0.001832923386245966, -0.02219288982450962, -0.005624793469905853, -0.01818566396832466, 0.09453992545604706, 0.018900327384471893, 0.023877456784248352, -0.04086350277066231, 0.009890448302030563, 0.014497483149170876, -0.02702963724732399, 0.027004115283489227, 0.017419951036572456, 0.013974246568977833, -0.002868229988962412, -0.03675418347120285, 0.020763561129570007, -0.04116978868842125, 0.010432828217744827, -0.012634250335395336, 0.031164484098553658, -0.012838440015912056, -0.0015035077231004834, 0.05436556041240692, -0.039051320403814316, -0.029990391805768013, -0.0012075918493792415, -0.007829406298696995, 0.0034457044675946236, 0.01329786702990532, -0.010522160679101944, 0.01818566396832466, -0.04198654741048813, 0.018249472603201866, 0.0008773785084486008, 0.04155264422297478, 0.032491717487573624, -0.009507591836154461, 0.03302771598100662, -0.01706261932849884, -0.022116318345069885, 0.02774430252611637, -0.008812070824205875, -0.019040707498788834, 0.0006572362617589533, -0.02940334565937519, -0.04938843101263046, -0.025345072150230408, 0.0018089949153363705, 0.006610648240894079, 0.018364328891038895, 0.025613071396946907, -0.0027517778798937798, 0.006144839804619551, -0.09402944892644882, -0.011619681492447853, 0.01116025447845459, -0.03440599888563156, -0.00039382328395731747, -0.013399962335824966, 0.0310368649661541, 0.004061464685946703, -0.021044321358203888, -0.012174822390079498, 0.007950644008815289, -0.02978620119392872, -0.016603190451860428, -0.01706261932849884, 0.04231835529208183, -0.028254777193069458, -0.007267884444445372, -0.0012658179039135575, 0.06610648334026337, -0.010853969492018223, -0.009896829724311829, -0.018887566402554512, -0.06340096145868301, 0.0028092062566429377, 0.0030437055975198746, 0.011134730651974678, -0.04586615785956383, 0.016832904890179634, 0.02677440084517002, -0.007995311170816422, -0.05615222454071045, -0.026391545310616493, 0.02649363875389099, 0.0033499905839562416, -0.03563113883137703, -0.007089218124747276, -0.005867269355803728, 0.0391278900206089, 0.017254047095775604, -0.010030829347670078, -0.0007090813596732914, 0.009539497084915638, 0.02261403203010559, 0.003509514033794403, 0.03759646415710449, -0.031394198536872864, -0.01567157544195652, 0.03259381279349327, 0.005168556701391935, 0.007529502734541893, 0.04821433871984482, 0.018262233585119247, -0.001861637574620545, 0.014318816363811493, 0.0009356045047752559, 0.0324406698346138, -0.03780065476894379, -0.0019270421471446753, -0.01955118216574192, 0.0010416875593364239, -0.004252892918884754, -0.03448256850242615, 0.004460273310542107, -0.034303903579711914, -0.017573093995451927, -0.012391774915158749, -0.0435434952378273, 0.008607880212366581, 0.010432828217744827, 0.022933078929781914, -0.01938527822494507, 0.0038189892657101154, -0.020048895850777626, 0.01787937805056572, -0.012570440769195557, -0.0006209446582943201, 0.027361446991562843, -0.03328295424580574, -0.0024391121696680784, 0.014395387843251228, 0.05370194464921951, -0.04119531437754631, 0.0310368649661541, 0.01518662367016077, -0.040812455117702484, 0.0037073229905217886, 0.0029527773149311543, 0.01345100998878479, 0.021261272951960564, 0.005554603412747383, 0.03662656247615814, -0.04216521605849266, 0.009245974011719227, 0.03420180827379227, -0.014663387089967728, 0.020150991156697273, 0.0032016339246183634, 0.04295644909143448, 0.022907555103302002, 0.011466539464890957, 0.040531694889068604, 0.043594542890787125, -0.02372431382536888, 0.03037324734032154, -0.031138960272073746, 0.02896944247186184, -0.017496522516012192, -0.026136307045817375, 0.019308706745505333, 0.022422604262828827, 0.03305324167013168, 0.018070805817842484, -0.03213438391685486, 0.013195772655308247, -0.02815268188714981, 0.03193019703030586, 0.066616952419281, -0.03660104051232338, -0.009954257868230343, 0.004792081657797098, 0.017675187438726425, 0.012181203812360764, -0.018670614808797836, 0.04476863518357277, -0.013157486915588379, 0.01775175891816616, -0.028790775686502457, -0.050409380346536636, -0.026161830872297287, 0.014586815610527992, 0.026417069137096405, 0.022294985130429268, -0.013897675089538097, 0.003927465062588453, -0.017802806571125984, -0.0031537767499685287, 0.03823455795645714, -0.02427307516336441, 0.027004115283489227, -0.009386354126036167, 0.030756104737520218, 0.012219489552080631, -0.0019398040603846312, -0.021529272198677063, -0.035835329443216324, -0.024464502930641174, 0.002463040640577674, -0.006387315224856138, -0.034048665314912796, -0.028101634234189987, -0.003681799164041877, -0.039587318897247314, -0.001257841708138585, 0.03231305256485939, 0.0012466750340536237, 0.0391278900206089, 0.013693485409021378, -0.04116978868842125, -0.022677840664982796, -0.0210698451846838, 0.005570555571466684, 0.06110382825136185, 0.003096348373219371, 0.01068806555122137, 0.014433673582971096, -0.008186738938093185, -0.01652662083506584, -0.009788352996110916, -0.01842813938856125, -0.0026257545687258244, -0.017943186685442924, -0.004648510832339525, 0.014701672829687595, -0.0038668462075293064, 0.03343609720468521, 0.023788124322891235, 0.029326774179935455, -0.006802076008170843, -0.021146416664123535, 0.01790490187704563, -0.003646703902631998, 0.009673496708273888, 0.013604152016341686, -0.02011270448565483, 0.02621287852525711, 0.013119201175868511, 0.008365404792129993, 0.02063594199717045, -0.012404536828398705, -0.010005305521190166, 0.028765251860022545, -0.025842783972620964, 0.016245858743786812, 0.03371685743331909, -0.05107299983501434, 0.032951146364212036, 0.039714936167001724, -0.032108861953020096, 0.01831328123807907, -0.00810378696769476, -0.01872166246175766, -0.012978820130228996, 0.00949483085423708, 0.0019190660677850246, 0.0079761678352952, 0.07110913097858429, -0.010311589576303959, -0.016730809584259987, -0.012117394246160984, -0.0022014223504811525, -0.01814737729728222, 0.010560446418821812, 0.00593107845634222, -0.013540342450141907, -0.006712743081152439, 0.0029607536271214485, -0.046249013394117355, 0.007050932385027409, -0.021720699965953827, -0.02731039933860302, -0.02968410775065422, -0.02454107441008091, -0.02261403203010559, 0.000163212331244722, 0.013221296481788158, 0.02830582484602928, 0.025064310058951378, -0.011051778681576252, 0.030194582417607307, 0.007676264271140099, -0.005181318614631891, 0.02122298814356327, -0.0343804731965065, -0.01406357903033495, 0.020967749878764153, -0.02234603278338909, -0.012647012248635292, -0.01956394501030445, 0.01518662367016077, 0.016883952543139458, 0.004495368339121342, 0.0016861619660630822, -0.005098366644233465, -0.012838440015912056, -0.0036945610772818327, 0.01130063459277153, 0.03614161163568497, 0.03690732643008232, -0.010847588069736958, -0.015735384076833725, -0.029173631221055984, 0.003091562772169709, 0.02496221475303173, -0.025447165593504906, 0.025549260899424553, 0.007318931631743908, 0.0023290410172194242, 0.052783090621232986, -0.016564905643463135, -0.002346588531509042, -0.020738037303090096, -0.010152067057788372, -0.00734445545822382, -0.007599692791700363, -0.023252125829458237, -0.02687649615108967, -0.005608841311186552, 0.005334461107850075, -0.0028857775032520294, 0.013489295728504658, -0.03440599888563156, 0.009099212475121021, 0.02634049765765667, 0.02413269318640232, -0.02383917011320591, -0.022690603509545326, -0.04122083634138107, -0.02275441214442253, -0.017292331904172897, -0.03591189906001091, -0.036396849900484085, 0.007165789138525724, 0.01758585497736931, 0.025166405364871025, 0.0027900636196136475, -0.013578628189861774, -0.010413684882223606, -0.033742379397153854, 0.016590429469943047, 0.015352528542280197, 0.04673396423459053, 0.0185940433293581, -0.02925020270049572, -0.0016247454332187772, -0.007395503111183643, -0.006821218878030777, 0.0024454931262880564, 0.01241729874163866, -0.001292936853133142, -0.05548860505223274, 0.02479631081223488, 0.005139842629432678, 0.0305008664727211, -0.0012171632843092084, 0.0009244378888979554, -0.0073763602413237095, -0.0054142228327691555, -0.0347122848033905, 0.03703494369983673, -0.002528445329517126, -0.04091455042362213, -0.014612339437007904, 0.03037324734032154, 0.00261777825653553, -0.011389967985451221, 0.004412416368722916, -0.02497497759759426, 0.002611397299915552, -0.045253586024045944, 0.03338504955172539, -0.0185940433293581, 0.004795272368937731, -0.010056352242827415, 0.022716127336025238, 0.0042560831643640995, 0.0015202576760202646, 0.0007681049755774438, 0.007350836414843798, -0.006470267660915852, -0.018530232831835747, 0.050256241112947464, 0.02174622379243374, -0.005793888587504625, 0.020214799791574478, -0.04561091959476471, 0.017649665474891663, -0.041399501264095306, -0.009526735171675682, 0.016054430976510048, -0.011415491811931133, -0.024706978350877762, -0.03037324734032154, 0.00358927552588284, -0.017024332657456398, 0.008990736678242683, 0.003981702961027622, 0.011192158795893192, 0.009418259374797344, 0.024745263159275055, 0.021133655682206154, 0.05855145305395126, 0.012615106999874115, -0.004843129310756922, 0.02206527069211006, 0.0006600279011763632, 0.01082206517457962, 0.011696252971887589, -0.02355840988457203, 0.00503136683255434, -0.01435710210353136, -0.035299330949783325, 0.04392635077238083, 0.01773899793624878, 0.004259273875504732, 0.019870229065418243, 0.01415291242301464, 0.014739958569407463, 0.025153642520308495, 0.019908515736460686, -0.022243937477469444, 0.02050832286477089, 0.06278839707374573, 0.00015992217231541872, -0.005181318614631891, 0.003096348373219371, 0.022933078929781914, 0.014752720482647419, -0.0338444747030735, 0.0011780799832195044, 0.03504409268498421, 0.01970432512462139, -0.0648813396692276, 0.0031298482790589333, 0.027412494644522667, -0.06707638502120972, 0.0018855661619454622, 0.012111013755202293, 0.027667731046676636, 0.007408265024423599, 0.007197693921625614, -0.014459197409451008, 0.006326696369796991, 0.02496221475303173, 0.00013240438420325518, 0.0029639441054314375, 0.03785170242190361, -0.00964159145951271, -0.0050951759330928326, -0.008850355632603168, -0.003094753250479698, -0.01073911227285862, -0.013106439262628555, -0.005844935774803162, -0.024847358465194702, 0.004830367397516966, -0.05543755739927292, -0.012500250712037086, 0.034865424036979675, -0.0053185089491307735, 0.020470038056373596, -0.03233857452869415, -0.00043430234654806554, -0.001958946930244565, 0.0029320393223315477, -0.006400077138096094, -0.05783678963780403, -0.020623179152607918, -0.012927773408591747, -0.026289450004696846, 0.024758026003837585, -0.035018566995859146, 0.020036134868860245, 0.013987008482217789, -0.03593742102384567, 0.022639555856585503, 0.016054430976510048, 0.03810694068670273, -0.011555871926248074, 0.011606919579207897, 0.003633942222222686, 0.008078263141214848, -0.007784740068018436, -0.03129210323095322, 0.007031789515167475, 0.00606507807970047, -0.032364100217819214, 0.021146416664123535, -0.0012466750340536237, -0.04451339691877365, 0.02258850820362568, -0.004578320309519768, 0.0072806463576853275, 0.006597886327654123, 0.050128620117902756, 0.010075495578348637, 0.030271152034401894, 0.0037392275407910347, 0.012174822390079498, -0.006282030139118433, -0.028765251860022545, -0.01123682502657175, 0.010049971751868725, -0.01123044453561306, 0.0033276572357863188, -0.0034616568591445684, 0.012430060654878616, -0.01665423810482025, -0.017151951789855957, 0.0142805315554142, 0.006020411383360624, 0.005072842817753553, 0.011421872302889824, 0.002073803683742881, 0.0007234384538605809, -0.022435365244746208, 0.00976921059191227, -0.04681053385138512, 0.021427176892757416, -0.024196503683924675, -0.025472689419984818, -0.03343609720468521, 0.009801114909350872, -0.03090924583375454, 0.015007957816123962, -0.009105592966079712, 0.029301250353455544, 0.012513012625277042, -0.05308937281370163, -0.014127388596534729, -0.009622449055314064, 0.021529272198677063, -0.0029001347720623016, 0.029709629714488983, 0.010432828217744827, 0.013667961582541466, -0.013336152769625187, -0.010828445665538311, -0.023354219272732735, 0.03953627124428749, -0.0016989237628877163, -0.029990391805768013, 0.039306554943323135, -0.037239134311676025, -0.0242475513368845, -0.013234058395028114, -0.0007046944228932261, 0.03440599888563156, -0.03159838542342186, 0.00558331748470664, 0.0019350183429196477, 0.03925550729036331, -0.010560446418821812, 0.033461619168519974, -0.014944148249924183, 0.01735614240169525, -0.01504624355584383, 0.012576821260154247, -0.021810034289956093, -0.030424294993281364, -0.012921391986310482, 0.010732731781899929, -0.010426446795463562, 0.032364100217819214, 0.005474841687828302, 0.012040822766721249, 0.009482068940997124, 0.010515780188143253, -0.024451740086078644, 0.0183260440826416, 0.0193980410695076, -0.005280223209410906, -0.02025308646261692, 0.013042629696428776, -0.015148337930440903, 0.014905862510204315, -0.003930655773729086, 0.020418990403413773, 0.002930444199591875, 0.012723582796752453, -0.012525774538516998, 0.023954028263688087, -0.027259351685643196, -0.0208018459379673, 0.0016861619660630822, 0.019219374284148216, -0.00502179516479373, 0.01704985648393631, -0.005238747224211693, -0.0007996108615770936, 0.0028857775032520294, 0.008065501227974892, -0.014127388596534729, 0.022129081189632416, -0.021542035043239594, 0.021261272951960564, 0.03782618045806885, 0.0018664232920855284, -0.032951146364212036, -0.0002837521897163242, 0.07335522025823593, -0.03657551482319832, -0.0011621277080848813, 0.011600539088249207, -0.04413054138422012, -0.018274996429681778, 0.016437286511063576, -0.009175783954560757, -0.004457082599401474, 0.010120161809027195, -0.011881300248205662, 0.013808341696858406, 0.010483874939382076, 0.01636071503162384, 0.010356256738305092, 0.02313726767897606, 0.002463040640577674, 0.01268529798835516, 0.005114318802952766, -0.009029022417962551, -0.02316279150545597, 0.006090601906180382, -0.004820795729756355, -0.0027804921846836805, -0.028612110763788223, -0.0003690971643663943, -0.017381666228175163, 0.03399761766195297, 0.018683375790715218, -0.004642129875719547, 0.009871305897831917, 0.030858198180794716, -0.01302348729223013, 0.011077302508056164, -0.0066553144715726376, -0.0022668270394206047, 0.022665079683065414, -0.039995696395635605, 0.0017324236687272787, 0.044870730489492416, 0.00327341933734715, -0.04229283332824707, 0.02884182333946228, 0.0065787434577941895, 0.0013224486028775573, 0.013565866276621819, 0.00037807037006132305, 0.04285435378551483, -0.008652547374367714, 0.015569480136036873, -0.014229483902454376, 0.04780596122145653, 0.02577897533774376, -0.018479185178875923, -0.01775175891816616, 0.0041667502373456955, -0.03062848560512066, -0.0053248899057507515, -0.026238402351737022, -0.027693254873156548, 0.00023150828201323748, -0.011466539464890957, -0.015403575263917446, 0.006853123661130667, 0.0034648473374545574, 0.004903748165816069, 0.0275911595672369, -0.028229253366589546, -0.02843344397842884, -0.037928275763988495, -0.00867168977856636, 0.013336152769625187, 0.008148453198373318, -0.008607880212366581, 0.007988929748535156, 0.004294368904083967, -0.009660734795033932, 0.005538651254028082, -0.024490026757121086, -0.01914280280470848, -0.02840792015194893, -0.007586930878460407, -0.004109321627765894, -0.03877055644989014, -0.022843744605779648, 0.015901288017630577, -0.0063075534999370575, -0.0050122239626944065, 0.026953067630529404, 0.007937882095575333, 0.018785471096634865, 0.025753451511263847, -0.00436774967238307, 0.025562023743987083, -0.007038170471787453, -0.013514818623661995, 0.008250548504292965, 0.0020993275102227926, -0.018951375037431717, -0.023264886811375618, 0.005876840557903051, -0.029479917138814926, -0.024579359218478203, 0.0338444747030735, -0.01956394501030445, 0.005784316919744015, 0.01887480355799198, 0.005915126297622919, 0.012219489552080631, -0.06452400982379913, 0.014229483902454376, -0.002702325815334916, -0.007038170471787453, 0.013131963089108467, -0.019436325877904892, 0.019589468836784363, 0.044845208525657654, -0.008020834997296333, 0.022154605016112328, -0.029990391805768013, 0.008033595979213715, 0.012423679232597351, -0.0027932540979236364, -0.006390505935996771, 0.025549260899424553, 0.039306554943323135, 0.003656275337561965, -0.05091985687613487, 0.009022640995681286, -0.012206727638840675, -0.04104217141866684, 0.01775175891816616, 0.021580319851636887, 0.02151651121675968, -0.002523659495636821, 0.0074720741249620914, 0.00893968902528286, -0.015888527035713196, 0.016475573182106018, 0.018134616315364838, -0.0027741112280637026, -0.036524467170238495, 0.0068786474876105785, -0.04224178567528725, -0.0006297184736467898, 0.011389967985451221, 0.0037424180191010237, 0.0032335384748876095, 0.007133884821087122, -0.008786546997725964, -0.039332080632448196, -0.003898750990629196, -0.0028060160111635923, 0.012500250712037086, 0.012327965348958969, 0.006993504241108894, -0.01606719195842743, 0.005146223586052656, 0.0313686728477478, -0.04157816991209984, 0.0285610631108284, -0.014050817117094994, -0.01831328123807907, -0.01706261932849884, -0.004026369657367468, 0.005388699006289244, 0.024349644780158997, -0.011287872679531574, -0.04285435378551483, -0.023035172373056412, -0.00839731004089117, -0.004833557642996311, 0.01109006442129612, 0.03305324167013168, -0.04155264422297478, -0.024464502930641174, -0.02426031231880188, -0.03609056398272514, 0.017777282744646072, -0.011319777928292751, -0.04673396423459053, -0.005091985687613487, -0.01193234696984291, 0.0347122848033905, 0.003547799540683627, -0.007121122907847166, -0.01567157544195652, -0.0034648473374545574, -0.013808341696858406, -0.03246619552373886]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-15T11:25:04.003632", "url_path": "/testing-evals/", "chunk_size": 4083}
updated_dt: 2025-03-15T11:25:04.005141
---
```
importjson
frompathlibimport Path
fromtypingimport Union
frompydantic_aiimport Agent, RunContext
fromfake_databaseimport DatabaseConn

classSqlSystemPrompt: 
The SqlSystemPrompt class is used to build the system prompt, it can be customised with a list of examples and a database type. We implement this as a separate class passed as a dep to the agent so we can override both the inputs and the logic during evals via dependency injection.
[](https://ai.pydantic.dev/testing-evals/#__code_4_annotation_1)
  def__init__(
    self, examples: Union[list[dict[str, str]], None] = None, db: str = 'PostgreSQL'
  ):
    if examples is None:
      # if examples aren't provided, load them from file, this is the default
      with Path('examples.json').open('rb') as f:
        self.examples = json.load(f)
    else:
      self.examples = examples
    self.db = db
  defbuild_prompt(self) -> str: 
The build_prompt method constructs the system prompt from the examples and the database type.
[](https://ai.pydantic.dev/testing-evals/#__code_4_annotation_2)
    return f"""\
Given the following {self.db} table of records, your job is to
write a SQL query that suits the user's request.
Database schema:
CREATE TABLE records (
 ...
);
{''.join(self.format_example(example)forexampleinself.examples)}
"""
  @staticmethod
  defformat_example(example: dict[str, str]) -> str: 
Some people think that LLMs are more likely to generate good responses if examples are formatted as XML as it's to identify the end of a string, see #93[](https://github.com/pydantic/pydantic-ai/issues/93).
[](https://ai.pydantic.dev/testing-evals/#__code_4_annotation_3)
    return f"""\
<example>
 <request>{example['request']}</request>
 <sql>{example['sql']}</sql>
</example>
"""

sql_agent = Agent(
  'google-gla:gemini-1.5-flash',
  deps_type=SqlSystemPrompt,
)

@sql_agent.system_prompt
async defsystem_prompt(ctx: RunContext[SqlSystemPrompt]) -> str:
  return ctx.deps.build_prompt()

async defuser_search(user_prompt: str) -> list[dict[str, str]]:
"""Search the database based on the user's prompts."""
  ... 
In reality, you would have more logic here, making it impractical to run the agent independently of the wider application.
[](https://ai.pydantic.dev/testing-evals/#__code_4_annotation_4)
  result = await sql_agent.run(user_prompt, deps=SqlSystemPrompt())
  conn = DatabaseConn()
  return await conn.execute(result.data)

```

`examples.json` looks something like this:
```
request: show me error records with the tag "foobar"
response: SELECT * FROM records WHERE level = 'error' and 'foobar' = ANY(tags)

```

examples.json```
{
"examples":[
{
"request":"Show me all records",
"sql":"SELECT * FROM records;"
},
{
"request":"Show me all records from 2021",
"sql":"SELECT * FROM records WHERE date_trunc('year', date) = '2021-01-01';"
},
{
"request":"show me error records with the tag 'foobar'",
"sql":"SELECT * FROM records WHERE level = 'error' and 'foobar' = ANY(tags);"
},
...
]
}

```

Now we want a way to quantify the success of the SQL generation so we can judge how changes to the agent affect its performance.
We can use [`Agent.override`](https://ai.pydantic.dev/api/agent/#pydantic_ai.agent.Agent.override) to replace the system prompt with a custom one that uses a subset of examples, and then run the application code (in this case `user_search`). We also run the actual SQL from the examples and compare the "correct" result from the example SQL to the SQL generated by the agent. (We compare the results of running the SQL rather than the SQL itself since the SQL might be semantically equivalent but written in a different way).
To get a quantitative measure of performance, we assign points to each run as follows:
  * **-100** points if the generated SQL is invalid
  * **-1** point for each row returned by the agent (so returning lots of results is discouraged)
  * **+5** points for each row returned by the agent that matches the expected result


We use 5-fold cross-validation to judge the performance of the agent using our existing set of examples.
sql_app_evals.py