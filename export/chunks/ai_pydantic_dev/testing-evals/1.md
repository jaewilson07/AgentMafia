---
url: https://ai.pydantic.dev/testing-evals/
session_id: pydantic_ai_docs
chunk_number: 1
title: Testing and Evaluations in Pydantic
summary: This document outlines the structure for unit tests and evaluations within Pydantic, including sections on unit testing with TestModel and FunctionModel, using pytest fixtures, measuring performance, and customizing system prompts.
embedding: [-0.04366346821188927, 0.017795506864786148, 0.04361188784241676, -0.026190344244241714, 0.027518559247255325, 0.00961988978087902, -0.017124950885772705, -0.00991648156195879, 0.03223823755979538, 0.061330024152994156, 0.01144457422196865, -0.06385750323534012, -0.026035601273179054, -0.010483874939382076, 0.0036880543921142817, -0.0027869956102222204, 0.018401585519313812, 0.008465761318802834, -0.02423025853931904, 0.06499228626489639, 0.05802882835268974, -0.005335428286343813, 0.033063534647226334, -0.028163325041532516, -0.02125144563615322, -0.04312186688184738, 0.0005589304491877556, 0.047351524233818054, -0.011218906380236149, -0.047274149954319, 0.07035672664642334, -0.00491955503821373, -0.038505349308252335, -0.006450871471315622, -0.008762353099882603, 0.01686704531311989, 0.0010993238538503647, 0.02354680933058262, 0.011147982440888882, 0.03917590528726578, -0.025790590792894363, -0.02849860116839409, -0.010451636277139187, 0.03670001029968262, -0.06406382471323013, 0.019136616960167885, 0.017060475423932076, 0.04448876902461052, -0.004639082122594118, -0.008272332139313221, -0.032031912356615067, 0.013823756016790867, 0.00478093046694994, -0.05410865694284439, -0.0008373882155865431, -0.003006215672940016, -0.0605047233402729, 0.004548815079033375, -0.0005762585205957294, -0.004887316841632128, 0.01846606284379959, 0.01751181110739708, -0.02211543172597885, 0.04670675843954086, -0.03208349272608757, -0.03595208376646042, -0.030948707833886147, -0.0044069672003388405, -0.027647512033581734, -0.019510582089424133, 0.04616515710949898, 0.01481669396162033, 0.021264340728521347, -0.005838344804942608, -0.01775682158768177, -0.047970496118068695, 0.048279985785484314, 0.057719338685274124, -0.014507207088172436, -0.02100643515586853, -0.017008893191814423, 0.03535889834165573, 0.001389467972330749, 0.005548200570046902, -0.0017956697847694159, -0.028575973585247993, -0.06060788780450821, -0.03133556619286537, -0.01815657503902912, -0.0441792793571949, 0.00040035860729403794, 0.008659190498292446, -0.02051641419529915, 0.017460228875279427, 0.06751976162195206, 0.04072334244847298, 0.00554497679695487, -0.03685475140810013, -0.02211543172597885, 0.011289830319583416, -0.003385014832019806, 0.005883478093892336, -0.06772609055042267, 0.012663180008530617, 0.06065946817398071, 0.017279695719480515, -0.004513353109359741, 0.012579360045492649, -0.046887293457984924, 0.009910034015774727, -0.06277429312467575, -0.012276320718228817, -0.044720884412527084, -0.004693887196481228, -0.026693260297179222, 0.004149061162024736, -0.005851239897310734, -0.03700949624180794, 0.0110319247469306, -0.07334844022989273, 0.003388238837942481, -0.0012750222813338041, 0.048151031136512756, -0.02443658374249935, 0.02580348588526249, -0.014610368758440018, -0.006763582117855549, -0.028240695595741272, -0.009471594356000423, 0.024217363446950912, -0.004664872772991657, 0.009116973727941513, 0.042244985699653625, -0.003497848752886057, -0.025597160682082176, 0.016570454463362694, -0.030871335417032242, -0.0011073834029957652, -0.004651977680623531, 0.046887293457984924, 0.01954926736652851, 0.009555413387715816, -0.028653346002101898, 0.03368251025676727, -0.027080118656158447, -0.023521017283201218, -0.030123408883810043, 0.01101258210837841, -0.008027320727705956, 0.01862080581486225, 0.033063534647226334, 0.025261882692575455, -0.03817007318139076, 0.00666041998192668, -0.02726065367460251, -0.010722437873482704, -0.005848016124218702, 0.025932438671588898, 0.037447936832904816, -0.07200732827186584, 0.01155418436974287, 0.05142643675208092, -0.018414480611681938, 0.01252777874469757, -0.038195863366127014, 0.023533912375569344, -0.05529502406716347, -0.017395753413438797, -0.028008580207824707, -0.024462373927235603, 0.013307943940162659, -0.03453360125422478, 0.028318068012595177, 0.0003000170981977135, 0.007569537963718176, -0.032470352947711945, -0.018079202622175217, -0.037293191999197006, -0.03739635646343231, -0.006776477675884962, -0.046423062682151794, -0.04500458016991615, -0.07004724442958832, -0.011296278797090054, -0.029246529564261436, -0.0014781231293454766, 0.028447020798921585, 0.0473257340490818, -0.06684920936822891, 0.002675773808732629, -0.0006266307318583131, 0.02001349814236164, 0.05668771639466286, 0.03208349272608757, 0.024771861732006073, -0.004245775751769543, 0.0791255310177803, 0.03855693340301514, 0.02361128479242325, 0.04064596816897392, -0.011418784037232399, 0.022566765546798706, 0.04629410803318024, -0.008227198384702206, 0.05173592269420624, -0.019845858216285706, -0.011380097828805447, -0.007943501695990562, -0.0589057058095932, -0.022050954401493073, -0.004429533611983061, -0.024114200845360756, 0.020090868696570396, -0.008265883661806583, -0.002919172402471304, 0.01614490896463394, -0.049698468297719955, 0.010277549736201763, 0.02098064497113228, 0.09207240492105484, -0.011863671243190765, 0.03443043678998947, 0.04964688420295715, -0.04386979341506958, -0.04405032843351364, 0.02335337921977043, 0.028008580207824707, -0.07499903440475464, 0.017898669466376305, -0.024681594222784042, -0.02072273939847946, -0.015680678188800812, -0.0348430871963501, -0.005361218936741352, -0.006347708869725466, -0.04866684228181839, -0.007543747313320637, -0.0032560620456933975, -0.021947791799902916, -0.01116732507944107, 0.00017257530998904258, 0.03053605929017067, -0.00486474996432662, -0.0005279011093080044, 0.002746697748079896, 0.015384086407721043, -0.0014015573542565107, -0.024539746344089508, 0.05134906619787216, 0.034482017159461975, 0.05761617794632912, -0.032625097781419754, 0.009310402907431126, -0.017176533117890358, -0.024036830291152, -0.002843412570655346, 0.008246541023254395, -0.003945960197597742, -0.030407104641199112, 0.012843714095652103, -0.021728571504354477, 0.048254191875457764, -0.020555099472403526, -0.00632836576551199, -0.0074341376312077045, -0.026125866919755936, -0.03623577952384949, -0.01372059341520071, -0.02536504529416561, -0.03951118513941765, 0.031361356377601624, 0.048744216561317444, 0.017743926495313644, -0.02836964838206768, 0.01332083996385336, -0.008311017416417599, 0.006873192265629768, 0.02014245092868805, 0.036803171038627625, -0.014262196607887745, -0.00894288718700409, -0.015151971951127052, 0.02549399808049202, 0.015590411610901356, -0.0024517178535461426, 0.034636761993169785, -0.027802255004644394, -0.015732260420918465, -0.00991648156195879, 0.0026096852961927652, 0.015461458824574947, 0.02697695791721344, 0.0333472341299057, -0.025687428191304207, 0.030639220029115677, -0.01427509170025587, 0.024294735863804817, 0.018324214965105057, -0.00027543545002117753, -0.016854150220751762, -0.005138774868100882, 0.02184462919831276, -0.004542367532849312, -0.023933667689561844, 0.009175002574920654, 0.0022744075395166874, 0.026925375685095787, -0.0016989550786092877, 0.004242551978677511, -0.0077113863080739975, 0.0015168091049417853, 0.04420506954193115, -0.003778321435675025, -0.0040233321487903595, -0.01927846670150757, -0.04662938788533211, 0.013449792750179768, -0.01386244222521782, 0.03298616409301758, -0.02493949979543686, -0.03517836332321167, -0.03907274454832077, 0.03156768158078194, -0.013965604826807976, -0.06292904168367386, -0.008272332139313221, 0.001913339365273714, -0.00983911007642746, -0.021767258644104004, -0.009478041902184486, -0.013991395011544228, -0.0008752681314945221, -0.023598389700055122, 0.02339206449687481, -0.0023356603924185038, 0.014287986792623997, -0.03252193331718445, 0.014455625787377357, -0.011186668649315834, 0.10192441195249557, -0.03737056627869606, -0.004693887196481228, -0.03445622697472572, -0.004600396379828453, 0.012843714095652103, 0.03690633550286293, 0.02230885997414589, 0.007459928281605244, 0.03613261505961418, 0.04283817112445831, 0.02759593166410923, -0.020245613530278206, 0.027570141479372978, 0.010941658169031143, -0.017718134447932243, -0.024217363446950912, -0.013243467546999454, 0.007550195325165987, -0.0010775630362331867, -0.015242238529026508, -0.041161783039569855, -0.017060475423932076, 0.0019762038718909025, 0.020116660743951797, -0.011373650282621384, 0.018956083804368973, -0.018453167751431465, -0.022360442206263542, -0.0403364822268486, 0.018762653693556786, 0.025236092507839203, 0.014623264782130718, -0.0014354075537994504, 0.025700323283672333, -0.014455625787377357, 0.0014515266520902514, -0.011251145042479038, -0.0021583500783890486, -0.010799809359014034, 0.042992912232875824, 0.03288300335407257, 0.010961000807583332, 0.012895295396447182, 0.0012476197443902493, 0.03615840524435043, 0.014520102180540562, 0.0007475241436623037, 0.000886551511939615, -0.01174116600304842, 0.01939452439546585, 0.01557751651853323, -0.05627506598830223, -0.03860851377248764, -0.01658334955573082, 0.041135989129543304, 0.034327276051044464, -0.017176533117890358, 0.04748047515749931, 0.07045989483594894, 0.014339568093419075, -0.019536372274160385, -0.015242238529026508, -0.05472763255238533, 0.01528092473745346, 0.00918789766728878, 0.012688970193266869, 0.01302424818277359, 0.019291361793875694, 0.011257592588663101, -0.014391149394214153, 0.025481102988123894, -0.016557559370994568, 0.02958180569112301, -0.02620323933660984, -0.020658262073993683, -0.06891245394945145, 0.043818213045597076, 0.019961915910243988, 0.02613876201212406, 0.008839724585413933, -0.06215532124042511, -0.09640522301197052, 0.012850161641836166, -0.018014727160334587, -0.04242552071809769, 0.012224739417433739, 0.059473101049661636, 0.001048548612743616, -0.005877030547708273, -0.06060788780450821, -0.0035816682502627373, -0.006170398555696011, 0.044411394745111465, 0.002885322319343686, 0.003578444244340062, -0.008633400313556194, 0.014391149394214153, 0.006544362287968397, 0.00320931663736701, 0.00043441023444756866, 0.028318068012595177, -0.03443043678998947, -0.011960386298596859, 0.05529502406716347, -0.0480220802128315, -0.03267667815089226, -0.049079492688179016, -0.051529597491025925, -0.014674846082925797, -0.042090240865945816, 0.011953938752412796, -0.011083506047725677, -0.01748601906001568, -0.007988635450601578, -0.001459586201235652, -0.07195574790239334, 0.05808040872216225, -0.009826214984059334, 0.06839664280414581, -0.002859531668946147, 0.03675159066915512, 0.024114200845360756, -0.009297507815063, 0.025532683357596397, -0.015977270901203156, 0.026319297030568123, 0.039124324917793274, 0.012179605662822723, 0.013578745536506176, -0.009826214984059334, 0.00940711796283722, -0.05101378634572029, 0.03631315007805824, 0.011141534894704819, -0.013256363570690155, -0.008659190498292446, 0.0032576739322394133, 0.011451021768152714, -0.018723968416452408, -0.015151971951127052, 0.025107139721512794, -0.01983296312391758, 0.02901441417634487, -0.005512738600373268, -0.007698491215705872, 0.08036347478628159, -0.016132013872265816, -0.04866684228181839, -0.02227017469704151, 0.006399290170520544, -0.03412095084786415, 0.00290788896381855, 0.038840629160404205, -0.014171929098665714, 0.038531139492988586, 0.007982187904417515, 0.01427509170025587, 0.03829902783036232, 0.03933065012097359, 0.00508074602112174, -0.007408346980810165, -0.014378254301846027, 0.00981976743787527, 0.058338314294815063, 0.010715990327298641, -0.013630326837301254, 0.01636412926018238, -0.022102534770965576, 0.017215218394994736, 0.03721582144498825, -0.04631989821791649, 0.03051026724278927, 0.015010123141109943, 0.03517836332321167, -0.029375482350587845, -0.009091182611882687, 0.004938898142427206, 0.03270246833562851, 0.006750687025487423, 0.008504446595907211, -0.01401718519628048, -0.02929810993373394, -0.017640763893723488, 0.022050954401493073, -0.011289830319583416, -0.022205697372555733, -0.001676388317719102, -0.008594714105129242, -0.005338652059435844, -0.016015956178307533, -0.0040233321487903595, -0.00129758904222399, 0.009058944880962372, -0.019497685134410858, -0.04582987725734711, 0.03071659244596958, 0.001292753266170621, -0.003436596132814884, -0.019265569746494293, -0.03473992273211479, 0.015796735882759094, 0.03646789491176605, -0.0010058330371975899, -0.006163951009511948, -0.011251145042479038, 0.036983706057071686, 0.006712000817060471, 0.00909763015806675, -0.0029481868259608746, -0.02215411700308323, 0.06390908360481262, -0.03445622697472572, 0.014868275262415409, -0.013127409853041172, 0.008684980683028698, 0.014919856563210487, -0.01682836003601551, -0.002886934205889702, -0.03187716752290726, 0.02211543172597885, -0.006718448828905821, -0.01418482419103384, 0.04232235625386238, -0.002503299154341221, -0.015242238529026508, 0.06112369894981384, 0.02991708368062973, -0.022076744586229324, -0.008124035783112049, 0.022076744586229324, -0.02107091248035431, -0.007085964549332857, -0.01943320967257023, -0.006325141992419958, -0.0038363502826541662, -0.007601776160299778, 0.018182365223765373, -0.025790590792894363, -0.019665325060486794, 0.01503591425716877, -0.022424917668104172, -0.03517836332321167, -0.004961464554071426, 0.02527477778494358, -0.05395391583442688, 0.02527477778494358, 0.004203866235911846, -0.0009332969784736633, -0.012701865285634995, 0.007260051090270281, 0.01574515551328659, -0.025545578449964523, -0.04276079684495926, -0.008917096070945263, -0.005918940529227257, 0.00948448944836855, 0.025932438671588898, -0.004419862292706966, -0.05931835621595383, -0.010896524414420128, 0.019729800522327423, -0.00040257498039864004, -0.010806256905198097, 0.02416578307747841, -0.005141998641192913, 0.01673809252679348, -0.006122041493654251, 0.042631845921278, -0.052174363285303116, -0.018582120537757874, -0.02221859246492386, -0.022205697372555733, 0.009355536662042141, -0.05348968505859375, 0.003086811164394021, 0.02319863624870777, -0.010509665124118328, 0.011515498161315918, 0.06014365702867508, -0.0441276989877224, -0.035745758563280106, 0.016003061085939407, 0.0048357355408370495, -0.0012371423654258251, 0.0028192338068038225, -0.03747372701764107, 0.010670856572687626, 0.007621119264513254, -0.03234139829874039, -0.00538378581404686, -0.049208447337150574, 0.05565609410405159, 0.03156768158078194, -0.000767673016525805, 0.008265883661806583, 0.0036525921896100044, -0.009091182611882687, 0.0005657810834236443, -0.003987870179116726, -0.010574141517281532, 0.018865816295146942, 0.03443043678998947, 0.0029594702646136284, -0.005503067281097174, -0.01846606284379959, -0.03623577952384949, -0.01795024983584881, 0.01757628656923771, 0.005438590422272682, -0.006982802413403988, -0.013120962306857109, -0.007266498636454344, 0.02354680933058262, 0.028085952624678612, 0.004793826024979353, 0.014094557613134384, -0.009871348738670349, -0.030742382630705833, -0.022347545251250267, 0.03468834236264229, -0.04002699628472328, 0.0023485554847866297, 0.015177762135863304, -0.00565458694472909, -0.002687057014554739, 0.054779212921857834, 0.01571936532855034, 0.0023163172882050276, 0.010896524414420128, -0.004693887196481228, -0.020413251593708992, 0.001745700603350997, -0.010677304118871689, -0.014442730695009232, 0.013282153755426407, 0.016622034832835197, 0.007563090417534113, -0.05240647867321968, -0.04405032843351364, 0.05379917100071907, -0.03657105565071106, -0.005009822081774473, -0.06071104854345322, -0.004481114912778139, 0.015732260420918465, -0.024578431621193886, 0.022283069789409637, 0.006151055917143822, -0.009600547142326832, 0.015822526067495346, 0.006615286227315664, -0.0209161676466465, -0.04884737730026245, -0.014120347797870636, -0.014287986792623997, 0.004464996047317982, -0.02379181981086731, 0.02162540890276432, -0.023443646728992462, -0.07381267100572586, -0.0129920095205307, -0.003075527958571911, 0.003971750847995281, 0.011902357451617718, -0.024849234148859978, -0.001811788883060217, 0.0017634315881878138, 0.02664167992770672, 0.04126494377851486, -0.020993540063500404, -0.03747372701764107, 0.019484790042042732, -0.017653658986091614, 0.01082560047507286, -0.04637148231267929, -0.014868275262415409, 0.03443043678998947, 0.003707397263497114, 0.010077673010528088, -0.004980807658284903, -0.04196128994226456, 0.03688054531812668, 0.0017215218394994736, -0.00937487930059433, 0.01211512926965952, -0.03069080226123333, -0.01884002611041069, 0.020903272554278374, -0.00983911007642746, -0.041007038205862045, 0.0003320538380648941, 0.002076142467558384, 0.0201682411134243, -0.03280562907457352, 0.007698491215705872, -0.02069694921374321, -0.043482933193445206, 0.009478041902184486, -0.035126782953739166, 0.009716604836285114, -0.050291649997234344, 0.025390835478901863, -0.021922001615166664, -0.018014727160334587, -0.006776477675884962, -0.011206011287868023, 0.001096906024031341, 0.06880929321050644, -0.02171567641198635, -0.01293398067355156, 0.012901742942631245, 0.010354922153055668, -0.0032979717943817377, 0.0071633365005254745, -0.012514883652329445, -0.0074470327235758305, -0.019162409007549286, -0.02007797360420227, -0.04002699628472328, 0.04505616053938866, -0.02589375153183937, -0.014584578573703766, -0.022128326818346977, 0.0044521004892885685, -0.012418168596923351, -0.04582987725734711, 0.04198708012700081, -0.0016135238111019135, 0.012953323312103748, 0.014133242890238762, -0.02001349814236164, -0.027544349431991577, 0.012140920385718346, 0.02898862212896347, 0.025764798745512962, -0.028266485780477524, 0.016622034832835197, 0.016299651935696602, 0.03796374797821045, 0.03069080226123333, -0.001404781243763864, 0.018595015630126, 0.017008893191814423, -0.0023001981899142265, 0.016312548890709877, 0.00836904626339674, -0.005438590422272682, 0.0032673452515155077, -0.026319297030568123, -0.03626156970858574, -0.04123915359377861, 0.00113478593993932, -0.0030191109981387854, 0.007318079937249422, 0.030793964862823486, -0.008813934400677681, -0.001000191317871213, -0.11502603441476822, 0.000491633138153702, -0.015474353916943073, -0.03553943336009979, 0.021909106522798538, -0.010219520889222622, -0.016325443983078003, -0.0034462676849216223, -0.022657033056020737, -0.002946574939414859, 0.000995355541817844, -0.02397235296666622, -0.012850161641836166, -0.022257279604673386, 0.044695090502500534, -0.05410865694284439, 0.00755664287135005, 0.004252223297953606, 0.044411394745111465, 0.0011509050382301211, 0.003571996698155999, 0.014984332956373692, -0.02880808897316456, 0.00666041998192668, -0.025532683357596397, -0.028447020798921585, -0.004132941830903292, 0.014997228048741817, 0.03566838428378105, 0.015951480716466904, -0.036029454320669174, -0.04031069204211235, 0.00666041998192668, 0.001123502617701888, -0.042244985699653625, 0.03721582144498825, 0.012495541013777256, 0.04374083876609802, -0.018337110057473183, -0.0026032377500087023, -0.002593566197901964, 0.010877180844545364, -0.01081270445138216, 0.03365672007203102, 0.028292277827858925, -0.0410844087600708, -0.03257351368665695, -0.007356765680015087, 0.009639233350753784, -0.015100390650331974, -0.01090297196060419, 0.007337423041462898, 0.006969906855374575, 0.024952394887804985, 0.014803798869252205, 0.017743926495313644, -0.040697552263736725, -0.0038331265095621347, -0.018362900242209435, 0.05436656251549721, -0.01976848766207695, 0.008871963247656822, -0.03688054531812668, -0.03226402774453163, -0.04933739826083183, -0.013333735056221485, -0.028111742809414864, 0.028653346002101898, -0.022283069789409637, -0.01347558293491602, -0.0013201558031141758, 0.030278151854872704, -0.005164565518498421, -0.021573828533291817, -0.006731343921273947, -0.02602270431816578, 0.007949949242174625, 0.011760508641600609, -0.00825943611562252, -0.0154872490093112, 0.024449478834867477, 0.0027934431564062834, 0.017034685239195824, 0.028111742809414864, 0.008349703624844551, 0.012901742942631245, -0.0011331740533933043, -0.007079517003148794, -0.006518571637570858, 0.00945225078612566, -0.0026725498028099537, 0.002205095486715436, -0.007550195325165987, 0.01881423592567444, -0.03863430395722389, 0.013282153755426407, -0.005583662539720535, -0.0024613894056528807, 0.009336193092167377, 0.0029111127369105816, 0.019536372274160385, 0.04541723057627678, -0.010412951000034809, -0.0006645106477662921, -0.037912167608737946, 0.0364421047270298, -0.004768035374581814, -0.05080746114253998, -0.00254037301056087, 0.006312246900051832, 0.03502362221479416, 0.0123923784121871, 0.00039713477599434555, 0.027621721848845482, -0.039769090712070465, -0.001221023267135024, 0.0838194191455841, -0.022373337298631668, -0.010109911672770977, 0.005706167779862881, 0.032599303871393204, -0.0006552421837113798, -0.011947491206228733, 0.014752217568457127, -0.022012269124388695, -0.009755291044712067, -0.014365358278155327, 0.007588881067931652, -0.03226402774453163, 0.005235489923506975, 0.018582120537757874, 0.019097931683063507, -0.018582120537757874, 0.033398814499378204, -0.032625097781419754, -0.026770632714033127, 0.04933739826083183, -0.014842484146356583, 0.010883629322052002, 0.002253452781587839, 0.008968677371740341, -0.006437975913286209, 0.0410328283905983, -0.014159034006297588, -0.042219195514917374, -0.022347545251250267, -0.003923393320292234, -0.01231500692665577, 0.006173622328788042, -0.010283997282385826, 0.022966520860791206, 0.024552641436457634, -0.013256363570690155, 0.03443043678998947, -0.030432896688580513, 0.022992311045527458, -0.026925375685095787, -0.050781670957803726, -0.011038372293114662, -0.026035601273179054, -0.02221859246492386, 0.05379917100071907, -0.0271317008882761, -0.012456854805350304, -0.0021986477077007294, -0.02443658374249935, -0.020039288327097893, -0.014468520879745483, -0.006209084298461676, 0.015770945698022842, 0.01177340466529131, 0.009336193092167377, 0.03422411158680916, 0.02215411700308323, 0.029556015506386757, 0.06292904168367386, 0.031722426414489746, 0.003849245607852936, -0.02958180569112301, 0.013359525240957737, -0.013540059328079224, 0.012269873172044754, 0.010483874939382076, 0.01945899985730648, 0.04949214309453964, -0.02580348588526249, -0.0036558161955326796, 0.015061704441905022, 0.0038750360254198313, 0.042244985699653625, 0.012882399372756481, -0.0024372106418013573, 0.0005053343484178185, 0.028782298788428307, -0.0014120348496362567, -0.008362598717212677, 0.03486887738108635, 0.010728885419666767, 0.020284298807382584, -0.005567543674260378, -0.014094557613134384, 0.028395438566803932, 0.028266485780477524, -0.018956083804368973, -0.012063547968864441, 0.04748047515749931, 0.034507811069488525, -0.042116034775972366, -0.0053773378022015095, 0.01967822015285492, 0.011328516528010368, 0.009046049788594246, 0.018711073324084282, 0.008652742952108383, -0.020116660743951797, 0.0005557066178880632, -0.04080071300268173, 0.0020374564919620752, -0.017408648505806923, -0.01062572281807661, -0.02159961871802807, -0.003038453869521618, -0.007924159057438374, 0.010400054976344109, -0.0016481798375025392, 0.03375988081097603, -0.001961696660146117, 0.001800505560822785, 0.015177762135863304, 0.018762653693556786, -0.029994456097483635, 0.021509351208806038, -0.05998891219496727, 0.0027160714380443096, 0.01016149204224348, -0.021573828533291817, 0.010503217577934265, -0.008581819012761116, 0.010761124081909657, -0.009381326846778393, -0.01008412055671215, 0.016248071566224098, 0.000212167899007909, -0.0181952603161335, -0.0020455161575227976, 0.03252193331718445, 0.06323852390050888, 0.029220737516880035, -0.02116117812693119, -0.03025236167013645, -0.005470829084515572, 0.020658262073993683, 0.00124359002802521, -0.013172543607652187, 0.03626156970858574, -0.029788130894303322, 0.03205770254135132, 0.009503832086920738, 0.0038524693809449673, 0.005580438766628504, -0.013217677362263203, 0.02991708368062973, -0.0009969675447791815, 0.0010074449237436056, -0.021148283034563065, -0.027363816276192665, -0.007414794526994228, -0.011966833844780922, 0.042683426290750504, -0.013449792750179768, -0.03437885642051697, 0.03035552427172661, 0.004087808541953564, 0.019936125725507736, -0.036493685096502304, 0.01673809252679348, -0.031258195638656616, -0.019949020817875862, -0.01418482419103384, -0.0026129090692847967, -0.014855380170047283, 1.9506651369738393e-05, 0.03360513970255852, 0.0015256745973601937, 0.03378567099571228, -0.025751903653144836, -0.026074286550283432, -0.03394041582942009, 0.010064777918159962, 0.033115118741989136, 0.0001281469885725528, 0.02772488445043564, 0.023649970069527626, -0.02109670266509056, 0.0035268631763756275, 0.003933065105229616, -0.026693260297179222, -0.010245312005281448, 0.010019644163548946, -0.05483079329133034, 0.03971750661730766, 0.02118697017431259, -0.00546115729957819, 0.019381627440452576, -0.008626952767372131, -0.006102698389440775, 0.0010743392631411552, -0.0573582723736763, 0.02125144563615322, 0.015061704441905022, -0.03182558715343475, -0.025442417711019516, 0.01611911877989769, -0.008762353099882603, 0.010928762145340443, 0.011405888013541698, -0.04946635290980339, -0.016080433502793312, -0.016003061085939407, 0.0017344171646982431, 0.006686210632324219, 0.020039288327097893, -0.0007052114233374596, -0.011528393253684044, -0.009168555028736591, -0.0010872345883399248, 0.0016135238111019135, -0.016944417729973793, 0.02264413796365261, -0.011225353926420212, 0.04405032843351364, -0.00018667955009732395, 0.024552641436457634, 0.010058330371975899, -0.030303943902254105, -0.01927846670150757, -0.05258701369166374, -0.04420506954193115, 0.0010791750391945243, -0.025790590792894363, -0.025158720090985298, 0.001254873350262642, -0.01788577437400818, -0.0077178338542580605, 0.01440404448658228, 0.0011629944201558828, 0.008639847859740257, -0.01372059341520071, -0.007234260439872742, 0.02069694921374321, 0.06014365702867508, 0.009677918627858162, -0.019072141498327255, -0.003102930262684822, 0.02963338792324066, 0.043018702417612076, 0.01364322192966938, 0.006982802413403988, -0.011380097828805447, -0.018865816295146942, -0.041135989129543304, 0.03770584240555763, 0.010806256905198097, -0.013282153755426407, 0.006341261323541403, -0.017060475423932076, -0.00022546616673935205, -0.018337110057473183, 0.019497685134410858, 0.016170699149370193, 0.027080118656158447, 0.011057715862989426, -0.017937354743480682, -0.011779852211475372, 0.011644450947642326, -0.01571936532855034, 0.025597160682082176, -0.020155346021056175, -0.008156274445354939, 0.023030996322631836, -0.0035365347284823656, -0.02793120965361595, -0.015951480716466904, 0.02385629527270794, -0.025455312803387642, 0.0037750976625829935, 0.030174989253282547, 0.014287986792623997, -0.007956396788358688, 0.02341785468161106, 0.01989744044840336, -0.018092099577188492, -0.03363092988729477, -0.007775862701237202, 0.009684366174042225, 0.002766040852293372, 0.0026789975818246603, 0.0008881634566932917, 0.014171929098665714, 0.03143873065710068, -0.028859669342637062, -0.00032963597914204, 0.008136930875480175, -0.0036622637417167425, 0.01302424818277359, -0.03969171643257141, 0.00894288718700409, 0.028859669342637062, 0.029968665912747383, 0.023508122190833092, -0.01427509170025587, 0.02582927606999874, -0.01019373070448637, 0.031232403591275215, -0.019936125725507736, -0.021019330248236656, 0.006544362287968397, -0.00034091935958713293, -0.01667361706495285, 0.02069694921374321, -0.0077436245046556, 0.01958795264363289, 0.0032786286901682615, -0.017344171181321144, 0.013217677362263203, 0.016041746363043785, 0.021045120432972908, -0.02960759773850441, 0.022038059309124947, 0.041754964739084244, -0.014803798869252205, -0.015293819829821587, -0.02726065367460251, 0.015848318114876747, -0.00886551570147276, -0.015874108299613, 0.008788143284618855, -0.015732260420918465, -0.026590097695589066, 0.007234260439872742, 0.0018633700674399734, 0.006492780987173319, -0.019626639783382416, 0.03375988081097603, 0.0020793662406504154, 0.009175002574920654, -0.0015450174687430263, 0.02914336696267128, -0.004103927407413721, 0.008949334733188152, -0.007156888488680124, -0.0028240696992725134, -0.027183281257748604, 0.038376398384571075, 0.014494311064481735, 0.022540975362062454, -0.02416578307747841, -0.03205770254135132, -0.0007793593686074018, 0.02317284420132637, -0.0024630012921988964, -0.00478737847879529, 0.0182210523635149, -0.016699407249689102, -0.003091647056862712, 0.009993853978812695, -0.034817297011613846, 0.024462373927235603, -0.03272825852036476, -0.01757628656923771, -0.0005444232374429703, 0.021303027868270874, -0.012437512166798115, 0.016596244648098946, -0.0031174374744296074, 0.035874709486961365, 0.027776464819908142, -0.01645439676940441, -0.03871167451143265, -0.008691429160535336, -0.014687741175293922, -0.014687741175293922, -0.0051742373034358025, -0.016415709629654884, -0.0018794892821460962, -0.02165120095014572, -0.00747282337397337, -0.0302265714854002, -0.030613429844379425, 0.016789674758911133, 0.005254832562059164, 0.03984646126627922, -0.005367666482925415, -0.03551364317536354, -0.015732260420918465, 0.011431679129600525, 0.011876566335558891, 0.017163638025522232, -0.0005831090966239572, 0.03688054531812668, 0.0022663481067866087, 0.030871335417032242, 0.02063247188925743, 0.010367817245423794, -0.00020521653641480953, -0.01983296312391758, -0.0012830818304792047, -0.06143318489193916, -0.03239298239350319, -0.001968144439160824, 0.015177762135863304, -0.005577214993536472, -0.013333735056221485, 0.03130977600812912, 0.04139389842748642, 0.006531466729938984, 0.027157491073012352, 0.015435667708516121, 0.014171929098665714, 0.004761587828397751, -0.00025830886443145573, -0.018027622252702713, 0.01865949109196663, 0.0007684789597988129, 0.020645366981625557, -0.027956999838352203, 0.03829902783036232, -0.018079202622175217, 7.75102944317041e-06, -0.016634929925203323, 0.011470364406704903, 0.023456541821360588, -0.0057158395648002625, -0.010941658169031143, -0.003800888080149889, 0.006321918219327927, 0.008794590830802917, -0.01481669396162033, -0.00720202224329114, -0.01963953487575054, 0.012940428219735622, -0.02710591070353985, -0.001972980098798871, 0.005158117972314358, -0.007801653351634741, 0.019961915910243988, -0.0041812993586063385, 0.001761819701641798, 0.023121263831853867, 0.005316085182130337, -0.001811788883060217, -0.0147264264523983, -0.010090568102896214, 0.002074530581012368, -0.04585566744208336, 0.04134231433272362, -0.0007958814967423677, 0.015151971951127052, 0.022102534770965576, -0.0026419234927743673, 0.01457168348133564, -0.012495541013777256, 0.0032125404104590416, 0.006376723293215036, 0.04281238093972206, 0.010316235944628716, 0.020838797092437744, -0.002622580621391535, 0.009310402907431126, -0.03051026724278927, -0.010167940519750118, 0.017099160701036453, 0.014919856563210487, -0.017150742933154106, 0.0065604811534285545, -0.024797651916742325, 0.03270246833562851, -0.003736411686986685, 0.0154872490093112, 0.016544664278626442, 0.015151971951127052, -0.011218906380236149, -0.03084554523229599, 0.009716604836285114, -0.015590411610901356, -0.0007688819896429777, -0.009413565509021282, -0.005693272687494755, 0.013823756016790867, -0.015306714922189713, 0.0020148898474872112, 0.0449787899851799, -0.021212760359048843, 0.017034685239195824, -0.005261280108243227, 0.008846172131597996, 0.029117576777935028, 0.020954854786396027, -0.016712302342057228, -0.01356585044413805, 0.0076662530191242695, 0.013449792750179768, -0.004697110969573259, -0.019600847736001015, -0.004229656886309385, -0.014094557613134384, 0.03069080226123333, 0.017021790146827698, -0.020877482369542122, -0.014752217568457127, -0.01698310300707817, 0.005899597425013781, 0.009968062862753868, -0.011973281390964985, 0.03383725509047508, 0.02432052604854107, -0.02759593166410923, -0.027157491073012352, -0.06334169209003448, 0.011418784037232399, 0.014442730695009232, -0.004368280991911888, 0.010342026129364967, -0.0024678371846675873, -0.006602391134947538, -0.005209699273109436, -0.0036945019382983446, 0.008001530542969704, -0.005712615791708231, -0.060040492564439774, 0.006512124091386795, -0.0022405574563890696, -0.02790541760623455, 0.01282437052577734, -0.0182210523635149, 0.020813006907701492, -0.007659805007278919, -0.002179304836317897, 0.006373499520123005, 0.013914023526012897, 0.018233947455883026, -0.009961615316569805, 0.007891920395195484, 0.01589989848434925, -0.00432314770296216, 0.01062572281807661, 0.026125866919755936, -0.030329734086990356, -0.02586796134710312, 0.019446104764938354, -0.032160867005586624, -0.03069080226123333, 0.011212458834052086, 0.019046351313591003, 0.005893149878829718, 0.026087181642651558, 0.02361128479242325, 0.018104994669556618, -0.06329010426998138, 0.01862080581486225, 0.014004290103912354, -0.0004980807425454259, 0.02252808026969433, -0.020090868696570396, 0.014778007753193378, 0.018079202622175217, -0.01266962755471468, 0.0031851378735154867, -0.014829589053988457, 0.03332144394516945, -0.016067538410425186, -0.01372059341520071, -0.008130483329296112, -0.01157352700829506, 0.00364292087033391, 0.02849860116839409, -0.03321827948093414, 0.0020455161575227976, 0.004265118855983019, 0.007021488156169653, 0.005673929583281279, 0.026615887880325317, 0.02880808897316456, -0.006105922162532806, 0.011921700090169907, 0.0182210523635149, -0.024294735863804817, 0.014868275262415409, 0.016003061085939407, 0.0077500720508396626, -0.05642981082201004, -0.010354922153055668, -0.023404959589242935, -0.020181136205792427, -0.0271317008882761, 0.002509746700525284, 0.02217990718781948, -0.00845931377261877, -0.010954553261399269, -0.007221365347504616, 0.0024178677704185247, 0.004819616675376892, 0.03473992273211479, -0.05390233173966408, -0.02308257855474949, -0.002935291500762105, 0.01302424818277359, 0.030613429844379425, -0.025468207895755768, -0.009084735065698624, -0.01386244222521782, 0.011019029654562473, 0.020813006907701492, 0.010961000807583332, -0.02867913618683815, -0.006815163418650627, -0.030768172815442085, -0.037602681666612625, -0.005087194032967091, 0.005586886312812567, -0.004468219820410013, 0.024887919425964355, 0.03623577952384949, -0.003107766155153513, -0.01815657503902912, -0.020039288327097893, -0.03100028820335865, -0.013694803230464458, -0.011560631915926933, -0.023366274312138557, 0.026615887880325317, -0.02855018340051174, 0.04809945076704025, 0.0019971588626503944, -0.010696646757423878, 0.02589375153183937, -0.005751301534473896, -0.001383826369419694, 0.009091182611882687]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-15T11:25:02.806049", "url_path": "/testing-evals/", "chunk_size": 3916}
updated_dt: 2025-03-15T11:25:02.807587
---
* [ pydantic_graph.nodes  ](https://ai.pydantic.dev/api/pydantic_graph/nodes/)
    * [ pydantic_graph.state  ](https://ai.pydantic.dev/api/pydantic_graph/state/)
    * [ pydantic_graph.mermaid  ](https://ai.pydantic.dev/api/pydantic_graph/mermaid/)
    * [ pydantic_graph.exceptions  ](https://ai.pydantic.dev/api/pydantic_graph/exceptions/)


Table of contents 
  * [ Unit tests  ](https://ai.pydantic.dev/testing-evals/#unit-tests)
    * [ Unit testing with TestModel  ](https://ai.pydantic.dev/testing-evals/#unit-testing-with-testmodel)
    * [ Unit testing with FunctionModel  ](https://ai.pydantic.dev/testing-evals/#unit-testing-with-functionmodel)
    * [ Overriding model via pytest fixtures  ](https://ai.pydantic.dev/testing-evals/#overriding-model-via-pytest-fixtures)
  * [ Evals  ](https://ai.pydantic.dev/testing-evals/#evals)
    * [ Measuring performance  ](https://ai.pydantic.dev/testing-evals/#measuring-performance)
    * [ System prompt customization  ](https://ai.pydantic.dev/testing-evals/#system-prompt-customization)


# Testing and Evals
With PydanticAI and LLM integrations in general, there are two distinct kinds of test:
  1. **Unit tests** — tests of your application code, and whether it's behaving correctly
  2. **Evals** — tests of the LLM, and how good or bad its responses are


For the most part, these two kinds of tests have pretty separate goals and considerations.
## Unit tests
Unit tests for PydanticAI code are just like unit tests for any other Python code.
Because for the most part they're nothing new, we have pretty well established tools and patterns for writing and running these kinds of tests.
Unless you're really sure you know better, you'll probably want to follow roughly this strategy:
  * Use [`pytest`](https://docs.pytest.org/en/stable/) as your test harness
  * If you find yourself typing out long assertions, use [inline-snapshot](https://15r10nk.github.io/inline-snapshot/latest/)
  * Similarly, [dirty-equals](https://dirty-equals.helpmanual.io/latest/) can be useful for comparing large data structures
  * Use [`TestModel`](https://ai.pydantic.dev/api/models/test/#pydantic_ai.models.test.TestModel) or [`FunctionModel`](https://ai.pydantic.dev/api/models/function/#pydantic_ai.models.function.FunctionModel) in place of your actual model to avoid the usage, latency and variability of real LLM calls
  * Use [`Agent.override`](https://ai.pydantic.dev/api/agent/#pydantic_ai.agent.Agent.override) to replace your model inside your application logic
  * Set [`ALLOW_MODEL_REQUESTS=False`](https://ai.pydantic.dev/api/models/base/#pydantic_ai.models.ALLOW_MODEL_REQUESTS) globally to block any requests from being made to non-test models accidentally


### Unit testing with `TestModel`
The simplest and fastest way to exercise most of your application code is using [`TestModel`](https://ai.pydantic.dev/api/models/test/#pydantic_ai.models.test.TestModel), this will (by default) call all tools in the agent, then return either plain text or a structured response depending on the return type of the agent.
`TestModel` is not magic
The "clever" (but not too clever) part of `TestModel` is that it will attempt to generate valid structured data for [function tools](https://ai.pydantic.dev/tools/) and [result types](https://ai.pydantic.dev/results/#structured-result-validation) based on the schema of the registered tools.
There's no ML or AI in `TestModel`, it's just plain old procedural Python code that tries to generate data that satisfies the JSON schema of a tool.
The resulting data won't look pretty or relevant, but it should pass Pydantic's validation in most cases. If you want something more sophisticated, use [`FunctionModel`](https://ai.pydantic.dev/api/models/function/#pydantic_ai.models.function.FunctionModel) and write your own data generation logic.
Let's write unit tests for the following application code:
weather_app.py