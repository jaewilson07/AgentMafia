---
url: https://ai.pydantic.dev/examples/flight-booking/
session_id: pydantic_ai_docs
chunk_number: 2
title: Flight Booking Example using Pydantic
summary: This document provides an example of creating a flight booking system using Pydantic. It includes the definition of data models for flight details and handling scenarios when no flights are found, along with configuration settings for logging.
embedding: [-0.048920340836048126, -0.023981662467122078, 0.06001045182347298, -0.06254372745752335, 0.008233141154050827, -0.023024648427963257, -0.03265108913183212, 0.04165828600525856, 0.018450681120157242, 0.04084201157093048, 0.006948912050575018, -0.022630583494901657, -0.017803288996219635, -0.012624150142073631, -0.044473037123680115, -0.019717317074537277, -0.013750049285590649, 0.009457557462155819, -0.027781574055552483, 0.03833688423037529, 0.06096746772527695, 0.006167819257825613, 0.004018054343760014, -0.012596002779901028, -0.029526717960834503, 0.03132815659046173, 0.036282118409872055, 0.020308414474129677, -0.00036899602855555713, -0.025557922199368477, 0.08297880738973618, -0.015818890184164047, 0.01305339951068163, -0.0024523502215743065, -0.016072217375040054, -0.02761268988251686, -0.007817965932190418, 0.08494912832975388, -0.006512626074254513, -0.034536972641944885, 0.01574852131307125, -0.00560135068371892, 0.025825323536992073, -0.014636695384979248, -0.052889134734869, 0.03349551558494568, 0.006030600052326918, 0.057533472776412964, 0.022616509348154068, 0.008732759393751621, -0.03585990518331528, 0.0078038922511041164, -0.01673368364572525, 0.0017169970087707043, -0.01671960949897766, -0.003572972258552909, -0.02648678980767727, 0.0026898446958512068, 0.030821504071354866, 0.002584291622042656, 0.026374200358986855, -0.00039736341568641365, 0.004943403415381908, 0.05547870695590973, -0.034368086606264114, 0.016987010836601257, 0.00520728575065732, -0.00371898734010756, -0.007902408018708229, 0.015847038477659225, 0.00338297663256526, 0.021293576806783676, -0.008549800142645836, -0.047006309032440186, -0.016241103410720825, -0.012800071388483047, 0.07290200144052505, 0.05854678153991699, -0.018788451328873634, -0.0820217877626419, -0.01274377666413784, 0.017015159130096436, -0.01712774857878685, 0.012011942453682423, 0.0018067171331495047, -0.05435280501842499, -0.07369013130664825, -0.01677590422332287, -0.03360810503363609, -0.06355703622102737, -0.055788327008485794, -0.0022817060817033052, -0.01657887175679207, 0.003492048243060708, 0.060404516756534576, 0.05190397426486015, 0.019773613661527634, -0.00895090214908123, -0.018549196422100067, 0.00043012885726056993, 0.014376331120729446, -0.037830229848623276, -0.056576456874608994, 0.019126219674944878, 0.012075274251401424, -0.032622940838336945, -0.00574912503361702, 0.043487872928380966, -0.044473037123680115, -0.003467419184744358, -0.06518959254026413, 0.04303751513361931, -0.005882825702428818, 0.029273390769958496, -0.04531745985150337, 0.020730627700686455, -0.06445775926113129, -0.017662551254034042, 0.014918170869350433, 4.312833334552124e-05, -0.07656117528676987, -0.011779725551605225, 0.00835980474948883, -0.0060622659511864185, 0.012694519013166428, 0.0012393692741170526, -0.03287627175450325, -0.07042502611875534, -0.040222764015197754, 0.0014777432661503553, 0.04616188630461693, 0.008036108687520027, 0.047766294330358505, -0.03712654113769531, -0.020758774131536484, -0.0074450112879276276, -0.04559893533587456, 0.016466282308101654, -0.00753649091348052, -0.0003780120168812573, -0.013869676738977432, 0.010815673507750034, 0.002105784136801958, 0.024840161204338074, -0.04793517664074898, 0.02099802903831005, -0.022419476881623268, 0.023587597534060478, -0.06029192730784416, 0.04365675896406174, 0.01487594936043024, -0.022700952365994453, -0.05235433578491211, 0.003810466732829809, 0.00166685925796628, -0.01714182272553444, 0.025600142776966095, 0.026711968705058098, 0.02785194292664528, -0.012026015669107437, -0.017606256529688835, 0.016663314774632454, -0.029526717960834503, -0.02921709604561329, -0.02395351603627205, -0.016227029263973236, -0.037830229848623276, -0.023263901472091675, -0.06935542076826096, -0.06423257291316986, 0.0006856552790850401, -0.027894163504242897, -0.008247215300798416, -0.004225641954690218, 0.011251959949731827, -0.03723913058638573, 0.026036430150270462, -0.01612851209938526, -0.02104024961590767, -0.00030544426408596337, -0.026585305109620094, -0.008957939222455025, -0.053029872477054596, -0.055394262075424194, -0.05961638689041138, 0.003242239123210311, 0.014362257905304432, 0.026163093745708466, 0.0003195180033799261, 0.03056817501783371, 0.06856729090213776, -0.007068539038300514, 0.03507177531719208, 0.017240338027477264, -0.030821504071354866, -0.003092705737799406, 0.03405846655368805, -0.011287144385278225, 0.03754875436425209, 0.006009489297866821, -0.019520284608006477, 0.015424825251102448, 0.026233462616801262, -0.03276367858052254, -0.0005282052443362772, 0.0005809818394482136, -0.028175638988614082, -0.018563270568847656, 0.00047674812958575785, 0.026937149465084076, 0.05432466045022011, -0.00686446949839592, 0.019421769306063652, -0.01769069768488407, -0.052663955837488174, 0.008155735209584236, -0.035493988543748856, -0.06130523607134819, 0.013672644272446632, 0.01787365786731243, -0.01747959293425083, -0.0020459708757698536, 0.022686878219246864, -0.044698216021060944, 0.003192981006577611, 0.028682293370366096, 0.01929510571062565, -0.013757086358964443, -0.015213719569146633, 0.006882061716169119, -0.005024327430874109, 0.0012121013132855296, -0.036676179617643356, -0.005520426668226719, 0.061755597591400146, -0.01276488695293665, 0.0023362417705357075, -0.032594796270132065, -0.007832039147615433, 0.008760906755924225, -0.01812698505818844, -0.009091639891266823, -0.014411515556275845, 0.025783102959394455, 0.027978606522083282, -0.015101129189133644, -0.039800554513931274, -0.059447500854730606, 0.05798383429646492, 0.04509228095412254, 0.04421970993280411, -0.002359111560508609, -0.004507116973400116, -0.06789174675941467, 0.0020530077163130045, -0.008127587847411633, -0.03481844812631607, -0.002601883839815855, 0.00806425604969263, -0.014636695384979248, -0.006924282759428024, 0.06355703622102737, -0.0330733023583889, 0.06462664157152176, -0.009753106161952019, -0.02025211974978447, 0.010520124807953835, -0.012026015669107437, -0.026317903771996498, -0.029864488169550896, -0.023995736613869667, 0.03600064292550087, 0.020674332976341248, -0.008979049511253834, -0.06029192730784416, -0.0358317568898201, -0.009781253524124622, 0.011765651404857635, -0.005784309469163418, -0.03056817501783371, -0.02606457658112049, 0.033945873379707336, 0.04177087917923927, -0.006681510712951422, 0.01617073453962803, 0.01361634861677885, 0.04027906060218811, -0.015734447166323662, -0.04861071705818176, 0.020083235576748848, 0.027176402509212494, 0.011427881196141243, 0.007613896392285824, -0.03251035138964653, 0.027767499908804893, -0.0035888052079826593, 0.028569703921675682, 0.005678756628185511, 0.008402026258409023, 0.012441190890967846, 0.0031102977227419615, -0.019140293821692467, -0.019154367968440056, -0.029076358303427696, 0.005136917345225811, 0.047006309032440186, 0.02941412851214409, 0.02142024040222168, 0.030230406671762466, -0.0009499778388999403, -0.0035465839318931103, 0.06597772240638733, -0.016972936689853668, -0.03971610963344574, -0.030399290844798088, -0.03448067605495453, 0.05553499981760979, 0.0007072057342156768, 0.03130001202225685, -0.03054002858698368, 0.009696810506284237, -0.03211628645658493, 0.04247456416487694, 0.02994893118739128, -0.015495194122195244, -0.015396677888929844, 0.020195825025439262, 0.02899191714823246, -0.027176402509212494, 0.021940968930721283, -0.009978285990655422, -0.022306887432932854, -0.0009614127338863909, -0.008613132871687412, -0.007156499661505222, -0.025065341964364052, -0.03737986832857132, -0.0057104225270450115, -0.01527001429349184, 0.04489525035023689, -0.016691463068127632, -0.01244822796434164, -0.05004623904824257, 0.0019017149461433291, -0.028963768854737282, 0.007832039147615433, 0.022869836539030075, 0.012736739590764046, 0.014566326513886452, 0.02104024961590767, -0.03870280086994171, 0.04044794663786888, -0.023672040551900864, 0.05502834543585777, -0.04996179789304733, -0.05621054023504257, 0.03037114255130291, 0.021251356229186058, -0.03225702419877052, 0.0272326972335577, -0.05933491140604019, 0.014664842747151852, 0.008148699067533016, -0.02416462078690529, -0.0012534429552033544, 0.02337649092078209, -0.03211628645658493, -0.003880835371091962, -0.022532066330313683, 0.02589569240808487, 0.04064497724175453, -0.013208210468292236, -0.02182837948203087, 0.006466886028647423, -0.021349871531128883, -0.02662752754986286, -0.030427439138293266, 0.03518436476588249, -0.018549196422100067, 0.04112348333001137, 0.024432022124528885, -0.03186295926570892, 0.004102496895939112, -0.04588041082024574, 0.02492460422217846, 0.006681510712951422, -0.018521049991250038, -0.011723429895937443, -0.015818890184164047, 0.024474244564771652, 0.05021512508392334, -0.043290842324495316, 0.026430495083332062, -0.017437370494008064, -0.011153443716466427, -0.0038702799938619137, 0.05201656371355057, 0.09097269177436829, -0.004528227727860212, -0.0069770594127476215, -0.013271542266011238, -0.02941412851214409, 0.01791587844491005, 0.019618801772594452, -0.04731593281030655, 0.007944629527628422, 0.03329848125576973, -0.00045783654786646366, -0.006924282759428024, 0.005140435416251421, 0.03605693578720093, -0.03929389640688896, 0.014988538809120655, -0.012553781270980835, 0.02491053007543087, -0.005590795539319515, 0.019604727625846863, 0.02140616811811924, 0.037886522710323334, 0.029723750427365303, -0.006361333187669516, -0.03054002858698368, 0.011047890409827232, 0.028696367517113686, -0.06468293815851212, 0.02921709604561329, 0.06130523607134819, -0.015537415631115437, 0.013679681345820427, -0.033579956740140915, -0.026317903771996498, -0.009183119051158428, 0.03602878749370575, 0.037070244550704956, -0.04360046610236168, -0.01885882019996643, -0.005393763072788715, 0.02453053928911686, -0.03034299612045288, -0.019365474581718445, 0.018380312249064445, -0.05804012715816498, 0.034931037575006485, 0.014242630451917648, -0.046612247824668884, 0.0009341448894701898, -0.003975833300501108, 0.0039793518371880054, 0.03169407695531845, 0.012455265037715435, 0.002805953146889806, -0.034565120935440063, -0.012293417006731033, 0.003321404103189707, -0.027317140251398087, -0.07903815805912018, 0.04027906060218811, -0.023066869005560875, 0.08489283174276352, -0.02918894961476326, 0.021279504522681236, 0.04725963994860649, -0.02551570162177086, 0.020519521087408066, -0.002338001038879156, 0.003064558142796159, 0.018605491146445274, -0.03236961364746094, 0.008641280233860016, -0.0071424259804189205, 0.020969880744814873, -0.03678877279162407, -0.0020829143468290567, -0.003954722546041012, -0.0074239009991288185, -0.008718685247004032, 0.015734447166323662, -0.010696046985685825, -0.02022397331893444, -0.00886646006256342, 0.026768265292048454, -0.010372350923717022, 0.008219067938625813, 0.0053796893917024136, 0.009035345166921616, 0.06305038183927536, 0.02084321714937687, -0.04540190473198891, -0.04996179789304733, -0.006157263647764921, -0.01264526043087244, 0.046640392392873764, 0.006364851724356413, -0.017029233276844025, -0.0018700489308685064, -0.01410189364105463, -0.01556556299328804, -0.001945695374161005, 0.010393461212515831, -0.04044794663786888, 0.010864932090044022, -0.05294543132185936, 0.019379548728466034, 0.00875386968255043, 0.028851179406046867, -0.014890022575855255, -0.012370822951197624, -0.03735172003507614, -0.018985483795404434, 0.002104025101289153, -0.015650006011128426, 0.007131870836019516, -0.009211266413331032, 0.010541236028075218, -0.005668201018124819, 0.02527644671499729, -0.007740559987723827, 0.021265430375933647, -0.04571152478456497, 0.00972495786845684, 0.024403875693678856, -0.0463307723402977, -0.001344042713753879, 0.009457557462155819, -0.022729098796844482, 0.0013950600987300277, 0.005386725999414921, -0.01653665117919445, -0.006357814650982618, -0.006903172470629215, 0.024952750653028488, -0.005221359897404909, -0.02761268988251686, 0.04489525035023689, -0.040982749313116074, 0.01870400831103325, 0.017029233276844025, 0.018577344715595245, -0.046584099531173706, -0.017972173169255257, -0.00855683721601963, 0.020688407123088837, -0.039406489580869675, -0.02685270644724369, 0.0013616349315270782, -0.028471188619732857, 0.035493988543748856, 0.023235755041241646, -0.01908399909734726, -0.009534962475299835, 0.029892636463046074, 0.014390405267477036, 0.014214483089745045, -0.039406489580869675, -0.006298001389950514, 0.04337528347969055, -0.004932847805321217, -0.04883589595556259, 0.017015159130096436, -0.02431943267583847, 0.008029071614146233, -0.00992199033498764, 0.01294080913066864, 0.013243394903838634, -0.044444888830184937, 0.03889983147382736, 0.023784630000591278, 0.03566287085413933, -0.014932244084775448, -0.00865535344928503, -0.009415335953235626, -0.022461697459220886, 0.016438135877251625, -0.006635771133005619, 0.035691019147634506, -0.0032334430143237114, 0.03177851811051369, -0.03217258304357529, -0.009105713106691837, 0.017184043303132057, -0.013658570125699043, 0.008036108687520027, 0.011519361287355423, 0.018183279782533646, -0.026388272643089294, -0.033411070704460144, 0.0003478853905107826, -0.004204531665891409, -0.016621094197034836, -0.013327836990356445, 0.0065091075375676155, -0.002288742922246456, -0.00837387889623642, -0.004788591992110014, -0.04824480041861534, 0.02257428877055645, -0.01108307484537363, 0.03563472256064415, -0.02339056506752968, 0.025600142776966095, 0.017831435427069664, -0.019801760092377663, -0.03324218839406967, 0.012919698841869831, -0.011850093491375446, 0.00252975570037961, 0.040194619446992874, 0.02279946766793728, -0.013440427370369434, -0.006090413313359022, -0.0033776990603655577, 0.008099440485239029, 9.191915160045028e-05, -0.05837789922952652, -0.00729020033031702, 0.01750773936510086, -0.06721621006727219, -0.027739353477954865, 0.03771764039993286, -0.02624753676354885, 0.014735211618244648, -0.006780026946216822, 0.012673407793045044, 0.008760906755924225, 0.005326912738382816, -0.01322228368371725, -0.03566287085413933, -0.026571232825517654, -0.007986851036548615, -0.010893079452216625, -0.03236961364746094, 0.06406369060277939, 0.02139209397137165, 0.011026780121028423, 0.00013183141709305346, -0.01673368364572525, 0.04588041082024574, -0.006804656237363815, -0.014341146685183048, -0.0017794492887333035, 0.014988538809120655, 0.02315131202340126, 0.010759378783404827, -0.032397761940956116, -0.005566166248172522, -0.013025252148509026, -0.02882303111255169, 0.010879005305469036, 0.027978606522083282, -0.002081155078485608, 0.0007982452516444027, -0.021448388695716858, 0.010752341710031033, 0.023109091445803642, 0.04728778451681137, 0.008289435878396034, -0.029132653027772903, -0.03954722732305527, 0.00525654386729002, 0.01866178773343563, -0.04669668897986412, 0.045627083629369736, -0.004172865767031908, 0.01276488695293665, -0.02104024961590767, 0.01849290169775486, 0.030202258378267288, 0.007993887178599834, 0.00885238591581583, 0.013151915743947029, -0.03484659269452095, 0.01579074189066887, 0.00729020033031702, 0.01051308773458004, -0.007050946820527315, -0.00364510016515851, -0.0016360729932785034, -0.023460933938622475, -0.0378020815551281, 0.04129236936569214, -0.0350436270236969, 0.019900277256965637, -0.056745342910289764, 0.01790180429816246, 0.02764083631336689, -0.008514616638422012, -0.011456029489636421, -0.024488316848874092, -0.010583456605672836, 0.04588041082024574, -0.0028903954662382603, 0.01847882755100727, -0.0008158374694176018, 0.005112288054078817, -0.0018260685028508306, 0.01449595857411623, -0.042502712458372116, 0.029920782893896103, -0.005077103618532419, -0.03524065762758255, -0.022278739139437675, 0.027542321011424065, 0.007184647023677826, -0.023700186982750893, -0.02721862494945526, -0.013778196647763252, -0.008071293123066425, 0.0036063974257558584, 0.009605331346392632, -0.0381961464881897, -0.0003412883379496634, 0.013665607199072838, -0.02042100578546524, -0.00030170593527145684, -0.013524869456887245, 0.024023884907364845, -0.023207606747746468, 0.01635369285941124, 0.0017565793823450804, -0.00738871656358242, -0.0322851724922657, 0.028330450877547264, 0.015129276551306248, -0.0007846113294363022, -0.022644657641649246, -0.030849650502204895, -0.016424061730504036, 0.027387509122490883, 0.00015723012620583177, -0.011118259280920029, 0.030061520636081696, -0.01712774857878685, 0.025389038026332855, -0.012884514406323433, 0.004148236475884914, -0.013700791634619236, -0.05550685152411461, 0.04025091230869293, -0.021363945677876472, 0.03217258304357529, 0.012947846204042435, -0.04244641587138176, 0.0022271701600402594, -0.0032439983915537596, 0.003996943589299917, -0.01966102235019207, -0.006867988035082817, 0.03878724202513695, -0.033579956740140915, 0.022658729925751686, -0.01870400831103325, 0.012997103855013847, 0.012300454080104828, -0.056323129683732986, 0.018239574506878853, 0.01826772280037403, 0.013165988959372044, 0.01982990838587284, -0.02955486625432968, 0.009696810506284237, -0.005766717251390219, 0.033974021673202515, -0.0007837316952645779, 0.0029062284156680107, -0.017071453854441643, 0.006808174308389425, -0.0008052821503952146, -0.024783866479992867, 0.006375406868755817, 0.016227029263973236, -0.04607744514942169, -0.023010574281215668, -0.00932385679334402, 0.030877798795700073, 0.03332662954926491, -0.044698216021060944, 0.0024945714976638556, -0.003192981006577611, 0.016705535352230072, -0.005907454993575811, 0.023010574281215668, 0.0068116928450763226, 0.010379387065768242, -0.013173026032745838, 0.011033816263079643, -0.03957537189126015, -0.015635931864380836, 0.005231915041804314, -7.597623334731907e-05, -0.037886522710323334, -0.004595078062266111, -0.00024211240815930068, 0.009302745573222637, 0.00545357633382082, -0.02198319137096405, 0.0006882941233925521, 0.0004714704700745642, -0.10949373990297318, -0.003880835371091962, 0.008289435878396034, 0.02043507806956768, 0.028851179406046867, 0.0076561179012060165, 0.03808355703949928, 0.0479070320725441, -0.020519521087408066, -0.04461377486586571, 0.011448992416262627, -0.009014233946800232, -0.013173026032745838, -0.028527483344078064, 0.03642285242676735, 0.01061160396784544, 0.009105713106691837, 0.06147412210702896, 0.03597249463200569, -0.03000522591173649, -0.02455868571996689, 0.004637299105525017, -0.05967268347740173, 0.015354456380009651, 0.0017574590165168047, 0.0037295427173376083, -0.021701715886592865, 0.006210040301084518, -0.001126779243350029, -0.023854998871684074, 0.002009027171880007, -0.043516021221876144, -0.0007564638508483768, 0.014059672132134438, 0.006188929546624422, 0.055394262075424194, -0.013208210468292236, -0.008732759393751621, 0.009626442566514015, -0.00496099516749382, 0.001215619733557105, 0.017409224063158035, 0.047428522258996964, 0.014165225438773632, 0.037464309483766556, -0.03312959894537926, -0.011814909987151623, -0.04230567812919617, 0.016198880970478058, -0.0018207908142358065, 0.04360046610236168, -0.004535264801234007, 0.0024242026265710592, 0.004098978359252214, -0.013299689628183842, 0.035128068178892136, -0.03664803504943848, 0.012018978595733643, -0.014094856567680836, -0.008451283909380436, 0.009584221057593822, 0.000631119532044977, 0.009126824326813221, -0.031468894332647324, -0.01080863643437624, 0.011118259280920029, -0.02838674560189247, 0.005045437719672918, -0.017620328813791275, 0.008050182834267616, -0.028851179406046867, 0.014510031789541245, 0.007867223583161831, 0.007888334803283215, -0.04379749670624733, 0.01826772280037403, 0.020786922425031662, 0.020533595234155655, -0.025149783119559288, -0.015523341484367847, 0.031102977693080902, -0.023249827325344086, 0.016832200810313225, -0.0037717637605965137, -0.02177208475768566, 0.023306123912334442, 0.029723750427365303, 0.021096544340252876, -0.003947685472667217, 0.010864932090044022, 0.018422532826662064, 0.012089347466826439, -0.027570467442274094, 0.010323092341423035, -0.02040693163871765, 0.03850577026605606, -0.02392536774277687, 0.023798704147338867, 0.019815834239125252, -0.003198258811607957, 0.024389801546931267, -0.0010212261695414782, 0.0013598756631836295, 0.007740559987723827, 3.249056317145005e-05, 0.018352163955569267, -0.017043305560946465, -0.047569260001182556, -0.02236318215727806, 0.020758774131536484, -0.010372350923717022, 0.01733885519206524, -0.016072217375040054, 0.05297357961535454, -0.033411070704460144, -0.003627507947385311, 0.0280208270996809, -0.01792995259165764, -0.027303066104650497, 0.00763500714674592, 0.01574852131307125, 0.012103421613574028, -0.0008131986251100898, 0.05080622062087059, -0.03014596365392208, -0.006685029249638319, -0.01088604237884283, 0.0025315149687230587, -0.03811170533299446, 0.012800071388483047, 0.0021779120434075594, 0.0020969880279153585, -0.015115203335881233, -0.00826128851622343, 0.028935620561242104, -0.001982638845220208, 0.06789174675941467, -0.020167678594589233, 0.022320961579680443, -0.009119787253439426, 0.01061160396784544, 0.01305339951068163, -0.01294080913066864, 0.001768014277331531, -0.021645421162247658, 0.012574891559779644, 0.0033530700020492077, -0.007170573342591524, -0.037858374416828156, 0.025614216923713684, 0.008859422989189625, -0.003701395122334361, -0.00012138605961808935, 0.007001688703894615, -0.023657966405153275, 0.011118259280920029, -0.006857432425022125, -0.04101089388132095, -0.0002061583800241351, -0.01363042276352644, -0.002345037879422307, 0.04286862909793854, 0.016255175694823265, 0.008936828933656216, 0.038815390318632126, -0.00924645084887743, -0.0517069436609745, 0.013405242934823036, 0.007613896392285824, 0.01731070689857006, -0.02645864151418209, -0.00807833019644022, 0.01832401752471924, -0.02548755332827568, 0.0322851724922657, 0.050693631172180176, 0.03135630488395691, 0.01078752614557743, 0.028091195970773697, 0.04655595123767853, -0.01963287591934204, 0.019520284608006477, -0.010738267563283443, -0.0038210218772292137, 0.05370541289448738, 0.03605693578720093, 0.002828822936862707, 0.024460170418024063, 0.015424825251102448, 0.003972314763814211, 0.029442276805639267, 0.033411070704460144, 0.007874260656535625, 0.04084201157093048, -0.01826772280037403, 0.015382603742182255, 0.03388958051800728, -0.0008844469557516277, -0.018000321462750435, 0.011484176851809025, 0.06631548702716827, -0.001804957864806056, 0.0047780368477106094, 0.019773613661527634, -0.008859422989189625, 0.010245687328279018, -0.015579636208713055, -0.02471349760890007, -0.008922754786908627, 0.0007349133957177401, -0.023460933938622475, 0.0014592715306207538, -0.015734447166323662, -0.010879005305469036, 0.01925288513302803, 0.013074509799480438, -0.009971248917281628, -0.014608548022806644, -0.034705858677625656, -0.027176402509212494, -0.046190034598112106, -0.01695886440575123, -0.008584984578192234, 0.018352163955569267, 0.027880091220140457, 0.009429410099983215, -0.008127587847411633, 0.013820418156683445, 0.019590653479099274, 0.023418713361024857, -0.014383368194103241, 0.0019967127591371536, -0.011941573582589626, -0.0004261706199031323, 0.017198117449879646, -0.01234971173107624, 0.0034339940175414085, -0.007068539038300514, 0.008219067938625813, 0.0007925278041511774, 0.01177268847823143, 0.017803288996219635, -0.003015300026163459, -0.018619565293192863, 0.044444888830184937, 0.0017988006584346294, 0.037464309483766556, 0.02275724709033966, 0.01139973383396864, 0.022883910685777664, 0.02955486625432968, 0.01674775779247284, 0.012117494828999043, -0.013574128039181232, 0.01809883676469326, 0.00023881386732682586, 0.0005765837850049138, 0.03656359016895294, -0.012208973988890648, -0.015030760318040848, -0.025754954665899277, 0.01536853052675724, -0.02785194292664528, 0.011582693085074425, -0.00743797468021512, -0.01884474605321884, -0.015706300735473633, 0.03692951053380966, 0.013405242934823036, 0.00371898734010756, -0.04768184944987297, 0.013165988959372044, 0.00026124389842152596, -0.008402026258409023, 0.0033776990603655577, -0.01432003639638424, -0.006403554230928421, -0.013771160505712032, 0.0034164017997682095, -0.01458040066063404, -0.0286119244992733, -0.005657645873725414, 0.015227792784571648, -0.003173629753291607, 0.031046682968735695, 0.007902408018708229, -0.0010414571734145284, -0.05494390428066254, 0.015298161655664444, -0.0012332119513303041, 0.03000522591173649, 0.0010396980214864016, 0.008831275627017021, -0.015621857717633247, -0.01439744234085083, 0.008817201480269432, 0.020139530301094055, 0.017001084983348846, -0.008148699067533016, 0.0016272768843919039, 0.019604727625846863, 0.03113112598657608, -0.0025878099258989096, 0.0024945714976638556, 0.009570146910846233, 0.02994893118739128, -0.008134624920785427, -0.010344203561544418, 0.00027355842757970095, 0.004070830997079611, -0.015340383164584637, -0.03847762197256088, 0.03729542717337608, -0.003541306359693408, -0.007262052968144417, 0.026008281856775284, -0.006945393513888121, 0.005534500349313021, -0.024629054591059685, 0.02451646514236927, 0.014270777814090252, 0.031440749764442444, 0.01618480682373047, 0.011864167638123035, 0.004162310156971216, -0.005889862775802612, -0.007902408018708229, 0.03535325080156326, 0.0011584451422095299, -0.013454500585794449, 0.04261530190706253, 0.013700791634619236, -0.008620169013738632, 0.00865535344928503, -0.04551449418067932, -0.022897984832525253, -0.01890104077756405, -0.004440266638994217, -0.02745787799358368, -0.028077123686671257, -0.015509268268942833, -0.03076520748436451, -0.02260243520140648, 0.0023063351400196552, -0.004647854715585709, 0.033354777842760086, -0.009858658537268639, 0.024980898946523666, 0.020955806598067284, 0.021293576806783676, 0.08117736876010895, 0.019886203110218048, -0.02744380384683609, 0.03290441632270813, 0.014847801998257637, 0.00047454910236410797, 0.024375727400183678, 0.03251035138964653, -0.018183279782533646, 0.00826128851622343, -0.021884674206376076, 0.03093409352004528, 0.020533595234155655, 0.0069594671949744225, 0.034368086606264114, 0.01909807324409485, 0.023489082232117653, 0.00022419037122745067, 0.03017411008477211, -0.0015912129310891032, 0.022672804072499275, 0.028175638988614082, 0.019506212323904037, -0.017395149916410446, 0.01068900991231203, 0.0010836784495040774, -0.004897663369774818, -0.033017005771398544, 0.030117815360426903, 0.03935019299387932, 0.023714261129498482, -0.03763319551944733, -0.0002744380326475948, -0.01363042276352644, -0.04534560814499855, -0.01847882755100727, 0.01351783238351345, 0.026149019598960876, 0.01747959293425083, 0.003859724849462509, -0.034142907708883286, 0.020688407123088837, -0.0019896759185940027, -0.000357561104465276, 0.0004960995283909142, 0.030652618035674095, -0.017240338027477264, -0.021729864180088043, 0.0009332652552984655, -0.0032299247104674578, 0.017662551254034042, 0.01693071611225605, -0.015044834464788437, -0.022335033863782883, -0.04303751513361931, -0.015593710355460644, -0.0038210218772292137, 0.01331376377493143, -0.01226526964455843, 0.030117815360426903, -0.03113112598657608, -0.02416462078690529, 0.02022397331893444, 0.04922996088862419, -0.0034797335974872112, -0.052860990166664124, 0.010006433352828026, 0.019604727625846863, -0.01351783238351345, 0.036479149013757706, -0.01612851209938526, -0.03428364545106888, -0.0008879653760232031, 0.008148699067533016, 0.002983634127303958, 0.027570467442274094, 0.008824238553643227, -0.01430596224963665, -0.0021515239495784044, 0.007599822711199522, -0.002362630097195506, -0.0061115240678191185, 0.016494430601596832, -0.00886646006256342, -0.01597370207309723, -0.029245244339108467, 0.024389801546931267, 0.01771884597837925, -0.03721098229289055, 0.011526397429406643, 0.004123607650399208, -0.007951666601002216, 0.003884353907778859, -0.013074509799480438, 0.012610075995326042, 0.018380312249064445, -0.00028147490229457617, 0.015579636208713055, -0.010435682721436024, -0.009309782646596432, 0.047034457325935364, -0.007993887178599834, -0.011266033165156841, 0.022264664992690086, -0.04886404424905777, 0.02761268988251686, -0.03645100072026253, 0.0010599290253594518, -0.015101129189133644, -0.020139530301094055, -0.039237603545188904, -0.004025091417133808, 0.006350777577608824, -0.008915717713534832, -0.022475771605968475, 0.008127587847411633, -0.004440266638994217, -0.0031877034343779087, 0.0019544914830476046, -0.030061520636081696, -0.009598294273018837, -0.006153745111078024, 0.01296191941946745, -0.012624150142073631, -0.014151151292026043, 0.014425589703023434, -0.013194136321544647, 0.0007305153412744403, 0.006832803599536419, -0.02396758832037449, -0.016663314774632454, -0.004440266638994217, 0.015692226588726044, 0.026331977918744087, 0.012511559762060642, -0.012223048135638237, -0.00602708151564002, -0.010379387065768242, -0.016015922650694847, 0.008127587847411633, -0.019914349541068077, 0.016100365668535233, -0.006639289669692516, -0.04264345020055771, -0.0013976988848298788, 0.00036085964529775083, -0.00490821897983551, -0.037267278879880905, 0.005397281609475613, 0.0009464594186283648, 0.015227792784571648, 0.001580657553859055, 0.020955806598067284, 0.0048659974709153175, 0.006931319832801819, -0.02336241863667965, 0.02820378728210926, -0.03645100072026253, -0.030455585569143295, -0.019984718412160873, -0.02158912643790245, 0.011962683871388435, 0.010871968232095242, -0.01040753535926342, -0.007606859784573317, 0.01633961871266365, 0.0008541004499420524, -0.0013422834454104304, 0.00666743703186512, 0.009471630677580833, 0.009380151517689228, -0.016086291521787643, 0.00355538004077971, 0.01714182272553444, 0.008957939222455025, -0.005133398808538914, 0.030483733862638474, -0.005041919648647308, 0.007304274011403322, -0.019576581194996834, -0.009021271020174026, -0.014467810280621052, 0.028077123686671257, -0.019013630226254463, -0.00282530440017581, 0.020097309723496437, -0.02567051164805889, -0.0017908841837197542, -0.004517672583460808, -0.03391772881150246, 0.030821504071354866, -0.020097309723496437, 0.01594555377960205, -0.017578108236193657, 0.04379749670624733, 0.002665215637534857, -0.033185891807079315, 0.008634243160486221, 0.02219429798424244, 0.023446859791874886, -0.030849650502204895, -0.008986086584627628, -0.025966061279177666, 0.0052635809406638145, -0.021152839064598083, -0.00386676169000566, -0.012230085209012032, -0.004271382000297308, 0.01594555377960205, 0.022461697459220886, -0.018999556079506874, 0.03138445317745209, 0.031187420710921288, -0.004324158187955618, 0.043347135186195374, -0.014538179151713848, 0.022729098796844482, 0.02526237443089485, -0.006593550089746714, -0.04208049923181534, 0.007663154508918524, 0.009408298879861832, -0.0009007197222672403, -0.019914349541068077, -0.01080160029232502, 0.00826128851622343, 0.04219308868050575, 0.008746832609176636, 0.020786922425031662, -0.02020989917218685, 0.031187420710921288, 0.011033816263079643, 0.004095459822565317, -0.017437370494008064, 0.016846273094415665, -0.008704612031579018, -0.014735211618244648, 0.023460933938622475, 0.0427841879427433, -0.01090715266764164, 0.02605050429701805, 0.04928625747561455, -0.019548432901501656, 0.03172222152352333, -0.02315131202340126, 0.01908399909734726, 0.028879325836896896, 0.025248300284147263, 0.009035345166921616, -0.007089649327099323, 0.017352929338812828, -0.02935783378779888, -0.01826772280037403, -0.03895612806081772, 0.014988538809120655, -0.03014596365392208, -0.01731070689857006, -0.011392696760594845, -0.015692226588726044, -0.010287907905876637, 0.011723429895937443, -0.0037049136590212584, 0.003944167401641607, 0.039603520184755325, 0.02102617546916008, 0.011434918269515038, -0.02202541194856167, -0.01747959293425083, -0.06096746772527695, -0.01088604237884283, 0.004278418608009815, -0.01088604237884283, -0.018169205635786057, 0.01244822796434164, -0.027936385944485664, -0.005337467882782221, 0.01363042276352644, -0.002128654159605503, -0.009337930008769035, -0.008402026258409023, -0.006079858168959618, 0.02724677138030529, -0.008338694460690022, -0.011878241784870625, 0.00971792172640562, 0.017944026738405228, -0.0026124389842152596, 0.025149783119559288, 0.026346052065491676, -0.01294080913066864, 0.023010574281215668, -0.011153443716466427, 0.023826852440834045, -0.013278579339385033, 0.014481884427368641, 0.023672040551900864, 0.027176402509212494, 0.022222444415092468, 0.003295015776529908, -0.015424825251102448, -0.030624471604824066, -0.022306887432932854, 0.04472636431455612, 0.011660098098218441, -0.01773292012512684, -0.0268386323004961, 0.004151755012571812, 0.01807069033384323, -0.0025614218320697546, -0.0033671436831355095, 0.00353075098246336, 0.004925811197608709, 0.008120551705360413, 0.005949676036834717, 0.03760504722595215, 0.05877196416258812, -0.00403916509822011, 0.01923881098628044, -0.028696367517113686, 0.046978164464235306, -0.02202541194856167, -0.021856527775526047, 0.012898587621748447, -0.020955806598067284, 0.024671277031302452, 0.006016526371240616, -0.00875386968255043, 0.012159716337919235, 0.03597249463200569, -0.025346815586090088, 0.050271421670913696, 0.0006438738782890141, 0.02412240020930767, -0.034734003245830536, -0.0032017771154642105, 0.015847038477659225, 0.002878081053495407, 0.011174554005265236, 0.027486026287078857, -0.004095459822565317, -0.015199645422399044, 0.00525302579626441, 0.02317945845425129, 0.011054927483201027, -0.008134624920785427, 0.02997707761824131, -0.012490449473261833, -0.023095017299056053, -0.006030600052326918, -0.00972495786845684, 0.043093807995319366, 0.04405082389712334, 0.025586070492863655, -0.013011178001761436, 0.0008369480492547154, 0.005745606496930122, -0.01867586001753807, 2.2457519662566483e-05, -0.03526880592107773, -0.0029678011778742075, -0.028569703921675682, 0.02838674560189247, 0.004028609953820705, 0.04033535718917847, -0.002264113863930106, -0.00807833019644022, -0.012539707124233246, -0.040616828948259354, 0.00617485586553812, 0.025234226137399673, 0.04734408110380173, -0.0066955843940377235, 0.020744701847434044, -0.02818971313536167, 0.038027260452508926, 0.017831435427069664, -0.03329848125576973, 0.00043012885726056993, 0.019365474581718445, -0.01440447848290205, 0.0255297739058733, -0.017958099022507668, 0.009964211843907833, -0.002596606034785509, 0.030821504071354866, -0.03487474098801613, 0.010956411249935627, -0.015509268268942833, -0.009401261806488037]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-15T11:18:03.099678", "url_path": "/examples/flight-booking/", "chunk_size": 4900}
updated_dt: 2025-03-15T11:18:03.101230
---
```
importdatetime
fromdataclassesimport dataclass
fromtypingimport Literal
importlogfire
frompydanticimport BaseModel, Field
fromrich.promptimport Prompt
frompydantic_aiimport Agent, ModelRetry, RunContext
frompydantic_ai.messagesimport ModelMessage
frompydantic_ai.usageimport Usage, UsageLimits
# 'if-token-present' means nothing will be sent (and the example will work) if you don't have logfire configured
logfire.configure(send_to_logfire='if-token-present')

classFlightDetails(BaseModel):
"""Details of the most suitable flight."""
  flight_number: str
  price: int
  origin: str = Field(description='Three-letter airport code')
  destination: str = Field(description='Three-letter airport code')
  date: datetime.date

classNoFlightFound(BaseModel):
"""When no valid flight is found."""

@dataclass
classDeps:
  web_page_text: str
  req_origin: str
  req_destination: str
  req_date: datetime.date

# This agent is responsible for controlling the flow of the conversation.
search_agent = Agent[Deps, FlightDetails | NoFlightFound](
  'openai:gpt-4o',
  result_type=FlightDetails | NoFlightFound, # type: ignore
  retries=4,
  system_prompt=(
    'Your job is to find the cheapest flight for the user on the given date. '
  ),
  instrument=True,
)

# This agent is responsible for extracting flight details from web page text.
extraction_agent = Agent(
  'openai:gpt-4o',
  result_type=list[FlightDetails],
  system_prompt='Extract all the flight details from the given text.',
)

@search_agent.tool
async defextract_flights(ctx: RunContext[Deps]) -> list[FlightDetails]:
"""Get details of all flights."""
  # we pass the usage to the search agent so requests within this agent are counted
  result = await extraction_agent.run(ctx.deps.web_page_text, usage=ctx.usage)
  logfire.info('found {flight_count} flights', flight_count=len(result.data))
  return result.data

@search_agent.result_validator
async defvalidate_result(
  ctx: RunContext[Deps], result: FlightDetails | NoFlightFound
) -> FlightDetails | NoFlightFound:
"""Procedural validation that the flight meets the constraints."""
  if isinstance(result, NoFlightFound):
    return result
  errors: list[str] = []
  if result.origin != ctx.deps.req_origin:
    errors.append(
      f'Flight should have origin {ctx.deps.req_origin}, not {result.origin}'
    )
  if result.destination != ctx.deps.req_destination:
    errors.append(
      f'Flight should have destination {ctx.deps.req_destination}, not {result.destination}'
    )
  if result.date != ctx.deps.req_date:
    errors.append(f'Flight should be on {ctx.deps.req_date}, not {result.date}')
  if errors:
    raise ModelRetry('\n'.join(errors))
  else:
    return result

classSeatPreference(BaseModel):
  row: int = Field(ge=1, le=30)
  seat: Literal['A', 'B', 'C', 'D', 'E', 'F']

classFailed(BaseModel):
"""Unable to extract a seat selection."""

# This agent is responsible for extracting the user's seat selection
seat_preference_agent = Agent[None, SeatPreference | Failed](
  'openai:gpt-4o',
  result_type=SeatPreference | Failed, # type: ignore
  system_prompt=(
    "Extract the user's seat preference. "
    'Seats A and F are window seats. '
    'Row 1 is the front row and has extra leg room. '
    'Rows 14, and 20 also have extra leg room. '
  ),
)

# in reality this would be downloaded from a booking site,
# potentially using another agent to navigate the site
flights_web_page = """
1. Flight SFO-AK123
- Price: $350
- Origin: San Francisco International Airport (SFO)
- Destination: Ted Stevens Anchorage International Airport (ANC)
- Date: January 10, 2025
2. Flight SFO-AK456
- Price: $370
- Origin: San Francisco International Airport (SFO)
- Destination: Fairbanks International Airport (FAI)
- Date: January 10, 2025
3. Flight SFO-AK789
- Price: $400
- Origin: San Francisco International Airport (SFO)
- Destination: Juneau International Airport (JNU)
- Date: January 20, 2025
4. Flight NYC-LA101
- Price: $250
- Origin: San Francisco International Airport (SFO)
- Destination: Ted Stevens Anchorage International Airport (ANC)
- Date: January 10, 2025
5. Flight CHI-MIA202
- Price: $200
- Origin: Chicago O'Hare International Airport (ORD)
- Destination: Miami International Airport (MIA)
- Date: January 12, 2025
6. Flight BOS-SEA303
- Price: $120
- Origin: Boston Logan International Airport (BOS)
- Destination: Ted Stevens Anchorage International Airport (ANC)
- Date: January 12, 2025
7. Flight DFW-DEN404
- Price: $150
- Origin: Dallas/Fort Worth International Airport (DFW)
- Destination: Denver International Airport (DEN)
- Date: January 10, 2025
8. Flight ATL-HOU505
- Price: $180
- Origin: Hartsfield-Jackson Atlanta International Airport (ATL)
- Destination: George Bush Intercontinental Airport (IAH)
- Date: January 10, 2025
"""
# restrict how many requests this app can make to the LLM
usage_limits = UsageLimits(request_limit=15)