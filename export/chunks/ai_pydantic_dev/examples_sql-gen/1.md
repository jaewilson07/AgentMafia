---
url: https://ai.pydantic.dev/examples/sql-gen/
session_id: pydantic_ai_docs
chunk_number: 1
title: SQL Generation with PydanticAI
summary: This document provides an example of using PydanticAI to generate SQL queries based on user input, showcasing dynamic system prompts, structured result types, result validation, and agent dependencies. It also includes instructions for running the example using PostgreSQL via Docker.
embedding: [-0.01691366545855999, 0.016175130382180214, 0.03651511296629906, 0.004403969738632441, -0.008444725535809994, -0.04024410992860794, 0.004745996091514826, 0.019516699016094208, 0.009528313763439655, 0.019298769533634186, -0.005523879546672106, -0.06440994888544083, -0.0005667651421390474, -0.01622355729341507, -0.016756271943449974, -0.004285925067961216, -0.020630555227398872, 0.02088480442762375, -0.010605848394334316, 0.015521344728767872, 0.02750740572810173, -0.012918311171233654, 0.0194561630487442, 0.00031043446506373584, -0.008910849690437317, 0.011247526854276657, -0.010950901545584202, 0.0476536750793457, 0.01224636472761631, -0.026224050670862198, 0.016453593969345093, -0.022010767832398415, 0.009268010035157204, -0.016356736421585083, -0.015715058892965317, 0.002105127787217498, 0.020436840131878853, 0.02721683494746685, -0.002580332802608609, 0.00663470895960927, 0.00624122703447938, -0.04753260314464569, 0.0632476657629013, 0.025594478473067284, -0.01064216997474432, 0.06591123342514038, -0.007984654046595097, -0.023766301572322845, 0.04305296391248703, -0.022918803617358208, -0.03385154530405998, 0.0189355555921793, 0.01796698570251465, 0.026078764349222183, -0.013317846693098545, -0.031648047268390656, -0.03949346765875816, 0.007106887176632881, -0.01457698829472065, -0.03225340321660042, 0.017640093341469765, -0.04206018149852753, 0.010454509407281876, 0.08426564931869507, 0.010242634452879429, 0.012155561707913876, -0.0014846371486783028, 0.029614048078656197, -0.031454332172870636, -0.006253334227949381, 0.04314982146024704, 0.006537851877510548, -0.01670784316956997, -0.011628901585936546, 0.013535774312913418, -0.052932385355234146, 0.010587687604129314, 0.0641193762421608, -0.043609894812107086, -0.017567450180649757, 0.020448947325348854, 0.007784886285662651, 0.0013446484226733446, 0.03072790428996086, -0.012797239236533642, 0.004134586080908775, -0.042713966220617294, -0.0013469185214489698, -0.016405165195465088, -0.031260617077350616, -0.014855451881885529, 0.03818589821457863, 0.003169042058289051, 0.039977751672267914, 0.05201224237680435, 0.04741153120994568, 0.043488822877407074, -0.025328122079372406, -0.0011320168850943446, 0.023294124752283096, 0.03288297355175018, -0.0019386546919122338, -0.03799218311905861, -0.009146939031779766, 0.055160097777843475, -0.009552528150379658, -0.014528559520840645, 0.02506176568567753, -0.027192620560526848, 0.007173476275056601, -0.04324667900800705, 0.0031750956550240517, 0.00869897473603487, -0.01380213163793087, -0.050898388028144836, -0.007355083245784044, -0.018814485520124435, -0.011743918992578983, 0.009207474999129772, -0.023463623598217964, -0.04002618044614792, -0.03111533261835575, -0.04639453440904617, -0.03934818133711815, 0.01573927327990532, -0.001331027946434915, -0.031066903844475746, -0.04937288910150528, -0.007930171675980091, 0.008087565191090107, 0.005741807632148266, 0.01835441403090954, 0.015872450545430183, 0.010672437958419323, -0.016792593523859978, -0.023342551663517952, -0.036975182592868805, -0.004128532484173775, 0.01622355729341507, 0.04489324986934662, -0.011980008333921432, 0.011610740795731544, -0.02207130379974842, 0.04850117489695549, -0.03900918364524841, -0.02449272945523262, -0.032689258456230164, 0.016368843615055084, -0.05026881769299507, 0.037750039249658585, 0.04138218238949776, 0.020255234092473984, -0.047096747905015945, -0.011374651454389095, -0.009752295911312103, 0.021332768723368645, -0.0062593878246843815, 0.04525646194815636, -0.0031448279041796923, -0.06344137340784073, -0.029468761757016182, 0.04586182162165642, -0.024081086739897728, -0.008202582597732544, -0.03472325578331947, -0.016489915549755096, -0.045425962656736374, -0.01034554559737444, -0.04997824504971504, -0.03266504406929016, -0.027846405282616615, -0.025715550407767296, 0.010805616155266762, 0.011477561667561531, 0.028621261939406395, -0.003789532696828246, -0.01249456126242876, -0.028064334765076637, -0.031260617077350616, -0.06174637749791145, -0.051673244684934616, 0.001412751036696136, -0.02176862582564354, 0.0005134181119501591, 0.02139330469071865, -0.03525597229599953, 0.005696406122297049, 0.005088022444397211, -0.0027286449912935495, 0.013354167342185974, 0.056128669530153275, 0.010587687604129314, -0.005163692403584719, 0.011986061930656433, 0.011156722903251648, -0.0485980324447155, 0.06915594637393951, -0.003992327023297548, 0.018112270161509514, 0.023390980437397957, 0.037459470331668854, 0.005887093488126993, 0.008244957774877548, -0.011519936844706535, 0.02049737609922886, -0.043004535138607025, 0.013971631415188313, -0.004685460589826107, -0.013523667119443417, -0.010357651859521866, 0.015388165600597858, -0.04898545891046524, 0.06717037409543991, 0.003946925513446331, 0.023257803171873093, -0.014940202236175537, -0.016502022743225098, -0.012760918587446213, 0.014080595225095749, -0.03876703977584839, -0.030049903318285942, -0.005545067135244608, 0.005100129637867212, -0.04063154011964798, -0.003426318522542715, 0.015908772125840187, 0.014346952550113201, -0.029178190976381302, 0.01854812726378441, 0.022979337722063065, 0.012379543855786324, -0.021695982664823532, 0.015436594374477863, -8.408782014157623e-05, 0.015581879764795303, -0.006786047946661711, 0.008753457106649876, 0.016017736867070198, 0.0002480070397723466, -0.009249849244952202, 0.02254348248243332, 0.013644739054143429, 0.048549603670835495, 0.000260870874626562, 0.020037304610013962, 0.0291539765894413, -0.0037380773574113846, -0.0257397647947073, 0.05394938588142395, 0.04440896213054657, -0.009643331170082092, -0.007542743813246489, 0.007464047521352768, -0.015545559115707874, -0.015279201790690422, -0.032035473734140396, -0.05956709384918213, -0.00010707245382945985, -0.0417696088552475, -0.02382683753967285, -0.027144191786646843, 0.026175621896982193, -0.040970537811517715, 0.038064826279878616, 0.0003263250691816211, -0.008535528555512428, 0.003147854469716549, -0.032011259347200394, -0.0009738674852997065, -0.049033887684345245, 0.011677329428493977, 0.040776822715997696, 0.04394889250397682, -0.03910604119300842, -0.040486253798007965, -0.000831608718726784, 0.0016087352996692061, 0.03169647231698036, 0.006549959070980549, 0.01883869804441929, -0.034844327718019485, -0.045062750577926636, 0.025715550407767296, 0.059712380170822144, -0.008729242719709873, 0.04997824504971504, -0.021320661529898643, -0.010000491514801979, -0.010684545151889324, -0.04917917400598526, 0.010745080187916756, 0.005399781279265881, 0.009631223976612091, -0.0006182204815559089, 0.008505260571837425, -0.01181656215339899, 0.036297183483839035, 0.04150325059890747, -0.00016089245036710054, 0.0457165353000164, 0.015908772125840187, 0.010212366469204426, -0.0043010590597987175, -0.048065319657325745, -0.02117537520825863, 0.034069471061229706, -0.019189806655049324, 0.014625417068600655, 0.028597047552466393, 0.018293878063559532, -0.01326941791921854, 0.010333438403904438, -0.015521344728767872, -0.0160540584474802, 0.002834582468494773, -0.04186646640300751, 0.021708089858293533, -0.01064822357147932, 0.028330691158771515, -0.05109209939837456, -0.04576496407389641, 0.002086966997012496, 0.03411789983510971, -0.016635200008749962, -0.07879322022199631, -0.00393481831997633, 0.011090134270489216, -0.015727166086435318, 0.021647553890943527, 0.014734380878508091, 0.0021747436840087175, -0.016683628782629967, -0.019710412248969078, 0.03423897176980972, 0.018681306391954422, -0.04072839394211769, 8.758754120208323e-05, 0.04925181716680527, -0.013438917696475983, 0.03777425363659859, -0.07840579003095627, 0.03721732646226883, -0.02060634084045887, -0.018741842359304428, -0.031066903844475746, 0.006580226588994265, -0.008608171716332436, 0.04799267649650574, 0.028258047997951508, -0.015702951699495316, -0.01510970201343298, 0.0009208988049067557, 0.05036567151546478, 0.030558403581380844, 0.03285875916481018, -0.05026881769299507, -0.03651511296629906, -0.04460267722606659, -0.037556327879428864, -0.00315996166318655, -0.05753309652209282, -0.012918311171233654, -0.013063596561551094, -0.026659907773137093, -0.025981906801462173, -0.010054973885416985, 0.007252172566950321, -0.03215654566884041, -0.021356983110308647, 0.016841022297739983, -0.0048549603670835495, 0.02554604969918728, -0.05138267204165459, 0.013862667605280876, -0.01934719830751419, -0.04871910437941551, -0.05840481072664261, 0.016962094232439995, 0.013584203086793423, 0.050220388919115067, -0.025231264531612396, 0.011205151677131653, -0.019698305055499077, -0.01584823615849018, 0.02438376657664776, 0.04295610636472702, 0.038645967841148376, 0.0072945477440953255, -0.0034596133045852184, 0.011078027077019215, 0.050220388919115067, -0.06528165936470032, -0.011689436621963978, -0.0038652021903544664, -0.018027521669864655, 0.0378953255712986, 0.0025092032738029957, -0.016550451517105103, 0.0437551774084568, 0.00585379870608449, 0.01034554559737444, -0.04399732127785683, -0.005154612008482218, -0.02789483405649662, 0.016574665904045105, 0.0027241050265729427, 0.04414260759949684, 0.016841022297739983, 0.005354379769414663, 0.004170907195657492, 0.023475730791687965, -0.04109160974621773, 0.02245873212814331, -0.014153238385915756, 0.03196283057332039, -0.04365831986069679, 0.03138168901205063, 0.007252172566950321, 0.020448947325348854, 0.07201322913169861, -0.03334304317831993, -0.06939808279275894, 0.004273817874491215, 0.006761833559721708, -0.029178190976381302, 0.03699939697980881, 0.023875266313552856, -0.0072945477440953255, 0.00578418280929327, -0.02506176568567753, 0.010079188272356987, 0.03566761314868927, 0.021248018369078636, -0.018887126818299294, -0.0023608908522874117, -0.020533697679638863, 0.04525646194815636, -0.009171153418719769, 0.02682940661907196, -0.013317846693098545, 0.009643331170082092, -0.020243126899003983, -0.027531620115041733, 0.03733839839696884, -0.04949396103620529, 0.003028296632692218, -0.021429626271128654, -0.028306476771831512, 0.0092377420514822, -0.04530489072203636, 0.014613309875130653, 0.030437331646680832, -0.02195023186504841, -0.006816315930336714, 0.03615190088748932, -0.04411839321255684, 0.034553758800029755, -0.011477561667561531, 0.05172167345881462, 0.001929574296809733, 0.05714566633105278, 0.04915495961904526, -0.053513526916503906, 0.01102354470640421, 0.004588603507727385, -0.01064216997474432, -0.009146939031779766, 0.03670882806181908, 0.004512934014201164, -0.02012205496430397, -0.027555834501981735, -0.002394185634329915, 0.03365783020853996, 0.001533822389319539, -0.026466192677617073, -0.004579523112624884, -0.002466828329488635, -0.002550064818933606, -0.04099475219845772, -0.01592087931931019, 0.02634512074291706, 0.004727835301309824, 0.05792052298784256, 0.06949494034051895, -0.010963008739054203, 0.057678382843732834, 0.0025182836689054966, -0.026950478553771973, 0.03264082968235016, 0.015581879764795303, -0.004237496759742498, -0.007978600449860096, 0.040486253798007965, -0.012046596966683865, 0.021114839240908623, 0.036805685609579086, -0.0013454051222652197, 0.008680813945829868, -0.011362544260919094, 0.0011516910744830966, 0.008093618787825108, -0.000775613181758672, -0.015182345174252987, 0.05549909919500351, -0.026708334684371948, -0.020339982584118843, 0.03934818133711815, 0.011507829651236534, 0.007125047966837883, 0.012264525517821312, -0.039711397141218185, -0.006604440975934267, 0.007137154694646597, 0.006689190864562988, 0.030873188748955727, 0.05743623897433281, -0.012185829691588879, 0.006513637490570545, 0.001894766348414123, -0.017228450626134872, -0.014794916845858097, -0.0008754970622248948, -0.024916479364037514, -0.004730862099677324, 0.00826311856508255, -0.03879125416278839, -0.00997022446244955, -0.04695146158337593, -0.028548618778586388, -0.05017196014523506, 0.0054663703776896, 0.017906449735164642, 0.009885474108159542, 0.007857529446482658, -0.06629866361618042, -0.017543235793709755, 0.014177452772855759, 0.029686689376831055, -0.04336775094270706, 0.014395381323993206, -0.03411789983510971, 0.03528018668293953, -0.0046158442273736, 0.0029677608981728554, 0.012276632711291313, 0.005950655788183212, 0.025037551298737526, -0.007978600449860096, 0.004183014389127493, 0.008571850135922432, 0.06934966146945953, -0.010242634452879429, -0.005572307854890823, -0.0026832432486116886, 0.018802378326654434, 0.0071674226783216, -0.013693167828023434, -0.0018417976098135114, 0.0228582676500082, 0.018112270161509514, -0.0011562311556190252, 0.004025621805340052, 0.023475730791687965, 0.004727835301309824, -0.018221234902739525, 0.027337906882166862, 0.03661197051405907, -0.021066412329673767, -0.0378953255712986, 0.027555834501981735, -0.036878328770399094, 0.03235026076436043, -0.012530882842838764, 0.006204905454069376, 0.022676659747958183, -0.00830549281090498, -0.03646668419241905, 0.0028058281168341637, -0.010847991332411766, 0.03012254647910595, -0.007058458402752876, -0.02595769241452217, 0.027870619669556618, 0.04549860581755638, -0.03460218757390976, -0.016550451517105103, 0.011065919883549213, 0.011828669346868992, 0.022688766941428185, 0.00351106864400208, -0.04034096747636795, 0.014419595710933208, -0.03777425363659859, 0.0025742792058736086, 0.003271952737122774, -0.003777425503358245, 0.01854812726378441, 0.010678491555154324, -0.04353725165128708, 0.011380705051124096, 0.027555834501981735, -0.009546474553644657, -0.011483615264296532, 0.03833118453621864, 0.012125293724238873, 0.009431456215679646, 0.007681976072490215, 0.024432193487882614, -0.006307816132903099, 0.007137154694646597, -0.022386088967323303, 0.005048674531280994, -0.03092161752283573, -0.03101847507059574, -0.0023775382433086634, 0.007579065393656492, -0.022277124226093292, 0.03433582931756973, 0.03876703977584839, -0.05404624342918396, 0.02382683753967285, -0.00025727658066898584, -0.003235631389543414, 0.0014483158010989428, 0.01673205755650997, -0.003686622017994523, 0.0009254390024580061, -0.017046842724084854, -0.043876249343156815, 0.006689190864562988, -0.030098332092165947, 0.010920633561909199, 0.032422903925180435, -0.0007672895444557071, 0.006816315930336714, 0.022107625380158424, 0.019577233120799065, -0.036975182592868805, -0.011671275831758976, -0.019516699016094208, -0.008638439700007439, 0.036975182592868805, 0.03189018741250038, 0.03431161493062973, 0.004307112656533718, -0.0025818462017923594, -0.0437551774084568, 0.020436840131878853, 0.003020729636773467, -0.044069964438676834, -0.040389396250247955, 0.00702213728800416, 0.02486805059015751, -0.027168406173586845, 0.019274555146694183, -0.01961355470120907, -0.010684545151889324, -0.039033398032188416, -0.00045136906555853784, 0.010866152122616768, -0.06358665972948074, 0.016502022743225098, 0.003147854469716549, -0.028112763538956642, 0.011864989995956421, 0.05578966811299324, 0.007833315059542656, 0.016853129491209984, 0.020739518105983734, 0.004836799576878548, -0.015485023148357868, 0.010460563004016876, 0.02837911993265152, 0.022216588258743286, -0.019310876727104187, -0.0114291338250041, 0.008596064522862434, -0.010581634007394314, -0.004019568208605051, 0.006416780408471823, 0.00447358563542366, -0.006350191310048103, -0.04540174826979637, 0.004954844247549772, 0.08334550261497498, -0.014237988740205765, 0.016284093260765076, -0.006068700458854437, 0.026587264612317085, 0.03218076005578041, 0.02330623008310795, -0.03833118453621864, 0.004304085858166218, 0.028161190450191498, -0.0015224720118567348, -0.018342306837439537, -0.019795162603259087, 0.030461546033620834, 0.006038432475179434, -0.02721683494746685, -0.04189068078994751, 0.01779748499393463, 0.02702312171459198, 0.005339245777577162, 0.002077886601909995, -0.0032901132944971323, -0.017664307728409767, -0.012300847098231316, 0.03467483073472977, -0.022712981328368187, -0.036127686500549316, 0.0014475591015070677, -0.012040543369948864, 0.009837045334279537, -0.02421426586806774, -0.018802378326654434, -0.020146269351243973, 0.03099426068365574, 0.012270579114556313, -0.01730109378695488, -0.008456832729279995, 0.0005164449103176594, 0.0022943017538636923, -0.033197756856679916, -0.012300847098231316, -0.06968865543603897, -0.00740956561639905, 0.02382683753967285, -0.006743673235177994, -0.013245203532278538, -0.0015171751147136092, -0.028451763093471527, 0.019214019179344177, -0.022119732573628426, 0.03314933180809021, -0.04457846283912659, -0.041648536920547485, 0.024371659383177757, -0.03297983109951019, -0.029517190530896187, 0.0072945477440953255, -0.013136239722371101, -0.04322246462106705, -0.0004888254916295409, -0.010418187826871872, 0.011683383025228977, -0.012555097229778767, 0.08867264539003372, 0.030848974362015724, -3.6090843877900625e-06, -0.018693413585424423, 0.007863583043217659, 0.015993522480130196, -0.030824759975075722, 0.02673254907131195, 0.01760377176105976, -0.000614058633800596, -0.03101847507059574, -0.06368351727724075, 0.029589833691716194, -0.013317846693098545, -0.004851933568716049, -0.006038432475179434, 0.03908182680606842, 0.009098510257899761, -0.018063843250274658, 0.08571850508451462, -0.03109111823141575, -0.042617108672857285, -0.012161615304648876, -0.014940202236175537, -0.0055632274597883224, -0.0019341144943609834, 0.0060354056768119335, 0.0097220279276371, -0.042835038155317307, -0.014746488071978092, 0.0019628689624369144, 0.03576447069644928, 0.02255558967590332, 0.025618692860007286, 0.025037551298737526, -0.022773517295718193, -0.00454622833058238, 0.030146760866045952, -0.033948399126529694, -0.01777327060699463, -0.025449194014072418, -0.03762897104024887, -0.022228695452213287, -0.029129762202501297, 0.005212120711803436, 0.010593741200864315, -0.0015345790889114141, 0.011798401363193989, -0.004939710255712271, 0.003308274084702134, -0.09487149119377136, -0.005548093467950821, 0.010018652305006981, -0.010654277168214321, 0.012143454514443874, 0.008487099781632423, 0.04196332395076752, 0.019952554255723953, -0.023960016667842865, -0.03346411511301994, -0.0018871993524953723, 0.01757955737411976, -0.015957200899720192, -0.00048012350453063846, 0.02117537520825863, -0.06470052152872086, 0.015097594819962978, -0.04908231645822525, 0.0641193762421608, -0.027919048443436623, -0.00043169496348127723, -0.03230183199048042, -0.04704831913113594, 0.006749726831912994, -0.0228340532630682, -0.019601447507739067, -0.022216588258743286, 0.04782317578792572, 0.02088480442762375, -0.026078764349222183, -0.045135390013456345, -0.03421475738286972, 0.03244711458683014, 0.014225881546735764, -0.012210044078528881, 0.007016083691269159, -0.018148591741919518, 0.044747963547706604, 0.011986061930656433, 0.018887126818299294, 0.003925737924873829, -0.014915987849235535, 0.031163759529590607, 0.009376974776387215, 0.012978846207261086, -0.006198852322995663, 0.010533206164836884, 0.008910849690437317, 0.0023790516424924135, 0.03588554263114929, -0.002972301095724106, 0.031551189720630646, 0.0026454085018485785, 0.00855974294245243, -0.009268010035157204, 0.005829584319144487, -0.04915495961904526, 0.022228695452213287, -0.012185829691588879, 0.028209619224071503, 0.014879666268825531, -0.03617611154913902, 0.0060747540555894375, -0.021441731601953506, -0.022398196160793304, -0.005330165382474661, 0.014359059743583202, -0.004779290873557329, -0.010272902436554432, 0.005681272130459547, -0.003040403826162219, 0.04656403511762619, -0.004549255128949881, 0.011507829651236534, -0.006828423123806715, -0.018923448398709297, 0.02653883583843708, 0.0013908068649470806, -0.022676659747958183, 0.0064046732150018215, 0.04336775094270706, -0.025424979627132416, 0.007379297632724047, 0.03070368990302086, -0.03324618563055992, 0.011701543815433979, 0.022688766941428185, -0.023257803171873093, 0.005744834430515766, 0.027144191786646843, 0.0048973350785672665, -0.04595867544412613, -0.006749726831912994, 0.03583711385726929, -0.016465701162815094, 0.0014899340458214283, -0.020848482847213745, 0.034263186156749725, 0.010963008739054203, 0.008995600044727325, 0.014262203127145767, 0.022664552554488182, -0.026490407064557076, -0.0024456409737467766, -0.021235911175608635, 0.020921126008033752, -0.03661197051405907, -0.01972251944243908, -0.020061518996953964, 0.014104809612035751, 0.004703621380031109, 0.00894111767411232, -0.028136977925896645, -0.015702951699495316, -0.007312708534300327, 0.03060683235526085, 0.0476294606924057, -0.023015659302473068, -0.0109327407553792, -0.002823988674208522, 0.030461546033620834, 0.0021671769209206104, -0.014915987849235535, 0.05094681680202484, -0.01796698570251465, -0.003962059039622545, -0.04227810725569725, -0.04264132305979729, -0.01535184495151043, -0.01954091340303421, 0.015957200899720192, 0.003190229646861553, -0.0010412133997306228, -0.010236580856144428, -0.0050093261525034904, -0.03486854210495949, 0.02244662493467331, -0.018523912876844406, 0.014794916845858097, 0.003308274084702134, 0.016284093260765076, -0.008620278909802437, -0.009855206124484539, -0.019008198752999306, -0.03569182753562927, -0.015824023634195328, 0.010708759538829327, -0.006153450347483158, 0.01673205755650997, 0.007833315059542656, 0.0018614716827869415, -0.020243126899003983, -0.0252796933054924, 0.03741104155778885, -0.007548797409981489, 0.06673451513051987, 0.005351352971047163, -0.07012451440095901, 0.008117832243442535, -0.040752608329057693, 0.0012061730958521366, 0.014237988740205765, 0.005021433345973492, -0.0008157180855050683, -0.018305985257029533, -0.008977439254522324, -0.0041890679858624935, 0.009843098931014538, -0.0389123260974884, -0.001098722335882485, -0.005950655788183212, 0.01472227368503809, 0.02508598007261753, -0.007651708088815212, 0.03477168455719948, 0.04314982146024704, 0.06382880359888077, 0.004285925067961216, -0.018003307282924652, 0.02632090635597706, -0.006683137267827988, 0.009261956438422203, 0.04017146676778793, -0.007621440105140209, 0.02779797650873661, -0.015690844506025314, -0.005626790225505829, 0.02956561930477619, -0.012821453623473644, -0.03457797318696976, 0.021611232310533524, 0.002672649687156081, -0.008111778646707535, 0.03995353728532791, -0.001181958825327456, 0.042617108672857285, 0.06005137786269188, -0.01777327060699463, 0.011017491109669209, -0.007536690216511488, -0.002550064818933606, -0.016792593523859978, -0.024274801835417747, 0.003816773649305105, -0.0072219050489366055, 0.05414309725165367, -0.00045590923400595784, -0.0228582676500082, -0.013971631415188313, 0.013257310725748539, -0.04482060670852661, 0.0015920880250632763, 0.031938616186380386, -0.022616123780608177, -0.011435187421739101, 0.03360940143465996, -0.03382733091711998, 0.02088480442762375, -0.03554654121398926, 0.00045212573604658246, -0.01883869804441929, -0.03714468330144882, -0.02992883324623108, 0.0014172912342473865, -0.005717593710869551, 0.029081333428621292, 0.02254348248243332, -0.002032484859228134, 0.022604016587138176, -0.005829584319144487, -0.009213528595864773, 0.013765810057520866, -0.021502267569303513, 0.0165383443236351, 0.023778408765792847, 0.017143700271844864, -0.03682989999651909, -0.04934867471456528, 0.011114347726106644, 0.002253440208733082, 0.02138119749724865, -0.013366274535655975, 0.04157589375972748, -0.02031577005982399, 0.004049836192280054, -0.010478723794221878, 0.035619184374809265, 0.023185160011053085, -0.013281525112688541, -0.005899200681596994, -0.017519021406769753, -0.0017419137293472886, 0.019080841913819313, -0.02496490813791752, 0.04353725165128708, 0.013245203532278538, 0.02478330209851265, 0.021756518632173538, -0.0016299227718263865, 0.008783725090324879, -0.029178190976381302, 0.029977262020111084, -0.022688766941428185, -0.0014097243547439575, -0.009504099376499653, -0.024843836203217506, -0.011525990441441536, -0.001670784316956997, 0.02098166197538376, 0.005647977348417044, -0.0023972124326974154, 0.01156836561858654, -3.549376197042875e-05, -0.00870502833276987, -0.04099475219845772, -0.018983984366059303, -0.04850117489695549, -0.026224050670862198, 0.010817723348736763, -0.056031811982393265, -0.0340210422873497, -0.002301868749782443, 0.027580048888921738, 0.008892688900232315, 0.012712489813566208, -0.008880581706762314, -0.013281525112688541, -0.02496490813791752, 0.009074295870959759, -0.0008437158539891243, 0.05273867025971413, 0.01273670420050621, 0.0023215427063405514, -0.013426810503005981, -0.0030252698343247175, -0.009709920734167099, -0.02070319652557373, 0.021126946434378624, -0.008353921584784985, -0.07017294317483902, 0.003190229646861553, 0.015521344728767872, 0.030364690348505974, 0.006834476720541716, 0.004658219404518604, -0.02158701792359352, -0.006295708939433098, -0.04946974664926529, 0.053997814655303955, 0.004509907215833664, -0.019649876281619072, -0.0036714880261570215, 0.01248245406895876, 0.004279871471226215, -0.0007570741581730545, -0.0027679933700710535, -0.020945340394973755, 0.006416780408471823, -0.026853621006011963, -0.005608629435300827, -0.015957200899720192, 0.023209374397993088, -0.006991869304329157, 0.00609896844252944, 0.005175799131393433, -0.019964661449193954, 0.005526906345039606, 0.008323653601109982, 0.020872697234153748, -0.036684613674879074, 0.03733839839696884, 0.02041262574493885, -0.016163023188710213, 0.011398865841329098, -0.025715550407767296, -0.009770456701517105, -0.052254386246204376, -0.026369335129857063, 0.027919048443436623, -0.014153238385915756, -0.02343940921127796, -0.0476052463054657, -0.017131593078374863, 0.007615386508405209, 0.0012084431946277618, -0.029977262020111084, 0.0036170058883726597, -0.019383519887924194, 0.014020060189068317, 0.03239868953824043, 0.04629767686128616, 0.01799120008945465, -0.023669445887207985, 0.013826346024870872, 0.021042197942733765, 0.03060683235526085, 0.007730404380708933, -0.011525990441441536, -0.022906696423888206, -0.03607925772666931, -0.009007707238197327, 0.005115263629704714, -0.009140885435044765, 0.016078272834420204, 0.014952309429645538, -0.018983984366059303, 0.008832153864204884, -0.00046612462028861046, 0.028814977034926414, -0.012894096784293652, 0.021804947406053543, 0.056225527077913284, -0.02925083413720131, -0.0218533743172884, 0.0016753245145082474, 0.028524406254291534, 0.008608171716332436, -0.022579802200198174, 0.011525990441441536, 0.02653883583843708, 0.035328615456819534, -0.06348980218172073, -0.002973814494907856, 0.0026348147075623274, -0.06290866434574127, 0.008892688900232315, -0.006065673660486937, 0.010605848394334316, -0.0005962763098068535, 0.035619184374809265, -0.004134586080908775, -0.01117488369345665, 0.009830991737544537, -0.026998907327651978, 0.01741005666553974, 0.010133670642971992, -0.01326941791921854, -0.0013802131870761514, -0.0070281908847391605, 0.0007839368772692978, -0.0004279114946257323, -0.0048246923834085464, -0.015424487181007862, -0.015606094151735306, 0.03140590339899063, -0.056709811091423035, 0.00880188588052988, 0.029783546924591064, -0.0032477383501827717, 0.011762079782783985, -0.033488329499959946, 0.01720423623919487, 0.013487346470355988, 0.010914579965174198, -0.01885080523788929, -0.03808904066681862, 0.0022776543628424406, -0.0019870831165462732, -0.0074701011180877686, 0.02001309022307396, -0.002533417660742998, 0.002070319838821888, 0.008596064522862434, -0.008765564300119877, 0.028839191421866417, 0.03169647231698036, 0.03314933180809021, -0.011241473257541656, 0.015242880210280418, 0.0321081168949604, -0.00617161113768816, -0.01380213163793087, -0.02362101711332798, 0.019298769533634186, -0.006356244906783104, -0.02566712163388729, 0.019904127344489098, 0.024468515068292618, -0.04927603155374527, 0.029032904654741287, -0.00273167178966105, 0.02518283575773239, -0.003187202848494053, 0.04775053262710571, 0.005414915271103382, 0.02041262574493885, 0.001947734970599413, 0.03528018668293953, -0.00762749370187521, 0.003411184763535857, 0.007936225272715092, -0.014843344688415527, -0.027144191786646843, 0.020630555227398872, -0.005024460144340992, -0.004307112656533718, -0.01680470071732998, -0.045329105108976364, 0.020376304164528847, 0.018063843250274658, 0.008850314654409885, 0.015146023593842983, 0.01409270241856575, -0.007742511574178934, 0.005878013093024492, 0.022979337722063065, -0.04436053708195686, 0.045740749686956406, -0.022676659747958183, -0.03346411511301994, 0.0037562379147857428, 0.01837862841784954, -0.03034047596156597, 0.02023101970553398, 0.012942525558173656, 0.030461546033620834, 0.012222150340676308, -0.023729979991912842, 0.016865236684679985, -0.024226373061537743, -0.0011880124220624566, -0.02682940661907196, 0.002569739008322358, 0.01040002703666687, 0.023584695532917976, -0.019976768642663956, -0.005805370397865772, -0.023645231500267982, 0.018487591296434402, 0.018911341205239296, -0.04423946514725685, 0.04511117935180664, -0.014262203127145767, -0.0418180376291275, 0.014552773907780647, -0.004298032261431217, 0.01039397343993187, 0.02479540929198265, 0.00040672399336472154, 0.001061644172295928, 0.015896664932370186, -0.011901311576366425, 0.017325308173894882, 0.008626332506537437, 0.0027498325798660517, -0.01682891510426998, 0.017446378245949745, -0.015000738203525543, -0.03799218311905861, -0.02673254907131195, 0.029226619750261307, 0.006368352100253105, 0.012966739013791084, -0.01886291243135929, 0.012391651049256325, -0.009449617005884647, 0.014020060189068317, -0.01613880880177021, -0.003341568633913994, -0.0033143276814371347, -0.022712981328368187, -0.035812899470329285, 0.009903634898364544, -0.014915987849235535, 0.020582126453518867, -0.028693905100226402, 0.008214689791202545, 0.012470346875488758, 0.016247771680355072, 0.007990707643330097, -0.02129644714295864, -0.020000983029603958, 0.007657761685550213, -0.004912469070404768, -0.005036567337810993, 0.02312462404370308, -0.009988384321331978, -0.001126720104366541, -0.01796698570251465, -0.016489915549755096, -0.01380213163793087, 0.016562558710575104, 0.03070368990302086, -0.0073369224555790424, 0.0063199233263731, 0.018305985257029533, -0.0035867381375283003, -0.028354905545711517, 0.0008255551219917834, 0.02128433994948864, -0.0340452566742897, -0.0008210149826481938, 0.011768133379518986, -0.021623339504003525, -0.02391158789396286, 0.0006583253853023052, 0.007215851452201605, -0.00030267832335084677, -0.005063808523118496, -0.001994650112465024, 0.004104318097233772, -0.008523421362042427, -0.011059866286814213, 0.007318761665374041, 0.02731369249522686, 0.003169042058289051, 0.025981906801462173, -0.004482666030526161, -0.006937387399375439, -0.006798155140131712, 0.0038016396574676037, 0.018899234011769295, -0.008916903287172318, 0.0007033487781882286, -0.015097594819962978, -0.00447358563542366, 0.04295610636472702, 0.02050948329269886, 0.010048920288681984, 0.02498912252485752, 0.014843344688415527, -0.019674090668559074, 0.029129762202501297, -0.017264772206544876, -0.008487099781632423, 0.014129023998975754, -0.008335760794579983, 0.011453348211944103, 0.03622454032301903, -0.019274555146694183, -0.027846405282616615, 0.005729700904339552, -0.014237988740205765, 0.0013703760923817754, -0.0006416780524887145, -0.009449617005884647, 0.023693658411502838, 0.015133916400372982, 0.0013892934657633305, -0.0027331851888448, 0.05327138677239418, 0.044869035482406616, -0.0003036241978406906, -0.00108131836168468, -0.017712734639644623, -0.037168897688388824, -0.01770062930881977, 0.009201421402394772, -0.02603033557534218, 0.006150423549115658, -0.010018652305006981, -0.026902049779891968, 0.014601202681660652, 0.007155315484851599, 0.020485268905758858, 0.02468644455075264, -0.04390046373009682, -0.03162383288145065, -0.019904127344489098, -0.02632090635597706, 0.03440847247838974, 0.000923925603274256, 0.00787569023668766, -0.022821946069598198, -0.014359059743583202, 0.017337415367364883, 0.02564290724694729, -0.015388165600597858, 0.004534121137112379, -0.02146594598889351, 0.022010767832398415, 0.010297116823494434, -0.02721683494746685, -0.0016647308366373181, -0.0007589659071527421, -0.005799316801130772, -0.014988631010055542, 0.012760918587446213, 8.853340841596946e-05, 0.005514799151569605, 0.05273867025971413, 0.01000654511153698, 0.027458976954221725, 0.01984359137713909, 0.017930664122104645, 0.016247771680355072, 0.02438376657664776, -0.014952309429645538, -0.0218654815107584, 0.003695702413097024, -0.014250095933675766, -0.01053925883024931, 0.052351243793964386, -0.0014188046334311366, 0.013402596116065979, 0.03450533002614975, -0.002382078440859914, 0.015957200899720192, -0.05201224237680435, -0.004512934014201164, 0.03317354619503021, -0.00816626101732254, 0.019807269796729088, -0.0075911725871264935, 0.014734380878508091, 0.03949346765875816, -0.001358269015327096, 0.023935802280902863, -0.024746980518102646, -0.005036567337810993, 0.007669868879020214, -0.0009140885667875409, 0.01116883009672165, 0.022034982219338417, 0.01710737869143486, 0.011302008293569088, -0.047096747905015945, 0.030388904735445976, 0.00312364031560719, -0.034941185265779495, 0.020376304164528847, 0.0349653996527195, 0.047774747014045715, 0.003408157965168357, 0.008505260571837425, -0.007252172566950321, -0.008989546447992325, 0.013826346024870872, 0.03910604119300842, 0.0010321331210434437, -0.03818589821457863, 0.026611478999257088, -0.020678984001278877, 0.018511805683374405, -0.00638651242479682, 0.014250095933675766, -0.0006238956702873111, 0.011731811799108982, -0.0028618236538022757, -0.010436348617076874, -0.004198148380964994, -0.008317600004374981, 0.005060781724750996, 0.013741595670580864, 0.019407734274864197, -0.011126454919576645, -0.008481047116219997, 0.04637032002210617, -0.03489275649189949, 0.026224050670862198, -0.016877343878149986, -0.030752118676900864, 0.003480800660327077, -0.010690598748624325, 0.01799120008945465, 0.03925132378935814, -0.007149261888116598, -0.02089691162109375, -0.02363312430679798, -0.028354905545711517, 0.008372082374989986, -0.014589095488190651, 0.021526481956243515, -0.03431161493062973, 0.003943898715078831, -0.057387810200452805, -0.02595769241452217, -4.67732606921345e-05, 0.020097840577363968, -0.0398808978497982, 0.030824759975075722, -0.0011706084478646517, 0.020545804873108864, -0.003777425503358245, 0.02176862582564354, -0.004848906770348549, -0.0189355555921793, 0.003411184763535857, -0.0291539765894413]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-15T11:18:05.334361", "url_path": "/examples/sql-gen/", "chunk_size": 1525}
updated_dt: 2025-03-15T11:18:05.334361
---
# SQL Generation
Example demonstrating how to use PydanticAI to generate SQL queries based on user input.
Demonstrates:
  * [dynamic system prompt](https://ai.pydantic.dev/agents/#system-prompts)
  * [structured `result_type`](https://ai.pydantic.dev/results/#structured-result-validation)
  * [result validation](https://ai.pydantic.dev/results/#result-validators-functions)
  * [agent dependencies](https://ai.pydantic.dev/dependencies/)


## Running the Example
The resulting SQL is validated by running it as an `EXPLAIN` query on PostgreSQL. To run the example, you first need to run PostgreSQL, e.g. via Docker:
```
dockerrun--rm-ePOSTGRES_PASSWORD=postgres-p54320:5432postgres

```

_(we run postgres on port`54320` to avoid conflicts with any other postgres instances you may have running)_
With [dependencies installed and environment variables set](https://ai.pydantic.dev/examples/#usage), run:
[pip](https://ai.pydantic.dev/examples/sql-gen/#__tabbed_1_1)[uv](https://ai.pydantic.dev/examples/sql-gen/#__tabbed_1_2)
```
python-mpydantic_ai_examples.sql_gen

```

```
uvrun-mpydantic_ai_examples.sql_gen

```

or to use a custom prompt:
[pip](https://ai.pydantic.dev/examples/sql-gen/#__tabbed_2_1)[uv](https://ai.pydantic.dev/examples/sql-gen/#__tabbed_2_2)
```
python-mpydantic_ai_examples.sql_gen"find me errors"

```

```
uvrun-mpydantic_ai_examples.sql_gen"find me errors"

```

This model uses `gemini-1.5-flash` by default since Gemini is good at single shot queries of this kind.
## Example Code
sql_gen.py