---
url: https://ai.pydantic.dev/agents/
session_id: pydantic_ai_docs
chunk_number: 4
title: AgentRun: Managing Node Iteration
summary: The `AgentRun` async iterator yields nodes in a flow, ending with an `End` node. It allows manual iteration using the `.next(...)` method to inspect or modify nodes, skip nodes, and handle errors more effectively.
embedding: [0.005591755732893944, 0.052121736109256744, 0.02406664378941059, -0.06290866434574127, -0.0035663729067891836, -5.134274033480324e-05, 0.010481000877916813, 0.0142994849011302, 0.04060962796211243, -0.0038666394539177418, 0.002130192704498768, -0.027669843286275864, -0.0501728355884552, -0.040405675768852234, 0.0007149034063331783, -0.008078868500888348, -0.047770701348781586, 0.0038751375395804644, 0.025879574939608574, 0.03562407195568085, 0.03322194144129753, -0.020894017070531845, 0.0024856969248503447, 0.037663619965314865, -0.041765373200178146, -0.011149519123136997, -0.0266727302223444, 0.07981424033641815, -0.028689615428447723, -0.0034927227534353733, 0.0032604411244392395, -0.008056207560002804, -0.031839579343795776, -0.013993552885949612, 0.02995866723358631, -0.01709819585084915, 0.009427235461771488, 0.0012046069605275989, -0.011177846230566502, 0.024610523134469986, 0.03365251049399376, -0.020746717229485512, 0.0008675152785144746, 0.02226504497230053, 0.008855029009282589, -0.01020339597016573, 0.01113818772137165, 0.004889245145022869, 0.04237723723053932, 0.005858029704540968, -0.017574088647961617, 0.04133480042219162, -0.01888846419751644, -0.00036240892950445414, -0.025290371850132942, -0.0002446747093927115, 0.006702175363898277, 0.02417995221912861, -0.0024318755604326725, -0.08230701833963394, 0.01855986937880516, 0.009330923669040203, 0.031771596521139145, 0.0421052984893322, -0.03267806023359299, 0.03415106609463692, -0.051215268671512604, 0.04094955325126648, -0.04704552888870239, -0.0037958219181746244, 0.020123520866036415, 0.02828170545399189, -0.05271093547344208, -0.015398573130369186, -0.03968050330877304, -0.018095307052135468, 0.03290467709302902, 0.024361245334148407, -0.011206173337996006, -0.017381465062499046, 0.006792821455746889, -0.020894017070531845, -0.0003323114651720971, 0.010022102855145931, 0.027737827971577644, -0.027669843286275864, -0.0300039891153574, -0.030049312859773636, -0.03564673289656639, -0.060053303837776184, -0.035873349756002426, 0.027420565485954285, 0.004164073150604963, 0.05130591616034508, 0.02585691213607788, 0.06821148842573166, -0.019421011209487915, -0.003761829575523734, 0.007784267887473106, 0.0331539548933506, 0.03204353526234627, -0.017948005348443985, -0.03811684995889664, -0.0022718277759850025, 0.01811796799302101, -0.010339365340769291, -0.0132457185536623, 0.018185952678322792, -0.013415681198239326, -0.04704552888870239, -0.06712372601032257, -0.007512328214943409, -0.02771516516804695, 0.010928568430244923, -0.05746987834572792, -0.01945500448346138, 0.004379358608275652, 0.012554539367556572, 0.058331020176410675, -0.01043567806482315, -0.011240165680646896, 0.02553964965045452, -0.035918671637773514, 0.006724836770445108, 0.00988613348454237, 0.0020749547984451056, -0.009172292426228523, -0.021267933771014214, 0.008696397766470909, -0.006628524977713823, 0.01688290946185589, -0.01854853890836239, -0.01875249296426773, -0.0028242047410458326, -0.005203675478696823, -0.032020874321460724, -0.017993329092860222, -0.004467172548174858, -0.0373690165579319, 0.033561863005161285, -0.006339589133858681, -0.04205997288227081, -0.008792709559202194, 0.0008306901436299086, -0.0024375407956540585, 0.06721437722444534, -0.061594292521476746, 0.04550454020500183, -0.021143294870853424, 0.024157291278243065, 0.05184979364275932, 0.018525877967476845, -0.04704552888870239, 0.0026514099445194006, -0.0092119500041008, 0.01449210848659277, -0.00022732441721018404, 0.03059319220483303, -0.0010870497208088636, -0.04985557124018669, -0.03149965777993202, 0.05252964422106743, -0.01593112200498581, -0.015024656429886818, -0.039000652730464935, -0.027851134538650513, -0.013551650568842888, -0.022027097642421722, -0.03272338584065437, -0.011648074723780155, 0.01417484600096941, -0.03249676898121834, -0.010571647435426712, 0.003951620776206255, 0.03193022683262825, -0.032406121492385864, -0.08289621770381927, -0.011013548821210861, -0.0061582960188388824, -0.029845358803868294, -0.018763823434710503, -0.03716506436467171, -0.0431477315723896, 0.0013164987321943045, -0.03476293012499809, -8.321065251948312e-05, 0.018185952678322792, -0.01043567806482315, -0.03802620619535446, 0.024610523134469986, 0.026332806795835495, 0.07723081111907959, 0.0041017537005245686, -0.00781259499490261, -0.02957341820001602, 0.013868913985788822, 0.03936323896050453, -0.0039261262863874435, 0.013347696512937546, 0.0291201863437891, 0.013132411055266857, 0.007444343529641628, 0.03872871398925781, -0.004807096906006336, 0.0064019085839390755, -0.054614514112472534, -0.009325258433818817, -0.012871801853179932, -0.009455562569200993, -0.01321172621101141, 0.001980059314519167, -0.01286047138273716, 0.037414342164993286, -0.03077448531985283, -0.023908013477921486, -0.021279264241456985, -0.047453440725803375, 0.0526202917098999, 0.02406664378941059, 0.037980880588293076, 0.04153875634074211, 0.014888687059283257, -0.006600197870284319, -0.022185729816555977, -0.01632769964635372, 0.004181069787591696, 0.01784602925181389, -0.019466334953904152, 0.017687397077679634, 0.028055090457201004, 0.012781155295670033, -0.013064426369965076, -0.013404350727796555, -0.04185602068901062, 0.023885350674390793, -0.06118638440966606, 0.032791368663311005, 0.011183511465787888, 0.017562758177518845, -0.05239367485046387, -0.027533872053027153, -0.015387242659926414, 0.04727214574813843, -0.016984887421131134, 0.003149965777993202, 0.008798375725746155, 0.003155631013214588, -0.03449099138379097, 0.0747380331158638, 0.03768628090620041, 0.03569205850362778, -0.008906017988920212, -0.014356138184666634, -0.005886356811970472, -0.0010941314976662397, -0.011274158023297787, -0.004302875604480505, -0.010022102855145931, -0.02880292385816574, 9.808233880903572e-05, 0.044711384922266006, -0.004770271945744753, -0.043419670313596725, 0.009551874361932278, -0.0011954006040468812, 0.02124527283012867, 0.036371905356645584, -0.008328146301209927, -0.0040054419077932835, -0.044303473085165024, 0.0011522019049152732, -0.002133025322109461, 0.0158744677901268, -0.028938893228769302, -0.03832080587744713, 0.0761430561542511, 0.03730103373527527, 0.04255852848291397, 0.004107419401407242, -0.03569205850362778, 0.01052632462233305, 0.05221237987279892, 0.03444566950201988, 0.046864237636327744, 0.021335918456315994, -0.012123968452215195, -0.006418904755264521, -0.011897352524101734, 0.028372352942824364, 0.021675843745470047, 0.011291153728961945, 0.023273486644029617, 0.034400343894958496, -0.022242384031414986, 0.030638515949249268, -0.007081757299602032, 0.07482868432998657, 0.014152184128761292, 0.000454294728115201, -0.020701393485069275, -0.034649621695280075, -0.04677359014749527, -0.00710441917181015, -0.0038864684756845236, 0.0004266758915036917, 0.004305708687752485, -0.0031839581206440926, -0.0054104626178741455, 0.025313032791018486, 0.012021991424262524, -0.009523547254502773, 0.1052405834197998, -0.01465073972940445, -0.0013908571563661098, 0.009993775747716427, -0.0023327309172600508, 0.06957118213176727, -0.022480331361293793, 0.02456519939005375, -0.001378110027872026, -0.007433012593537569, -0.022480331361293793, 0.04709085449576378, 0.005291488952934742, -0.01247522421181202, -0.0009043404133990407, 0.018775155767798424, -0.003045155666768551, -0.017313480377197266, 0.01964762806892395, -0.007659628987312317, -0.03523882478475571, -0.0013972307788208127, 0.012055983766913414, 0.0027972941752523184, -0.024905124679207802, -0.023772044107317924, 0.002965840045362711, 0.002773216227069497, 0.04058696702122688, -0.031114408746361732, 0.0006540003232657909, -0.0473627932369709, -0.013846252113580704, 0.008628413081169128, 0.056472767144441605, 0.0175400972366333, 0.021551204845309258, -0.020780708640813828, -0.013291042298078537, 0.028395013883709908, 0.0149113480001688, 0.022423677146434784, 0.04004308953881264, 0.007285711821168661, -0.008078868500888348, -0.010407350957393646, -0.006367916241288185, -0.020848693326115608, 0.007121415343135595, -0.08683934062719345, 0.0024984439369291067, 0.00944423209875822, 0.005926014389842749, -0.04627503454685211, -0.027307257056236267, -0.027533872053027153, 0.010826590470969677, 0.006583201698958874, 0.03902331739664078, 0.0870206356048584, 0.03523882478475571, -0.0014425539411604404, -0.013393019326031208, -0.014888687059283257, -0.0003250526497140527, -0.029392125084996223, -0.001098380540497601, 0.01663363166153431, 0.04926636815071106, 0.02957341820001602, 0.058512311428785324, 0.0071497424505651, -0.021471887826919556, 0.019341696053743362, 0.029709389433264732, -0.020463446155190468, 0.02445189282298088, 0.009551874361932278, 0.03750498592853546, 0.0373690165579319, -0.04976492375135422, -0.013585642911493778, -0.014673401601612568, -0.018378576263785362, 0.016610970720648766, 0.017868690192699432, 0.018707171082496643, 0.027805812656879425, 0.0017647739732638001, 0.007427347358316183, 0.003685346571728587, -0.024791816249489784, 0.010016437619924545, 0.018707171082496643, 0.012554539367556572, 0.07564450055360794, -0.007920237258076668, 0.014707393944263458, 0.04391822591423988, 0.04038301482796669, 0.017166180536150932, 0.013574312441051006, -0.06086912006139755, -0.018525877967476845, -0.004688123241066933, -0.01487735565751791, -0.0011854862095788121, 0.015965113416314125, 0.0698431208729744, -0.005554930306971073, -0.06290866434574127, 0.019862912595272064, 0.032927338033914566, -0.027352578938007355, 0.04294377565383911, 0.04554986208677292, -0.03653053566813469, -0.026264822110533714, -0.010917237028479576, 0.013823590241372585, 0.04434879869222641, 0.02565295808017254, -0.0177213903516531, -0.02214040607213974, 0.0034898901358246803, 0.06404174864292145, 0.006690844427794218, -0.016973556950688362, -0.003651353996247053, 0.03761829435825348, -0.056155502796173096, 0.00992012582719326, 0.050580743700265884, -0.06118638440966606, -0.0028766097966581583, -0.03872871398925781, -0.02226504497230053, 0.03609996661543846, -0.035352133214473724, -0.02047477662563324, 0.010067426599562168, -0.0715654045343399, -0.003498388221487403, -0.05502242222428322, -0.031771596521139145, 0.09309394657611847, 0.019726943224668503, 0.04704552888870239, -0.013415681198239326, 0.012339253909885883, 0.006877802778035402, -0.029256155714392662, 0.029233494773507118, -0.03360718861222267, 0.023953335359692574, 0.011081533506512642, -0.011908682994544506, -0.010900241322815418, 0.03782225027680397, 0.032406121492385864, -0.04561784863471985, 0.004453008994460106, -0.011908682994544506, -0.011398796923458576, -0.000898675003554672, 0.004821260459721088, 0.009007995016872883, -0.0013391603715717793, -0.014820701442658901, -0.0014885853743180633, 0.005025214981287718, 0.0015990608371794224, 0.008741721510887146, -0.034468330442905426, 0.026786038652062416, 0.01696222461760044, -0.041697386652231216, -0.012361915782094002, 0.012905794195830822, 0.032406121492385864, 0.011257161386311054, 0.031046424061059952, -0.00952921248972416, 0.029460111632943153, 0.012622524052858353, -0.032927338033914566, 0.00547278206795454, -0.0013257049722597003, -0.012792486697435379, -0.018979109823703766, -0.014900017529726028, 0.00797122623771429, 0.049311693757772446, -0.007331035099923611, -0.039907120168209076, 0.03764095529913902, 0.011716059409081936, 0.01931903325021267, 0.0652654767036438, -0.031386349350214005, 0.00995411816984415, 0.029006877914071083, -8.905310096452013e-05, -0.027873797342181206, -0.002638662699609995, -0.01868450827896595, 0.01225993875414133, -0.012599863111972809, 0.002009802730754018, 0.02379470504820347, -0.004563484340906143, -0.01977226696908474, 0.0023653069511055946, 0.028055090457201004, 0.0032236159313470125, 0.033312585204839706, -0.036961108446121216, -0.0016089752316474915, -0.013325034640729427, 0.0257889274507761, 0.02259363792836666, -0.00992012582719326, 0.0477253794670105, 0.00018642726354300976, 0.01747211255133152, 0.035488102585077286, 0.012917125597596169, -0.06975247710943222, -0.04990089684724808, -0.0015834809746593237, 0.01868450827896595, -0.03340323269367218, 0.010095753706991673, -0.014469446614384651, 0.0051668500527739525, 0.0049883900210261345, -0.03134102374315262, 0.012191953137516975, -0.013710282742977142, 0.0010403101332485676, 0.01436746958643198, 0.018673177808523178, -0.034966886043548584, 0.02138124220073223, 0.011143852956593037, -0.0284176766872406, -0.025381019338965416, 0.027669843286275864, -0.01905842497944832, -0.02181181311607361, -0.0021783486008644104, 0.013109749183058739, -0.018457893282175064, 0.020440785214304924, 0.030547868460416794, 0.031975552439689636, -0.03437768295407295, -0.037210386246442795, 0.004696621559560299, 0.03297266364097595, 0.02995866723358631, -0.001817178912460804, -0.02515440247952938, 0.006435900926589966, -0.02361341193318367, 0.020270822569727898, 0.029097525402903557, -0.04267183691263199, 0.0533454604446888, -0.013778267428278923, -0.048087965697050095, 0.018321922048926353, 0.030933115631341934, 0.019624965265393257, -0.0028284539002925158, -0.02449721470475197, 0.009172292426228523, -0.002280325861647725, -0.0058297025971114635, 0.0103960195556283, -0.033697836101055145, 0.0051668500527739525, -0.01594245247542858, -0.020962001755833626, 0.03249676898121834, 0.023273486644029617, -0.0007442926871590316, -0.0224576685577631, 0.008401797153055668, 0.0515778549015522, 0.01882047764956951, -0.020066868513822556, 0.028893569484353065, 0.025811588391661644, -0.005741888657212257, 0.01670161634683609, 0.013619636185467243, -0.03576004132628441, 0.009319592267274857, -0.0031273041386157274, -0.046682946383953094, -0.04940234124660492, -0.02200443670153618, -0.012656516395509243, 0.03551076352596283, -0.07011506706476212, 0.04790667071938515, 0.062047526240348816, -0.027420565485954285, 0.020656069740653038, 0.010968226008117199, -0.005537934135645628, -0.00456065172329545, -0.00631692772731185, -0.00952921248972416, -0.04727214574813843, 0.005243333056569099, -0.017200171947479248, 0.01982892118394375, -0.041765373200178146, 0.0022619133815169334, 0.0043651950545609, 0.0036938446573913097, -0.049175724387168884, -0.03335791081190109, -0.03313129395246506, -0.026831362396478653, -0.016871578991413116, -0.01810663752257824, 0.04190134257078171, 0.02680870145559311, -0.025811588391661644, 0.008951341733336449, 0.003155631013214588, -0.015704505145549774, -0.01747211255133152, 0.0061582960188388824, 0.0033397567458450794, -0.019160402938723564, -0.04228658974170685, -0.024610523134469986, 0.01276982482522726, -0.01618039980530739, 0.0015126633225008845, -0.01656564697623253, -0.016724279150366783, 0.009540543891489506, 0.0005672487895935774, -0.0037674950435757637, -0.041810695081949234, 0.015330588445067406, -0.0004783727054018527, 0.004220727365463972, -0.04704552888870239, 0.013993552885949612, 0.046682946383953094, 0.02393067441880703, 0.03863806650042534, -0.0047419448383152485, -0.03757297247648239, -0.004775937180966139, 0.020565424114465714, 0.01632769964635372, 0.007546320557594299, -0.002965840045362711, 0.0072120619006454945, -0.01317773386836052, -0.026151513680815697, 0.050127509981393814, -0.014129522256553173, 0.017574088647961617, -0.02674071677029133, 0.060189273208379745, 0.033629849553108215, -0.02495044842362404, -0.009160961024463177, -0.013608304783701897, 0.04371427372097969, 0.05447854474186897, -0.0035692057572305202, 5.9033086472481955e-06, -0.04498332366347313, 0.045731157064437866, 0.02059941552579403, 0.007959894835948944, 0.028780262917280197, 0.00722905807197094, -0.00844711996614933, -0.05488645285367966, -0.01433347724378109, 0.0038694723043590784, -0.02624215930700302, 0.014639409258961678, -0.024859800934791565, -0.00742168165743351, -0.005319816060364246, -0.01016940362751484, -0.01286047138273716, -0.023908013477921486, -0.012339253909885883, 0.03693844750523567, -0.030366575345396996, 0.013064426369965076, -0.028644291684031487, 0.0017605249304324389, -0.008022215217351913, 0.004149909596890211, -0.0038893010932952166, -0.02054276131093502, -0.009670848026871681, 0.005954341497272253, -0.022888239473104477, 0.009840809740126133, 0.004724948666989803, -0.013857582584023476, -0.00702510355040431, 0.01708686351776123, -0.0029176841489970684, -0.0031443003099411726, 0.008532101288437843, -0.026786038652062416, -0.019919566810131073, -0.038479436188936234, -0.025902235880494118, -0.01931903325021267, -0.05484113097190857, 0.02873493917286396, -0.03453631326556206, 0.003855308750644326, -0.011206173337996006, -0.00662285927683115, -0.01854853890836239, -0.0008335228194482625, -0.015783820301294327, 2.027706386797945e-06, 0.012588531710207462, 0.03915928676724434, -0.02669539302587509, -0.007642632350325584, -0.03238346055150032, 0.005971337668597698, -6.378007674356923e-05, 0.006792821455746889, 0.046546973288059235, 0.014548762701451778, 0.018956448882818222, -0.00737635837867856, -0.026831362396478653, -0.004622971173375845, -0.041380126029253006, -0.007551986258476973, 0.012395908124744892, 0.03154497966170311, 0.003911962732672691, 0.014390131458640099, 0.029800035059452057, 0.010679289698600769, -0.007127080578356981, 0.013744275085628033, -0.03129570186138153, 0.011965337209403515, 0.008452785201370716, 0.026831362396478653, 0.027420565485954285, -0.01886580139398575, 0.03204353526234627, -0.02041812241077423, 0.016089752316474915, -0.005841033533215523, 0.02361341193318367, -0.018582532182335854, -0.009835144504904747, 0.004467172548174858, 0.026922008022665977, -0.03501220792531967, 0.015511881560087204, 0.006424570456147194, -0.03691578656435013, -0.02072405442595482, -0.05162317678332329, -0.020497439429163933, 0.01817462220788002, -0.017109526321291924, 0.006911795120686293, 0.008203507401049137, 0.0034105742815881968, -0.04690955951809883, 0.011149519123136997, 0.0031641290988773108, -0.053662724792957306, 0.00718373479321599, -0.02488246187567711, 0.006373581476509571, 0.012157960794866085, -0.013914236798882484, 0.023409457877278328, 0.02368139661848545, 0.013732943683862686, -0.01405020710080862, -0.06200220063328743, 0.011574423871934414, -0.01868450827896595, 0.0133363651111722, -0.008690732531249523, 0.04249054566025734, -0.019874243065714836, -0.02662740834057331, -0.005475614685565233, -0.060370564460754395, -0.011058872565627098, 0.0026910677552223206, 0.032088860869407654, -0.0012286849087104201, 0.03032125160098076, 0.04097221419215202, -0.014548762701451778, -0.046365682035684586, -0.031567640602588654, 0.026786038652062416, -0.013721613213419914, -0.007336700800806284, 0.031069086864590645, -0.001421308727003634, 0.0533454604446888, 0.011279823258519173, -0.018729832023382187, -0.0133363651111722, -0.02386268973350525, 0.007920237258076668, -0.0006416072137653828, 0.04269449785351753, -0.004195232875645161, -0.009971114806830883, -0.01599910669028759, 0.020497439429163933, -0.008594420738518238, 0.03870605304837227, 0.00718373479321599, 0.0035437115002423525, -0.00242337747476995, 0.03852476179599762, 0.02610618993639946, -0.022219721227884293, -0.0027873797807842493, 0.004804264288395643, 0.023885350674390793, 0.003979947417974472, 0.04663762077689171, -0.007750275079160929, -0.009767159819602966, -0.0034870572853833437, 3.370473859831691e-05, 0.021800482645630836, 0.008566093631088734, 0.005373637657612562, -0.04511929303407669, -0.0014000633964315057, 0.02099599502980709, -0.009115638211369514, 0.0037136736791580915, 0.04557252675294876, 0.0008051958284340799, 0.015579866245388985, -0.005458618514239788, 0.006883468013256788, -0.013585642911493778, 0.007251719478517771, -0.007195065729320049, 0.02189112827181816, 0.00857175886631012, -0.029233494773507118, -0.002965840045362711, -0.022049760445952415, -0.03224749118089676, -0.005501109175384045, -0.0029488438740372658, 0.01695089414715767, -0.017574088647961617, 0.020497439429163933, 0.0037929893005639315, -0.05701664462685585, -0.02495044842362404, -0.0022689951583743095, 0.040994878858327866, 0.031386349350214005, -0.006985445506870747, 0.06123170629143715, 0.01068495586514473, -0.012588531710207462, 0.03487623855471611, -0.018083976581692696, 0.03204353526234627, -0.020633408799767494, -0.03483091667294502, -0.034400343894958496, 0.012373246252536774, 0.0034842246677726507, 0.019919566810131073, -0.029256155714392662, 0.002943178405985236, -0.002140107098966837, 0.03251942992210388, 0.0477253794670105, -0.053209491074085236, -0.07138411700725555, -0.010866248980164528, -0.0259702205657959, 0.010571647435426712, 0.0049940552562475204, 0.004166906233876944, -0.016282375901937485, 0.03578270226716995, -0.03480825573205948, -0.03270072117447853, -0.019500326365232468, 0.007880579680204391, -0.015851804986596107, 0.01312107965350151, -0.023454779759049416, 0.0025111911818385124, -0.029641402885317802, -0.006730502005666494, 0.0014007716672495008, -0.04502864554524422, -0.01097955647855997, -0.006214950233697891, 0.004900576081126928, -0.027805812656879425, 0.007002441678196192, -0.02329614944756031, -0.05733390897512436, 0.0021953447721898556, -0.02866695448756218, -0.020780708640813828, -0.027533872053027153, 0.02995866723358631, -0.0016684620641171932, 0.03813951089978218, 0.026582084596157074, 0.0407002754509449, -0.009376246482133865, 0.02961874194443226, -0.008101530373096466, -0.015330588445067406, -0.022163067013025284, -0.016973556950688362, 0.0049940552562475204, 0.08090199530124664, 0.008350808173418045, 0.01286047138273716, 0.028938893228769302, -0.015840474516153336, -0.01138746552169323, -0.0047391122207045555, -0.015704505145549774, -0.009007995016872883, -0.020316146314144135, 6.178833427838981e-05, -0.0052376678213477135, 0.005263162311166525, 0.061141058802604675, 0.03392444923520088, 0.05565694719552994, 0.019953560084104538, -0.005543599836528301, 0.044507429003715515, -0.004132913425564766, 0.005002553574740887, 0.01803865283727646, -0.0039034646470099688, -0.0032632737420499325, 0.01829926110804081, 0.007648298051208258, 0.019353026524186134, -0.007767271716147661, 0.0020055538043379784, 0.018197283148765564, 0.02266162447631359, 0.01901310309767723, 0.004234890919178724, -0.01656564697623253, 0.02182314358651638, 0.034083083271980286, -0.011217503808438778, -0.023092195391654968, -0.02406664378941059, 0.016667624935507774, 0.02726193331182003, 0.0018667512340471148, -0.0340377576649189, 0.01984025165438652, 0.043283700942993164, -0.00571356201544404, 0.0021457725670188665, -0.011495108716189861, -0.006804152391850948, 0.024043982848525047, 0.016520323231816292, -0.011693397536873817, 0.01624838449060917, 0.015568535774946213, -0.004019605461508036, -0.027987105771899223, 0.02015751414000988, -0.013483665883541107, 0.019307702779769897, -0.035352133214473724, -0.015908459201455116, 0.005067705642431974, -0.0010027769021689892, 0.02834969200193882, 0.0016033098800107837, 0.014288153499364853, -0.017392795532941818, 0.0036230271216481924, -0.004229225683957338, -0.013155072927474976, 0.005427458789199591, -0.02449721470475197, -0.022888239473104477, 0.037459664046764374, -0.03417372703552246, 0.013970891013741493, 0.0087303901091218, 0.05330013856291771, 0.006991110742092133, -0.020270822569727898, 0.004656963516026735, -0.028644291684031487, -0.019149072468280792, 0.02258230745792389, 0.03013996034860611, 0.009489554911851883, 0.048541199415922165, -0.005070538260042667, -0.012441230937838554, -0.03827548399567604, 0.007874914444983006, 0.019341696053743362, 0.015455227345228195, 0.008543431758880615, 0.010537655092775822, 0.007285711821168661, 0.032474108040332794, -0.002480031456798315, 0.003158463863655925, -0.007653963286429644, 0.0349215604364872, -0.014934009872376919, 0.01850321516394615, -0.009166627191007137, -0.007976891472935677, -0.026400791481137276, 0.007189400028437376, 0.03213418275117874, 0.024927785620093346, 0.0019021600019186735, -0.01503598690032959, 0.025199726223945618, 0.03968050330877304, -0.03313129395246506, 0.013970891013741493, 0.001548072206787765, -0.01433347724378109, -0.011574423871934414, -0.02329614944756031, 0.010543320327997208, 0.013936898671090603, -0.025494325906038284, -0.02617417462170124, 0.00093195925001055, -0.004688123241066933, -0.018661847338080406, -0.0326327383518219, -0.013834921643137932, 0.012690509669482708, 0.021993106231093407, -0.003308597020804882, -0.021324587985873222, 0.007195065729320049, 0.04242255911231041, 0.0046739596873521805, 0.027103301137685776, -0.00020023669640067965, -0.02163052000105381, -0.0331539548933506, -0.006056318990886211, -0.009914460591971874, -0.0055860900320112705, -0.022559646517038345, -0.007648298051208258, 0.01586313731968403, 0.00861141737550497, -0.04709085449576378, -0.012905794195830822, 0.003710840828716755, -0.036507874727249146, -0.01257720123976469, 0.007585978601127863, 0.01273583248257637, 0.008634078316390514, 0.022570976987481117, -0.03238346055150032, -0.023058202117681503, -0.02771516516804695, 0.012758494354784489, 0.002329898066818714, 0.0028808589559048414, -0.019874243065714836, 0.01971561275422573, -0.012373246252536774, -0.03297266364097595, -0.02771516516804695, 0.0075576514936983585, 0.027533872053027153, -0.008118527010083199, 0.018967779353260994, 0.00117132265586406, -0.007285711821168661, 0.01068495586514473, -0.034400343894958496, -0.00238230312243104, 0.0007248178590089083, -0.016033098101615906, -0.025290371850132942, -0.020452115684747696, 0.0022208390291780233, -0.003843977814540267, -0.0017591085052117705, 0.004835424013435841, 0.024859800934791565, -0.0005509607144631445, 0.03707441687583923, 0.01574982888996601, 0.015307926572859287, 0.05266561359167099, 0.05302819982171059, 0.01465073972940445, -0.012033321894705296, 0.015330588445067406, -0.0024460391141474247, -0.011047541163861752, 0.010129746049642563, -0.009070314466953278, -0.005546432454138994, -0.013834921643137932, -0.010922902263700962, 0.035034868866205215, 0.025630297139286995, -0.007098753470927477, 0.014480777084827423, -0.0013080006465315819, 0.026446115225553513, 0.012101306580007076, -0.008787044323980808, -0.005764550529420376, 0.02936946414411068, 0.07609773427248001, -0.03897799178957939, -0.011121192015707493, 0.012486554682254791, -0.002443206263706088, 0.014004883356392384, -0.01436746958643198, 0.02968672662973404, 0.03281402960419655, 0.012713170610368252, -0.021653180941939354, -0.011251496151089668, 0.026763377711176872, -0.04727214574813843, 0.0042518870905041695, 0.041357461363077164, -0.032610077410936356, -0.013868913985788822, 0.0359639972448349, 0.011364804580807686, 0.0029771707486361265, -0.02476915530860424, -0.010622636415064335, 0.019285041838884354, 0.015557204373180866, 0.02936946414411068, -0.009189288131892681, 0.005999664776027203, -0.009387577883899212, -0.018718501552939415, -0.007551986258476973, 0.031023763120174408, -0.010781267657876015, 0.014424123801290989, -0.023205501958727837, 0.01971561275422573, 0.04582180455327034, 0.0027023986913263798, 0.03693844750523567, 0.0025140237994492054, -0.005127192474901676, -0.005535101518034935, 0.016305038705468178, -0.009166627191007137, -0.03915928676724434, 0.009665182791650295, 0.00882670283317566, -0.016622301191091537, 0.042966436594724655, -0.008226169273257256, -0.009302596561610699, 0.0037051753606647253, -0.02291090227663517, 0.013948229141533375, 0.0300039891153574, 0.011693397536873817, -0.03530681133270264, 0.01996489055454731, 0.03750498592853546, 0.0015126633225008845, -0.025290371850132942, -0.022740939632058144, -0.0006316927610896528, -0.015557204373180866, -0.003025326645001769, 0.03129570186138153, 0.01408419944345951, -0.035284146666526794, 0.02617417462170124, 0.0206107459962368, 0.009772825054824352, 0.013891574926674366, -0.008362139575183392, -0.012157960794866085, 0.0034842246677726507, 0.0020480442326515913, -0.004872248973697424, -0.0554303303360939, 0.009285599924623966, 0.004849587567150593, 0.01417484600096941, -0.03621327504515648, 0.009517882019281387, 0.014118191786110401, 0.005362306721508503, -0.01286047138273716, 0.019364356994628906, -0.00025635960628278553, 0.028848247602581978, -0.013698951341211796, 0.008005218580365181, 0.007546320557594299, -0.00837913528084755, 0.003914795350283384, -0.01408419944345951, -0.029256155714392662, 0.012849140912294388, -0.03007197380065918, 0.007693621329963207, -0.013823590241372585, -0.006413239520043135, 0.010690621100366116, 0.002570678014308214, 0.012044653296470642, 0.014628077857196331, 0.029596081003546715, -0.04550454020500183, 0.016939563676714897, -0.023012878373265266, 0.005818371661007404, -0.008940010331571102, 0.02642345242202282, -0.0037363350857049227, -0.00790324155241251, 0.018718501552939415, -0.008747386746108532, -0.01875249296426773, 0.020010214298963547, -0.011121192015707493, -0.01301910262554884, 0.030411899089813232, 0.00944423209875822, -0.021743828430771828, 0.0006115097785368562, -0.005739056039601564, 0.01759675145149231, -0.0006412531365640461, 0.03947654739022255, 0.028009766712784767, -0.01261119358241558, -0.011540431529283524, 0.017132187262177467, 0.03231547400355339, 0.0041754040867090225, -0.04663762077689171, -0.009614193812012672, -0.029278818517923355, -0.01016940362751484, -0.005702231079339981, 0.0341963917016983, -0.01977226696908474, -0.009421570226550102, 0.009704840369522572, -0.012373246252536774, 0.006537878420203924, -0.005019549746066332, 0.011217503808438778, 0.011274158023297787, 0.03204353526234627, 0.029233494773507118, 0.005387801211327314, 0.007053430192172527, 0.008792709559202194, 0.03435502201318741, -0.014616747386753559, -0.0033539202995598316, -0.014514770358800888, -0.013064426369965076, 0.007359362207353115, -0.018015990033745766, -0.00025281874695792794, 0.004135746508836746, 0.005050709471106529, -0.005246165674179792, -0.0014326395466923714, -0.01785735972225666, -0.016271045431494713, -0.0056512425653636456, -0.008713394403457642, 0.010107084177434444, -0.03217950463294983, 0.004580480512231588, 0.026128852739930153, 0.007642632350325584, 0.028508322313427925, 0.0037533314898610115, -0.014061537571251392, 0.005308485124260187, 0.041108183562755585, 0.0015395740047097206, 0.011098530143499374, -0.07491932809352875, 0.00806187279522419, -0.002499860245734453, 0.026219498366117477, -0.0011628245702013373, 0.018854470923542976, -0.01468473207205534, -0.0012570118997246027, -0.012792486697435379, 0.014220168814063072, -0.006996776442974806, -0.0266727302223444, 0.037980880588293076, -0.016588307917118073, 0.0014234331902116537, -0.013619636185467243, 0.04006575047969818, 0.003232114017009735, 0.005081869196146727, 0.006951453164219856, -0.006736167706549168, -0.02891623228788376, 0.0010488082189112902, 0.014265491627156734, -0.006486889906227589, -0.004441678058356047, -0.014616747386753559, -0.027035316452383995, 0.028236383572220802, 0.0005198009894229472, 0.03915928676724434, -0.00702510355040431, 0.03562407195568085, -0.035034868866205215, -0.006730502005666494, -0.025290371850132942, 0.019296372309327126, -0.003557874821126461, 0.0073083736933767796, 0.0505354218184948, -0.03220216557383537, 0.01804998330771923, 0.033108633011579514, -0.02138124220073223, 0.018219945952296257, 0.013257049955427647, -0.021415233612060547, -0.010339365340769291, 0.029324140399694443, 0.028893569484353065, -0.015126633457839489, -0.03716506436467171, 0.017574088647961617, -0.0092119500041008, -0.007274381350725889, -0.04151609539985657, -0.01637302339076996, 0.016622301191091537, -0.02712596394121647, 0.004571982659399509, -0.020678730681538582, 0.0047391122207045555, 0.02483713999390602, 0.02123394049704075, -0.013313704170286655, -0.029641402885317802, -0.04663762077689171, 0.024474553763866425, 0.01703020930290222, -0.00758031290024519, 0.0013398685259744525, -0.011659405194222927, 0.01715484820306301, 0.022435007616877556, 0.01791401393711567, -0.051169946789741516, -0.005200842395424843, -0.013007772155106068, -0.0052376678213477135, 0.021347248926758766, -0.021086640655994415, -0.004727781284600496, -0.020463446155190468, 0.003611696185544133, 0.006928791292011738, 0.025313032791018486, 0.01715484820306301, -0.009806817397475243, -0.006753163877874613, -0.0010672208154574037, 0.017313480377197266, -0.046818915754556656, 0.0035493767354637384, -0.01874116249382496, 0.009364916011691093, -0.017778044566512108, -0.026446115225553513, -0.022831585258245468, -0.03052520751953125, -0.015817813575267792, 0.027420565485954285, 0.0024970276281237602, 0.015557204373180866, 0.029800035059452057, -0.009149630554020405, 0.0013441175688058138, -0.05357207730412483, 0.00947255827486515, 0.02522238716483116, -0.017880020663142204, 0.011047541163861752, -0.047000207006931305, 0.011308150365948677, 0.012327923439443111, -0.018593862652778625, -0.02195911295711994, -0.03480825573205948, -0.017766712233424187, 0.015591196715831757, 0.020962001755833626, 0.0009539127349853516, -0.0008335228194482625, 0.007257385179400444, 0.007568982429802418, -0.04781602695584297, 0.01663363166153431, 0.008741721510887146, -0.0002115675015375018, -0.008424459025263786, 0.029709389433264732, 0.034898899495601654, 0.021267933771014214, 0.01436746958643198, 0.031182393431663513, 0.027465887367725372, 0.010764271020889282, 0.034649621695280075, 0.0012329339515417814, -0.028304368257522583, -0.049946218729019165, 0.013302372768521309, -0.027057979255914688, -0.009483889676630497, 0.01747211255133152, 0.008990999311208725, -0.033108633011579514, -0.031567640602588654, -0.00809586513787508, -0.0035465441178530455, 0.0477253794670105, 0.024927785620093346, 0.005147021263837814, 0.020882686600089073, -0.00361452903598547, 0.015364580787718296, 0.04881313815712929, -0.023885350674390793, 0.023908013477921486, -0.02424793690443039, 0.025630297139286995, 0.011404462158679962, -0.000710654363501817, -0.030026651918888092, 0.007529324386268854, 0.004379358608275652, 0.013676289469003677, -0.00021298385399859399, 0.003081980859860778, -0.0033794145565479994, -0.0012003579176962376, 0.02291090227663517, -0.011727389879524708, -0.02445189282298088, -0.024587862193584442, -0.026967331767082214, -0.0016203060513362288, -0.0036230271216481924, -0.051668502390384674, 0.02022549882531166, -0.04375959560275078, -0.005299987271428108, -0.014288153499364853, 0.006951453164219856, -0.011772713623940945, -0.00896267220377922, -0.023817365989089012, 0.02028215304017067]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-14T10:06:46.522492", "url_path": "/agents/", "chunk_size": 2636}
updated_dt: 2025-03-14T10:06:49.285159
---
```

  * The `AgentRun` is an async iterator that yields each node (`BaseNode` or `End`) in the flow.
  * The run ends when an `End` node is returned.


#### Using `.next(...)` manually
You can also drive the iteration manually by passing the node you want to run next to the `AgentRun.next(...)` method. This allows you to inspect or modify the node before it executes or skip nodes based on your own logic, and to catch errors in `next()` more easily:
agent_iter_next.py```
frompydantic_aiimport Agent
frompydantic_graphimport End
agent = Agent('openai:gpt-4o')

async defmain():
  async with agent.iter('What is the capital of France?') as agent_run:
    node = agent_run.next_node [](https://ai.pydantic.dev/agents/#__code_3_annotation_1)
    all_nodes = [node]
    # Drive the iteration manually:
    while not isinstance(node, End): [](https://ai.pydantic.dev/agents/#__code_3_annotation_2)
      node = await agent_run.next(node) [](https://ai.pydantic.dev/agents/#__code_3_annotation_3)
      all_nodes.append(node) [](https://ai.pydantic.dev/agents/#__code_3_annotation_4)
    print(all_nodes)
"""
    [
      UserPromptNode(
        user_prompt='What is the capital of France?',
        system_prompts=(),
        system_prompt_functions=[],
        system_prompt_dynamic_functions={},
      ),
      ModelRequestNode(
        request=ModelRequest(
          parts=[
            UserPromptPart(
              content='What is the capital of France?',
              timestamp=datetime.datetime(...),
              part_kind='user-prompt',
            )
          ],
          kind='request',
        )
      ),
      CallToolsNode(
        model_response=ModelResponse(
          parts=[TextPart(content='Paris', part_kind='text')],
          model_name='gpt-4o',
          timestamp=datetime.datetime(...),
          kind='response',
        )
      ),
      End(data=FinalResult(data='Paris', tool_name=None, tool_call_id=None)),
    ]
    """

```

#### Accessing usage and the final result
You can retrieve usage statistics (tokens, requests, etc.) at any time from the [`AgentRun`](https://ai.pydantic.dev/api/agent/#pydantic_ai.agent.AgentRun) object via `agent_run.usage()`. This method returns a [`Usage`](https://ai.pydantic.dev/api/usage/#pydantic_ai.usage.Usage) object containing the usage data.
Once the run finishes, `agent_run.final_result` becomes a [`AgentRunResult`](https://ai.pydantic.dev/api/agent/#pydantic_ai.agent.AgentRunResult) object containing the final output (and related metadata).
### Streaming
Here is an example of streaming an agent run in combination with `async for` iteration:
streaming.py