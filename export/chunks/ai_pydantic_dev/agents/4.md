---
url: https://ai.pydantic.dev/agents/
session_id: pydantic_ai_docs
chunk_number: 4
title: Using AgentRun in Pydantic AI
summary: The AgentRun is an async iterator that processes nodes in a flow until an End node is reached. Users can manually control the iteration by leveraging the AgentRun.next method, allowing for node inspection, modification, and error handling.
embedding: [0.005542389117181301, 0.052155666053295135, 0.024038733914494514, -0.06294024735689163, -0.003642060561105609, -5.854449773323722e-05, 0.01052969042211771, 0.014205736108124256, 0.040555451065301895, -0.00387429166585207, 0.0020900783129036427, -0.027641143649816513, -0.05011656507849693, -0.04032888263463974, 0.0006945687346160412, -0.007997806183993816, -0.04780558496713638, 0.003823314094915986, 0.025783296674489975, 0.03554832562804222, 0.03323734179139137, -0.020844141021370888, 0.002420016098767519, 0.037632737308740616, -0.04177891090512276, -0.011175405234098434, -0.026621593162417412, 0.07997806370258331, -0.028751321136951447, -0.0034862959291785955, 0.0032257442362606525, -0.008009134791791439, -0.03185528516769409, -0.014024482108652592, 0.029997438192367554, -0.01712844707071781, 0.009413848631083965, 0.0011498263338580728, -0.011147084645926952, 0.0246278066188097, 0.033735789358615875, -0.02073085866868496, 0.0008135162643156946, 0.022282840684056282, 0.008989036083221436, -0.010229488834738731, 0.01111876405775547, 0.004893842153251171, 0.04252658039331436, 0.005896399728953838, -0.01752493903040886, 0.04134843498468399, -0.018850354477763176, -0.0003720650856848806, -0.025262193754315376, -0.00021488440688699484, 0.006763017736375332, 0.024197328835725784, -0.0023803669027984142, -0.08233436197042465, 0.01854448951780796, 0.009345878846943378, 0.03174200281500816, 0.042050790041685104, -0.03271624073386192, 0.03423423692584038, -0.05124939978122711, 0.040963269770145416, -0.047125887125730515, -0.003860131138935685, 0.020062485709786415, 0.028252875432372093, -0.05274474248290062, -0.015383882448077202, -0.03955855593085289, -0.018159326165914536, 0.03298811987042427, 0.024287955835461617, -0.011186733841896057, -0.017388999462127686, 0.006802666932344437, -0.020900784060359, -0.0003756052174139768, 0.010087884962558746, 0.02775442786514759, -0.027641143649816513, -0.03006540797650814, -0.030088065192103386, -0.03566160798072815, -0.06008550524711609, -0.035842861980199814, 0.027414577081799507, 0.004100858233869076, 0.05134002864360809, 0.025828611105680466, 0.06819659471511841, -0.01942809857428074, -0.0037666724529117346, 0.007776903919875622, 0.0331014022231102, 0.03194591403007507, -0.017876116558909416, -0.03806321695446968, -0.0023350536357611418, 0.018080027773976326, -0.010371093638241291, -0.013186185620725155, 0.018193310126662254, -0.01341275218874216, -0.04698994383215904, -0.06710907071828842, -0.007527680601924658, -0.02759583108127117, 0.01095450296998024, -0.05750264227390289, -0.019462084397673607, 0.004386899061501026, 0.012540469877421856, 0.058318283408880234, -0.010337108746170998, -0.01122071873396635, 0.025579387322068214, -0.035888172686100006, 0.006768682040274143, 0.009923623874783516, 0.002087246160954237, -0.009175953455269337, -0.02126329019665718, 0.008671842515468597, -0.006666726898401976, 0.01692453771829605, -0.01857847347855568, -0.018805040046572685, -0.0029057187493890524, -0.005236524157226086, -0.032036539167165756, -0.01801205798983574, -0.00451434263959527, -0.03733820095658302, 0.03346391022205353, -0.006287227384746075, -0.04214141517877579, -0.008790790103375912, 0.0007809472735971212, -0.0024384246207773685, 0.0672450140118599, -0.0615808442234993, 0.04540397971868515, -0.021150005981326103, 0.024174673482775688, 0.0518384724855423, 0.018567146733403206, -0.047080572694540024, 0.0026805680245161057, -0.009232595562934875, 0.014466287568211555, -0.00021913253294769675, 0.030541198328137398, -0.00108752038795501, -0.049799371510744095, -0.03151543438434601, 0.052608802914619446, -0.015961628407239914, -0.01490809302777052, -0.0390147939324379, -0.027867712080478668, -0.013537364080548286, -0.022044945508241653, -0.03273889794945717, -0.011634202674031258, 0.014126437716186047, -0.03248967230319977, -0.010614652186632156, 0.0038544670678675175, 0.03190059959888458, -0.032399047166109085, -0.08301406353712082, -0.010994152165949345, -0.00611730245873332, -0.029884155839681625, -0.018725741654634476, -0.03715694695711136, -0.04320628196001053, 0.0012262925738468766, -0.034664712846279144, -1.3795349332212936e-05, 0.01818198151886463, -0.0104503920301795, -0.03806321695446968, 0.024537179619073868, 0.02632705681025982, 0.07721395045518875, 0.004049880895763636, -0.007856202311813831, -0.029566962271928787, 0.013956512324512005, 0.039331987500190735, -0.003826146014034748, 0.013265484012663364, 0.02904585748910904, 0.013106887228786945, 0.00745404651388526, 0.03867494687438011, -0.004772062413394451, 0.006366525776684284, -0.05464790016412735, -0.009317558258771896, -0.012789693661034107, -0.009408184327185154, -0.013208841904997826, 0.001996619626879692, -0.012835007160902023, 0.03736085817217827, -0.030699795112013817, -0.023925449699163437, -0.021240632981061935, -0.04744308069348335, 0.05269942805171013, 0.0241067036986351, 0.0379725880920887, 0.04157499969005585, 0.014896764419972897, -0.006655398290604353, -0.022124243900179863, -0.016369448974728584, 0.004100858233869076, 0.017910102382302284, -0.01947341300547123, 0.017660878598690033, 0.028003651648759842, 0.012778365053236485, -0.013016260229051113, -0.013458065688610077, -0.04182422533631325, 0.023925449699163437, -0.06121833622455597, 0.032761551439762115, 0.011147084645926952, 0.0175702515989542, -0.05242754891514778, -0.027527861297130585, -0.015395211055874825, 0.04717119783163071, -0.016947193071246147, 0.0031011325772851706, 0.008796454407274723, 0.003194591263309121, -0.034506116062402725, 0.07485765963792801, 0.03765539452433586, 0.03566160798072815, -0.008966379798948765, -0.014398317784070969, -0.005924720782786608, -0.001116549246944487, -0.011396307498216629, -0.004242462571710348, -0.009991593658924103, -0.02872866578400135, -9.436594154976774e-06, 0.04472427815198898, -0.004740909207612276, -0.04341018944978714, 0.009589438326656818, -0.001202927902340889, 0.021353917196393013, 0.03638662025332451, -0.008365977555513382, -0.00399607140570879, -0.04427114501595497, 0.0010648637544363737, -0.0021920334547758102, 0.015848344191908836, -0.029023202136158943, -0.03831243887543678, 0.07617174088954926, 0.03731554374098778, 0.04257189482450485, 0.0041036903858184814, -0.03570692241191864, 0.010648638010025024, 0.052200980484485626, 0.034506116062402725, 0.046718064695596695, 0.0214218869805336, -0.012098664417862892, -0.006434496026486158, -0.011849441565573215, 0.028411472216248512, 0.021569155156612396, 0.011328337714076042, 0.02324574999511242, 0.034347519278526306, -0.022248854860663414, 0.030654482543468475, -0.007051890250295401, 0.07485765963792801, 0.014001825824379921, 0.00042587469215504825, -0.020719530060887337, -0.0346420556306839, -0.046718064695596695, -0.007063218858093023, -0.003959253896027803, 0.00038056133780628443, 0.0042991042137146, -0.003197423415258527, -0.0054121133871376514, 0.025216879323124886, 0.011962724849581718, -0.00945349782705307, 0.10521760582923889, -0.014658869244158268, -0.001404713955707848, 0.00996327307075262, -0.0023647905327379704, 0.06960130482912064, -0.02255471982061863, 0.024537179619073868, -0.0014415309997275472, -0.007380411960184574, -0.022509407252073288, 0.04698994383215904, 0.00523369200527668, -0.012483828701078892, -0.0009105151402764022, 0.01870308630168438, -0.0030898042023181915, -0.01732102781534195, 0.019620681181550026, -0.0076352995820343494, -0.03509519249200821, -0.0013948016567155719, 0.012008038349449635, 0.002840580651536584, -0.02487703040242195, -0.023789510130882263, 0.0030133379623293877, 0.002788187237456441, 0.04057810455560684, -0.031130272895097733, 0.000650317408144474, -0.04730713739991188, -0.013865885324776173, 0.008637857623398304, 0.056415122002363205, 0.017513610422611237, 0.02146719954907894, -0.020764842629432678, -0.013276811689138412, 0.02843412756919861, 0.014919420704245567, 0.02235081046819687, 0.03996637463569641, 0.007227479480206966, -0.008031792007386684, -0.010427734814584255, -0.006440159864723682, -0.02082148566842079, 0.007165173534303904, -0.08682037889957428, 0.0024752418976277113, 0.00943650584667921, 0.006009683478623629, -0.04633290320634842, -0.027278637513518333, -0.02766380086541176, 0.010841219685971737, 0.006587428506463766, 0.0390147939324379, 0.08709225803613663, 0.03525378927588463, -0.0014500272227451205, -0.013367438688874245, -0.014896764419972897, -0.00024904642486944795, -0.029408365488052368, -0.0011094690999016166, 0.016607344150543213, 0.04921029880642891, 0.02965758927166462, 0.05854485183954239, 0.00721048703417182, -0.021512513980269432, 0.01939411461353302, 0.02970290184020996, -0.020538276061415672, 0.02446920983493328, 0.009606430307030678, 0.03749679774045944, 0.03736085817217827, -0.04970874637365341, -0.013548691757023335, -0.014726839028298855, -0.018317922949790955, 0.016652656719088554, 0.017796818166971207, 0.018725741654634476, 0.027799740433692932, 0.001728987554088235, 0.007414397317916155, 0.0036675494629889727, -0.024763746187090874, 0.010031242854893208, 0.01865777187049389, 0.01257445476949215, 0.07567329704761505, -0.007873195223510265, 0.0147494962438941, 0.04402191936969757, 0.04041950777173042, 0.01732102781534195, 0.013526035472750664, -0.06090114265680313, -0.01862378790974617, -0.004721084609627724, -0.01495340559631586, -0.0011271695839241147, 0.01593897119164467, 0.06982787698507309, -0.005587702617049217, -0.06294024735689163, 0.019869904965162277, 0.03294280543923378, -0.027323950082063675, 0.04297971352934837, 0.04547194764018059, -0.03656787425279617, -0.02621377445757389, -0.010903525166213512, 0.013843229040503502, 0.04447505623102188, 0.02560204453766346, -0.01777416281402111, -0.022203542292118073, 0.0035967472940683365, 0.06407307833433151, 0.006666726898401976, -0.016969850286841393, -0.003749679774045944, 0.037632737308740616, -0.056007303297519684, 0.009946281090378761, 0.05052438750863075, -0.06117302551865578, -0.0028165080584585667, -0.038652289658784866, -0.022294169291853905, 0.03600145876407623, -0.03525378927588463, -0.02049296349287033, 0.010195503942668438, -0.07159509509801865, -0.0035231129731982946, -0.05501040816307068, -0.031832627952098846, 0.09316425025463104, 0.01972263678908348, 0.047125887125730515, -0.013401423580944538, 0.012302574701607227, 0.00678567448630929, -0.029159141704440117, 0.029227111488580704, -0.0335998497903347, 0.023880137130618095, 0.011107435449957848, -0.011951396241784096, -0.01097715925425291, 0.03785930573940277, 0.032399047166109085, -0.0456758588552475, 0.004477525595575571, -0.012008038349449635, -0.011447285301983356, -0.000895646691787988, 0.004840032197535038, 0.00894938688725233, -0.0013608165318146348, -0.014794809743762016, -0.001447903225198388, 0.005066599231213331, 0.0016227844171226025, 0.008745476603507996, -0.03441549092531204, 0.02673487737774849, 0.016901880502700806, -0.04164297133684158, -0.01229124702513218, 0.012936961837112904, 0.032399047166109085, 0.01122071873396635, 0.031062303110957146, -0.009521467611193657, 0.029544305056333542, 0.012585783377289772, -0.03298811987042427, 0.005550885573029518, -0.0012255845358595252, -0.01280102226883173, -0.018974965438246727, -0.01490809302777052, 0.007958156988024712, 0.04934623837471008, -0.007329434622079134, -0.03996637463569641, 0.03774602338671684, 0.011792799457907677, 0.019371457397937775, 0.06529653817415237, -0.03135683760046959, 0.00996327307075262, 0.029000544920563698, -9.593686263542622e-05, -0.027845054864883423, -0.0026324226055294275, -0.018691757693886757, 0.012223276309669018, -0.012585783377289772, 0.0020150281488895416, 0.023744195699691772, -0.00463612237945199, -0.019824590533971786, 0.0023732867557555437, 0.02811693400144577, 0.0032993783243000507, 0.033327970653772354, -0.03713429346680641, -0.0016227844171226025, -0.013333453796803951, 0.025828611105680466, 0.022622691467404366, -0.009912295266985893, 0.04776027426123619, 0.00021134430426172912, 0.017513610422611237, 0.03541238605976105, 0.012835007160902023, -0.06973724812269211, -0.04993531480431557, -0.0015732229221612215, 0.01865777187049389, -0.03341859579086304, 0.010104876942932606, -0.01452292874455452, 0.005165722221136093, 0.005007125437259674, -0.0313115268945694, 0.012189291417598724, -0.013695960864424706, 0.0010195503709837794, 0.014386989176273346, 0.018714414909482002, -0.03500456362962723, 0.02137657441198826, 0.011130091734230518, -0.028502097353339195, -0.025330163538455963, 0.027686458081007004, -0.019042935222387314, -0.021807050332427025, -0.002087246160954237, 0.013118214905261993, -0.018397221341729164, 0.020470306277275085, 0.03058651275932789, 0.031991224735975266, -0.034347519278526306, -0.037179604172706604, 0.004667275119572878, 0.03294280543923378, 0.02986149862408638, -0.0018196143209934235, -0.025126254186034203, 0.006417503580451012, -0.02365356869995594, 0.02032303810119629, 0.029113829135894775, -0.04268517717719078, 0.053333815187215805, -0.013763930648565292, -0.04807746782898903, 0.018351906910538673, 0.030949018895626068, 0.019665993750095367, -0.0027966834604740143, -0.024514522403478622, 0.00910798367112875, -0.0022713318467140198, -0.00590206403285265, 0.010422070510685444, -0.03369047865271568, 0.005114744417369366, -0.015961628407239914, -0.020912112668156624, 0.03251232951879501, 0.023359032347798347, -0.0007632467895746231, -0.02247542329132557, 0.008371641859412193, 0.05156659334897995, 0.018839025869965553, -0.02013045735657215, 0.02888726070523262, 0.025828611105680466, -0.00572930695489049, 0.016788596287369728, 0.013616662472486496, -0.03577489033341408, 0.009255251847207546, -0.0031492779962718487, -0.046718064695596695, -0.04952749237418175, -0.022010959684848785, -0.012631096877157688, 0.035435039550065994, -0.07005444169044495, 0.04780558496713638, 0.06203397735953331, -0.027437234297394753, 0.02065156027674675, 0.010903525166213512, -0.005499908234924078, -0.00464461836963892, -0.006270234938710928, -0.00959510263055563, -0.04730713739991188, 0.005253516603261232, -0.017185088247060776, 0.019869904965162277, -0.04171093925833702, 0.002244426868855953, 0.004352913703769445, 0.0037100305780768394, -0.04921029880642891, -0.033373285084962845, -0.0331014022231102, -0.02693878673017025, -0.016890551894903183, -0.018159326165914536, 0.041937507688999176, 0.02682550437748432, -0.025896580889821053, 0.009000364691019058, 0.003183262888342142, -0.015723733231425285, -0.017468297854065895, 0.006151287350803614, 0.0033022104762494564, -0.01911090686917305, -0.042300011962652206, -0.024559836834669113, 0.012812349945306778, -0.016301477327942848, 0.0015349898021668196, -0.016584686934947968, -0.016652656719088554, 0.009549789130687714, 0.0006195184541866183, -0.003735519479960203, -0.041801568120718, 0.015327241271734238, -0.0006290767923928797, 0.00421130983158946, -0.04703525826334953, 0.013933856040239334, 0.046718064695596695, 0.023880137130618095, 0.03862963244318962, -0.004780558403581381, -0.03767805173993111, -0.004854192957282066, 0.020515620708465576, 0.016290150582790375, 0.007567329797893763, -0.0029793528374284506, 0.0071595096960663795, -0.013186185620725155, -0.0261684600263834, 0.05007125437259674, -0.014149094000458717, 0.017660878598690033, -0.026689564809203148, 0.06017613038420677, 0.033577192574739456, -0.024967657402157784, -0.009164625778794289, -0.013605333864688873, 0.04370472580194473, 0.054466649889945984, -0.0036250681150704622, -6.934181874385104e-05, -0.045018814504146576, 0.04572117328643799, 0.02060624584555626, 0.007946829311549664, 0.028751321136951447, 0.007238808088004589, -0.008450940251350403, -0.05473852902650833, -0.014285034500062466, 0.003826146014034748, -0.026191117241978645, 0.014624884352087975, -0.02483171597123146, -0.00742572546005249, -0.005332814995199442, -0.01020116824656725, -0.01290297694504261, -0.023925449699163437, -0.012359216809272766, 0.03697569668292999, -0.030314631760120392, 0.013140872120857239, -0.028638038784265518, 0.0017119951080530882, -0.007975149899721146, 0.004092362243682146, -0.0038969481829553843, -0.02049296349287033, -0.009651743806898594, 0.0059417132288217545, -0.022871913388371468, 0.009889638982713223, 0.004797551315277815, -0.013786586932837963, -0.007017905358225107, 0.017071805894374847, -0.002928375266492367, -0.0031379496213048697, 0.008581215515732765, -0.02682550437748432, -0.019994515925645828, -0.038561660796403885, -0.025783296674489975, -0.01931481622159481, -0.054829154163599014, 0.02872866578400135, -0.034551430493593216, 0.0038912841118872166, -0.011260367929935455, -0.006672391202300787, -0.018533160910010338, -0.0007759911241009831, -0.015757717192173004, -9.92335844784975e-06, 0.012540469877421856, 0.03906010836362839, -0.026644250378012657, -0.00772026227787137, -0.03228576481342316, 0.0059643699787557125, -9.328178566647694e-05, 0.006808331236243248, 0.04658212512731552, 0.014534257352352142, 0.01895231008529663, -0.0074087330140173435, -0.026802847161889076, -0.0046332902275025845, -0.04134843498468399, -0.0076579563319683075, 0.012370545417070389, 0.03160606324672699, 0.003928101155906916, 0.014398317784070969, 0.029770871624350548, 0.010676958598196507, -0.007119860500097275, 0.013707288540899754, -0.03128886967897415, 0.012030694633722305, 0.008473596535623074, 0.02678018994629383, 0.027369264513254166, -0.01882769726216793, 0.03208185359835625, -0.0204023364931345, 0.016086239367723465, -0.005879407282918692, 0.023585598915815353, -0.018589802086353302, -0.009816004894673824, 0.004494518041610718, 0.02693878673017025, -0.03498190641403198, 0.01551982294768095, 0.006451488472521305, -0.03690772503614426, -0.020742187276482582, -0.05161190778017044, -0.020515620708465576, 0.0182159673422575, -0.01708313263952732, 0.006944271270185709, 0.008230037055909634, 0.0033786767162382603, -0.04694463312625885, 0.011237711645662785, 0.0031634382903575897, -0.05360569432377815, 0.007204822730273008, -0.024854373186826706, 0.006406174972653389, 0.012166635133326054, -0.013854557648301125, 0.023359032347798347, 0.02365356869995594, 0.01375260204076767, -0.014047139324247837, -0.06203397735953331, 0.011549240909516811, -0.018635116517543793, 0.013344782404601574, -0.008671842515468597, 0.042458608746528625, -0.019858576357364655, -0.026598937809467316, -0.0054489304311573505, -0.060357384383678436, -0.011062121950089931, 0.0026706557255238295, 0.032149821519851685, -0.001227000611834228, 0.03022400476038456, 0.04094061255455017, -0.01460222713649273, -0.046310245990753174, -0.031538091599941254, 0.02682550437748432, -0.013707288540899754, -0.007363419514149427, 0.031107615679502487, -0.0013848893577232957, 0.053288500756025314, 0.011266032233834267, -0.018771056085824966, -0.013333453796803951, -0.023834822699427605, 0.007918507792055607, -0.0006117302691563964, 0.042617205530405045, -0.004182988777756691, -0.009929288178682327, -0.015972957015037537, 0.02049296349287033, -0.008530238643288612, 0.03869760408997536, 0.007148181088268757, 0.0035570980980992317, -0.0024086879566311836, 0.038561660796403885, 0.02605517767369747, -0.022248854860663414, -0.002826420357450843, 0.004718252923339605, 0.02385747991502285, 0.00396775035187602, 0.04658212512731552, -0.007691941224038601, -0.00979901198297739, -0.003480631858110428, 5.035800131736323e-05, 0.02175040915608406, 0.008592544123530388, 0.0054121133871376514, -0.045132096856832504, -0.0014627716736868024, 0.02105938084423542, -0.009221266955137253, 0.003724191104993224, 0.04563054442405701, 0.0008135162643156946, 0.01559912133961916, -0.005482915323227644, 0.006910285912454128, -0.013560020364820957, 0.007221815176308155, -0.007170837838202715, 0.02186369150876999, 0.008581215515732765, -0.029181798920035362, -0.003021834185346961, -0.022135572507977486, -0.032308418303728104, -0.0054206098429858685, -0.002973688766360283, 0.016947193071246147, -0.017592908814549446, 0.020458977669477463, 0.0037695043720304966, -0.05709482356905937, -0.02499031275510788, -0.002269915770739317, 0.040917955338954926, 0.03144746646285057, -0.006966928020119667, 0.06121833622455597, 0.010722272098064423, -0.012619768269360065, 0.03482330963015556, -0.018023384734988213, 0.032059196382761, -0.020628903061151505, -0.03482330963015556, -0.03441549092531204, 0.012370545417070389, 0.0034721356350928545, 0.019937874749302864, -0.02920445427298546, 0.00293687148950994, -0.0020745019428431988, 0.03253498673439026, 0.0477149598300457, -0.053243186324834824, -0.07141384482383728, -0.010869540274143219, -0.026032520458102226, 0.010665629990398884, 0.004970308393239975, 0.004231134429574013, -0.016244836151599884, 0.03582020476460457, -0.03484596684575081, -0.03271624073386192, -0.019530054181814194, 0.007901515811681747, -0.01585967279970646, 0.013072902336716652, -0.023381689563393593, 0.0025616204366087914, -0.02965758927166462, -0.006768682040274143, 0.0014825962716713548, -0.04495084658265114, -0.01103380136191845, -0.006162615958601236, 0.004916498437523842, -0.027799740433692932, 0.007051890250295401, -0.023268405348062515, -0.05732138827443123, 0.002234514569863677, -0.02868335135281086, -0.020787499845027924, -0.027459891512989998, 0.029997438192367554, -0.0016454410506412387, 0.03813118487596512, 0.026598937809467316, 0.04073670133948326, -0.00943650584667921, 0.029634932056069374, -0.008054448291659355, -0.015247942879796028, -0.022135572507977486, -0.016947193071246147, 0.005035446025431156, 0.08088432997465134, 0.00835464894771576, 0.012846334837377071, 0.02893257513642311, -0.015893658623099327, -0.011384979821741581, -0.004723916761577129, -0.01570107601583004, -0.00902868527919054, -0.02028905227780342, 0.0001330194645561278, -0.005264845211058855, 0.005253516603261232, 0.06117302551865578, 0.03391704335808754, 0.055644795298576355, 0.019994515925645828, -0.005516900680959225, 0.04447505623102188, -0.00417732447385788, 0.0050552706234157085, 0.01796674355864525, -0.003865795210003853, -0.0032484009861946106, 0.01829526573419571, 0.007618307135999203, 0.01931481622159481, -0.007873195223510265, 0.0019328976050019264, 0.018159326165914536, 0.02267933264374733, 0.018974965438246727, 0.004151836037635803, -0.01659601554274559, 0.021739080548286438, 0.03407564014196396, -0.011226383037865162, -0.023064495995640755, -0.024038733914494514, 0.01675461232662201, 0.027278637513518333, 0.0018550152890384197, -0.03400766849517822, 0.019858576357364655, 0.04318362474441528, -0.005763291846960783, 0.0022288504987955093, -0.011554904282093048, -0.006768682040274143, 0.023993419483304024, 0.01647140271961689, -0.011679516173899174, 0.01631280593574047, 0.01562177762389183, -0.004024391993880272, -0.027980994433164597, 0.02013045735657215, -0.013458065688610077, 0.019246846437454224, -0.03536707162857056, -0.015961628407239914, 0.005058102775365114, -0.0010464552324265242, 0.028388815000653267, 0.0015661426587030292, 0.01434167567640543, -0.01741165481507778, 0.0035797548480331898, -0.004208477679640055, -0.013129543513059616, 0.005488579627126455, -0.024491867050528526, -0.022871913388371468, 0.0374741405248642, -0.03416626527905464, 0.013956512324512005, 0.008717156015336514, 0.053288500756025314, 0.006949935108423233, -0.02024373970925808, 0.0046332902275025845, -0.02868335135281086, -0.019133562222123146, 0.02260003425180912, 0.030133379623293877, 0.009476155042648315, 0.04853060096502304, -0.005046774633228779, -0.012427186593413353, -0.03826712444424629, 0.007895851507782936, 0.019360128790140152, 0.01549716666340828, 0.008507581427693367, 0.010580667294561863, 0.007278457283973694, 0.03244435787200928, -0.0024978984147310257, 0.0031889271922409534, -0.007584322243928909, 0.0348912812769413, -0.014964734204113483, 0.018533160910010338, -0.009141968563199043, -0.008003470487892628, -0.02637237124145031, 0.007142517250031233, 0.03217247873544693, 0.024899685755372047, 0.0019399778684601188, -0.015066689811646938, 0.025171566754579544, 0.03964918106794357, -0.03303343430161476, 0.013979168608784676, 0.0015208293916657567, -0.014307690784335136, -0.01156623288989067, -0.023313719779253006, 0.01054668240249157, 0.013945183716714382, -0.02555673010647297, -0.0261684600263834, 0.0009529964299872518, -0.004698428325355053, -0.018691757693886757, -0.032557643949985504, -0.013888542540371418, 0.012699066661298275, 0.022010959684848785, -0.0032625612802803516, -0.021353917196393013, 0.007216151338070631, 0.042458608746528625, 0.004718252923339605, 0.0271880105137825, -0.0002186015190090984, -0.021569155156612396, -0.033169373869895935, -0.006094645708799362, -0.00994061678647995, -0.0055622137151658535, -0.02252073585987091, -0.007652292028069496, 0.015803031623363495, 0.008609537035226822, -0.047080572694540024, -0.012993603944778442, 0.003738351399078965, -0.036499906331300735, -0.012597111985087395, 0.007572994101792574, 0.012846334837377071, 0.00862086471170187, 0.022543393075466156, -0.032353732734918594, -0.02304183878004551, -0.027731770649552345, 0.01272172387689352, 0.0022656675428152084, 0.0028320844285190105, -0.019937874749302864, 0.01967732235789299, -0.01233655959367752, -0.033010777086019516, -0.027686458081007004, 0.007539008744060993, 0.02750520408153534, -0.008082768879830837, 0.019008951261639595, 0.0012170883128419518, -0.007323770318180323, 0.010722272098064423, -0.03441549092531204, -0.002455417299643159, 0.0007611226756125689, -0.0160295981913805, -0.025375476107001305, -0.020436322316527367, 0.002218938199803233, -0.003860131138935685, -0.0017672206740826368, 0.004811711609363556, 0.02487703040242195, -0.0005752671859227121, 0.037066321820020676, 0.01570107601583004, 0.015247942879796028, 0.05265411362051964, 0.052925996482372284, 0.014647540636360645, -0.012076008133590221, 0.015349897556006908, -0.0024483369197696447, -0.011113099753856659, 0.010070892050862312, -0.009102319367229939, -0.0055792066268622875, -0.013820571824908257, -0.010943174362182617, 0.03502722084522247, 0.025579387322068214, -0.007085875142365694, 0.014432302676141262, -0.0013473641593009233, 0.02637237124145031, 0.012121321633458138, -0.00876246951520443, -0.005817101337015629, 0.029408365488052368, 0.07617174088954926, -0.03899214044213295, -0.011141420342028141, 0.012540469877421856, -0.0024030236527323723, 0.014001825824379921, -0.014364332892000675, 0.02961227484047413, 0.03278420865535736, 0.012755708768963814, -0.021603140980005264, -0.01131700910627842, 0.02678018994629383, -0.04726182669401169, 0.00421130983158946, 0.04134843498468399, -0.032557643949985504, -0.01383190043270588, 0.03597880154848099, 0.011396307498216629, 0.0029538641683757305, -0.02478640340268612, -0.01063164509832859, 0.019280830398201942, 0.01551982294768095, 0.029408365488052368, -0.00919294636696577, 0.0059870267286896706, -0.009328885935246944, -0.018725741654634476, -0.007584322243928909, 0.031016988679766655, -0.010841219685971737, 0.014454958960413933, -0.02324574999511242, 0.019688650965690613, 0.045789141207933426, 0.0026465828996151686, 0.03688506782054901, 0.0025757807306945324, -0.005100584123283625, -0.0055565498769283295, 0.01631280593574047, -0.009175953455269337, -0.039128080010414124, 0.009646079502999783, 0.008739812299609184, -0.016584686934947968, 0.04293439909815788, -0.008247029967606068, -0.009255251847207546, 0.0037553440779447556, -0.022973868995904922, 0.013979168608784676, 0.02990681119263172, 0.011679516173899174, -0.035321757197380066, 0.019903888925909996, 0.03751945495605469, 0.0015392379136756063, -0.025420790538191795, -0.02271331660449505, -0.000656689575407654, -0.015508494339883327, -0.0029680244624614716, 0.031266212463378906, 0.014092451892793179, -0.035276442766189575, 0.0261684600263834, 0.02060624584555626, 0.00971971359103918, 0.013945183716714382, -0.008348984643816948, -0.01213265024125576, 0.003440982662141323, 0.002000867621973157, -0.004871185403317213, -0.05546354129910469, 0.009317558258771896, 0.0049051702953875065, 0.014228392392396927, -0.03616005554795265, 0.00951580423861742, 0.014171750284731388, 0.005423441994935274, -0.012868992052972317, 0.019416771829128265, -0.0001890416315291077, 0.028796635568141937, -0.01375260204076767, 0.007969485595822334, 0.007516351994127035, -0.008467932231724262, 0.0038572989869862795, -0.014047139324247837, -0.02929508127272129, 0.01290297694504261, -0.030133379623293877, 0.00774858333170414, -0.013797915540635586, -0.006457152776420116, 0.010716607794165611, 0.0025616204366087914, 0.012076008133590221, 0.014613555744290352, 0.029521647840738297, -0.045381322503089905, 0.01691320911049843, -0.02300785481929779, 0.005879407282918692, -0.008972043171525002, 0.02641768380999565, -0.0037100305780768394, -0.007963821291923523, 0.018714414909482002, -0.008711491711437702, -0.0187370702624321, 0.019994515925645828, -0.011175405234098434, -0.013016260229051113, 0.030405258759856224, 0.009425177238881588, -0.021761737763881683, 0.0006067741196602583, -0.005734971258789301, 0.017547596246004105, -0.0006113762501627207, 0.03955855593085289, 0.02807162143290043, -0.012608439661562443, -0.011509591713547707, 0.01708313263952732, 0.032353732734918594, 0.004163164179772139, -0.04662743955850601, -0.009680064395070076, -0.02929508127272129, -0.010167183354496956, -0.005797276739031076, 0.03418892249464989, -0.019745292142033577, -0.009459162130951881, 0.009691393002867699, -0.012359216809272766, 0.0065930928103625774, -0.00500995758920908, 0.011226383037865162, 0.011266032233834267, 0.03212716802954674, 0.029159141704440117, 0.005349807441234589, 0.007091539446264505, 0.008813447318971157, 0.034347519278526306, -0.014692854136228561, -0.0033871729392558336, -0.014556914567947388, -0.01300493162125349, 0.00742572546005249, -0.018068699166178703, -0.0002170084771933034, 0.004132011439651251, 0.005106248427182436, -0.0051997071132063866, -0.001343824085779488, -0.01788744516670704, -0.016324134543538094, -0.005618855822831392, -0.00876246951520443, 0.01014452613890171, -0.03221779316663742, 0.004585144575685263, 0.02612314745783806, 0.007623971439898014, 0.028592724353075027, 0.003749679774045944, -0.014103780500590801, 0.005293165799230337, 0.0410538949072361, 0.0015378218377009034, 0.011147084645926952, -0.07485765963792801, 0.00809409748762846, -0.0024865702725946903, 0.026191117241978645, -0.0011993878288194537, 0.018884338438510895, -0.0147494962438941, -0.0012624016962945461, -0.012925633229315281, 0.01423972100019455, -0.006921614520251751, -0.026644250378012657, 0.037995245307683945, -0.016584686934947968, 0.0013855972792953253, -0.01359400525689125, 0.04007966071367264, 0.003268225584179163, 0.0050411103293299675, 0.006949935108423233, -0.006700711790472269, -0.028955232352018356, 0.0010896445019170642, 0.01423972100019455, -0.006570436060428619, -0.004347249865531921, -0.014613555744290352, -0.027006758376955986, 0.02816224843263626, 0.0005586286424659193, 0.039173390716314316, -0.007063218858093023, 0.03566160798072815, -0.03504987806081772, -0.00670637609437108, -0.02539813332259655, 0.01926950365304947, -0.0035570980980992317, 0.007357755675911903, 0.05043375864624977, -0.03221779316663742, 0.018034713342785835, 0.03305609151721001, -0.02134258858859539, 0.018193310126662254, 0.013310796581208706, -0.0214218869805336, -0.010337108746170998, 0.029317738488316536, 0.028909917920827866, -0.015134659595787525, -0.03724757581949234, 0.017592908814549446, -0.00913063995540142, -0.007335098925977945, -0.0415523424744606, -0.016380775719881058, 0.016618670895695686, -0.027052070945501328, 0.004709756467491388, -0.020674217492341995, 0.0047833905555307865, 0.02483171597123146, 0.021251961588859558, -0.013322125189006329, -0.029680244624614716, -0.046672750264406204, 0.024514522403478622, 0.01703782007098198, -0.007601314689964056, 0.0013176272623240948, -0.011679516173899174, 0.017185088247060776, 0.022407451644539833, 0.017864787951111794, -0.05111346021294594, -0.0051543936133384705, -0.013050245121121407, -0.005287501495331526, 0.021319931373000145, -0.02105938084423542, -0.004797551315277815, -0.020470306277275085, 0.00360524351708591, 0.006853644270449877, 0.02528485096991062, 0.017185088247060776, -0.009787684306502342, -0.0067573534324765205, -0.0010853963904082775, 0.01728704385459423, -0.046808693557977676, 0.0034834640100598335, -0.018805040046572685, 0.009345878846943378, -0.017819475382566452, -0.02641768380999565, -0.022769959643483162, -0.030541198328137398, -0.015837015584111214, 0.02734660729765892, 0.0024950664956122637, 0.015542479231953621, 0.029793528839945793, -0.00913063995540142, 0.0012999267783015966, -0.05351506918668747, 0.009476155042648315, 0.02523953653872013, -0.017944086343050003, 0.011022472754120827, -0.047080572694540024, 0.01130001712590456, 0.012325231917202473, -0.01874839887022972, -0.021976975724101067, -0.03480065241456032, -0.017796818166971207, 0.015576465055346489, 0.021002737805247307, 0.0009494562982581556, -0.000894230674020946, 0.00726146437227726, 0.0075446730479598045, -0.04780558496713638, 0.01662999950349331, 0.008717156015336514, -0.0002902886481024325, -0.008456604555249214, 0.029725559055805206, 0.03480065241456032, 0.021331259980797768, 0.01444363035261631, 0.03119824267923832, 0.027482546865940094, 0.010744928382337093, 0.034664712846279144, 0.001177439116872847, -0.028298188000917435, -0.05002593994140625, 0.013254155404865742, -0.027052070945501328, -0.00943650584667921, 0.017434312030673027, 0.009079663082957268, -0.03303343430161476, -0.031628720462322235, -0.00817339587956667, -0.003613739740103483, 0.0477149598300457, 0.024967657402157784, 0.005179882515221834, 0.020900784060359, -0.003591083223000169, 0.015395211055874825, 0.04880248010158539, -0.023925449699163437, 0.02390279248356819, -0.02426530048251152, 0.025670014321804047, 0.011390644125640392, -0.0006439451826736331, -0.029997438192367554, 0.00742572546005249, 0.004395395051687956, 0.013639318756759167, -0.000242320224060677, 0.00305865122936666, -0.0034438148140907288, -0.0011512422934174538, 0.02292855642735958, -0.01172482967376709, -0.024446552619338036, -0.024650463834404945, -0.026961443945765495, -0.0015335737261921167, -0.0036250681150704622, -0.05161190778017044, 0.020187098532915115, -0.04370472580194473, -0.0053554717451334, -0.01434167567640543, 0.006961263716220856, -0.011838112957775593, -0.008881417103111744, -0.02385747991502285, 0.02032303810119629]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-16T00:34:51.577702", "url_path": "/agents/", "chunk_size": 2636}
updated_dt: 2025-03-16T00:34:51.579264
---
```

  * The `AgentRun` is an async iterator that yields each node (`BaseNode` or `End`) in the flow.
  * The run ends when an `End` node is returned.


#### Using `.next(...)` manually
You can also drive the iteration manually by passing the node you want to run next to the `AgentRun.next(...)` method. This allows you to inspect or modify the node before it executes or skip nodes based on your own logic, and to catch errors in `next()` more easily:
agent_iter_next.py```
frompydantic_aiimport Agent
frompydantic_graphimport End
agent = Agent('openai:gpt-4o')

async defmain():
  async with agent.iter('What is the capital of France?') as agent_run:
    node = agent_run.next_node [](https://ai.pydantic.dev/agents/#__code_3_annotation_1)
    all_nodes = [node]
    # Drive the iteration manually:
    while not isinstance(node, End): [](https://ai.pydantic.dev/agents/#__code_3_annotation_2)
      node = await agent_run.next(node) [](https://ai.pydantic.dev/agents/#__code_3_annotation_3)
      all_nodes.append(node) [](https://ai.pydantic.dev/agents/#__code_3_annotation_4)
    print(all_nodes)
"""
    [
      UserPromptNode(
        user_prompt='What is the capital of France?',
        system_prompts=(),
        system_prompt_functions=[],
        system_prompt_dynamic_functions={},
      ),
      ModelRequestNode(
        request=ModelRequest(
          parts=[
            UserPromptPart(
              content='What is the capital of France?',
              timestamp=datetime.datetime(...),
              part_kind='user-prompt',
            )
          ],
          kind='request',
        )
      ),
      CallToolsNode(
        model_response=ModelResponse(
          parts=[TextPart(content='Paris', part_kind='text')],
          model_name='gpt-4o',
          timestamp=datetime.datetime(...),
          kind='response',
        )
      ),
      End(data=FinalResult(data='Paris', tool_name=None, tool_call_id=None)),
    ]
    """

```

#### Accessing usage and the final result
You can retrieve usage statistics (tokens, requests, etc.) at any time from the [`AgentRun`](https://ai.pydantic.dev/api/agent/#pydantic_ai.agent.AgentRun) object via `agent_run.usage()`. This method returns a [`Usage`](https://ai.pydantic.dev/api/usage/#pydantic_ai.usage.Usage) object containing the usage data.
Once the run finishes, `agent_run.final_result` becomes a [`AgentRunResult`](https://ai.pydantic.dev/api/agent/#pydantic_ai.agent.AgentRunResult) object containing the final output (and related metadata).
### Streaming
Here is an example of streaming an agent run in combination with `async for` iteration:
streaming.py