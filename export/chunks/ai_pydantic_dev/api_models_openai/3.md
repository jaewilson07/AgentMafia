---
url: https://ai.pydantic.dev/api/models/openai/
session_id: pydantic_ai_docs
chunk_number: 3
title: Customizing OpenAI Client Configuration
summary: This section provides guidelines for configuring the OpenAI client by customizing the `base_url` and `api_key`. It outlines handling different providers, using a placeholder API key when necessary, and conditions regarding the use of `openai_client` and `http_client`.
embedding: [0.01443206612020731, 0.01839580200612545, 0.025218002498149872, -0.05137612298130989, -0.03127794712781906, -0.018535548821091652, -0.034911371767520905, -0.03935787081718445, -0.0013275976525619626, -0.005554948002099991, -0.0015253080055117607, -0.023464811965823174, -0.02575158327817917, -0.047869738191366196, -0.003315818030387163, -0.012393028475344181, 0.004579894244670868, 0.016680724918842316, -0.027771564200520515, 0.0017404868267476559, 0.04090779274702072, 0.004557661712169647, -0.0036651857662945986, 0.04001849144697189, 0.012818622402846813, 0.03188775107264519, -0.05488250404596329, 0.0016388525255024433, 0.005145234987139702, -0.01064618956297636, 0.033285222947597504, -0.018294168636202812, -0.02215627022087574, -0.030032925307750702, -0.0056375255808234215, -0.01626148261129856, -0.00937576126307249, -0.013085411861538887, 0.017646249383687973, 0.0354449488222599, 0.016464751213788986, -0.01969163864850998, 0.006288620177656412, 0.05945604667067528, -0.02754288725554943, 0.003484149696305394, -0.0018103603506460786, 0.015994692221283913, 0.03600393980741501, 0.0324721485376358, -0.025929441675543785, 0.017684362828731537, -0.02502743899822235, -0.0013784148031845689, 0.016795063391327858, -0.030210785567760468, 0.016299596056342125, 0.01229774672538042, -0.02009817585349083, -0.020619051530957222, 0.011560898274183273, -0.04182250052690506, -0.021635394543409348, -0.03938327729701996, -0.007050877436995506, -0.026551952585577965, -0.04294047877192497, 0.022359538823366165, -0.02390946075320244, 0.0031220775563269854, -0.03455565124750137, 0.028940357267856598, -0.05239246413111687, 0.004849859979003668, -0.03752845153212547, -0.01398741640150547, 0.017684362828731537, 0.07968126237392426, 0.03275164216756821, -0.021139927208423615, -0.0435502827167511, 0.01140209473669529, 0.0500548779964447, -0.029829656705260277, 0.016629906371235847, -0.01777329295873642, -0.09309698641300201, -0.005443785339593887, -0.00246463087387383, -0.07119480520486832, -0.00902004074305296, -0.0027425370644778013, -0.025738878175616264, 0.011281403712928295, 0.06408040225505829, 0.02586592175066471, -0.002362996805459261, -0.02388405241072178, 0.03483514487743378, 0.019119946286082268, -0.015118096955120564, -0.033183589577674866, -0.03750304505228996, 0.017265120521187782, -0.009407522156834602, 0.01443206612020731, 0.022791484370827675, -0.007787725888192654, -0.04047584533691406, -0.0006062324973754585, -0.0738372951745987, 0.01779870130121708, 0.019577300176024437, -0.01105272676795721, -0.08730383217334747, -0.024531971663236618, -0.01617255248129368, -0.014368544332683086, -0.027110939845442772, -0.02220708690583706, -0.005980541463941336, 0.025332340970635414, 0.015067280270159245, -0.008473756723105907, 0.005662934388965368, 0.012272337451577187, 0.010970148257911205, -0.01842121034860611, -0.07902064174413681, -0.037833355367183685, -0.016439342871308327, -0.004157476592808962, 0.0011195649858564138, -0.04177168384194374, -0.033183589577674866, -0.08217130601406097, -0.049521297216415405, -0.03729977458715439, -0.041161879897117615, 0.03549576923251152, -0.013428427278995514, -0.005259573459625244, -0.04903853312134743, -0.0003043072938453406, -0.021470239385962486, 0.031608257442712784, -0.03503841534256935, -0.03097304329276085, -0.02716175839304924, 0.02199111506342888, 0.003458741120994091, 0.007292258553206921, -0.0026075541973114014, 0.04255934804677963, 0.01971704699099064, -0.028355959802865982, 0.01899290457367897, 0.022626329213380814, 0.02634868398308754, -0.04822545871138573, -0.004036786034703255, 0.00889935065060854, -0.03181152418255806, 0.02840677835047245, -0.030871408060193062, 0.007616217713803053, -0.01633770763874054, 0.002412225818261504, -0.06855231523513794, -0.0651983842253685, 0.028559228405356407, 0.033310629427433014, -0.0006320381071418524, -0.03834152594208717, 0.014241501688957214, -0.02672981284558773, -0.02680603787302971, -0.02766992896795273, -0.018217941746115685, 0.0068158479407429695, -0.009769594296813011, 0.024061912670731544, -0.04172086715698242, -0.034504834562540054, -0.02261362411081791, 0.012018252164125443, 0.00022470700787380338, 0.03727436810731888, 0.058795422315597534, 0.02421436458826065, 0.00889935065060854, -0.0016309124184772372, 0.04832709580659866, -0.02004735916852951, 0.012945665046572685, 0.00701276445761323, 0.003095081076025963, -0.011649827472865582, 0.03554658591747284, -0.003458741120994091, 0.001757955178618431, 0.02672981284558773, 0.07292258739471436, -0.06834904104471207, -0.0037032985128462315, -0.02807646617293358, -0.04144137352705002, 0.02345210686326027, -0.040729932487010956, 0.018535548821091652, 0.00816885381937027, -0.006040886975824833, 0.037833355367183685, 0.0010099905775859952, -0.016655314713716507, 0.017887631431221962, -0.0805959701538086, -0.01444477029144764, 0.004948318470269442, 0.03600393980741501, 0.03628343343734741, 0.06829822808504105, 0.01487671583890915, 0.0072350893169641495, 0.021165335550904274, 0.054933320730924606, 0.02335047349333763, 0.004538605455309153, -0.016020100563764572, -0.018065491691231728, 0.018688000738620758, 0.03602934628725052, 0.02158457785844803, -0.027898605912923813, 0.015727903693914413, -0.05554312840104103, 0.019031016156077385, 0.02572617307305336, 0.021000180393457413, -0.02510366402566433, 0.008892998099327087, 0.014749673195183277, 0.005863026715815067, 0.01925969310104847, 0.05889705941081047, 0.017976561561226845, -0.01604551076889038, -0.04901312664151192, 0.007292258553206921, 0.001299013034440577, 0.05401861295104027, -0.0402979850769043, -0.008416587486863136, -0.0213686041533947, 0.00485621253028512, -0.018942086026072502, -0.05396779626607895, 0.0013482420472428203, -0.03879887983202934, -0.06641799211502075, 0.016375821083784103, 0.04149219021201134, -0.049877017736434937, -0.01159265823662281, -0.0031427221838384867, -0.00495149428024888, 0.0006066295318305492, -0.051630206406116486, 0.009826763533055782, -0.032014794647693634, 0.01925969310104847, 0.00191040663048625, 0.004576717969030142, 0.021686211228370667, -0.017874926328659058, 0.007984641939401627, 0.01858636736869812, 0.041111059486866, -0.01403823308646679, -0.03427615761756897, -0.002621846506372094, 0.019513778388500214, 0.023490220308303833, 0.008289544843137264, -0.004027257673442364, 0.0026806038804352283, 0.030718958005309105, 0.0073811886832118034, -0.029448529705405235, -0.0005288157844915986, 0.017735179513692856, -0.004014553502202034, -0.014190685003995895, -0.05976095050573349, 0.03793498873710632, -0.008175206370651722, 0.023172613233327866, 0.0015705670230090618, 0.025764286518096924, -0.00289498851634562, 0.03414911404252052, 0.01202460378408432, 0.010328582488000393, 0.0013935010647401214, -0.024900395423173904, 0.01950107514858246, 0.0023328240495175123, -0.014393952675163746, 0.012151647359132767, -0.04233067110180855, 0.013949302956461906, 0.029855065047740936, -0.04776810482144356, -0.010474681854248047, 0.0077305566519498825, -0.020161697641015053, 0.004224174190312624, 0.02754288725554943, 0.028940357267856598, 0.020568234845995903, -0.03900215029716492, -0.005383440293371677, -0.05345962569117546, 0.01825605519115925, -0.009966510348021984, 0.059557680040597916, 0.03712191432714462, -0.0038557499647140503, -0.04098401963710785, 0.01837039366364479, 0.013301384635269642, -0.057118456810712814, 0.021813254803419113, 0.028635455295443535, 0.05229083076119423, -0.0013434779830276966, -0.03287868574261665, -0.01485130749642849, 0.02766992896795273, 0.027898605912923813, -0.012412085197865963, -0.015232435427606106, -0.0416700504720211, 0.0007527287816628814, -0.022893117740750313, -0.04799678176641464, 0.023299654945731163, 0.011719701811671257, -0.010411160066723824, 0.014470178633928299, 0.02086043357849121, -0.004913381766527891, 0.025573723018169403, 0.022486582398414612, -0.06265752762556076, -0.0202887412160635, 0.030261602252721786, 0.028660863637924194, -0.009756889194250107, 0.004427442792803049, 0.0008734194561839104, 0.03999308496713638, 0.03836693614721298, -0.04797137528657913, -0.024150842800736427, 0.02302016131579876, -0.0221816785633564, 0.017087260261178017, -0.04504938796162605, -0.013758738525211811, 0.04108565300703049, 0.010862162336707115, -0.04377895966172218, -0.019742457196116447, -0.057931531220674515, -0.015054576098918915, -0.003700122470036149, 0.0068349046632647514, -0.013974711298942566, 0.006765030790120363, 0.04898771643638611, -0.005259573459625244, -0.009477395564317703, -0.03056650608778, -0.019539188593626022, 0.0039002150297164917, 0.003779524238780141, 0.005132530350238085, -0.0779026672244072, 0.004691056441515684, 0.01861177571117878, -0.04934343695640564, -0.0171761903911829, -0.01990761235356331, -0.007343075703829527, 0.04070452228188515, 0.023579150438308716, 0.01882774755358696, 0.049521297216415405, 0.03480973467230797, 0.039561137557029724, 0.016642611473798752, -0.026247048750519753, 0.04009471833705902, -0.014114459045231342, -0.020771503448486328, 0.03186234459280968, -0.0008087070309557021, 0.02524341084063053, 0.0313795804977417, 0.07988453656435013, -0.06489347666501999, 0.03587689623236656, 0.03691864758729935, 0.0031157254707068205, -0.02361726202070713, 0.02807646617293358, 0.019513778388500214, 0.03056650608778, 0.03348848968744278, -0.006612579338252544, -0.08298438042402267, -0.008359418250620365, -0.00814344547688961, -0.05727091059088707, 0.042508531361818314, 0.015334069728851318, -0.06402958929538727, 0.008149798028171062, 0.004995959345251322, 0.005034072324633598, -0.033691760152578354, 0.012844030745327473, -0.024392224848270416, 0.03145580738782883, -0.026907673105597496, -0.06489347666501999, -0.022473877295851707, -0.0068793692626059055, -0.01316163782030344, 0.03808744251728058, -0.012710635550320148, -0.0419241338968277, 0.02066986821591854, -0.027009306475520134, 0.01233585923910141, -0.019170762971043587, 0.008746898733079433, 0.006387078668922186, 0.011122600175440311, -0.005402496550232172, -0.004179709125310183, 0.009991918690502644, -0.004135244060307741, 0.021660802885890007, -0.034987594932317734, 0.04141596332192421, 0.016210665926337242, 0.030718958005309105, 0.0025138601195067167, 0.04225444793701172, 0.025065550580620766, -0.004633887205272913, 0.023223429918289185, -0.01483860332518816, -0.04360109940171242, -0.030210785567760468, -0.024900395423173904, -0.014203389175236225, -0.023096386343240738, 0.011637123301625252, 0.03259919211268425, -0.003315818030387163, -0.023693488910794258, 0.01834498532116413, -0.02670440450310707, -0.025827808305621147, 0.011719701811671257, 0.007952881045639515, 0.009299535304307938, 0.0024963917676359415, -0.025357749313116074, -0.0535612590610981, 0.018649887293577194, -0.02805105783045292, 0.09324944019317627, -0.0013331557856872678, -0.04062829911708832, -0.003747763577848673, 0.02531963586807251, 0.011198826134204865, 0.015537338331341743, 0.03674078732728958, -0.014749673195183277, 0.01286308653652668, -0.027720745652914047, -0.01793844811618328, 0.011643475852906704, -0.06280997395515442, -0.02426518127322197, -0.026653585955500603, -0.004246406722813845, 0.010461977683007717, 0.03097304329276085, -0.024176251143217087, -0.010989204980432987, -0.020619051530957222, 0.02962638810276985, -0.015372183173894882, 0.008181558921933174, -0.03768090531229973, 0.0186625923961401, 0.013123524375259876, 0.03135417029261589, 0.015524634160101414, 0.008200614713132381, 0.008206967264413834, 0.02282959781587124, 0.010042736306786537, 0.015003758482635021, 0.033310629427433014, -0.0111607126891613, 0.019488370046019554, -0.017811404541134834, -0.018649887293577194, -0.015956580638885498, -0.04103483632206917, -0.04672635346651077, -0.020923955366015434, 0.02723798342049122, 0.05528904125094414, -0.007806782145053148, 0.01147196814417839, -0.019348623231053352, -0.05185888335108757, 0.03478432819247246, 0.0012410497292876244, -0.025446679443120956, -0.0162360742688179, 0.008206967264413834, -0.04631981626152992, 0.025395862758159637, 0.004811747465282679, -0.005621645599603653, -0.00017279809981118888, 0.01023965235799551, -0.008226023055613041, 0.0008063249988481402, 0.016807766631245613, -0.018942086026072502, 0.02064445987343788, 0.003363459138199687, -0.007984641939401627, -0.032904092222452164, -0.014648038893938065, 0.016731541603803635, -0.057118456810712814, 0.01360628753900528, 0.004897501319646835, -9.880557627184317e-05, 0.00804816372692585, -0.004154300782829523, 0.03295491263270378, 0.013949302956461906, -0.03816366568207741, 0.01148467231541872, 0.019412145018577576, 0.02131778746843338, -0.012069068849086761, -0.023248838260769844, 0.011313164606690407, 0.0026154944207519293, -0.008175206370651722, 0.007952881045639515, 0.007463766261935234, -0.010455625131726265, 0.033615533262491226, 0.022575510665774345, -0.02091125026345253, -0.005297685973346233, -0.01633770763874054, 0.0015213378937914968, -0.022245200350880623, 0.0027520654257386923, -0.03224347159266472, 0.011630771681666374, -0.03206561133265495, 0.03249755874276161, -1.2276258530619089e-05, 0.023629967123270035, 0.03592771291732788, -0.030337829142808914, 0.0023090036120265722, 0.01107813511043787, -0.020403079688549042, -0.011802279390394688, 0.010608077049255371, -0.002669487614184618, -0.039078377187252045, 0.0026710755191743374, 0.05135071277618408, -0.0073113152757287025, -0.013415723107755184, 0.0505884550511837, -0.019145354628562927, -0.04001849144697189, 0.05777908116579056, -0.000531991885509342, -0.01815442182123661, 0.0018183005740866065, 0.012367620132863522, -0.013873076997697353, -0.013796851970255375, -0.023718897253274918, -0.007895711809396744, 0.014686151407659054, -0.03935787081718445, 0.001607885817065835, 0.06199690327048302, 0.02210545353591442, -0.016566386446356773, 0.005011839792132378, 0.024354111403226852, 0.039916858077049255, 0.005059480667114258, -0.021114518865942955, -0.01485130749642849, -0.0029791544657200575, -0.008162502199411392, 0.030439462512731552, 0.01950107514858246, 0.01233585923910141, 0.04055207222700119, -0.020390374585986137, -0.00595195684581995, 0.026678994297981262, 0.04456662759184837, -0.01360628753900528, 0.012977425940334797, -0.039942268282175064, 0.003442860906943679, 0.01283767819404602, 0.012265985831618309, 0.004691056441515684, -0.008346714079380035, -0.034479424357414246, -0.008194263093173504, 0.019246989861130714, -0.002145435893908143, -0.012424789369106293, -0.006631636060774326, -0.052443280816078186, -0.018954791128635406, 0.008194263093173504, 0.023845940828323364, -0.008410235866904259, 0.013504653237760067, 0.015575451776385307, -0.02033955790102482, 0.049089349806308746, -0.04525265842676163, -0.008391179144382477, -0.026602769270539284, 0.014978350140154362, -0.018865860998630524, 0.023363176733255386, 0.016032805666327477, -0.00990298856049776, -0.011884856969118118, 0.015067280270159245, 0.004440146964043379, 0.0413905568420887, 0.006266387645155191, 0.010055440478026867, 0.01099555753171444, -0.018065491691231728, 0.02634868398308754, -0.058693788945674896, -0.028330551460385323, 0.05071549862623215, 0.0077940779738128185, -0.000595116289332509, -0.07058499753475189, 0.032319698482751846, 0.04433795064687729, -0.004386154003441334, 0.01856095716357231, -0.0012823386350646615, -0.0023582326248288155, 0.004351216834038496, -0.006510945037007332, -0.012589944526553154, -0.013225158676505089, -0.0006614167359657586, 0.020466599613428116, 0.008295897394418716, -0.030414054170250893, 0.021355900913476944, 0.008581743575632572, 4.468830957193859e-05, 0.009299535304307938, -0.020225219428539276, -0.03259919211268425, -0.0037922286428511143, -0.021025588735938072, -0.01804008148610592, -0.008632560260593891, 0.003007739083841443, 0.031150903552770615, -0.019272398203611374, -0.04606573283672333, 0.015130801126360893, -0.007552696391940117, 0.0354449488222599, -0.03480973467230797, 0.01655368134379387, 0.015791423618793488, 0.016325004398822784, 0.007775021251291037, -0.003563551465049386, -0.019361328333616257, 0.033310629427433014, -0.00772420410066843, -0.006637988146394491, 0.006352141499519348, -0.030312420800328255, 0.004268639255315065, 0.04055207222700119, -0.013314088806509972, 0.0033666351810097694, -0.013072707690298557, -0.013275976292788982, 0.011313164606690407, 0.0011267111403867602, 0.011586306616663933, -0.01360628753900528, -0.025586426258087158, -0.03663915395736694, 0.010843105614185333, 0.023845940828323364, 0.0050944178365170956, 0.0032141837291419506, -0.02886413224041462, 0.00772420410066843, -0.0005625615594908595, -0.013657104223966599, -0.009528212249279022, 0.03803662583231926, -0.0015785072464495897, -0.013098116032779217, -0.008696082048118114, 0.008499165996909142, 0.0008110891212709248, 0.015473817475140095, -0.01402552891522646, 0.0021644923835992813, 0.052900634706020355, -0.001684905611909926, -0.024011095985770226, 0.03638506680727005, 0.016795063391327858, 5.36954466952011e-05, 0.0012315214844420552, 0.0427372083067894, -0.048250868916511536, -0.001410175464116037, -0.0004208293976262212, 0.012882143259048462, 0.01398741640150547, -0.03226887807250023, -0.016185257583856583, -0.02148294262588024, -0.018116308376193047, 0.0373251847922802, 0.03211642801761627, -0.03010915219783783, 0.004487788304686546, 0.036613743752241135, 0.002394757466390729, -0.027746153995394707, 0.027873197570443153, 0.014305023476481438, -0.0030903168953955173, -0.006339437328279018, 0.034022070467472076, -0.007622570265084505, -0.017011035233736038, -0.020555529743433, -0.015766015276312828, 0.010176130570471287, -0.013860372826457024, 0.023134499788284302, -0.015600860118865967, -0.020796911790966988, 0.03125253692269325, -0.02340129017829895, 0.04278802499175072, -0.08725301921367645, -0.016452046111226082, 0.03295491263270378, 0.012265985831618309, 0.035800669342279434, 0.009236014448106289, 0.010639837011694908, -0.025357749313116074, 0.0090645058080554, -0.01022694818675518, 0.005958308931440115, 0.026577360928058624, 0.013923894613981247, 0.004976903088390827, 0.05391697958111763, -0.013923894613981247, -0.03465728461742401, -0.01361899171024561, 0.0006864283350296319, 0.007362132426351309, -0.010373047553002834, 0.013707921840250492, -0.02304556965827942, 0.03686783090233803, -0.021038293838500977, -0.020631756633520126, 0.004071722738444805, -0.015118096955120564, 0.010411160066723824, -0.06621472537517548, -0.026043780148029327, 0.014952941797673702, 0.007863951846957207, 0.012799565680325031, -0.04393141344189644, 0.07388811558485031, -0.001330773695372045, -0.04027257859706879, 0.0050181918777525425, -0.050791725516319275, 0.021330492570996284, -0.0438297763466835, 0.04418549686670303, -0.0035190864000469446, 0.01604551076889038, -0.01069700624793768, -0.009178845211863518, -0.014673447236418724, -0.0162360742688179, -0.024366814643144608, 0.0033189940731972456, 0.005516835022717714, -0.019945725798606873, 0.04400763660669327, -0.004182885400950909, 0.01791303977370262, -0.04560837894678116, -0.03806203231215477, -0.014965645968914032, -0.004259110894054174, 0.0014181156875565648, 0.006873017176985741, 0.013288680464029312, 0.0026869559660553932, -0.018548253923654556, -0.007755964994430542, -0.016795063391327858, -0.0033189940731972456, -0.020390374585986137, 0.0010997145436704159, 0.001846885192207992, 0.024417633190751076, -0.02275337092578411, 0.017036443576216698, -0.022664440795779228, -0.0038557499647140503, 0.01147196814417839, 0.07673387229442596, 0.01939943991601467, -0.008613504469394684, -0.02096206694841385, -0.019983837381005287, 0.026475725695490837, 0.037782538682222366, -0.042813435196876526, -0.002726656850427389, -0.0032268879003822803, -0.007273202296346426, 0.03503841534256935, 0.00889935065060854, 0.03351389989256859, -0.014533700421452522, 0.021012885496020317, -0.02277877926826477, -0.011637123301625252, 0.01666801981627941, -0.04263557493686676, -0.00491655757650733, 0.00553271546959877, -0.0071080466732382774, 0.037807948887348175, 0.018510140478610992, -0.04052666574716568, 0.040323395282030106, 0.0202887412160635, -0.004564013797789812, -0.007990994490683079, 0.01741757243871689, 0.01750650256872177, 0.03768090531229973, 0.015867650508880615, 0.01524514053016901, 0.007559048477560282, 0.012844030745327473, -0.047082073986530304, 0.0024789231829345226, 0.06657044589519501, -0.023223429918289185, 0.004284519702196121, 0.03608016297221184, -0.01074147131294012, 0.04019635170698166, 0.01069700624793768, 0.009344000369310379, -0.014139867387712002, 0.0016261482378467917, 0.0015380122931674123, 0.02361726202070713, -0.007482822984457016, 0.01189120952039957, 0.00404313812032342, 0.007082637865096331, -0.03422534093260765, 0.01107813511043787, -0.044083863496780396, -0.02053012140095234, 0.03262459859251976, -0.008391179144382477, -0.019742457196116447, -0.03313277289271355, 0.020110880956053734, -0.007457414176315069, 0.0041257161647081375, 0.01191661786288023, -0.019348623231053352, 0.003242768347263336, 0.018764225766062737, 0.008765955455601215, -0.006285444367676973, 0.0022931231651455164, 0.0038335174322128296, -0.050004057586193085, -0.025853216648101807, 0.009547268971800804, -0.0050086635164916515, -0.010925684124231339, -0.03635966032743454, -0.03808744251728058, -0.015511929988861084, 0.01877693086862564, 0.015334069728851318, 0.03094763495028019, -0.012793213129043579, -0.007292258553206921, 0.032421331852674484, -0.044896937906742096, -0.004271815065294504, -0.007317667361348867, -0.024798762053251266, 0.02591673843562603, -0.023388585075736046, -0.03259919211268425, 0.04560837894678116, -0.03851938620209694, 0.05010569468140602, -0.0025011557154357433, 0.007489175070077181, -0.03524168208241463, -0.007902064360678196, 0.03267541527748108, 0.0105509078130126, 0.01612173579633236, -0.03475891798734665, 0.01232315506786108, 0.031150903552770615, 0.01834498532116413, 0.005586708430200815, 0.04342323914170265, -0.01058902032673359, -0.01709996536374092, 0.02069527842104435, 0.023223429918289185, -0.019323214888572693, 0.032014794647693634, 0.010138018056750298, 0.005704223178327084, 0.04654849320650101, 0.01707455702126026, -0.037807948887348175, 0.016350412741303444, 0.02201652340590954, 0.02105099707841873, 0.0008202202734537423, -0.0028759322594851255, -0.014495586976408958, 0.026958489790558815, -0.05107121914625168, -0.016007397323846817, -0.017620841041207314, -0.006923834327608347, -0.03303113579750061, -0.013809556141495705, -0.02423977293074131, -0.013377610594034195, -0.03709650784730911, -0.03846856951713562, 0.00815614964812994, -0.015334069728851318, -0.026628177613019943, -0.04001849144697189, -0.021495647728443146, -0.006765030790120363, -0.005882083438336849, 0.014520996250212193, -0.01502916682511568, 0.0007872685673646629, -0.02199111506342888, 0.04149219021201134, 0.02634868398308754, -0.013885782100260258, 0.013962007127702236, -0.01527054887264967, -0.0236680805683136, 0.0015149858081713319, 0.031532030552625656, -0.004440146964043379, 0.013047299347817898, -0.012793213129043579, -0.0028108227998018265, 0.01647745631635189, 0.005446961615234613, 0.05554312840104103, -0.01152278482913971, 0.012869439087808132, 0.047793515026569366, 0.018332280218601227, 0.01544840820133686, 0.06098056212067604, 0.015981988981366158, 0.008804067969322205, 0.012615353800356388, 0.008696082048118114, -0.01316163782030344, -0.02280418947339058, 0.0038430457934737206, 0.011846744455397129, 0.012647113762795925, 0.04233067110180855, -0.0016515568131580949, 0.014050937257707119, 0.0018167125526815653, 0.01793844811618328, -0.008200614713132381, -0.009070858359336853, 0.0057137515395879745, -0.024963917210698128, 0.003474621567875147, 0.03836693614721298, 0.026856854557991028, 0.04184791073203087, 0.012119886465370655, 0.018243350088596344, 0.00900733657181263, 0.03859561309218407, 0.00942657794803381, -0.03005833365023136, 0.0055104829370975494, -0.004284519702196121, -0.005828090012073517, 0.0033920437563210726, -0.028610046952962875, -0.005678814835846424, -0.028787905350327492, -0.001362534356303513, 0.022664440795779228, -0.013288680464029312, -0.042406897991895676, -0.005583532620221376, 0.012659817934036255, -0.026551952585577965, 0.023083683103322983, 0.0505884550511837, -0.004878444597125053, -0.003110961290076375, 0.0030252074357122183, 0.012710635550320148, 0.03796039894223213, -0.0015356302028521895, 0.016185257583856583, 0.005332623142749071, 0.0068984259851276875, 6.501020106952637e-05, -0.01980597712099552, -0.023553742095828056, -0.004611654672771692, 0.03460646793246269, -0.0042527588084340096, -0.05528904125094414, 0.004884797148406506, -0.009864876046776772, -0.06392795592546463, 0.04820005223155022, 0.02766992896795273, -0.002590085845440626, -0.002467807149514556, 0.006720565725117922, 0.007679739501327276, -0.01098285336047411, -0.016058214008808136, 0.021495647728443146, -0.006758678704500198, 0.01793844811618328, 0.02443033643066883, 0.006339437328279018, 0.014482882805168629, -0.0338188037276268, -0.006434719543904066, 0.0027187166269868612, -0.021711619570851326, -0.020809616893529892, 0.04278802499175072, -0.0020580939017236233, 0.014965645968914032, 0.034530241042375565, -0.03834152594208717, -0.0034142760559916496, -0.07038173079490662, 0.003085552714765072, -0.0032522964756935835, -0.0023741130717098713, -0.017227008938789368, 0.00948374718427658, -0.023934869095683098, 0.005167467053979635, -0.0015284840483218431, 0.019933020696043968, -0.008486460894346237, -0.0031570144928991795, 0.04799678176641464, -0.030668139457702637, 0.055034954100847244, -0.008988280780613422, -0.0244811549782753, -0.011884856969118118, -0.019412145018577576, 0.011001909151673317, 0.03254837542772293, 0.03714732453227043, 0.0017309585819020867, -0.0229947529733181, -0.0068158479407429695, 0.01793844811618328, 0.022308722138404846, 0.03961195424199104, 0.04972456395626068, 0.023172613233327866, 0.023198021575808525, -0.005431081168353558, 0.02096206694841385, 0.01887856423854828, 0.04573541879653931, 0.022308722138404846, 0.003114137565717101, -0.012164351530373096, 0.03557199239730835, 0.022842301055788994, 0.00720968097448349, 0.004910205490887165, 0.051630206406116486, 0.04804759845137596, -0.007527288049459457, 0.003909743390977383, -0.012545479461550713, -0.004656119737774134, -0.0054374332539737225, 0.0035286147613078356, -0.010525498539209366, -0.001475284923799336, -0.019869498908519745, -0.023007458075881004, 0.0351654551923275, -0.00929318368434906, 0.013021890074014664, -0.025281524285674095, 0.007038172800093889, -0.009928397834300995, -0.03427615761756897, -0.029016584157943726, -0.04050125554203987, 0.016604498028755188, -0.0030442639254033566, -0.005809033755213022, 0.011249642819166183, -0.039103783667087555, -0.020555529743433, -0.022626329213380814, -0.00854998268187046, 0.005332623142749071, -0.004602126777172089, 0.013758738525211811, -0.02756829559803009, 0.002988682594150305, -0.015918467193841934, 0.026501135900616646, 0.006561762187629938, -0.03506382182240486, 0.018675297498703003, -0.002216897439211607, -0.0039764405228197575, 0.03770631179213524, 0.011338572949171066, 0.005882083438336849, 0.017887631431221962, -0.01844661869108677, -0.016998331993818283, 0.021025588735938072, -0.041593823581933975, -0.01674424484372139, -0.004008201416581869, 0.03971359133720398, 0.0014935473445802927, 0.0016102679073810577, 0.01074147131294012, -0.006447423715144396, -0.011071782559156418, -0.01440665777772665, 0.02886413224041462, -0.003909743390977383, 0.001536424271762371, -0.013898486271500587, 0.030718958005309105, 0.02378241904079914, 0.008505517616868019, 0.025904033333063126, 0.011967434547841549, 0.047463200986385345, -0.0008527750032953918, -0.016998331993818283, 0.026958489790558815, 0.022384947165846825, 0.02321072667837143, -0.012164351530373096, -0.020568234845995903, 0.025192594155669212, -0.0316590741276741, 0.022245200350880623, -0.026551952585577965, -0.04174627363681793, 0.007165215909481049, 0.04179709404706955, 0.0017087261658161879, 0.009026393294334412, 0.0014332019491121173, -0.014482882805168629, 0.008918407373130322, -0.01731593906879425, 0.021470239385962486, 0.017620841041207314, -0.02112722396850586, -0.05859215557575226, -0.010442920960485935, -0.01487671583890915, -0.0028473474085330963, -0.018624478951096535, -0.02172432467341423, 0.0002538871776778251, 0.019704343751072884, 0.002580557484179735, 0.0044623794965445995, 0.013834964483976364, 0.0012847206089645624, 0.007228737231343985, -0.003852573921903968, -0.04400763660669327, -0.0016356764826923609, 0.009210605174303055, 0.0033666351810097694, -0.025878624990582466, -0.02004735916852951, 0.017201600596308708, -0.030388645827770233, 0.021711619570851326, -0.028101874515414238, 0.011440207250416279, 0.0006141727208159864, -0.000951233203522861, 0.013707921840250492, -0.008397531695663929, 0.01906912960112095, 0.02153376117348671, 0.01782410964369774, -0.027339618653059006, 0.017404867336153984, -0.015994692221283913, 0.004119364079087973, -0.012615353800356388, -0.000959173368755728, -0.023464811965823174, -0.016706133261322975, 0.00485621253028512, 0.0021644923835992813, -0.003569903550669551, -0.013733330182731152, -0.03635966032743454, -0.015473817475140095, 0.009947453625500202, 0.014648038893938065, -0.0052913338877260685, 0.005386616103351116, -0.010188835673034191, -0.013491949066519737, 0.0012251692824065685, -0.021203448995947838, 0.023439403623342514, 0.029473938047885895, 0.0070254686288535595, 0.011128951795399189, 0.012481958605349064, -0.013834964483976364, -0.021228857338428497, 0.011668884195387363, -0.0047355215065181255, -0.014648038893938065, -0.010087201371788979, 0.011262346990406513, 0.025802399963140488, 0.03635966032743454, 0.0017055500065907836, -0.008962871506810188, -0.01666801981627941, -0.005329446867108345, -0.0373251847922802, -0.022766076028347015, -0.013758738525211811, 0.00796558614820242, -0.002208957215771079, -0.0036874182987958193, 0.039916858077049255, 0.009566325694322586, -0.024582788348197937, -0.0052754539065063, 0.011643475852906704, 0.018268760293722153, -0.010862162336707115, -0.010036383755505085, 0.019742457196116447, 0.005224636755883694, 0.023286951705813408, 0.014686151407659054, -0.0033825153950601816, -0.02407461777329445, 0.009521860629320145, -0.03259919211268425, -0.009191549383103848, 0.012050013057887554, -0.009871228598058224, 0.02088584192097187, 0.0046084788627922535, -0.014292318373918533, -0.014571812935173512, -0.012647113762795925, -0.018217941746115685, 0.008321305736899376, 0.004541781265288591, 0.005405672360211611, -0.00361119257286191, 0.03633425012230873, -0.01502916682511568, 0.002048565773293376, 0.021737029775977135, 0.02548479288816452, 0.022499285638332367, -0.00813074130564928, -0.006422015372663736, -0.0003180040803272277, -0.02524341084063053, -0.03181152418255806, -0.030312420800328255, 0.043270789086818695, -0.010836753994226456, 0.003209419548511505, 0.04898771643638611, -0.023083683103322983, 0.016617203131318092, -0.032904092222452164, 0.012685227207839489, 0.05696600675582886, -0.0059964219108223915, -0.004379801917821169, 0.03524168208241463, 0.04222903773188591, 0.03394584357738495, 0.015613564290106297, -0.009864876046776772, -0.010976500809192657, -0.01861177571117878, -0.016604498028755188, -0.0036874182987958193, 0.029346894472837448, 0.018294168636202812, -0.001410175464116037, 0.003563551465049386, 0.0313795804977417, -0.007622570265084505, 0.00898192822933197, 0.009458338841795921, -0.013657104223966599, -0.001095744431950152, -0.029423119500279427, -0.018268760293722153, 0.011764166876673698, -0.0015832713106647134, 0.011357629671692848, -0.004713288974016905, 0.02155916951596737, 0.011935674585402012, -0.0039129192009568214, -0.03432697430253029, 0.032827869057655334, -0.021216154098510742, 0.005764568690210581, 0.005926548037678003, 0.008702433668076992, -0.007031820714473724, -0.011980139650404453, 0.04253394156694412, -0.014152571558952332, 0.012145294807851315, -0.002820350928232074, 0.024277886375784874, 0.02883872389793396, -0.01636311784386635, 0.005180171690881252, -0.03727436810731888, 0.00511347409337759, 0.01861177571117878, 0.007527288049459457, -0.03554658591747284, 0.013314088806509972, -0.01734134741127491, -0.019729752093553543, -0.030820591375231743, 0.005910668056458235, 0.019945725798606873, -0.0028822843451052904, 0.0254339762032032, 0.035749852657318115, 0.020784208551049232, -0.03379339352250099, -0.0061329929158091545, -0.0020025125704705715, -0.030185377225279808, -0.0017071380279958248, -0.003211007686331868, -0.009591734036803246, -0.015677085146307945, -0.0055740042589604855, 0.007533640135079622, -0.016032805666327477, 0.0066252839751541615, 0.021216154098510742, -0.01607091911137104, -0.00021458328410517424, 0.00035294087138026953, 0.02972802333533764, 0.004459203686565161, -0.03275164216756821, -0.005084889475256205, 0.06159036606550217, -0.04334701597690582, -0.012551832012832165, -0.019221581518650055, 0.017493797466158867, 0.0022359539289027452, -0.017404867336153984, -0.0015927995555102825, -0.020250627771019936, -0.003973264712840319, 0.008391179144382477, 0.004128891974687576, -0.012380324304103851, -0.023083683103322983, -0.02965179830789566, 0.002000924665480852, -0.018865860998630524, 0.04390600323677063, -0.011554545722901821, -0.010080848820507526, -0.01834498532116413, -0.034454017877578735, 0.029346894472837448, 0.020492009818553925, -0.0024233420845121145, 0.014165275730192661, -0.011097191832959652, 0.03582607954740524, -0.040831565856933594, 0.028584636747837067, -0.021038293838500977, 0.045379702001810074, 0.005354855675250292, 0.0007678151014260948, -0.0033983958419412374, 0.027466660365462303, -0.012202464044094086, 0.024773351848125458, -0.01525784470140934, -0.029550163075327873, 0.012126238085329533, 0.023274246603250504, -0.029067400842905045, 0.015600860118865967, 0.03379339352250099, -0.05053763836622238, -0.0025662651751190424, 0.022359538823366165, -0.016540976241230965, -0.015727903693914413, 0.03790958225727081, 0.015016462653875351, 0.056254565715789795, -0.014965645968914032, 0.002675839699804783, 0.017468389123678207, 0.022893117740750313, -0.005824913736432791, 0.012513719499111176, -0.012875791639089584, -0.0015618328470736742]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-15T11:17:48.599721", "url_path": "/api/models/openai/", "chunk_size": 4991}
updated_dt: 2025-03-15T11:17:48.599721
---
This is for observability purposes, you must
        customize the `base_url` and `api_key` to use a different provider.
    """
    self._model_name = model_name
    if provider is not None:
      if isinstance(provider, str):
        self.client = infer_provider(provider).client
      else:
        self.client = provider.client
    else: # pragma: no cover
      # This is a workaround for the OpenAI client requiring an API key, whilst locally served,
      # openai compatible models do not always need an API key, but a placeholder (non-empty) key is required.
      if (
        api_key is None
        and 'OPENAI_API_KEY' not in os.environ
        and base_url is not None
        and openai_client is None
      ):
        api_key = 'api-key-not-set'
      if openai_client is not None:
        assert http_client is None, 'Cannot provide both `openai_client` and `http_client`'
        assert base_url is None, 'Cannot provide both `openai_client` and `base_url`'
        assert api_key is None, 'Cannot provide both `openai_client` and `api_key`'
        self.client = openai_client
      elif http_client is not None:
        self.client = AsyncOpenAI(base_url=base_url, api_key=api_key, http_client=http_client)
      else:
        self.client = AsyncOpenAI(base_url=base_url, api_key=api_key, http_client=cached_async_http_client())
    self.system_prompt_role = system_prompt_role
    self._system = system
  @property
  defbase_url(self) -> str:
    return str(self.client.base_url)
  async defrequest(
    self,
    messages: list[ModelMessage],
    model_settings: ModelSettings | None,
    model_request_parameters: ModelRequestParameters,
  ) -> tuple[ModelResponse, usage.Usage]:
    check_allow_model_requests()
    response = await self._completions_create(
      messages, False, cast(OpenAIModelSettings, model_settings or {}), model_request_parameters
    )
    return self._process_response(response), _map_usage(response)
  @asynccontextmanager
  async defrequest_stream(
    self,
    messages: list[ModelMessage],
    model_settings: ModelSettings | None,
    model_request_parameters: ModelRequestParameters,
  ) -> AsyncIterator[StreamedResponse]:
    check_allow_model_requests()
    response = await self._completions_create(
      messages, True, cast(OpenAIModelSettings, model_settings or {}), model_request_parameters
    )
    async with response:
      yield await self._process_streamed_response(response)
  @property
  defmodel_name(self) -> OpenAIModelName:
"""The model name."""
    return self._model_name
  @property
  defsystem(self) -> str | None:
"""The system / model provider."""
    return self._system
  @overload
  async def_completions_create(
    self,
    messages: list[ModelMessage],
    stream: Literal[True],
    model_settings: OpenAIModelSettings,
    model_request_parameters: ModelRequestParameters,
  ) -> AsyncStream[ChatCompletionChunk]:
    pass
  @overload
  async def_completions_create(
    self,
    messages: list[ModelMessage],
    stream: Literal[False],
    model_settings: OpenAIModelSettings,
    model_request_parameters: ModelRequestParameters,
  ) -> chat.ChatCompletion:
    pass
  async def_completions_create(
    self,
    messages: list[ModelMessage],
    stream: bool,
    model_settings: OpenAIModelSettings,
    model_request_parameters: ModelRequestParameters,
  ) -> chat.ChatCompletion | AsyncStream[ChatCompletionChunk]:
    tools = self._get_tools(model_request_parameters)
    # standalone function to make it easier to override
    if not tools:
      tool_choice: Literal['none', 'required', 'auto'] | None = None
    elif not model_request_parameters.allow_text_result:
      tool_choice = 'required'
    else:
      tool_choice = 'auto'
    openai_messages: list[chat.ChatCompletionMessageParam] = []
    for m in messages:
      async for msg in self._map_message(m):
        openai_messages.append(msg)
    try:
      return await self.client.chat.completions.create(
        model=self._model_name,
        messages=openai_messages,
        n=1,
        parallel_tool_calls=model_settings.get('parallel_tool_calls', NOT_GIVEN),
        tools=tools or NOT_GIVEN,
        tool_choice=tool_choice or NOT_GIVEN,
        stream=stream,
        stream_options={'include_usage': True} if stream else NOT_GIVEN,
        max_tokens=model_settings.get('max_tokens', NOT_GIVEN),
        temperature=model_settings.get('temperature', NOT_GIVEN),
        top_p=model_settings.get('top_p', NOT_GIVEN),
        timeout=model_settings.get('timeout', NOT_GIVEN),
        seed=model_settings.get('seed', NOT_GIVEN),
        presence_penalty=model_settings.get('presence_penalty', NOT_GIVEN),
        frequency_penalty=model_settings.get('frequency_penalty', NOT_GIVEN),
        logit_bias=model_settings.get('logit_bias', NOT_GIVEN),
        reasoning_effort=model_settings.get('openai_reasoning_effort', NOT_GIVEN),
      )
    except APIStatusError as e:
      if (status_code := e.status_code) >= 400: