---
url: https://ai.pydantic.dev/api/models/function/
session_id: pydantic_ai_docs
chunk_number: 2
title: Creating and Testing a Function Model with Pydantic AI
summary: This document provides an example of defining a function model using Pydantic AI, including the implementation of a model function that processes messages and returns a response. It also includes a unit test for the agent using pytest to verify that the agent correctly responds to a user prompt.
embedding: [-0.041273027658462524, 0.003891973989084363, 0.028519731014966965, -0.029477396979928017, -0.027048196643590927, 0.03769930079579353, -0.02728177420794964, 0.017167897894978523, 0.0018802934791892767, -0.015556217171251774, 0.013302200473845005, -0.07077378034591675, 0.010586869902908802, -0.01017227116972208, -0.026697831228375435, -0.0059182532131671906, 0.011211687698960304, 0.01772848144173622, 0.009284678846597672, 0.017413152381777763, 0.07278253883123398, 0.0065693482756614685, 0.008046722039580345, -0.021033594384789467, 0.0028291994240134954, -0.019597096368670464, -0.014411690644919872, 0.043515365570783615, -0.009413146413862705, -0.04342193529009819, 0.038610249757766724, -0.010189789347350597, -0.005124091636389494, -0.040548939257860184, -0.015988335013389587, -0.03697521239519119, 0.008560591377317905, 0.025903670117259026, -0.02489929087460041, 0.009635044261813164, -0.025670094415545464, -0.057927053421735764, 0.04003506898880005, 0.028216080740094185, -0.04057229682803154, 0.031556230038404465, -0.015054026618599892, 0.051480334252119064, 0.0032700756564736366, 0.010709498077630997, -0.013150375336408615, 0.018324103206396103, 0.035386890172958374, -0.0030948929488658905, 0.004446718841791153, 0.0016744539607316256, -0.012426287867128849, 0.029080316424369812, -0.010359132662415504, 0.02265695296227932, 0.007369349244982004, 0.009740154258906841, -0.012811689637601376, 0.044683247804641724, -0.027445277199149132, -0.03727886453270912, -0.024852575734257698, 0.011772272177040577, -0.032887618988752365, -0.010545994155108929, 0.005124091636389494, 0.01980731636285782, -0.044005874544382095, -0.023673012852668762, -0.044916823506355286, -0.03685842454433441, 0.02398834004998207, 0.06656939536333084, -0.004207302816212177, -0.020297827199101448, -0.015275925397872925, 0.01852264255285263, 4.5848578338336665e-06, 0.0022715346422046423, -0.02623067796230316, 0.0030423381831496954, -0.06516793370246887, -0.03363506495952606, -0.024875933304429054, -0.06231829896569252, -0.02436206303536892, 0.021664250642061234, -0.03844674676656723, 0.009553292766213417, 0.07708035409450531, -0.00655766949057579, -0.031182507053017616, 0.006312414072453976, 0.026043817400932312, 0.011340155266225338, 0.022691989317536354, -0.013033587485551834, -0.04311828315258026, 0.03171973302960396, -0.005281756166368723, 0.005611683242022991, 0.012589791789650917, -0.014481763355433941, -0.055778149515390396, 0.021722646430134773, -0.03891390189528465, 0.015357676893472672, -0.010458402335643768, 0.006791246589273214, -0.07128764688968658, -0.014189792796969414, 0.01707446575164795, -0.021524105221033096, 0.033915355801582336, -0.03517667204141617, -6.633216980844736e-05, 0.024852575734257698, 0.018382497131824493, -0.01478541363030672, 0.022014616057276726, -0.02611389011144638, 0.021407317370176315, -0.03552703559398651, -0.0404321514070034, -0.005442340392619371, 0.008543072268366814, -0.0012131397379562259, 0.012729937210679054, 0.011363512836396694, -0.04566426947712898, -0.010189789347350597, -0.03141608461737633, -0.02489929087460041, -0.04304821044206619, 0.06105698272585869, 0.020519724115729332, -0.000883212429471314, -0.01858103647828102, 0.02471242845058441, -0.023731406778097153, 0.02842630073428154, -0.044683247804641724, -0.004887595307081938, -0.01478541363030672, 0.02076498046517372, 0.01798541657626629, 0.05703946202993393, 0.00707737822085619, 0.028566446155309677, -0.0219211857765913, 0.01573139987885952, -0.007527013309299946, 0.030621923506259918, 0.04209054633975029, -0.02071826532483101, 0.04050222411751747, 0.020729944109916687, -0.039521198719739914, -0.01724964939057827, -0.029080316424369812, 0.026767905801534653, -0.03615769371390343, -0.0177401602268219, -0.029991265386343002, -0.012706579640507698, 0.02294892445206642, -0.011246724985539913, -0.020741622895002365, 0.01472701970487833, 0.006493436172604561, -0.012262783944606781, -0.035994190722703934, -0.034592729061841965, -0.06044968590140343, -0.025109509006142616, -0.021722646430134773, -0.022983960807323456, -0.049051135778427124, -0.022481771185994148, -0.030808784067630768, -0.004969347268342972, 0.028519731014966965, 0.05928179994225502, -0.004899274092167616, 0.036110978573560715, 0.027375204488635063, 0.021640893071889877, 0.040665727108716965, 0.00020000016957055777, 0.008262780494987965, -0.012940156273543835, 0.05526427924633026, -0.01700439304113388, -0.003792703850194812, 0.013454025611281395, -0.006913874298334122, 0.028940169140696526, 0.014224829152226448, -0.027865717187523842, 0.02994455024600029, -0.05652559548616409, -0.0006510954117402434, 0.018569357693195343, -0.03594747558236122, 0.01955038122832775, 0.043094925582408905, -0.05320880189538002, 0.028216080740094185, -0.04075915738940239, -0.04428616911172867, -0.007772269193083048, -0.02653432823717594, -0.003792703850194812, 0.011299279518425465, 0.03141608461737633, -0.01943359337747097, 0.02424527518451214, 0.08296649158000946, -0.00843796320259571, -0.0004937960184179246, 0.03706864267587662, 0.005322631914168596, -0.06385990977287292, -0.006160588935017586, 0.04335185885429382, -0.026137247681617737, -0.025436516851186752, -0.002477374393492937, -0.03989492356777191, 0.01869782619178295, -0.048630695790052414, 0.014691982418298721, 0.0030627762898802757, 0.012951835058629513, -0.011369352228939533, -0.024735786020755768, 0.0005083945579826832, -0.00036824846756644547, -0.0095357745885849, -0.0008664240594953299, 0.018802935257554054, 0.02819272316992283, -0.007223363500088453, 0.05138690397143364, 0.05138690397143364, 0.05988910049200058, -0.02728177420794964, 0.009605847299098969, 0.014318260364234447, -0.013524098321795464, 0.023462792858481407, -0.0023386881221085787, -0.00865986105054617, -0.052134349942207336, 0.033868640661239624, -0.03912412002682686, 0.015404392033815384, -0.022972282022237778, -0.0035357694141566753, -0.015556217171251774, -0.03298104926943779, -0.0007510955329053104, -0.03396207094192505, 0.01883797161281109, -0.052694935351610184, 0.021909506991505623, 0.001348176272585988, 0.031299296766519547, -0.02520294114947319, -0.05283508077263832, 0.010569351725280285, -0.01017227116972208, 0.03564382344484329, 0.015018990263342857, -0.02095184288918972, -0.013710959814488888, 0.023556223139166832, 0.029991265386343002, 0.0048321206122636795, -0.00036313896998763084, 0.035503678023815155, -0.0030131412204355, -0.05082631856203079, -0.045944564044475555, 0.0034423386678099632, -0.0033255501184612513, 0.033985428512096405, 0.02672119066119194, -0.04360879585146904, 0.025856954976916313, -0.014645267277956009, 0.016712423413991928, 0.02520294114947319, 0.03055185079574585, -0.00035948934964835644, -0.008975190110504627, 0.001170803909189999, -0.016712423413991928, -0.02436206303536892, -0.02095184288918972, 0.01326716411858797, 0.027071554213762283, -0.009249642491340637, 0.03601754829287529, -0.01839417591691017, 0.008613145910203457, 0.05138690397143364, -0.03284090384840965, -0.027982505038380623, -0.03384528309106827, -0.03844674676656723, 0.02028614841401577, -0.014738698489964008, 0.0546569786965847, -0.006954750046133995, -0.038540177047252655, -0.020508045330643654, -0.004172265995293856, -0.0385168194770813, -0.06783071160316467, 0.002578104380518198, 0.0034861343447118998, -0.009477379731833935, 0.009705117903649807, 0.006002924405038357, -0.0232525747269392, -0.02819272316992283, -0.03963799029588699, 0.021582499146461487, 0.035807330161333084, 0.013629208318889141, -0.06353289633989334, 0.045524124056100845, 0.018254030495882034, 0.05685260146856308, -0.02041461504995823, 0.03692849725484848, -0.07600589841604233, 0.009938694536685944, -0.019842352718114853, 0.022867172956466675, 0.04143653064966202, 0.05848763883113861, -0.006143070757389069, 0.0028000022284686565, 0.029407324269413948, 0.018370818346738815, 0.028332870453596115, 0.027585424482822418, -0.0002293797442689538, -0.031135791912674904, -0.03204674273729324, 0.02623067796230316, 0.006376647390425205, 0.017413152381777763, -0.06362632662057877, 0.025740167126059532, 0.011708038859069347, 0.00419270433485508, -0.028169365599751472, 0.028683235868811607, -0.008402926847338676, -0.0351065993309021, -0.03202338516712189, 0.009640883654356003, -0.0024467173498123884, -0.0018467168556526303, -0.013302200473845005, -0.027001481503248215, -0.006259859073907137, -0.028216080740094185, -0.048677410930395126, -0.01148030161857605, 0.0010437964228913188, -0.0033781048841774464, 0.05120004341006279, 0.003156207036226988, 0.03590076044201851, -0.016840890049934387, 0.020449651405215263, 0.028823381289839745, 0.003515331307426095, 0.000627372763119638, -0.02424527518451214, 0.033424846827983856, 0.07124093174934387, -0.04942485690116882, -0.05260150134563446, 0.02987447753548622, 0.020613156259059906, 0.024455495178699493, -0.0095357745885849, -0.002248177072033286, 0.028286155313253403, 0.0020744542125612497, -0.004026280716061592, -0.009862781502306461, -0.019632132723927498, 0.026557685807347298, -0.01557957474142313, 0.040362078696489334, 0.010849643498659134, 0.0277022123336792, -0.013617529533803463, 0.019223373383283615, 0.04835040494799614, -0.01967884786427021, 0.004519711714237928, 0.003845258615911007, -0.025132866576313972, -0.06395334005355835, -0.013874463737010956, 0.015054026618599892, 0.04057229682803154, -0.0012036506086587906, -0.029921192675828934, -0.10370811074972153, -0.016630670055747032, 0.019480308517813683, -0.03503652662038803, 0.0523679256439209, 0.08114459365606308, -0.028146008029580116, 0.020543081685900688, -0.02781900018453598, -0.02204965241253376, 0.00487299682572484, -0.0043678865768015385, -0.006691976450383663, 0.00217956374399364, -0.012893441133201122, -0.005959128960967064, -0.009564971551299095, -0.03863360732793808, 0.004805843345820904, 0.018546000123023987, -0.04311828315258026, -0.0014343077782541513, 0.04253434017300606, -0.019106585532426834, -0.006581027526408434, 0.008607306517660618, 0.008151831105351448, 0.051667194813489914, -0.030832141637802124, 0.0039357696659862995, -0.02611389011144638, -0.050078872591257095, -0.0316963754594326, -0.01821899227797985, -0.03989492356777191, 0.06624238938093185, 0.022201478481292725, 0.07381027936935425, -0.013372274115681648, 0.04089930281043053, -0.002744527766481042, -0.030037980526685715, 0.015708042308688164, -0.02515622414648533, 0.003725550603121519, 0.015743078663945198, -0.02447885274887085, -0.015813151374459267, 0.028146008029580116, 0.027235059067606926, -0.0103883296251297, 0.046551864594221115, 0.024198560044169426, 0.02739856205880642, -0.03685842454433441, 0.04148324579000473, 0.03727886453270912, -0.05727304145693779, -0.027258416637778282, 0.021956222131848335, -0.03305112197995186, 0.017903665080666542, 0.006516793742775917, -0.05306865647435188, 0.044613175094127655, -0.03461608663201332, -0.028169365599751472, -0.026277393102645874, 0.018908044323325157, -0.02763213962316513, 0.0011204389156773686, 0.032537251710891724, -0.010621906258165836, 0.058581069111824036, -0.0060438006184995174, 0.022201478481292725, 0.01357081439346075, -0.031743090599775314, -0.008251101709902287, -0.022084688767790794, 0.006382486782968044, -0.020858410745859146, 0.02478250302374363, 0.004277375992387533, -0.0185927152633667, 0.02180439792573452, 0.025927027687430382, 0.004519711714237928, 0.06675625592470169, -0.05988910049200058, 0.01415475644171238, 0.010721176862716675, -0.009524095803499222, 0.018020452931523323, 0.008630664087831974, 0.02041461504995823, 0.018359139561653137, -0.02842630073428154, -0.0074861375615000725, 0.06362632662057877, -0.011918257921934128, -0.0029094915371388197, 0.0005040150135755539, -0.021827755495905876, -0.01713286153972149, -0.0028759147971868515, -0.024432137608528137, -0.022073009982705116, -0.022481771185994148, 0.027772285044193268, 0.017845269292593002, 0.04033871740102768, -0.024221917614340782, -0.026160605251789093, 0.01749490574002266, 0.015100742690265179, 0.027351846918463707, -0.011316797696053982, -0.005935771390795708, -0.007871539331972599, 0.02800586260855198, -0.007129932753741741, 0.0047708069905638695, -0.006954750046133995, 0.035573750734329224, -0.008099276572465897, 0.04134310036897659, -0.010978111065924168, 0.004601463675498962, 0.06675625592470169, 0.010341614484786987, 0.023731406778097153, -0.0408058725297451, 0.015719721093773842, -0.00534598995000124, -0.02865987829864025, -0.0008379569044336677, 0.00908613856881857, -0.0050715371035039425, 0.012764973565936089, 9.653292363509536e-05, 0.01493723876774311, 0.012578112073242664, -0.014890523627400398, 0.020800016820430756, 0.032397106289863586, -0.027258416637778282, -0.039334338158369064, 0.007637962698936462, 0.016712423413991928, 0.010867162607610226, -0.027235059067606926, -0.007708035409450531, 0.009302197024226189, -0.014224829152226448, 0.006686137057840824, -0.012928477488458157, -0.010347453877329826, 0.0018175197765231133, -0.010621906258165836, -0.029781047254800797, 0.024268632754683495, 0.01809052564203739, -0.019772278144955635, -0.004472996573895216, -0.027912432327866554, 0.001937227905727923, 0.017389794811606407, 0.009997088462114334, 0.007118253968656063, -0.01833578199148178, 0.0035007328260689974, -0.03454601392149925, -0.02508615143597126, -0.0039416090585291386, 0.013932858593761921, 0.0058102235198020935, -0.048443835228681564, 0.033424846827983856, 0.035994190722703934, -0.035573750734329224, -0.05418982729315758, 0.02199125848710537, -0.01748322695493698, 0.013944537378847599, 0.005091974977403879, 0.011684681288897991, -0.060963552445173264, 0.008245262317359447, 0.0024525567423552275, 0.02187447063624859, -0.007007305044680834, -0.054890554398298264, 0.001466424553655088, -0.028870096430182457, -0.05811391770839691, 0.02307739108800888, 0.07983656227588654, -0.026931408792734146, -0.01463358849287033, 0.03898397460579872, 0.03625112399458885, 0.01889636553823948, -0.01218103151768446, -0.010289059951901436, -0.02690805122256279, -0.006400005426257849, -0.010312417522072792, 0.0316963754594326, -0.01585986651480198, 0.011824827641248703, 0.03263068199157715, 0.016689063981175423, -0.018195634707808495, -0.016443809494376183, -0.006551830098032951, -0.008975190110504627, -0.015345998108386993, -0.04526719078421593, -0.024315347895026207, 0.02294892445206642, 0.005941610783338547, 0.00498102605342865, -0.007509495131671429, 0.014867165125906467, -0.024642355740070343, 0.0025051115080714226, 0.019270088523626328, -0.03031827323138714, 0.009991249069571495, -0.011030665598809719, -0.029477396979928017, 0.028636520728468895, 0.005424821749329567, 0.03192995488643646, -0.010312417522072792, -0.01493723876774311, 0.025833597406744957, 0.00577226746827364, -0.04720587655901909, 0.00892847403883934, 0.004239419475197792, -0.002348907059058547, 0.00587737699970603, 0.020671550184488297, 0.006359129212796688, 0.006189785897731781, 0.015357676893472672, -0.02520294114947319, -0.01779855415225029, 0.0065635088831186295, -0.004931390751153231, 0.011778111569583416, 0.00042846749420277774, 0.008548912592232227, 0.0026131407357752323, -0.03484966233372688, -0.021185418590903282, 0.04050222411751747, 0.006318253464996815, -0.02187447063624859, -0.04891099035739899, 0.026861336082220078, 0.06199129298329353, 0.002737228525802493, -0.0060438006184995174, -0.005024821497499943, -0.0068029253743588924, 0.018440891057252884, 0.007071538828313351, -0.05414310842752457, -0.03594747558236122, 0.02222483605146408, 0.04057229682803154, -0.010621906258165836, -0.01827738806605339, -0.001489782240241766, -0.011106578633189201, -0.021162061020731926, -0.006382486782968044, -0.013816069811582565, 0.03006133809685707, 0.014248186722397804, -0.017716802656650543, -0.030902214348316193, -0.01827738806605339, 0.029173746705055237, 0.015462785959243774, -0.019445272162556648, -0.04026864469051361, 0.027982505038380623, -0.0038073023315519094, 0.030294915661215782, -0.010557672940194607, -0.004686135333031416, 0.007678838446736336, 0.03001462295651436, 0.01700439304113388, -0.0227737408131361, -0.04019857197999954, 0.01278833206743002, 0.014598552137613297, -0.0028817541897296906, 0.008700736798346043, -0.04293142259120941, -0.010207307524979115, 0.07184823602437973, -0.012519718147814274, -0.011912418529391289, -0.0033868642058223486, 0.017039429396390915, -0.010861323215067387, -0.02028614841401577, -0.005602924153208733, -0.037325579673051834, -0.042604412883520126, 0.03333141282200813, -0.025296371430158615, 0.00487591652199626, -0.03627448156476021, 0.01755329966545105, -0.009775190614163876, -0.002236498286947608, -0.04031535983085632, -0.012764973565936089, -0.005757668986916542, 0.06166428327560425, -0.021769361570477486, -0.007281757891178131, -0.006832122337073088, 0.00718248775228858, -0.013302200473845005, 0.014388333074748516, -0.024385420605540276, 0.0029883235692977905, 0.007684677839279175, -0.006586866918951273, -0.04545405134558678, 0.016618991270661354, -0.009763511829078197, -0.014131398871541023, -0.017086144536733627, 0.02429199032485485, -0.035924118012189865, -0.01839417591691017, 0.026043817400932312, 0.00017646000196691602, 0.008554751984775066, 0.0013941617216914892, -0.008700736798346043, -0.02041461504995823, 0.01364088710397482, 0.034102216362953186, 0.030598565936088562, -0.05358252674341202, 0.006762049160897732, 0.01305694505572319, 0.0432584285736084, -0.008537232875823975, -0.019480308517813683, 0.0216292142868042, -0.005016062408685684, 0.017891986295580864, 0.00493431044742465, -0.0037343096919357777, 0.0005109493504278362, 0.006826282944530249, -0.04099273309111595, -0.030878856778144836, -0.023836515843868256, 0.015147457830607891, 0.001100730849429965, 0.01991242542862892, 0.01736643724143505, -0.0047007338143885136, 0.01485548634082079, -0.07997670769691467, -0.004417521879076958, 0.028402943164110184, -0.009950373321771622, 0.0027941628359258175, -0.009716796688735485, 0.0019868628587573767, 0.025062793865799904, -0.014073004014790058, -0.022481771185994148, 0.024151844903826714, -0.004598543979227543, -0.0059124138206243515, 0.0017445270204916596, 0.08838547766208649, -0.0011043804697692394, -0.0016408772207796574, -0.005106573458760977, 0.034219007939100266, 0.02478250302374363, 0.007889057509601116, 0.010931395925581455, -0.05400296300649643, 0.004969347268342972, -0.017529942095279694, -0.0012051104567945004, -0.031486157327890396, 0.005205843597650528, 0.03590076044201851, -0.0066452608443796635, -0.008040882647037506, -0.019036512821912766, 0.006639421451836824, -0.0008080298430286348, -0.07049348950386047, 0.05825406312942505, 0.01341898925602436, 0.01912994310259819, -0.008648182265460491, 0.00022372281819116324, 0.010154752992093563, 0.00230803107842803, -0.011789790354669094, 0.0391007624566555, 0.01341898925602436, -0.001601461204700172, -0.028402943164110184, -0.0034861343447118998, -0.024011697620153427, -0.025132866576313972, 0.0018262788653373718, -0.003967886324971914, -0.01675913855433464, 0.02861316129565239, 0.043211713433265686, 0.039684705436229706, -0.06895188242197037, -0.0010620446410030127, -0.014680303633213043, 0.010569351725280285, -0.019818995147943497, 0.0402219295501709, 0.0005572997033596039, 0.010989789851009846, 0.0015255487523972988, 0.006621903274208307, -0.02350950799882412, -0.0002746352693066001, -0.016420451924204826, 0.003278834745287895, -0.03849346190690994, -0.011953294277191162, -0.03211681544780731, -0.007871539331972599, 0.01552118081599474, 0.006943071261048317, 0.024011697620153427, 0.008344531990587711, 0.0055357711389660835, -0.018207313492894173, 0.021839434280991554, 0.005106573458760977, 0.012473003007471561, 0.04501025751233101, -0.05783362314105034, 0.011743075214326382, 0.0138511061668396, -0.01615183800458908, -0.014236507937312126, 0.01633870042860508, 0.03384528309106827, 0.004218981601297855, -0.033868640661239624, 0.020437972620129585, -0.04816354438662529, 0.004175185691565275, -0.031112434342503548, 0.012099280022084713, 0.011994170024991035, 0.0019445271464064717, 0.023159142583608627, 0.034172289073467255, -0.029173746705055237, -0.0038014629390090704, 0.00038284703623503447, 0.004893434699624777, -0.014902202412486076, -0.030902214348316193, 0.0012109498493373394, -0.006919713690876961, 0.02994455024600029, 0.01320877019315958, -0.022680310532450676, 0.026557685807347298, -0.05264822021126747, -0.011188330128788948, 0.08857233822345734, -0.024315347895026207, -0.04337521642446518, 0.011077381670475006, -0.010528475977480412, 0.03877375274896622, 0.011620447039604187, 0.003348907921463251, -0.007783947978168726, 0.01159708946943283, -0.0493314266204834, -0.004797084257006645, -0.02812265045940876, -0.003769346047192812, 0.01436497550457716, 0.024432137608528137, -0.03587740287184715, 0.01748322695493698, -0.03928762301802635, -0.01748322695493698, 0.024572283029556274, -0.03454601392149925, -0.017880307510495186, -0.02557666413486004, 0.004890515003353357, -0.0334014855325222, 0.009091977961361408, -0.01665402762591839, -0.05325551703572273, -0.010948914103209972, 0.023859873414039612, -0.003421900561079383, 0.026043817400932312, 0.009886139072477818, 0.009582489728927612, 0.013722638599574566, 0.016607312485575676, 0.02835622802376747, -0.010972271673381329, 0.010429205372929573, -0.0006178836920298636, -0.04174017906188965, -0.010978111065924168, 0.021489068865776062, -0.011462783440947533, 0.060356255620718, -0.019935782998800278, -0.01955038122832775, -0.007830663584172726, -0.028986884281039238, -0.030505133792757988, -0.0037401490844786167, -0.007042341399937868, 0.029056958854198456, -0.02440878003835678, -0.006458399351686239, 0.027118271216750145, -0.010189789347350597, 0.000574088073335588, 0.03372849524021149, 0.030341630801558495, -0.03122922219336033, -0.02429199032485485, 0.028216080740094185, 0.022154763340950012, -0.005471537355333567, 0.0038773755077272654, -0.000906570116057992, 0.008256941102445126, -0.004414602182805538, 0.012297820299863815, 0.008274459280073643, -0.010341614484786987, 0.04839712008833885, 0.031299296766519547, 0.011001468636095524, 0.0004941609804518521, 0.028963526710867882, -0.017296364530920982, -0.004157667513936758, 0.07161466032266617, 0.029243819415569305, -0.013383952900767326, -0.002630659146234393, 0.01791534386575222, 0.023486150428652763, 0.00356788607314229, -0.021886149421334267, -0.01463358849287033, 0.051106613129377365, 0.039334338158369064, -0.020449651405215263, -0.01905987039208412, 0.03078542649745941, -0.013021908700466156, -0.003810222027823329, 0.021757682785391808, 0.00288467388600111, -0.004543069284409285, -0.025833597406744957, -0.025950387120246887, -0.005410223267972469, -0.011089060455560684, -0.018487606197595596, -0.024081772193312645, -0.005941610783338547, -0.03783944621682167, 1.5282859749277122e-05, 0.016735780984163284, 0.0009343073470517993, -0.017716802656650543, 0.015532859601080418, -0.005570807494223118, 0.02223651483654976, -0.001979563618078828, 0.006143070757389069, -0.020870089530944824, 0.004697814118117094, 0.05521756410598755, -0.022084688767790794, 0.01278833206743002, -0.024128487333655357, 0.008467160165309906, 0.011836506426334381, -0.013091981410980225, 0.035807330161333084, -0.014026288874447346, -0.014201471582055092, 0.03188323602080345, 0.017588336020708084, 0.01876789890229702, 0.0489577054977417, -0.013687602244317532, 1.2579846043081488e-05, 0.010581030510365963, 0.030762068927288055, -0.0207766592502594, -0.0034773750230669975, 0.03195331245660782, -0.03517667204141617, 0.029103673994541168, 0.02035622112452984, -0.008467160165309906, -0.015486144460737705, -0.006943071261048317, 0.030995646491646767, 0.011153293773531914, 0.004735770169645548, 0.01427154429256916, -0.06815771758556366, 0.0041547478176653385, 0.017202934250235558, 0.016794174909591675, 0.010522636584937572, -0.012297820299863815, 0.005605843849480152, -0.004052557982504368, -0.004362047184258699, 0.0049138725735247135, -0.02424527518451214, 0.005740150809288025, -0.009337234310805798, 0.005173726938664913, -0.02223651483654976, -0.03660149127244949, -0.0022525566164404154, -0.009576650336384773, -0.028075935319066048, 0.03746572509407997, -0.01719125546514988, -0.005398544482886791, -0.031019004061818123, 0.023275932297110558, 0.04545405134558678, 0.013372274115681648, 0.020800016820430756, 0.01706278696656227, -0.020449651405215263, 0.02588031254708767, -0.009979570284485817, -0.006545990705490112, -0.007918254472315311, 0.023778121918439865, -0.01278833206743002, 0.006037961225956678, 0.018966438248753548, -0.00902190525084734, 0.011188330128788948, -0.02405841462314129, -0.02424527518451214, -0.024198560044169426, -0.054890554398298264, 0.031205864623188972, -0.004604383371770382, -0.055124133825302124, -0.01894308067858219, 0.02272702567279339, -0.005471537355333567, 0.014645267277956009, 0.01665402762591839, -0.04561755433678627, -0.015649648383259773, -0.016782496124505997, -0.0017021911917254329, -0.0051270113326609135, 0.011404388584196568, 0.0025386882480233908, -0.011719717644155025, 0.01615183800458908, -0.020975200459361076, -0.0049080331809818745, 0.001071533770300448, 0.014960596337914467, 0.0003352192579768598, 0.05498398840427399, -0.007451101206243038, 0.02557666413486004, -0.010102198459208012, -0.04853726550936699, -0.0021970821544528008, -0.05689931660890579, -0.010680301114916801, 0.017109503969550133, -0.03650806099176407, -0.003716791281476617, -0.026137247681617737, -0.013278842903673649, 0.011503659188747406, 0.010429205372929573, -0.008578109554946423, -0.003100732574239373, 0.009740154258906841, 0.0016686144517734647, 0.007205845322459936, 0.05222778022289276, 0.019153300672769547, -0.0020116805098950863, 0.008455481380224228, 0.0020043812692165375, 0.0377693735063076, 0.016175195574760437, -0.004808763042092323, -0.00938394945114851, -0.004703653510659933, -0.01924673095345497, 0.021243812516331673, 0.008963511325418949, -0.006359129212796688, 0.043445292860269547, -0.002462775679305196, -0.024829218164086342, -0.03989492356777191, 0.015614611096680164, -0.016805853694677353, 0.016899283975362778, 0.03966134786605835, -0.0007824823842383921, -0.026277393102645874, 0.007585407700389624, 0.009816066361963749, 0.02763213962316513, -0.02247009053826332, 0.03734893724322319, 0.04409930482506752, 0.016957677900791168, -0.0381430983543396, -3.127283707726747e-05, -0.004332850221544504, -0.02588031254708767, 0.013582493178546429, 0.033074479550123215, -0.005246719811111689, -0.01305694505572319, -0.021535784006118774, 0.0129985511302948, -0.011760593391954899, 0.0026423379313200712, -0.00874161347746849, -0.008624824695289135, -0.006855479907244444, -0.004032120108604431, -0.038843829184770584, 0.030948931351304054, 0.02550658956170082, -0.011585410684347153, -0.0027109510265290737, 0.01059854868799448, 0.0051474496722221375, -0.012916798703372478, -0.017775196582078934, 0.005705113988369703, 0.02527301385998726, 0.017027750611305237, -0.003874455811455846, 0.008618985302746296, 0.0014729938702657819, 0.0129051199182868, 0.02417520247399807, -0.00414306903257966, -0.032467179000377655, 0.019760599359869957, -0.008087597787380219, 0.006855479907244444, 0.047229234129190445, -0.004741609562188387, 0.024922648444771767, 0.02819272316992283, -0.02424527518451214, 0.002007300965487957, -0.010773731395602226, -0.007065699435770512, -0.0472525916993618, 0.0068029253743588924, 0.05012558773159981, 0.028683235868811607, -0.01938687637448311, 0.01065694261342287, 0.01839417591691017, -0.023521186783909798, -0.04267448931932449, 0.009781030006706715, -0.0029182506259530783, 0.004484675358980894, -0.0028335789684206247, 0.022143084555864334, 0.004113872069865465, -0.029407324269413948, 0.029173746705055237, 0.0040729958564043045, 0.0258102398365736, -9.881395089905709e-05, 0.010861323215067387, 0.007754751015454531, 0.016899283975362778, 0.017833590507507324, 0.008800007402896881, -0.010908038355410099, 0.024221917614340782, 0.0032467180863022804, 0.0485839806497097, -0.019211694598197937, -0.011013147421181202, -0.012951835058629513, 0.011585410684347153, -0.01754162088036537, -0.006382486782968044, 0.00880584679543972, 0.0032875938341021538, 0.008315335027873516, -0.03765258565545082, -0.03877375274896622, 0.024875933304429054, -0.01974892057478428, -0.034219007939100266, 0.02313578501343727, -0.00023868633434176445, -0.006382486782968044, 0.015299282968044281, -0.004557667765766382, 0.04223069176077843, 0.02569345198571682, -0.025132866576313972, -0.029407324269413948, -0.008221904747188091, -0.026347467675805092, 0.023030675947666168, -0.007217524107545614, -0.034709516912698746, 0.00545109948143363, -0.014446727000176907, 0.0017562058055773377, -0.02926717698574066, -0.00917373038828373, -0.007299276068806648, 0.0007985408301465213, 0.03667156398296356, 0.007731392979621887, -0.049284711480140686, -0.015696363523602486, 0.020192718133330345, 0.031065719202160835, -0.0027167906519025564, -0.002725549740716815, -0.001648176577873528, 0.015182494185864925, 0.011065702885389328, 0.02076498046517372, -0.0011036505457013845, -0.016969356685876846, -0.023602938279509544, 0.016712423413991928, -0.021722646430134773, -0.027375204488635063, -0.002696352545171976, 0.013781033456325531, 0.0007200735853984952, -0.014902202412486076, 0.015626290813088417, 0.01785694807767868, 0.030808784067630768, 0.022364981472492218, 0.0016788335051387548, -0.014738698489964008, -0.004309492651373148, 0.011100739240646362, -0.016899283975362778, 0.025927027687430382, 0.002478834241628647, 0.032467179000377655, -0.024105129763484, 0.006271537858992815, 0.002772265113890171, 0.0064817569218575954, -0.017389794811606407, 0.02800586260855198, 0.01749490574002266, 0.00498102605342865, -0.031182507053017616, 0.000900730665307492, 0.016794174909591675, 0.01616351678967476, -0.0016788335051387548, -0.024151844903826714, -0.0019518263870850205, 0.005570807494223118, -0.014983953908085823, 0.0028627761639654636, 0.006259859073907137, -0.03323798254132271, 0.027842357754707336, -0.025062793865799904, 0.00217810389585793, 0.023357683792710304, -0.019363518804311752, -0.04580441862344742, -0.004656937904655933, -0.00880584679543972, 0.006160588935017586, -0.01755329966545105, -0.0006317523657344282, 0.006680297665297985, 0.012683222070336342, 0.016677385196089745, -0.014236507937312126, 0.0054481797851622105, -0.0023328487295657396, 0.0014868625439703465, -0.02952411212027073, 0.014224829152226448, 0.0018817533273249865, 0.03160294517874718, 0.010715337470173836, 0.010131395421922207, -0.031486157327890396, -0.009786869399249554, 0.026137247681617737, 0.004166426602751017, -0.042300764471292496, -0.003573725465685129, -0.03475623205304146, 0.0038773755077272654, 0.0007062049699015915, 0.006464238744229078, 0.00030602214974351227, 0.010972271673381329, -0.007947451435029507, -0.010411687195301056, -0.004201463423669338, -0.011830667033791542, -0.013243806548416615, -0.024548925459384918, 0.021407317370176315, 0.03734893724322319, -0.02823944017291069, -0.027538709342479706, 0.05367595702409744, -0.01591826044023037, 0.017833590507507324, 0.01817227713763714, -0.010417526587843895, -0.010335775092244148, 0.016186874359846115, -0.029991265386343002, 0.010621906258165836, 0.054096393287181854, 0.011637966148555279, -0.01797373779118061, -0.013769354671239853, -0.006686137057840824, -0.018978117033839226, 0.00466277776286006, -0.019001474604010582, -0.025740167126059532, 0.0006967158988118172, -0.03564382344484329, 0.00801752507686615, 0.01017227116972208, -0.007532852701842785, 0.027772285044193268, 0.00666861841455102, -0.04690222814679146, -0.028683235868811607, -0.04414601996541023, -0.0064992755651474, 0.01955038122832775, -0.009675920009613037, 0.0015620450722053647, 0.0008313875296153128, 0.0015328479930758476, -0.00887008011341095, 0.006020443048328161, -0.0069722686894237995, 0.003179564606398344, -0.049892012029886246, -0.012461324222385883, -0.008181028999388218, 0.0026481773238629103, -0.013862784951925278, -0.0030306593980640173, 0.023404398933053017, 0.018686147406697273, 0.011252564378082752, 0.004023361019790173, 0.006078836973756552, 0.009144533425569534, -0.020134322345256805, -0.005442340392619371, -0.017938701435923576, 0.015883224084973335, 0.03571389615535736, 0.004046718589961529, 0.004207302816212177, -0.011637966148555279, -0.0029693455435335636, -0.017646729946136475, -0.02011096477508545, 0.04295478016138077, 0.002865695860236883, 0.006919713690876961, 0.007789787370711565, 0.01894308067858219, 0.025343086570501328, -0.0698394700884819, 0.04209054633975029, 0.021337244659662247, 0.005389785394072533, 0.03108907677233219, -0.011865703389048576, 0.01159708946943283, 0.04258105531334877, -0.02161753550171852, -0.003970806021243334, -0.011445265263319016, 0.02994455024600029, -0.002395622432231903, 0.02009928598999977, 0.024105129763484, -0.021886149421334267, 0.0377693735063076, 0.01163212675601244, -0.01980731636285782, -0.009734314866364002, 0.007626283448189497, 0.0017883225809782743, 0.0025664253626018763, 0.0031182507518678904, 0.022189799696207047, -0.002213140483945608, 0.011129936203360558, 0.029010243713855743, -0.037559155374765396, 0.03363506495952606, 0.003906572703272104, 0.011439425870776176, -0.03445258364081383, -0.04162339121103287, -0.009132854640483856, 0.008029203861951828, -0.005600004456937313, 0.014143077656626701, 0.002080293605104089, -0.024268632754683495, 0.0017941620899364352, -0.015275925397872925, -0.02242337539792061, 0.02374308556318283, 0.02702483907341957, -0.02975768782198429, -0.007293436676263809, -0.0025985422544181347, -0.0014868625439703465, 0.025950387120246887, -0.002462775679305196, 0.0028175206389278173, -0.029080316424369812, -0.015953298658132553, -0.00960000790655613, 0.024572283029556274, -0.016000013798475266, 0.008694897405803204, -0.013033587485551834, -0.012227747589349747, 0.021535784006118774, 0.0033635064028203487, -0.04113288223743439, 0.013547456823289394, 0.04197375848889351, -0.03305112197995186, -0.029197104275226593, -0.005106573458760977, -0.008858401328325272, -0.014762056060135365, 0.013921178877353668, -0.042978137731552124, 0.032654039561748505, -0.008280298672616482, 0.029383964836597443, 0.006020443048328161, -0.0236262958496809, 0.015077384188771248, -0.015486144460737705, -0.027889074757695198, 0.00034452581894584]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-14T10:14:42.000172", "url_path": "/api/models/function/", "chunk_size": 1887}
updated_dt: 2025-03-14T10:14:42.000172
---
```
frompydantic_aiimport Agent
frompydantic_ai.messagesimport ModelMessage, ModelResponse, TextPart
frompydantic_ai.models.functionimport FunctionModel, AgentInfo
my_agent = Agent('openai:gpt-4o')

async defmodel_function(
  messages: list[ModelMessage], info: AgentInfo
) -> ModelResponse:
  print(messages)
"""
  [
    ModelRequest(
      parts=[
        UserPromptPart(
          content='Testing my agent...',
          timestamp=datetime.datetime(...),
          part_kind='user-prompt',
        )
      ],
      kind='request',
    )
  ]
  """
  print(info)
"""
  AgentInfo(
    function_tools=[], allow_text_result=True, result_tools=[], model_settings=None
  )
  """
  return ModelResponse(parts=[TextPart('hello world')])

async deftest_my_agent():
"""Unit test for my_agent, to be run by pytest."""
  with my_agent.override(model=FunctionModel(model_function)):
    result = await my_agent.run('Testing my agent...')
    assert result.data == 'hello world'

```

See [Unit testing with `FunctionModel`](https://ai.pydantic.dev/testing-evals/#unit-testing-with-functionmodel) for detailed documentation.
###  FunctionModel `dataclass`
Bases: `Model[](https://ai.pydantic.dev/api/models/base/#pydantic_ai.models.Model "pydantic_ai.models.Model")`
A model controlled by a local function.
Apart from `__init__`, all methods are private or match those of the base class.
Source code in `pydantic_ai_slim/pydantic_ai/models/function.py`
```
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
```
|