---
url: https://ai.pydantic.dev/examples/weather-agent/
session_id: pydantic_ai_docs
chunk_number: 2
title: Weather Agent Implementation Using Pydantic
summary: This document describes the setup of a weather agent using Pydantic and AsyncClient, including configuration for logfire and dependencies required to interact with weather and geo APIs.
embedding: [-0.07446472346782684, 0.03969400376081467, 0.05446386709809303, -0.021911192685365677, -0.015795547515153885, 0.006852857302874327, 0.03187315911054611, -0.027462713420391083, -0.018372580409049988, -0.023988205939531326, -0.007673405110836029, -0.00042910489719361067, -0.014180094003677368, -0.03415530547499657, -0.016013504937291145, -0.006865678355097771, -0.002294969977810979, 0.012244113720953465, -0.030411556363105774, 0.045848116278648376, 0.026693448424339294, -0.013769819401204586, 0.0032196890097111464, 0.012897987850010395, -0.016628915444016457, -0.0033687339164316654, -0.027539638802409172, 0.07364417612552643, 0.003641181392595172, 0.025924185290932655, 0.047822557389736176, -0.01584683172404766, 0.004785460885614157, 0.006323988549411297, 0.004593145102262497, -0.031539808958768845, 0.02500106953084469, 0.02043677121400833, 0.0051284246146678925, -0.001778922276571393, 0.005192529875785112, -0.07523398846387863, 0.015898115932941437, 0.017205864191055298, -0.045899398624897, 0.01687251590192318, -0.041078679263591766, 0.08333689719438553, 0.04464293643832207, -0.034591224044561386, -0.013019787147641182, -0.0019455960718914866, -0.06610538810491562, 0.005420103669166565, -0.04882260039448738, 0.0019263644935563207, -0.019949570298194885, 0.05615624785423279, 0.024039490148425102, -0.03677080199122429, 0.015244241803884506, 0.003285396844148636, 0.006949014961719513, 0.02018035016953945, -0.008929869160056114, 0.000992830959148705, 0.007699047215282917, -0.008974743075668812, -0.03730928897857666, -0.006564383395016193, 0.0318475142121315, 0.030155135318636894, 0.01359032467007637, -0.08251634985208511, -0.028437113389372826, -0.0163212101906538, -0.018270011991262436, 0.023244583979249, -0.010320954024791718, -0.033539894968271255, -0.024462584406137466, 0.005548314191401005, -0.05272020399570465, 0.03628360480070114, -0.01133381761610508, -0.05472029000520706, -0.04605325311422348, 0.010487628169357777, -0.010301722213625908, -0.017205864191055298, 0.001215596916154027, 0.011718450114130974, -0.009269626811146736, 0.012147955596446991, 0.07282362878322601, 0.043924953788518906, 0.010487628169357777, -0.015269883908331394, 0.0013454101281240582, -0.007365699857473373, -0.004660455510020256, -0.039001669734716415, -0.04761742055416107, -0.006054745987057686, 0.034770719707012177, -0.002711654407903552, 0.008545237593352795, 0.0087055005133152, -0.035104066133499146, -0.019449550658464432, -0.12338989228010178, 0.031283389776945114, -0.01635967381298542, 0.023052267730236053, -0.04259156435728073, 0.007993931882083416, 0.007128510158509016, -0.03202700987458229, 0.02203940413892269, -0.02616778574883938, -0.01927005499601364, 0.026539595797657967, 0.028231976553797722, 0.05636138468980789, 0.013654430396854877, 0.0011779350461438298, -0.022244540974497795, -0.06456686556339264, -0.028257619589567184, 0.010128638707101345, 0.033027052879333496, -0.007692636922001839, 0.01309671439230442, -0.04025813192129135, -0.035283561795949936, 0.009032437577843666, -0.05825890228152275, -0.010442754253745079, -0.028001196682453156, 0.056053679436445236, 0.021039361134171486, 0.0008766400278545916, 0.013603146187961102, -0.004541860893368721, -0.044617291539907455, 0.011045344173908234, -0.045822471380233765, 0.018808497115969658, -0.023129194974899292, 0.024757469072937965, 0.03730928897857666, 2.36763935390627e-05, -0.044796787202358246, 0.0006815195083618164, 0.00227253302000463, 0.03174494579434395, 0.038822174072265625, 0.015692979097366333, 0.04143767058849335, -0.042283859103918076, -0.021808624267578125, 0.019667508080601692, -0.017500748857855797, -0.042027439922094345, -0.021590666845440865, -0.028590966016054153, 0.012481302954256535, -0.007134920451790094, -0.040822260081768036, -0.019731612876057625, -0.03305269405245781, 0.0051284246146678925, 0.007788794580847025, 0.023629216477274895, 0.05028420314192772, -0.022065047174692154, 0.003663618117570877, 0.004814308602362871, -0.009711953811347485, -0.015154493972659111, -0.04205308109521866, -0.010013248771429062, -0.0005533089279197156, -0.0177058856934309, -0.04692508280277252, 0.01734689623117447, 0.06733621656894684, 0.02707808092236519, -0.011551775969564915, 0.064874567091465, 0.002444014884531498, 0.04056583717465401, 0.021231677383184433, 0.012269755825400352, -0.030693620443344116, 0.018539253622293472, 0.05272020399570465, -0.02874481864273548, 0.01839822344481945, 0.023449720814824104, 0.016526347026228905, 0.053181760013103485, 0.053540751338005066, -0.03107825294137001, 0.02094961330294609, -0.028231976553797722, -0.008205479010939598, -0.02055216021835804, -0.04815590754151344, 0.02310355193912983, 0.0290781669318676, -0.045822471380233765, -0.008410615846514702, -0.007506731431931257, -0.03148852661252022, 0.022129151970148087, -0.03569383546710014, 0.006343219894915819, -0.009429890662431717, 0.03825804591178894, -0.039950426667928696, 0.036642592400312424, 0.0034809180069714785, -0.028719177469611168, 0.0015088786603882909, 0.007596478797495365, 0.04100175201892853, -0.019436728209257126, 0.031539808958768845, 0.05002778023481369, 0.039335016161203384, 0.0015417325776070356, -0.019552119076251984, 0.001391085097566247, 0.06446429342031479, -0.03038591518998146, 0.04613017663359642, -0.02201376110315323, -0.023039447143673897, 0.03669387847185135, -0.01544937863945961, -0.029308944940567017, -0.00951322726905346, -0.012487713247537613, 0.015116031281650066, 0.007211846765130758, -0.008763195015490055, -0.06333604454994202, 0.0959528237581253, 0.013385187834501266, 0.01493653655052185, -0.024218983948230743, -0.005269456189125776, -0.05554083734750748, -0.03097568452358246, -0.004452113527804613, -0.02666780725121498, 0.003756570862606168, -0.026437027379870415, -0.03133467212319374, 0.020449591800570488, -0.013449293561279774, -0.0650797039270401, 0.022424036636948586, 0.019552119076251984, -0.04336082935333252, -0.014385230839252472, -0.02459079585969448, -0.0186931062489748, 0.0005448951269499958, 0.000329341011820361, 0.022488141432404518, 0.045566052198410034, -0.005189324729144573, -0.0365913100540638, 0.021000897511839867, 0.006032309494912624, 0.018603360280394554, -0.01818026416003704, -0.005035471636801958, -0.02255224622786045, 0.021141929551959038, 0.024949785321950912, 0.06066926196217537, -0.035950254648923874, 0.009026027284562588, -0.01996239274740219, 0.0021619515027850866, -0.010962007567286491, 0.024360015988349915, 0.052233003079891205, 0.04259156435728073, -0.001610645791515708, -0.023308688774704933, 0.004849566612392664, 0.006840036250650883, 0.03979657217860222, 0.01877003349363804, 0.006253472529351711, -0.03192444145679474, 0.014949357137084007, 0.014026240445673466, -0.014474977739155293, 0.0022613147739320993, -0.012635155580937862, 0.044694218784570694, 0.03212957829236984, 0.02666780725121498, 0.036129750311374664, 0.003596307709813118, 0.0052085560746490955, 0.0872344970703125, 0.00273729651235044, 0.000463160831714049, -0.00307384948246181, -0.023231763392686844, 0.06333604454994202, 0.0007059596828185022, 0.016026325523853302, -0.015475020743906498, -0.03871960565447807, -0.011090218089520931, 0.03505278006196022, -0.010897901840507984, -0.03200136870145798, -0.010622248984873295, 0.03384760022163391, -0.03315526247024536, -0.028001196682453156, 0.006439378019422293, 0.006234241183847189, -0.012962092645466328, -0.004654045216739178, 0.029103808104991913, 0.04220693185925484, 0.01016710139811039, -0.019885465502738953, -0.017282789573073387, 0.016744306311011314, 0.05948972329497337, -0.04318133369088173, -0.020603444427251816, -0.06292577087879181, 0.0006690991576761007, 0.010468396358191967, 0.015333988703787327, 0.042642850428819656, 0.0002896758378483355, 0.010083764791488647, -0.023257404565811157, -0.0006719037191942334, 0.02335997298359871, 0.0007444228394888341, 0.01709047518670559, -0.019500834867358208, -0.025039533153176308, -0.006128467153757811, 0.009058079682290554, -0.04959186539053917, -0.010737638920545578, -0.06702850759029388, 0.004051455296576023, 0.021667594090104103, -0.03695029765367508, -0.0008389782160520554, 0.002359075238928199, -0.020962435752153397, -0.01621864177286625, -0.026693448424339294, 0.02211633138358593, 0.04743792489171028, -0.007166973315179348, -0.057592205703258514, -0.013936493545770645, -0.03574511781334877, -0.023744605481624603, 0.030257703736424446, 0.01319287158548832, -0.0055290828458964825, 0.035283561795949936, 0.008859353139996529, 0.006173341069370508, -0.01985982432961464, -0.028693534433841705, 0.024693364277482033, 0.004003376234322786, -0.013398009352385998, -0.00030249691917560995, 0.007852899841964245, 0.006442583166062832, 0.040027353912591934, -0.06707978993654251, -0.0043527502566576, -0.003072246676310897, -0.009340142831206322, -0.0006037918501533568, 0.04554041102528572, 0.023962562903761864, 0.03825804591178894, -0.010603017173707485, -0.002192401560023427, -0.006686183623969555, -0.018128979951143265, 0.0264113862067461, 0.009019616059958935, 0.025680584833025932, 0.038976024836301804, 0.02462925761938095, -0.013128766790032387, -0.05238685756921768, 0.018757212907075882, -0.08200350403785706, 0.020167529582977295, -0.013000556267797947, 0.0009423479787074029, -0.015423736535012722, -0.037693921476602554, -0.03177059069275856, 0.027565281838178635, 0.04805333539843559, -0.023488184437155724, -0.05436129868030548, 0.051386814564466476, -0.0004028617695439607, -0.025129279121756554, 0.046001967042684555, 0.03938629850745201, -0.04992521181702614, 0.026360101997852325, -0.029052523896098137, -0.015090389177203178, -0.03169366344809532, 0.022347109392285347, 0.017911022529006004, -0.02630881778895855, 0.002596264937892556, 0.012750545516610146, 0.031539808958768845, 0.012199239805340767, -0.004477755632251501, -0.001310953521169722, -0.03248856961727142, -0.0075772469863295555, 0.040540196001529694, -0.020744476467370987, -0.007404163014143705, 0.007199025712907314, 0.002043356653302908, -0.017757169902324677, -0.015167315490543842, 0.017244327813386917, -0.002944036154076457, -0.015180136077105999, 0.037104152143001556, -0.0051027825102210045, -0.001976046012714505, 0.05615624785423279, 0.021834267303347588, 0.05938715487718582, 0.021039361134171486, 0.015167315490543842, 0.004769434686750174, -0.04815590754151344, 0.016628915444016457, -0.046078894287347794, 0.025808796286582947, 0.033719390630722046, 0.021436814218759537, 0.027052439749240875, 0.00874396413564682, 0.020641908049583435, 0.01744946464896202, 0.0030690415296703577, 0.002133104018867016, -0.048181548714637756, -0.0311551783233881, 0.01938544400036335, 0.02346254140138626, 0.008814479224383831, -0.011910765431821346, 0.020923972129821777, 0.0015208984259516, -0.01359032467007637, -0.010256849229335785, -0.013295440003275871, 0.02197529934346676, -0.014474977739155293, -0.03661695122718811, 0.007545194588601589, -0.01873156987130642, 0.009724775329232216, 0.03446301072835922, 0.022359929978847504, -0.014231378212571144, 0.03148852661252022, -0.0014543890720233321, -0.02794991247355938, 0.03318090736865997, 0.012340270914137363, 0.0011338626500219107, 0.04223257675766945, -0.007372110150754452, -0.0015617655590176582, 0.027924271300435066, 0.021513741463422775, -0.004279029089957476, 0.0034168127458542585, -0.010904312133789062, 0.02448822744190693, 0.011904355138540268, -0.003564255079254508, -0.006699004676192999, -0.016680199652910233, 0.020885508507490158, -0.015026283450424671, -0.010122227482497692, -0.033898886293172836, 0.017795633524656296, -0.030078209936618805, 0.010026070289313793, -0.006561178248375654, -0.016718663275241852, -0.010827385820448399, 0.018487969413399696, 0.006865678355097771, 0.012795419432222843, 0.003663618117570877, -0.031206462532281876, -0.002676396630704403, 0.004375187214463949, 0.017039190977811813, 0.005189324729144573, -0.014962178654968739, 0.04356596618890762, -0.06082311272621155, 0.0311551783233881, -0.006628488656133413, -0.0312577486038208, -0.0028783283196389675, -0.03333475813269615, -0.01839822344481945, 0.02743707038462162, -0.029103808104991913, -0.014731399714946747, -0.014718578197062016, 0.006311167497187853, -0.007320825941860676, -0.01657763123512268, -0.0034456602297723293, -0.004115560557693243, 0.06415659189224243, -0.038206763565540314, 0.016769947484135628, -0.005404077470302582, 0.038463182747364044, 0.0253215953707695, 0.008365742862224579, -0.007558015640825033, 0.008186247199773788, -0.004269413184374571, 0.019500834867358208, -0.024757469072937965, 0.02571904845535755, -0.0005420905072242022, -0.009968374855816364, 0.032847557216882706, 0.03364246338605881, -0.023449720814824104, -0.025129279121756554, 0.009474764578044415, 0.014026240445673466, -0.026244712993502617, -0.048873886466026306, 0.014757041819393635, 0.020090602338314056, 0.0014760246267542243, 0.022129151970148087, -0.05156630650162697, -0.041771017014980316, 0.013910851441323757, 0.002814222825691104, 0.0037725972943007946, 0.02900123968720436, -0.004737382289022207, -0.01003889087587595, -0.028693534433841705, -0.027924271300435066, -0.007166973315179348, 0.017385359853506088, -0.04861746355891228, 0.024167699739336967, 0.01257105078548193, -0.02000085450708866, -0.008314457722008228, -0.04018120467662811, 0.019372623413801193, 0.011346639133989811, 0.018064875155687332, -0.035796403884887695, 0.02725757658481598, 0.03325783088803291, -0.032744988799095154, -0.02171887829899788, 0.021629130467772484, 0.028155051171779633, -0.024680541828274727, 0.054822858422994614, 0.002966473111882806, -0.06261806190013885, -0.04354032501578331, -0.03754006698727608, -0.020577803254127502, -0.022975342348217964, -0.023488184437155724, -0.036232318729162216, 0.03071926161646843, -0.02405231073498726, 0.041078679263591766, 0.06513099372386932, -0.015526304952800274, 0.004083508159965277, -0.007468268275260925, 0.02335997298359871, 0.0014479785459116101, 0.0005621233722195029, -0.014231378212571144, -0.013962135650217533, -0.028539681807160378, -0.02073165588080883, 0.024065131321549416, -0.01942390762269497, 0.023000983521342278, 0.028847387060523033, 0.012462071143090725, -0.0024055514950305223, -0.025988290086388588, 0.024283090606331825, -0.022795846685767174, -0.04112996533513069, -0.027847344055771828, 0.012744135223329067, 0.029898714274168015, 0.02251378260552883, 0.0087055005133152, 0.02812940813601017, 0.0180007703602314, -0.03720672056078911, 0.026026753708720207, 0.05213043466210365, 0.0007756741833873093, -0.005907304119318724, -0.023859994485974312, 0.004048250149935484, 0.04433523118495941, 0.018321296200156212, 0.004452113527804613, 0.023193299770355225, -0.005061113741248846, -0.03182187303900719, 0.033539894968271255, -0.04433523118495941, 0.001568977371789515, -0.00834651105105877, 0.0070579941384494305, -0.029360229149460793, 0.02900123968720436, 0.027642207220196724, 0.01687251590192318, 0.027539638802409172, 0.01319287158548832, -0.02787298709154129, 0.0070195309817790985, 0.01084020733833313, 0.031462885439395905, 0.031052609905600548, 0.0007420189213007689, 0.02543698623776436, -0.05672037601470947, -0.040822260081768036, 0.0177058856934309, -0.010211975313723087, -0.0032565495930612087, -0.056463953107595444, 0.0022805463522672653, 0.033462971448898315, -0.0052213771268725395, 0.010282491333782673, -0.007166973315179348, -0.03800162672996521, 0.028411472216248512, 0.006356040947139263, 0.005295098293572664, -0.002352664712816477, 0.04779691621661186, 0.0025674174539744854, 0.0284883975982666, -0.0037277236115187407, 0.009936322458088398, -0.001294927205890417, -0.036232318729162216, -0.015308346599340439, 0.012199239805340767, 0.033027052879333496, -0.009827343747019768, 0.00733364699408412, -0.02794991247355938, 0.00014533875219058245, -0.005615624599158764, 0.02091115154325962, -0.019693149253726006, -0.005105987656861544, -0.005170092917978764, -0.022218899801373482, 0.00011779349733842537, -0.037001583725214005, -0.0012107889633625746, -0.0034937390591949224, 0.03569383546710014, -0.0028254413045942783, -0.011359459720551968, -0.04564297944307327, 0.01350057777017355, -0.01865464448928833, -0.02003931812942028, 0.007372110150754452, -0.033539894968271255, -0.06590025126934052, 0.028616609051823616, 0.024731827899813652, -0.002982499310746789, -0.016923800110816956, -0.017654601484537125, 0.034411728382110596, -0.02856532484292984, -0.008878584951162338, 0.0034007865469902754, -0.047719988971948624, 0.009032437577843666, -0.0046636611223220825, -0.00874396413564682, 0.001320569310337305, -0.015398094430565834, -0.033462971448898315, 0.034591224044561386, 0.02856532484292984, -0.01122483890503645, 0.01665455847978592, 0.01056455448269844, -0.05825890228152275, 0.022526605054736137, -0.026206249371170998, 0.009519637562334538, 0.005218171980232, -0.017731526866555214, -0.0021058593410998583, 0.027155008167028427, 0.007679815404117107, -0.0011819415958598256, -0.05307919159531593, -0.01111586019396782, -0.034591224044561386, -0.020385487005114555, 0.005067524500191212, -0.02251378260552883, -0.011776144616305828, -0.015039104968309402, 0.020680371671915054, -0.03133467212319374, -0.011359459720551968, 0.011058165691792965, -0.003743749810382724, -0.05220736190676689, 0.012763366103172302, 0.03384760022163391, 0.01371853519231081, -0.0791315883398056, -0.008538826368749142, 0.005724603775888681, 0.03687337040901184, 0.007173383608460426, 0.009795290417969227, -0.013564682565629482, -0.01548784226179123, 0.031796231865882874, 0.0451044924557209, -0.007410573307424784, 0.0060867988504469395, 0.02270609885454178, 0.011256891302764416, -0.03012949414551258, -0.06523355841636658, 0.0010016453452408314, 0.02091115154325962, -0.012962092645466328, 0.04023249074816704, 0.033206548541784286, 0.007987520657479763, -0.08297790586948395, -0.024821573868393898, 0.009955554269254208, -0.007038762792944908, 0.009744006209075451, -0.019488012418150902, 0.009744006209075451, 0.010936365462839603, -0.006955425720661879, -0.002501709619536996, -0.006897730752825737, -0.01683405414223671, -0.03910423815250397, -0.0243343748152256, 0.023052267730236053, -0.011712039820849895, 0.026872944086790085, 0.034232232719659805, 0.03815547749400139, 0.010218385607004166, -0.02820633538067341, -0.007134920451790094, -0.03443736955523491, 0.031129537150263786, -0.02247532084584236, -0.013577504083514214, -0.002803004579618573, 0.02270609885454178, 0.05113039165735245, 0.001403906149789691, -0.013821103610098362, -0.01952647604048252, 0.026116501539945602, 0.007327236235141754, -0.03479636088013649, 0.05477157235145569, 0.0026443437673151493, 0.03989914059638977, 0.016782769933342934, -0.00714133121073246, 0.02193683572113514, -0.01240437664091587, 0.046335313469171524, 0.008128552697598934, 0.043489038944244385, 0.027565281838178635, -0.015308346599340439, -0.0005805536638945341, -0.05025855824351311, -0.014846788719296455, 0.012218471616506577, 0.009429890662431717, 0.0007071616710163653, 0.021308602765202522, 0.0037790078204125166, 0.029206376522779465, -0.06620796024799347, 0.03246292844414711, -0.012526176869869232, 0.014705757610499859, 0.0028751229401677847, -0.005997051484882832, -0.005057908594608307, -0.023488184437155724, -0.04692508280277252, 0.032668065279722214, -0.01942390762269497, 0.018782854080200195, -0.009122185409069061, -0.031539808958768845, -0.011596649885177612, 0.018936706706881523, 0.02175734005868435, -0.038822174072265625, -0.010769691318273544, 0.01760331727564335, 0.031385958194732666, -0.014180094003677368, -0.01240437664091587, -0.0034713023342192173, 0.021308602765202522, -0.017936663702130318, -0.008884995244443417, 0.01675712689757347, -0.00746185751631856, 0.012218471616506577, -0.012846703641116619, -0.00323411263525486, -0.0409504696726799, 0.004529039841145277, 0.008064447902143002, 0.011314586736261845, 0.01056455448269844, 0.005000213626772165, -0.02223172038793564, 0.021052181720733643, -0.02179580368101597, 0.009936322458088398, 0.03305269405245781, 0.008718322031199932, 0.04502756521105766, -0.0011875508353114128, -0.020706012845039368, 0.016821231693029404, 0.003589897183701396, 0.03359118103981018, -0.03502713888883591, -0.028257619589567184, -0.01350057777017355, -0.024988248944282532, 0.018385400995612144, 0.004791871644556522, -0.029283303767442703, 0.014641651883721352, -0.0203726664185524, -0.00805162638425827, 0.06174623221158981, -0.005368819460272789, -0.023129194974899292, -0.0003265363920945674, 0.028719177469611168, -0.00408030254766345, 0.012833882123231888, -0.006775930989533663, 0.006198983173817396, 0.014423693530261517, -0.025693407282233238, -0.01000042725354433, -0.02389845810830593, -0.0003499749000184238, 0.04084790125489235, -0.0010937968036159873, -0.01359032467007637, 0.00502906134352088, -0.012878756038844585, -0.01803923211991787, 0.030744904652237892, -0.007468268275260925, -0.009558101184666157, 0.009641437791287899, -0.009179879911243916, -0.009615795686841011, -0.019000813364982605, -0.010429933667182922, -0.02856532484292984, 0.007897773757576942, 0.027129365131258965, 0.03512970730662346, -0.040642764419317245, 0.020680371671915054, 0.012763366103172302, -0.031283389776945114, -0.01388520933687687, 0.014782683923840523, 0.03333475813269615, 0.056310102343559265, -0.013231335207819939, -0.04830975830554962, -0.02219325676560402, -0.027590923011302948, -0.014821146614849567, 0.053438182920217514, 0.0023927304428070784, -0.01269926130771637, 0.02375742606818676, -0.032744988799095154, -0.02874481864273548, -0.009051669389009476, -0.0017709090607240796, 0.00587525125592947, 0.004269413184374571, 0.026796018704771996, 0.013071072287857533, -0.024872858077287674, 0.031052609905600548, 0.04389931261539459, 0.026360101997852325, -0.022090688347816467, -0.016154536977410316, 0.019103381782770157, -0.021847087889909744, 0.05579725652933121, 0.015590410679578781, 0.0026235096156597137, 0.05287405475974083, 0.022757383063435555, -0.005964998621493578, 0.007442626170814037, -0.03174494579434395, 0.015295526012778282, 0.009455532766878605, -0.006634898949414492, -0.016167357563972473, 0.035437412559986115, -0.04551476612687111, 0.04395059868693352, 0.03646309673786163, 0.011481259949505329, -0.0010777704883366823, -0.015410915948450565, 0.038283687084913254, 0.04861746355891228, 0.0031780204735696316, -0.01657763123512268, 0.023911278694868088, 0.07543912529945374, -0.03887345641851425, -0.023988205939531326, -0.00807085819542408, -0.013513398356735706, -0.027642207220196724, -0.031462885439395905, -0.01909055933356285, -0.004968161229044199, 0.014026240445673466, 0.018282832577824593, -0.051617592573165894, -0.0011755310697481036, -0.04610453546047211, -0.03748878464102745, -0.011808197014033794, -0.008013162761926651, -0.012538997456431389, 0.012173597700893879, 0.005564340390264988, 0.024821573868393898, 0.011468439362943172, -0.030847473070025444, 0.013962135650217533, 0.020462414249777794, -0.011218428611755371, 0.02342407964169979, 0.010077354498207569, -0.01147484965622425, 0.039950426667928696, -0.03546305373311043, 0.014231378212571144, -0.012506945058703423, 0.025706227868795395, 0.035180993378162384, -0.0034104022197425365, 0.0028574939351528883, -0.024360015988349915, -0.027129365131258965, 0.006801573093980551, 0.05251506716012955, 0.03859139233827591, 0.033462971448898315, -0.003567460225895047, 0.013359545730054379, 0.009404248557984829, 0.013782640919089317, 0.024642080068588257, -0.019334159791469574, -0.0008285610820166767, 0.0006226227851584554, 0.010474806651473045, 0.03800162672996521, -0.015398094430565834, -0.014128809794783592, 0.005731014534831047, 0.011974871158599854, -0.013872387818992138, 0.010199153795838356, 0.0018862986471503973, -0.021667594090104103, -0.01203897688537836, -0.010878670029342175, 0.04792512580752373, 0.04723278805613518, -0.009269626811146736, 0.000992830959148705, 0.009115774184465408, 0.0007171781035140157, 0.01096841786056757, 0.00030450019403360784, -0.04861746355891228, -0.017462285235524178, -0.015462200157344341, -0.012090261094272137, -0.0284883975982666, 0.012314628809690475, 0.005670114420354366, 0.009724775329232216, 0.015026283450424671, -0.010513270273804665, -0.02259070985019207, -0.051027823239564896, 0.0007852899725548923, 0.04664301872253418, 0.002033740747720003, 0.01532116811722517, -0.01705201156437397, -0.023347152397036552, 0.007025941740721464, -0.005388050805777311, 0.020744476467370987, -0.025154922157526016, -0.012321040034294128, -0.006420146208256483, 0.019539296627044678, 0.0034392497036606073, -0.010506859980523586, 0.007634941954165697, -0.006090003997087479, 0.029308944940567017, -0.015551947057247162, -0.031796231865882874, 0.04059147834777832, 0.023077910766005516, -0.034591224044561386, 0.0056220353581011295, 0.02441130019724369, -0.010506859980523586, 0.02666780725121498, 0.020539339631795883, -0.03495021164417267, -0.019334159791469574, -0.005535493139177561, -0.004115560557693243, 0.014859610237181187, 0.021359886974096298, 0.00046676676720380783, 0.028231976553797722, 0.01271849311888218, -0.017834095284342766, -0.024257447570562363, 0.02710372395813465, 0.01350057777017355, -0.0338219590485096, 0.03902731090784073, 0.014398051425814629, -0.006961836013942957, -0.0038495236076414585, -0.03028334677219391, -0.014167272485792637, -0.030950041487812996, -0.0022420829627662897, -0.011577418074011803, -0.0007564426050521433, -0.03677080199122429, -0.0016923800576478243, -0.024001026526093483, -0.005606009159237146, -0.00725030992180109, -0.016705842688679695, 0.005641266703605652, 0.013526219874620438, 0.016039147973060608, 0.015000641345977783, 0.0737980306148529, -0.007166973315179348, -0.027308860793709755, -0.004208513535559177, 0.03641181439161301, -0.013180050998926163, 0.026437027379870415, 0.024090774357318878, -0.03202700987458229, -0.026590880006551743, -0.024911321699619293, 0.011551775969564915, -0.0019455960718914866, -0.031232105568051338, 0.02201376110315323, -0.01625710539519787, -0.00030550186056643724, 0.0284883975982666, 0.012051797471940517, -0.015167315490543842, 0.02539852261543274, 0.03187315911054611, -0.012756955809891224, -0.014744220301508904, -0.006577204447239637, -0.005573956295847893, 0.02106500416994095, -0.05754092335700989, 0.009711953811347485, 0.032411642372608185, 0.008115732111036777, -0.0101863332092762, 0.0005529082845896482, -0.007128510158509016, -0.022744562476873398, 0.019295696169137955, -0.010077354498207569, -0.022795846685767174, 0.009186290204524994, 0.012385144829750061, -0.01756485365331173, 0.008237531408667564, -0.019436728209257126, -0.022103508934378624, -0.018744392320513725, 0.03443736955523491, 0.02124449796974659, -0.019231591373682022, -0.016154536977410316, 0.005269456189125776, 0.03848882392048836, -0.011814608238637447, 0.035796403884887695, -0.0163212101906538, -0.04038634151220322, -0.052566349506378174, 0.02277020551264286, 0.04682251438498497, 0.00042469764593988657, 0.036232318729162216, -0.0235394686460495, -0.007513141725212336, -0.017141759395599365, 0.051027823239564896, -0.017064832150936127, -0.012192829512059689, 0.024911321699619293, 0.007769563235342503, -0.026949871331453323, 0.014333946630358696, -0.008000342175364494, 0.007987520657479763, 0.016077611595392227, -0.0005192529642954469, -0.006801573093980551, 0.023372793570160866, 0.015295526012778282, -0.01723150536417961, 0.016128895804286003, 0.03351425379514694, -0.02375742606818676, -0.009269626811146736, 0.005689345765858889, 0.0019680329132825136, -0.029462799429893494, -0.0033430918119847775, 0.009455532766878605, 0.000615811615716666, -0.021988119930028915, 0.002666780725121498, -0.0008285610820166767, -0.008320868946611881, -0.019590580835938454, -0.003644386539235711, 0.025821616873145103, 0.015103209763765335, -0.003118723165243864, 0.01650070585310459, -0.015616052784025669, 0.0031459678430110216, 0.0017228301148861647, -0.012308218516409397, -0.01332108210772276, 0.005891277454793453, -0.014974999241530895, 0.03089875727891922, -0.004109150264412165, -0.01229539792984724, -0.010660712607204914, -0.002463246462866664, -0.006827215198427439, 0.014833968132734299, 0.008128552697598934, -0.009628617204725742, -0.014141630381345749, -0.024244626984000206, 0.01149408146739006, 0.0031876363791525364, -0.016731485724449158, -0.033027052879333496, 0.004413650371134281, -0.004182871431112289, -0.012506945058703423, -0.01600068435072899, 0.0008614150574430823, 0.03756570816040039, 0.018116159364581108, -0.02033420279622078, -0.001594619476236403, -0.017026368528604507, -0.001126650720834732, 0.008538826368749142, 0.016193000599741936, -0.009359374642372131, -0.014000598341226578, -0.009699133224785328, 0.005298303440213203, -0.033206548541784286, -0.02262917347252369, -0.014705757610499859, -0.017577674239873886, 0.01557758916169405, 0.041771017014980316, -0.02251378260552883, 0.013154408894479275, -0.005929740611463785, 0.007647763006389141, -0.00015134862042032182, 0.015859652310609818, 0.027052439749240875, 0.020975256338715553, -0.0012428415939211845, -0.003304628422483802, -0.01873156987130642, 0.003548228647559881, -0.026437027379870415, 0.009070901200175285, -0.036129750311374664, -0.03248856961727142, -0.016949443146586418, -0.005035471636801958, 0.009711953811347485, -0.006122056860476732, 0.008192658424377441, 0.0032196890097111464, 0.015564768575131893, 0.017539212480187416, 0.024001026526093483, 0.028257619589567184, -0.013539040461182594, 0.010506859980523586, -0.021552203223109245, 0.0035225865431129932, 0.023667678236961365, 0.02193683572113514, 0.007391341961920261, 0.011596649885177612, -0.013769819401204586, 0.003311038948595524, -0.00560280354693532, -0.0030978890135884285, -0.013045430183410645, 0.013654430396854877, 0.04243771359324455, 0.0009215137688443065, 0.004070687107741833, -0.019975213333964348, -0.004718150477856398, 0.0015745866112411022, -0.010795333422720432, -0.0022581093944609165, -0.005003419239073992, -0.029898714274168015, 0.014269840903580189, -0.0022004146594554186, 0.013269797898828983, 0.013808283023536205, -0.012712081894278526, 0.02055216021835804, 0.021847087889909744, 0.0008069255272857845, 0.02021881379187107, -0.014295483008027077, -0.0026235096156597137, -0.007910594344139099, 0.010320954024791718, 0.0018638618057593703, 0.0043142870999872684, 0.02612932212650776, 0.020834224298596382, -0.012058207765221596, -0.006718236021697521, 0.022321468219161034, -0.004147613421082497, 0.020859867334365845, 0.01782127469778061, 0.016205821186304092, -0.007788794580847025, 0.03238600119948387, -0.028616609051823616, 0.018064875155687332, -0.007096457295119762, 0.012814650312066078, -0.03610410913825035, 0.0033206548541784286, -0.009667079895734787, 0.014577546156942844, 0.018975170329213142, 0.02106500416994095, -0.01332108210772276, 0.045822471380233765, -0.032924484461545944, -0.004862387664616108, -0.011449207551777363, -0.006416941061615944, -0.023000983521342278, -0.037437498569488525, -0.03046284057199955, 0.028283260762691498, 0.024244626984000206, 0.011628702282905579, 0.0451044924557209, -0.02179580368101597, 0.005416898522526026, -0.01635967381298542, -0.004346339963376522, 0.01264156587421894, 0.03548869863152504, -0.004772639833390713, 0.009814522229135036, 0.04051455482840538, 0.009590153582394123, 0.016205821186304092, -0.023180479183793068, -0.016385316848754883, 0.013071072287857533, -0.010353006422519684, -0.01803923211991787, 0.010705586522817612, 0.019731612876057625, -0.006615667603909969, 0.009378606453537941, -0.021270141005516052, 0.009994016960263252, 0.027129365131258965, 0.01029531192034483, -0.007743921130895615, -0.0018927091732621193, -0.03823240473866463, 0.011551775969564915, 0.01320569310337305, 0.0056989616714417934, 0.004897645208984613, -0.005442540626972914, -0.020385487005114555, 0.017513569444417953, 0.01730843260884285, -0.00251453067176044, 0.013109534978866577, -0.03307833895087242, -0.00846831128001213, 0.007974700070917606, -0.011147912591695786, -0.035437412559986115, -0.02579597570002079, 0.001527308952063322, 0.02674473449587822, -0.009942732751369476, 0.010897901840507984, 0.01350057777017355, 0.02820633538067341, 0.0022484934888780117, 0.016295569017529488, -0.010135049000382423, 0.032334715127944946, -0.0015104812337085605, 0.028360188007354736, 0.02587290108203888, 0.00720543647184968, -0.021962476894259453, -0.008526005782186985, -0.013410829938948154, 0.007596478797495365, -0.009160648100078106, -0.0060611567460000515, 0.026719091460108757, 0.006349630653858185, 0.014333946630358696, -0.06543869525194168, 0.014577546156942844, 0.0023158041294664145, -0.025731869041919708, 0.01566733606159687, -0.013109534978866577, -0.01027608010917902, 0.0567716583609581, 0.006795162335038185, 0.022218899801373482, -0.025372879579663277, 0.024603616446256638, -0.00606756703928113, -0.015987863764166832, -0.013821103610098362, -0.007558015640825033, 0.029488440603017807, -0.005788709037005901, -0.020154708996415138, 0.009141416288912296, 0.029539724811911583, 0.005057908594608307, 0.008295226842164993, 0.012609513476490974, 0.04125817492604256, -0.004375187214463949, 0.031283389776945114, -0.01643660105764866, 0.008519595488905907, 0.023988205939531326, 0.004952135030180216, -0.0062310355715453625, -0.029232019558548927, -0.03366810828447342, -0.029642293229699135, -0.018205907195806503, -0.03610410913825035, 0.042617205530405045, -0.0026523570995777845, -0.03807855024933815, -0.01927005499601364, 0.012526176869869232, 0.014321125112473965, 0.013109534978866577, 0.028539681807160378, -0.012795419432222843, -0.0311551783233881, 0.0004964154795743525, -0.02692422829568386, 0.022141972556710243, -0.01647506281733513, 0.019911108538508415, -0.02339843660593033, -0.013564682565629482, 0.004516218788921833, 0.027821702882647514, -0.052053507417440414, 0.03946322575211525, 0.0010160690871998668, -0.023552289232611656, -0.016013504937291145, 0.01716740056872368, 0.003756570862606168, -0.00469250837340951, 0.022424036636948586, -0.006323988549411297, 0.02597546949982643, -0.014231378212571144, -0.03271934762597084, -0.008820890448987484, 0.010506859980523586, -0.0490533784031868, 0.015410915948450565, -0.010250438004732132, 0.02179580368101597, 0.01548784226179123, 0.003996965941041708, -0.02110346592962742, -0.029283303767442703, 0.009269626811146736, 0.011846660636365414]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-15T11:18:06.869101", "url_path": "/examples/weather-agent/", "chunk_size": 4633}
updated_dt: 2025-03-15T11:18:06.869101
---
```
from__future__import annotations as _annotations
importasyncio
importos
fromdataclassesimport dataclass
fromtypingimport Any
importlogfire
fromdevtoolsimport debug
fromhttpximport AsyncClient
frompydantic_aiimport Agent, ModelRetry, RunContext
# 'if-token-present' means nothing will be sent (and the example will work) if you don't have logfire configured
logfire.configure(send_to_logfire='if-token-present')

@dataclass
classDeps:
  client: AsyncClient
  weather_api_key: str | None
  geo_api_key: str | None

weather_agent = Agent(
  'openai:gpt-4o',
  # 'Be concise, reply with one sentence.' is enough for some models (like openai) to use
  # the below tools appropriately, but others like anthropic and gemini require a bit more direction.
  system_prompt=(
    'Be concise, reply with one sentence.'
    'Use the `get_lat_lng` tool to get the latitude and longitude of the locations, '
    'then use the `get_weather` tool to get the weather.'
  ),
  deps_type=Deps,
  retries=2,
  instrument=True,
)

@weather_agent.tool
async defget_lat_lng(
  ctx: RunContext[Deps], location_description: str
) -> dict[str, float]:
"""Get the latitude and longitude of a location.
  Args:
    ctx: The context.
    location_description: A description of a location.
  """
  if ctx.deps.geo_api_key is None:
    # if no API key is provided, return a dummy response (London)
    return {'lat': 51.1, 'lng': -0.1}
  params = {
    'q': location_description,
    'api_key': ctx.deps.geo_api_key,
  }
  with logfire.span('calling geocode API', params=params) as span:
    r = await ctx.deps.client.get('https://geocode.maps.co/search', params=params)
    r.raise_for_status()
    data = r.json()
    span.set_attribute('response', data)
  if data:
    return {'lat': data[0]['lat'], 'lng': data[0]['lon']}
  else:
    raise ModelRetry('Could not find the location')

@weather_agent.tool
async defget_weather(ctx: RunContext[Deps], lat: float, lng: float) -> dict[str, Any]:
"""Get the weather at a location.
  Args:
    ctx: The context.
    lat: Latitude of the location.
    lng: Longitude of the location.
  """
  if ctx.deps.weather_api_key is None:
    # if no API key is provided, return a dummy response
    return {'temperature': '21 °C', 'description': 'Sunny'}
  params = {
    'apikey': ctx.deps.weather_api_key,
    'location': f'{lat},{lng}',
    'units': 'metric',
  }
  with logfire.span('calling weather API', params=params) as span:
    r = await ctx.deps.client.get(
      'https://api.tomorrow.io/v4/weather/realtime', params=params
    )
    r.raise_for_status()
    data = r.json()
    span.set_attribute('response', data)
  values = data['data']['values']
  # https://docs.tomorrow.io/reference/data-layers-weather-codes
  code_lookup = {
    1000: 'Clear, Sunny',
    1100: 'Mostly Clear',
    1101: 'Partly Cloudy',
    1102: 'Mostly Cloudy',
    1001: 'Cloudy',
    2000: 'Fog',
    2100: 'Light Fog',
    4000: 'Drizzle',
    4001: 'Rain',
    4200: 'Light Rain',
    4201: 'Heavy Rain',
    5000: 'Snow',
    5001: 'Flurries',
    5100: 'Light Snow',
    5101: 'Heavy Snow',
    6000: 'Freezing Drizzle',
    6001: 'Freezing Rain',
    6200: 'Light Freezing Rain',
    6201: 'Heavy Freezing Rain',
    7000: 'Ice Pellets',
    7101: 'Heavy Ice Pellets',
    7102: 'Light Ice Pellets',
    8000: 'Thunderstorm',
  }
  return {
    'temperature': f'{values["temperatureApparent"]:0.0f}°C',
    'description': code_lookup.get(values['weatherCode'], 'Unknown'),
  }

async defmain():
  async with AsyncClient() as client:
    # create a free API key at https://www.tomorrow.io/weather-api/
    weather_api_key = os.getenv('WEATHER_API_KEY')
    # create a free API key at https://geocode.maps.co/
    geo_api_key = os.getenv('GEO_API_KEY')
    deps = Deps(
      client=client, weather_api_key=weather_api_key, geo_api_key=geo_api_key
    )
    result = await weather_agent.run(
      'What is the weather like in London and in Wiltshire?', deps=deps
    )
    debug(result)
    print('Response:', result.data)

if __name__ == '__main__':
  asyncio.run(main())

```

## Running the UI
You can build multi-turn chat applications for your agent with [Gradio](https://www.gradio.app/), a framework for building AI web applications entirely in python. Gradio comes with built-in chat components and agent support so the entire UI will be implemented in a single python file!
Here's what the UI looks like for the weather agent:
Note, to run the UI, you'll need Python 3.10+.
```
pipinstallgradio>=5.9.0
python/uv-run-mpydantic_ai_examples.weather_agent_gradio

```

## UI Code
pydantic_ai_examples/weather_agent_gradio.py