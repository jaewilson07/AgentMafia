---
url: https://ai.pydantic.dev/api/models/bedrock/
session_id: pydantic_ai_docs
chunk_number: 4
title: Bedrock Model Interaction and Inference Configuration
summary: This documentation chunk describes how to interact with the Bedrock model, focusing on streaming responses versus standard responses. It also outlines the process of creating an inference configuration from model settings, such as max tokens, temperature, and top-p values.
embedding: [-0.00930160190910101, 0.005235882475972176, -0.010447883978486061, 0.03145111724734306, 0.0021701748482882977, -0.00771352369338274, 0.0067582884803414345, -0.017791254445910454, 0.009009061381220818, -0.030376477167010307, -0.024692827835679054, -0.03610788658261299, 0.02056143619120121, 0.004746324382722378, 0.014185241423547268, -0.01872260868549347, -0.007629940286278725, 0.02244802564382553, 0.015415106900036335, 0.06624555587768555, 0.06371418386697769, 0.005943353287875652, 0.05272897705435753, 0.01463897805660963, 0.017898717895150185, 0.002532865619286895, -0.031570520251989365, 0.03288396820425987, -0.003256754716858268, -0.026698822155594826, 0.02081218548119068, -0.016071829944849014, 0.0103523600846529, -0.07054411619901657, 0.0030089905485510826, 0.017898717895150185, -0.021827122196555138, 0.019952474161982536, -0.01040609274059534, 0.025003278627991676, -0.010549377650022507, 0.009647874161601067, -0.008573235012590885, 0.0042627365328371525, -0.048669230192899704, 0.03073468990623951, -0.023331617936491966, 0.0619947575032711, -0.0027627190575003624, 0.04587516561150551, 0.00511050783097744, 0.0373019315302372, 0.008507562801241875, -0.015188238583505154, 0.0030298864003270864, -0.017994241788983345, -0.03257351741194725, 0.007140382658690214, 0.014925548806786537, -0.016465865075588226, 0.013337470591068268, -0.03579743579030037, 0.008131438866257668, -0.002631374169141054, -0.03770790621638298, -0.011546404100954533, -0.01109863817691803, 0.028322720900177956, -0.020883828401565552, -0.016430044546723366, 0.008191141299903393, 0.034985486418008804, -0.028322720900177956, -0.009671755135059357, 0.017540505155920982, -0.026340607553720474, -0.025934632867574692, 0.0515826940536499, -0.0035283996257930994, -0.019964413717389107, 0.0028045105282217264, -0.012919554486870766, -0.008059795945882797, -0.025194326415657997, -0.015904664993286133, -0.05072298273444176, -0.03785119205713272, -0.029421241953969002, 0.019474856555461884, -0.009176227264106274, -0.021074874326586723, -0.008220992051064968, -0.04938565567135811, 0.005767231807112694, 0.014089717529714108, -0.0377795472741127, -0.03553474694490433, -0.0025806273333728313, 0.015534510836005211, 0.010734454728662968, 0.0615171417593956, -0.02062113769352436, -0.04609009250998497, 0.009797129780054092, 0.04243632033467293, -0.05440063774585724, 0.036752671003341675, -0.031952615827322006, -0.034842200577259064, 5.830292593600461e-06, -0.06720078736543655, 0.003022423479706049, 0.025122683495283127, 0.02364206872880459, -0.01893753558397293, -0.051964789628982544, -0.05841262638568878, 0.004468709230422974, -0.0037224318366497755, 0.0023552514612674713, -0.0549737811088562, -0.03883030638098717, 0.02552865818142891, -0.0046299053356051445, -0.04563635587692261, -0.024286853149533272, 0.004194078966975212, -0.045516952872276306, -0.06681869924068451, 0.01364792138338089, 0.023415200412273407, 0.010435943491756916, -0.015164357610046864, 0.003546310355886817, -0.037087004631757736, -0.006185147445648909, -0.03226306661963463, 0.007546357344835997, 0.02204205095767975, 0.006710526533424854, -0.01037624105811119, -0.012991197407245636, -0.02729584276676178, -0.03653774410486221, -0.011647897772490978, 0.02911078929901123, -0.06724855303764343, 0.01891365461051464, -0.011958349496126175, -0.013874789699912071, -0.004898564890027046, 0.026173442602157593, -0.019224107265472412, -0.02739136666059494, 0.009044882841408253, -0.019295748323202133, 0.015080774202942848, 0.017624087631702423, 0.052108075469732285, -0.04255572333931923, -0.008435919880867004, -0.014101658016443253, -0.02720031887292862, -0.007474714890122414, -0.022615190595388412, -0.026985391974449158, 0.004465724341571331, -0.03238246962428093, -0.017695730552077293, -0.026460012421011925, -0.04298558086156845, -0.017647968605160713, -0.04647218808531761, 0.0375407412648201, 0.007223965600132942, -0.035224296152591705, -0.07259786874055862, -0.07302772253751755, -0.03297949209809303, -0.013492695987224579, 0.006519479677081108, 0.012286711484193802, -0.038519855588674545, -0.053875260055065155, -0.030304834246635437, 0.016788257285952568, 0.016167353838682175, -0.0030015278607606888, 0.02029874548316002, 0.023164451122283936, -0.035272058099508286, 0.03059140406548977, 0.046734876930713654, 0.016274817287921906, 0.01461509708315134, -0.008579205721616745, 0.06634107977151871, -0.031857091933488846, 0.0027463010046631098, 0.010692662559449673, -0.022985344752669334, 0.0033283974044024944, 0.042173631489276886, 0.019737545400857925, 0.004597068764269352, -0.023391319438815117, -0.00685978215187788, 0.03049588017165661, -0.01208372414112091, -0.016477806493639946, 0.01275238860398531, -0.05325435847043991, -0.0010156836360692978, -0.0013276275712996721, 0.0015373314963653684, -0.021433087065815926, -0.07149934768676758, -0.008083676919341087, -0.029445122927427292, 0.03087797574698925, -0.034842200577259064, 0.04654382914304733, 0.09475932270288467, 0.03620341047644615, -0.03909299522638321, 0.020895767956972122, -0.04315274581313133, -0.05277673900127411, -0.008346366696059704, 0.046830400824546814, 0.03410189226269722, 0.03632281348109245, 0.0025388358626514673, -0.03711088374257088, -0.006014996208250523, -0.03954673185944557, 0.018400216475129128, -0.011773272417485714, 0.04145720228552818, -0.004158257972449064, -0.029922740533947945, -0.012525520287454128, 0.031092902645468712, 0.016274817287921906, -0.0030716778710484505, -0.00506274588406086, -0.01028668787330389, 0.021277861669659615, -0.007552327588200569, 0.02231667935848236, 0.08353531360626221, -0.05693201348185539, -0.014925548806786537, -0.0013753892853856087, -0.033528752624988556, 0.009516529738903046, 0.014173300936818123, 0.014985250309109688, 0.02229280024766922, -0.00856129452586174, 0.029922740533947945, 0.05702753737568855, -0.06977992504835129, 0.014340466819703579, -0.010638930834829807, -0.020000234246253967, 0.015940485522150993, -0.011713570915162563, 0.0016343476017937064, -0.024573422968387604, 0.011910587549209595, 0.017994241788983345, 0.017624087631702423, 0.036561623215675354, -0.0375407412648201, -0.012979256920516491, 0.0041910940781235695, -0.01723005250096321, 0.022949524223804474, 8.796745532890782e-05, -0.004847818054258823, 0.006274700630456209, 0.043893054127693176, 0.0027761519886553288, -0.01565391570329666, -0.013456874527037144, 0.021433087065815926, 0.013910611160099506, -0.019200226292014122, -0.02083606645464897, 0.014328526332974434, 0.022830119356513023, 0.02232862077653408, -0.04121839627623558, 0.02419132925570011, -0.009074733592569828, -0.01533152349293232, 0.004522441420704126, 0.020107699558138847, 0.014889727346599102, 0.014161360450088978, -0.052060313522815704, 0.03785119205713272, -0.011224012821912766, 0.013862849213182926, -0.010973263531923294, 0.03264515846967697, -0.06576793640851974, 0.04062137380242348, -0.006143355742096901, 0.03104514069855213, -0.005232897121459246, -0.05339764431118965, -0.012537460774183273, -0.03990494832396507, -0.022925643250346184, 0.003940344788134098, -0.038281045854091644, 0.031546641141176224, 0.004077659919857979, -0.02552865818142891, -0.0014141957508400083, 0.008501592092216015, -0.022651012986898422, 0.014424050226807594, 0.0449199303984642, 0.008412038907408714, -0.05330212041735649, -0.02939736098051071, 0.019212165847420692, 0.015212119556963444, 0.025098802521824837, 0.008388157933950424, -0.0020597258117049932, 0.004059749189764261, 0.019809188321232796, 0.0006134400609880686, -0.01871066726744175, -0.026388369500637054, 0.0549737811088562, -0.0025179400108754635, -0.026006275787949562, 0.005400063470005989, -0.016477806493639946, -0.03723028674721718, -0.03644222021102905, -0.002650777343660593, 0.02934959903359413, 0.045373667031526566, 0.03054364211857319, 0.008752341382205486, -0.0002320922794751823, 0.01376732625067234, 0.021659955382347107, 0.015415106900036335, -0.005095582455396652, -0.00017117738025262952, 0.028561530634760857, -0.00725978659465909, 0.010961323045194149, -0.014770322479307652, 4.258445551386103e-05, -0.004409007262438536, 0.008149349130690098, -0.0450393371284008, 0.02889586240053177, -0.03629893437027931, 0.016418103128671646, -0.008059795945882797, -0.07020977884531021, -0.03302725404500961, -0.014041956514120102, -0.05506930500268936, -0.009164286777377129, 0.0007399340975098312, -0.0008328456315211952, 0.022567428648471832, 0.016764376312494278, 0.01525988057255745, 0.03434070199728012, 0.05855591222643852, -0.009886682964861393, -0.006226938683539629, -0.0023895802441984415, -0.009677725844085217, 0.026913749054074287, 0.02755853347480297, -0.002352266339585185, -0.02423909120261669, 0.009170257486402988, 0.03773178532719612, -0.05287226289510727, -0.010943411849439144, 0.02217339538037777, 0.010907591320574284, 0.05621558427810669, -0.006250819656997919, -0.0014627038035541773, 0.00017276321887038648, -0.0031463056802749634, 0.02746300958096981, 0.013373291119933128, -0.010232956148684025, 0.008441890589892864, -0.03658550605177879, 0.05067522078752518, 0.021516671404242516, 0.007934421300888062, -0.04785727709531784, 0.005059760995209217, 0.04790503904223442, -0.055785730481147766, 0.013074780814349651, 0.003653774270787835, 0.003155261045321822, -0.05654991790652275, 0.033576514571905136, -0.001534346374683082, -0.020155461505055428, 0.00013078511983621866, -0.0038478064816445112, -0.04052584990859032, -0.002973169321194291, 0.012835972011089325, 0.04618561640381813, 0.01912858337163925, 0.035200413316488266, -0.0377795472741127, 0.03909299522638321, -0.03617953136563301, -0.008232932537794113, -0.018483798950910568, 0.024334615096449852, 0.01740916073322296, 0.012441936880350113, -0.01688378117978573, 0.0017627072520554066, 0.012077754363417625, -0.048788633197546005, 0.026268964633345604, 0.043678123503923416, -0.02236444130539894, -0.03945121169090271, 0.03271680325269699, -0.028418244794011116, -0.03613176941871643, -0.008203081786632538, 0.02741524763405323, 0.016680793836712837, -0.028060032054781914, 0.000994787784293294, -0.021791301667690277, -0.016346460208296776, 0.04126615822315216, -0.03049588017165661, -0.047045327723026276, 0.04052584990859032, 0.06352313607931137, 0.024740589782595634, -0.03297949209809303, 0.059129051864147186, 0.04308110475540161, -0.029492884874343872, -0.0028254063799977303, -0.03223918378353119, -0.01691960170865059, -0.03926016390323639, -0.0018925595795735717, 0.005447825416922569, -0.008620996959507465, -0.0040090023539960384, 0.05444839969277382, -0.0006391865899786353, 0.018483798950910568, 0.012406116351485252, -0.06347537040710449, 0.044561717659235, -0.0018567382358014584, 0.007773225661367178, 0.0794278010725975, 0.015152417123317719, -0.04828713461756706, -0.026460012421011925, 0.004522441420704126, -0.022854000329971313, 0.08683086931705475, -0.02195846661925316, -0.024883873760700226, 0.007564268074929714, 0.040119875222444534, -0.045230381190776825, 0.0024448048789054155, -0.026865987107157707, -0.012370294891297817, 0.017719611525535583, -0.00688366312533617, 0.01682407781481743, -0.017755432054400444, 0.00842397939413786, -0.05005431920289993, -0.03216754272580147, -0.01853156089782715, -0.022854000329971313, 0.014316585846245289, 0.028752576559782028, 0.0271286778151989, -0.01857932284474373, 0.023080868646502495, -0.05468720942735672, 0.02923019416630268, -0.04126615822315216, -0.03701535984873772, 0.01721811294555664, 0.05483049526810646, 0.014209122397005558, 0.030113786458969116, 0.009450857527554035, -0.004546321928501129, -0.004585128743201494, 0.0002576522820163518, -0.02222115732729435, -0.034913841634988785, 0.0188300721347332, 0.013349411077797413, 0.013707623817026615, -0.0015246447874233127, -0.019952474161982536, 0.012513579800724983, -0.006949335336685181, -0.008716519922018051, 0.023283855989575386, -0.018268872052431107, 0.02411968633532524, -0.014447931200265884, -0.011624016799032688, -0.038710903376340866, -0.031952615827322006, -0.017862897366285324, 0.047045327723026276, 0.03429294005036354, -0.012919554486870766, 0.002597045386210084, 0.003623923286795616, -0.006044846959412098, -0.007200084626674652, -0.003089588601142168, -0.012053873389959335, 0.031785447150468826, 0.004746324382722378, 0.0005160508444532752, 0.020059937611222267, -0.027677936479449272, 0.014603156596422195, -0.03197649493813515, 0.029874978587031364, 0.007480685133486986, -0.018352454528212547, -0.022997284308075905, 0.010656842030584812, 0.006620973348617554, 0.01033444982022047, -0.00948070827871561, 0.0035313847474753857, 0.04604233056306839, -0.043367672711610794, 0.04943341761827469, 0.028752576559782028, -0.0016597210196778178, -0.010626990348100662, 0.011218042112886906, 0.008465771563351154, -0.008788162842392921, -0.0129553759470582, -0.004128406755626202, 0.009080703370273113, 0.005107522942125797, 0.026985391974449158, 0.002695554168894887, -0.004453783854842186, 0.01693154312670231, -0.01107475720345974, -0.029779454693198204, 0.0341496542096138, -0.009910563938319683, -0.057218581438064575, -0.014603156596422195, -0.015570332296192646, -0.020179342478513718, 0.011421029455959797, -0.0127762695774436, 0.02588687092065811, -0.0024448048789054155, 0.004856773652136326, 0.024859992787241936, -0.048908036202192307, -0.016047948971390724, 0.003758253064006567, -0.0042627365328371525, -0.04501545429229736, 0.008620996959507465, 0.060657430440187454, -0.008925477974116802, 0.014579275622963905, 0.03266904130578041, -0.02891974337399006, -0.01723005250096321, 0.005788127891719341, -0.03271680325269699, -0.038663141429424286, 0.01903305947780609, 0.024692827835679054, -0.011241923086345196, -0.010280718095600605, -0.006740377750247717, 0.017671849578619003, -0.012597163207828999, -0.01268074568361044, -0.021624134853482246, 0.07369638979434967, -0.008573235012590885, 0.006692615803331137, 0.04501545429229736, 0.024788351729512215, -0.017743492498993874, -0.0028940639458596706, 0.017922598868608475, -0.003579146461561322, 0.009982206858694553, 0.00937324482947588, -0.005877681076526642, 0.01115833967924118, 0.0037612381856888533, 0.04286617413163185, 0.02053755521774292, -0.012250890024006367, 0.03548698499798775, 0.031474996358156204, -0.012621044181287289, 0.004056764300912619, -0.026197323575615883, 0.0061493259854614735, 0.02053755521774292, 0.023140570148825645, -0.011737450957298279, 0.003997061867266893, -0.011349387466907501, 0.0007235159864649177, 0.04573187977075577, 0.0013194185448810458, -0.005525438115000725, 0.019773365929722786, -0.021862942725419998, 0.020979350432753563, 0.036728788167238235, 0.008274723775684834, -0.01898529753088951, 0.005319465417414904, 0.01369568333029747, -0.004017957486212254, -0.012334473431110382, -0.05258569121360779, 0.05081850662827492, 0.0005578423733823001, 0.05072298273444176, -0.010752364993095398, 0.018149467185139656, 0.003000035183504224, 0.021946527063846588, 0.01873454824090004, 0.053923022001981735, 0.05282450094819069, 0.0439646951854229, 0.03094961680471897, 0.0153792854398489, -0.01104490552097559, -0.03233470767736435, 0.015104655176401138, -0.01702706515789032, -0.010053849779069424, -0.007498595397919416, 0.0291824322193861, -0.03219142183661461, -0.048740871250629425, -0.0033164569176733494, 0.06920678168535233, -0.014865846373140812, 0.034842200577259064, 0.0020313672721385956, 0.010728484019637108, 0.006394105032086372, 0.006817990448325872, -0.04618561640381813, -0.017767373472452164, -0.0259107518941164, 0.05487825721502304, -0.009038912132382393, 0.008997120894491673, 0.034794438630342484, -0.007498595397919416, 0.013576279394328594, -0.028322720900177956, -0.006274700630456209, -0.030233191326260567, -0.012979256920516491, -0.00934339314699173, -0.051869265735149384, -0.006549330893903971, -0.007134412415325642, 0.011343416757881641, 0.01869872771203518, -0.03281232714653015, -0.010274747386574745, 0.004400051664561033, 0.029851097613573074, 0.0015731528401374817, 0.0052120015025138855, 0.0071702334098517895, 0.036943718791007996, 0.024286853149533272, 0.010901620611548424, 0.02911078929901123, 0.013361350633203983, -0.03751685842871666, 0.02741524763405323, -0.009779219515621662, -0.031833209097385406, 0.009098614566028118, 0.017803194001317024, 0.0347466766834259, 0.0008194126421585679, -0.048836395144462585, -0.005549319088459015, -0.018340514972805977, -0.01454345416277647, 0.0030448120087385178, -0.002213458763435483, -0.0169554241001606, 0.006131415255367756, -0.019522616639733315, -0.0008171738008968532, -0.009743398055434227, 0.007797106634825468, 0.009361304342746735, -0.052490171045064926, -0.013218065723776817, 0.017815135419368744, -0.013707623817026615, 0.0064776879735291, -0.03980942443013191, 0.035128772258758545, -0.04943341761827469, 0.006465747486799955, -0.0028179434593766928, -0.016525566577911377, 0.01723005250096321, 0.015391225926578045, -0.005014984402805567, 0.0032776505686342716, -0.04582740366458893, 0.010006087832152843, 0.01902111992239952, 0.042101986706256866, -0.028728695586323738, -0.009044882841408253, -0.01451957318931818, -0.003367203753441572, -0.0207644235342741, -0.01677631586790085, 0.03543922305107117, -0.023271914571523666, -0.021361446008086205, 0.01197028998285532, 0.033409349620342255, 0.0173136368393898, 0.07226353883743286, -0.03897359222173691, -0.002438834635540843, -0.020800244063138962, 0.028704814612865448, -0.012358354404568672, -0.03295561298727989, 0.028394363820552826, -0.021015172824263573, -0.004910505376756191, -0.005253793206065893, -0.004367215558886528, -0.055737968534231186, -0.008149349130690098, 0.002991079818457365, 0.0017612146912142634, -0.024788351729512215, 0.012537460774183273, 0.02891974337399006, -0.005373197607696056, -0.0005541109712794423, 0.0012432981748133898, 0.04066913574934006, -0.07407848536968231, 0.01897335797548294, 0.016406163573265076, 0.009850862435996532, -0.0016910646809265018, 0.011701630428433418, -0.0011776257306337357, 0.008059795945882797, -0.010674752295017242, -0.038448214530944824, -0.0007347101345658302, 0.009307571686804295, -0.006626943591982126, -0.01031653955578804, 0.03878254443407059, 0.031546641141176224, -0.010477734729647636, 0.015522570349276066, -0.006561271380633116, -0.016298698261380196, -0.008913537487387657, 0.036681029945611954, -0.0077911363914608955, 0.020871886983513832, -0.03892583027482033, -0.006919484119862318, 0.00025877170264720917, 0.0015052416129037738, 0.021576372906565666, -0.029779454693198204, -0.0023059973027557135, 0.0019880831241607666, -0.00868069939315319, -0.015916604548692703, -0.04274677112698555, 0.03926016390323639, 0.016036009415984154, 0.004346319939941168, -0.001496286247856915, -0.03395860642194748, 0.00785083882510662, -0.0013179259840399027, -0.005474691279232502, -0.01115833967924118, -0.009194137528538704, -0.012429996393620968, -0.03701535984873772, -0.02025098353624344, -0.010609080083668232, 0.006692615803331137, -0.009062793105840683, -0.007200084626674652, -0.02229280024766922, 0.01737333834171295, 0.04231691360473633, 0.04458560049533844, -0.048764754086732864, -0.026913749054074287, -0.007104561198502779, 0.039952706545591354, 0.0002583985624369234, 0.00470453267917037, 0.04496769234538078, 0.00939115509390831, 0.006238879170268774, -0.02391669899225235, -0.005164240021258593, -0.018376335501670837, -0.010901620611548424, 0.026173442602157593, -0.013755385763943195, -0.005597080569714308, 0.008059795945882797, 0.011564315296709538, -0.006591122131794691, 0.01680019684135914, -0.003653774270787835, 0.03582131490111351, -0.0035910869482904673, 0.009850862435996532, 0.03429294005036354, 0.007229935843497515, -0.010400122031569481, 0.028561530634760857, -0.011516553349792957, -0.0015910634538158774, 0.008895627222955227, 0.0009432946681044996, -0.024812232702970505, 0.0035552657209336758, 0.027057034894824028, 0.021050993353128433, -0.023104749619960785, -0.030185429379343987, -0.03457951173186302, -0.0023686846252530813, -0.019928593188524246, 0.009737428277730942, 0.030400358140468597, -0.050340890884399414, 0.011450881138443947, 0.0010649379109963775, -0.0439646951854229, -0.009385185316205025, -0.0006462762248702347, -0.0068418714217841625, 0.0035940720699727535, -0.004438858013600111, 0.033337704837322235, 0.024692827835679054, 0.0014455394120886922, 0.003931389655917883, 0.02734360471367836, 0.02376147359609604, -0.013122542761266232, -0.016489746049046516, 0.054209593683481216, 0.021003231406211853, -0.01862708479166031, -0.003916463814675808, -0.01890171505510807, 0.036872074007987976, -0.027701817452907562, 0.009104584343731403, 0.017683789134025574, 0.045373667031526566, -0.00428064726293087, 0.008173230104148388, -0.03078245185315609, -0.015856903046369553, -0.01899723894894123, 0.019224107265472412, -0.02540925331413746, 0.02939736098051071, -0.026006275787949562, 0.0015186745440587401, 0.015164357610046864, -0.0016149443108588457, -0.052012551575899124, -0.025934632867574692, -0.036919835954904556, -0.015797199681401253, 0.041982583701610565, 0.009313542395830154, -0.05277673900127411, -0.016250938177108765, 0.019665902480483055, 0.03214365988969803, 0.013027018867433071, -0.0442035049200058, 0.007546357344835997, -0.0011985215824097395, -0.012221039272844791, 0.005412003956735134, -0.0240361038595438, 0.031212307512760162, -0.021086815744638443, -0.029731692746281624, -0.005573200061917305, 0.026292845606803894, -0.05994100123643875, 0.0034657123032957315, -0.05014984309673309, 0.001180610852316022, -0.016549447551369667, -0.016441984102129936, -0.009361304342746735, -0.011552374809980392, -0.008364276960492134, 0.06438284367322922, -0.0018925595795735717, 0.02760629542171955, 0.0271286778151989, -0.021636074408888817, 0.0013567323330789804, 0.03240635246038437, 0.04816773161292076, 0.01540316641330719, 0.008937418460845947, 0.017767373472452164, 0.006746347993612289, 0.01675243489444256, 0.013827027752995491, -0.011415059678256512, 0.014877786859869957, -0.04487216845154762, -0.014316585846245289, -0.00255525391548872, -0.0033910847268998623, 0.031546641141176224, 0.026579417288303375, 0.016095710918307304, 0.001864201040007174, 0.04766623303294182, 0.0023268929217010736, -0.007761285174638033, 0.02538537234067917, 0.06261566281318665, -0.009707576595246792, 0.02386893704533577, 0.006871722638607025, 0.018101705238223076, -0.0009701606468297541, -0.019642021507024765, -0.011606106534600258, 0.05005431920289993, -0.020895767956972122, -0.01116431038826704, -0.01892559602856636, 0.0405736118555069, -0.029946621507406235, 0.028346601873636246, 0.017600206658244133, 0.01542704738676548, -0.031737685203552246, 0.00840009842067957, 0.010907591320574284, -0.04986327141523361, 0.01894947700202465, -0.013349411077797413, 0.0023925653658807278, -0.002098532160744071, 0.023307736963033676, 0.015295702032744884, -0.023200273513793945, 0.015606153756380081, 0.010447883978486061, 0.019474856555461884, 0.026245085522532463, 0.004397066775709391, 0.004758264869451523, 0.0044478136114776134, -0.03145111724734306, 0.05306331068277359, 0.04589904844760895, -0.012919554486870766, 0.02588687092065811, -0.020967410877346992, -0.004594083875417709, 0.01287179347127676, 0.01861514337360859, 0.021433087065815926, -0.010632961057126522, -0.050340890884399414, 0.009200108237564564, -0.029421241953969002, 0.006626943591982126, 0.02220921590924263, -0.005573200061917305, -0.0015955411363393068, 0.018412156030535698, 0.05091403052210808, 0.01194640900939703, -0.018018122762441635, 0.018340514972805977, -0.022674893960356712, -0.023439081385731697, 0.04948117956519127, 0.02415550872683525, 0.04054972901940346, 0.03383920341730118, 0.0019507692195475101, 0.002853764919564128, 0.017433039844036102, -0.02571970596909523, -0.022603251039981842, 0.017504682764410973, 0.015665855258703232, 0.04320050776004791, 0.021397266536951065, -0.04090794175863266, -0.00024142074107658118, -0.015558391809463501, 0.010400122031569481, 0.019713664427399635, -0.03744521737098694, -0.04554083198308945, 0.0016567358979955316, -0.008364276960492134, 0.016071829944849014, -0.03386308625340462, -0.025982394814491272, 0.004071689676493406, -0.009982206858694553, 0.019880831241607666, 0.012644925154745579, 0.009868772700428963, -0.06323656439781189, 0.01896141655743122, -0.008346366696059704, -0.010806096717715263, -0.029469003900885582, 0.03364815562963486, -0.02903914637863636, 0.014794203452765942, -0.01287179347127676, 0.004394081421196461, 0.01886589266359806, 0.018125586211681366, -0.004937371239066124, -0.02760629542171955, -0.007468744646757841, -0.014925548806786537, 0.0038806425873190165, 0.004340349696576595, -0.01714647002518177, -0.019164403900504112, -0.03383920341730118, -0.006949335336685181, -0.023618187755346298, 0.013289708644151688, 0.012644925154745579, 0.040024351328611374, 0.004791100975126028, 0.027057034894824028, 0.007546357344835997, 0.021074874326586723, -0.024668946862220764, -0.016250938177108765, -0.00690754409879446, -0.021767420694231987, 0.03627505153417587, 0.023594306781888008, 0.00851353257894516, 0.01374344527721405, -0.006143355742096901, 0.010035938583314419, 0.011910587549209595, 0.043415434658527374, 0.002768689300864935, 0.019618140533566475, 0.0036030274350196123, 0.012197158299386501, -0.008143379352986813, -0.06094399839639664, -0.0018089765217155218, -0.06185147166252136, -0.01702706515789032, -0.012573282234370708, -0.03083021380007267, 0.019319629296660423, -0.001959724584594369, -0.036919835954904556, 0.0051314034499228, -0.012370294891297817, -0.02371371164917946, 0.009791160002350807, 0.0016806167550384998, -0.0013791206292808056, -0.013803147710859776, 0.06108728423714638, -0.0011343416990712285, -0.013755385763943195, 0.036657147109508514, -0.02063307911157608, 0.010895650833845139, -0.005450810305774212, 0.02072860114276409, 0.005441855173557997, -0.009970266371965408, 0.022651012986898422, 0.038472093641757965, 0.01282403152436018, -0.043749768286943436, 0.00555827422067523, 0.0019880831241607666, 0.014758381992578506, 0.009140405803918839, 0.043725885450839996, 0.01690766215324402, 0.008370247669517994, -0.0030179459135979414, 0.019486796110868454, -0.03209589794278145, -0.024883873760700226, -0.004376170691102743, -0.01461509708315134, -0.04054972901940346, 0.04635278508067131, 0.02741524763405323, -0.03945121169090271, -0.019928593188524246, -0.03259739652276039, -0.00860308576375246, -0.020000234246253967, 0.04601845145225525, 0.021373385563492775, -0.043749768286943436, 0.026006275787949562, -0.05287226289510727, 0.017659908160567284, 0.025051040574908257, -0.041910938918590546, -0.00931951217353344, -0.021683836355805397, 0.035200413316488266, 0.014889727346599102, -0.03094961680471897, 0.0004380648606456816, -0.005707529839128256, 0.012621044181287289, -0.02377341315150261, 0.03937956690788269, -0.005217971745878458, 0.003835865994915366, -0.02746300958096981, -0.003910493571311235, 0.055499158799648285, -0.018113646656274796, 0.0305197611451149, 0.0017403189558535814, 0.03577355295419693, 0.04054972901940346, -0.005107522942125797, -0.013218065723776817, -7.392810948658735e-05, 0.0024552526883780956, -0.02195846661925316, -0.023570425808429718, 0.052442409098148346, -0.03214365988969803, -0.007026948034763336, 0.01540316641330719, -0.002682121004909277, -0.009976237080991268, -0.028131673112511635, 0.024251030758023262, -0.034937724471092224, 0.026555536314845085, 0.00683590117841959, -0.0222808588296175, -0.03570191189646721, -0.008238903246819973, 0.006358283571898937, -0.018197229132056236, 0.016656912863254547, 0.021588314324617386, -0.03615564852952957, -0.0012276263441890478, 0.013206125237047672, 0.0615171417593956, 0.0008671743562445045, -0.028298839926719666, 0.019677843898534775, 0.015271821059286594, 0.023427141830325127, 0.021576372906565666, -0.0221017524600029, 0.04589904844760895, 0.02419132925570011, -0.010328480042517185, 0.012788210064172745, -0.021719658747315407, 0.04494381323456764, -0.04929013177752495, 0.014065836556255817, -0.015976307913661003, 0.004376170691102743, 0.020967410877346992, 0.03290785104036331, -0.0059194727800786495, -0.007080680225044489, 0.036609385162591934, 0.01525988057255745, 0.017767373472452164, 0.014447931200265884, -0.005653797648847103, 0.030257072299718857, 0.010256837122142315, -0.05000655725598335, 0.018185287714004517, 0.015116595663130283, 0.0027239127084612846, 0.02588687092065811, 0.0002763092052191496, 0.019236046820878983, 0.004644830711185932, -0.002822421258315444, -0.004122436512261629, 0.005874695722013712, -0.00634037284180522, 0.03226306661963463, 0.00854338426142931, -0.014376288279891014, -0.026722701266407967, 0.004567218013107777, -0.02195846661925316, -0.012394175864756107, -0.03579743579030037, 0.031212307512760162, -0.019725605845451355, 0.036752671003341675, 0.004797071218490601, 0.015295702032744884, 0.0010462809586897492, 0.026531655341386795, 0.019892770797014236, -0.012573282234370708, -0.008716519922018051, 0.0032298886217176914, 0.0015313612530007958, 0.031713806092739105, -0.028752576559782028, -0.02029874548316002, 0.007528446614742279, -0.0066747055388987064, -0.016227057203650475, -0.014603156596422195, -0.04059749096632004, 0.02751077152788639, 0.006567241158336401, 0.008286664262413979, 0.00472841365262866, -0.00948070827871561, 0.026770463213324547, 0.012418056838214397, 0.022531608119606972, -0.002407490974292159, 0.03383920341730118, -0.0342690609395504, -0.04599456861615181, 0.01107475720345974, -0.01203596219420433, -0.009003090672194958, -0.03574967384338379, -0.043510958552360535, -0.013098661787807941, 0.009928475134074688, 0.026173442602157593, -0.017600206658244133, 0.018197229132056236, 0.011785212904214859, 0.028203316032886505, 0.01114042941480875, 0.01535540446639061, 0.01109266746789217, 0.014710620976984501, 0.010143402963876724, 0.002632866846397519, -0.04601845145225525, -0.014794203452765942, 0.008161289617419243, -0.0008559802081435919, -0.0008820999064482749, 0.012429996393620968, 0.0036806403659284115, -0.005841859616339207, 0.027080915868282318, 0.014065836556255817, 0.029803335666656494, -0.005149314180016518, -0.00842995010316372, 0.006967246066778898, -0.008131438866257668, -0.017444981262087822, -0.014256884343922138, -0.013170303776860237, -0.0001873156288638711, -0.023009225726127625, -0.017433039844036102, -0.028704814612865448, -0.00856129452586174, 0.028561530634760857, -0.02579134702682495, -0.002244802424684167, 0.018424097448587418, 0.011295654810965061, -0.019498737528920174, 0.013588218949735165, -0.0288242194801569, 0.010644901543855667, 0.01740916073322296, -0.007003067526966333, -0.050293128937482834, -0.011719540692865849, 0.013516576960682869, 0.012585222721099854, -0.0335526317358017, 0.010489675216376781, -0.00021007709437981248, 0.0347466766834259, 0.0006167982937768102, 0.009647874161601067, 0.00022145782713778317, -0.010101611725986004, 0.0075105358846485615, -0.018292753025889397, 0.0027298827189952135, 0.02567194402217865, 0.007498595397919416, -0.029516763985157013, 0.006519479677081108, -0.008388157933950424, -0.0035552657209336758, -0.007223965600132942, 0.006853811908513308, -0.0012798657407984138, -0.014424050226807594, 0.023367438465356827, 0.004743339493870735, 0.017850955948233604, 0.021516671404242516, -0.015224059112370014, -0.027940627187490463, 0.0011656853603199124, -0.015916604548692703, 0.0039224340580403805, -0.03364815562963486, -0.0013768818462267518, 0.016215115785598755, 0.022615190595388412, 0.012943435460329056, 0.03090185485780239, 0.007432923186570406, -0.028227197006344795, -0.014698680490255356, -0.009934444911777973, -0.008023974485695362, -0.017624087631702423, -0.011265804059803486, -0.0103523600846529, 0.024883873760700226, -0.02576746791601181, -0.021445028483867645, 0.015737498179078102, 0.02889586240053177, 0.018304692581295967, -0.019224107265472412, -0.014901667833328247, -0.019546497613191605, 0.021588314324617386, -0.011827005073428154, 0.01199417095631361, 0.0035104891285300255, -0.015224059112370014, 0.019665902480483055, -0.0029089893214404583, -0.0011224012123420835, -0.03049588017165661, -0.017588267102837563, 0.029851097613573074, -0.02913467027246952, 0.01033444982022047, -0.017492743209004402, 0.00560603616759181, 0.00430452823638916, -0.016441984102129936, -0.045206502079963684, 0.002671673195436597, 0.029492884874343872, 0.013934492133557796, -0.012501639313995838, 0.024788351729512215, -0.0002802271628752351, 0.004620949737727642, 0.047093089669942856, 0.017659908160567284, 0.0023597292602062225, -0.043487079441547394, 0.013827027752995491, 0.005856785457581282, -0.02218533493578434, 0.0017821105429902673, -0.019439034163951874, 0.020059937611222267, 0.011767302639782429, -0.0005399317014962435, 0.001650765654630959, 0.020024115219712257, -0.013707623817026615, 0.026961511000990868, 0.025170445442199707, 0.026531655341386795, -0.01701512560248375, 0.038758665323257446, -0.021504729986190796, 0.014997190795838833, -0.010077730752527714, 0.03238246962428093, -0.014877786859869957, 0.004307513125240803, 0.03906911611557007, -0.03658550605177879, -0.0051254332065582275, -0.022973405197262764, -0.028251077979803085, -0.013218065723776817, 0.01466285903006792, 0.013349411077797413, -0.01533152349293232, -0.012453877367079258, -0.001958231907337904, -0.02576746791601181, -0.023176392540335655, 0.016238996759057045, 0.01280015055090189, -0.025074921548366547, 0.030018262565135956, 0.012835972011089325, -0.027940627187490463, 0.021433087065815926, 0.014006135053932667, -0.011200131848454475, -0.028203316032886505, 0.012238949537277222, -0.008155319839715958, -0.022639071568846703, -0.0028597351629287004, -0.005874695722013712, 0.02059725672006607, -0.010746395215392113, 0.00423587067052722, -0.015773320570588112, 0.028298839926719666, -0.005988129880279303, 0.01717035099864006, 0.012167307548224926, -0.009074733592569828, 0.019677843898534775, 0.0008649355149827898, 0.001704497612081468, 0.03739745542407036, 0.048549823462963104, -0.03235859051346779, 0.027725698426365852, -0.02401222288608551, 0.01687183976173401, 0.0010343404719606042, 0.01118222065269947, -0.02404804341495037, 0.05822157859802246, -0.009021001867949963, -0.0018925595795735717, 0.01196431927382946, 0.0009306079591624439, 0.01881813071668148, 0.021456968039274216, -0.019140522927045822, 0.00773143395781517]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-15T11:17:30.655115", "url_path": "/api/models/bedrock/", "chunk_size": 5000}
updated_dt: 2025-03-15T11:17:30.656621
---
onfig': {'tools': tools, **({'toolChoice': tool_choice} if tool_choice else {})}}
        if tools
        else {}
      ),
    }
    if stream:
      model_response = await anyio.to_thread.run_sync(functools.partial(self.client.converse_stream, **params))
      model_response = model_response['stream']
    else:
      model_response = await anyio.to_thread.run_sync(functools.partial(self.client.converse, **params))
    return model_response
  @staticmethod
  def_map_inference_config(
    model_settings: ModelSettings | None,
  ) -> InferenceConfigurationTypeDef:
    model_settings = model_settings or {}
    inference_config: InferenceConfigurationTypeDef = {}
    if max_tokens := model_settings.get('max_tokens'):
      inference_config['maxTokens'] = max_tokens
    if temperature := model_settings.get('temperature'):
      inference_config['temperature'] = temperature
    if top_p := model_settings.get('top_p'):
      inference_config['topP'] = top_p
    # TODO(Marcelo): This is not included in model_settings yet.
    # if stop_sequences := model_settings.get('stop_sequences'):
    #   inference_config['stopSequences'] = stop_sequences
    return inference_config
  async def_map_message(self, messages: list[ModelMessage]) -> tuple[str, list[MessageUnionTypeDef]]:
"""Just maps a `pydantic_ai.Message` to the Bedrock `MessageUnionTypeDef`."""
    system_prompt: str = ''
    bedrock_messages: list[MessageUnionTypeDef] = []
    for m in messages:
      if isinstance(m, ModelRequest):
        for part in m.parts:
          if isinstance(part, SystemPromptPart):
            system_prompt += part.content
          elif isinstance(part, UserPromptPart):
            bedrock_messages.extend(await self._map_user_prompt(part))
          elif isinstance(part, ToolReturnPart):
            assert part.tool_call_id is not None
            bedrock_messages.append(
              {
                'role': 'user',
                'content': [
                  {
                    'toolResult': {
                      'toolUseId': part.tool_call_id,
                      'content': [{'text': part.model_response_str()}],
                      'status': 'success',
                    }
                  }
                ],
              }
            )
          elif isinstance(part, RetryPromptPart):
            # TODO(Marcelo): We need to add a test here.
            if part.tool_name is None: # pragma: no cover
              bedrock_messages.append({'role': 'user', 'content': [{'text': part.model_response()}]})
            else:
              assert part.tool_call_id is not None
              bedrock_messages.append(
                {
                  'role': 'user',
                  'content': [
                    {
                      'toolResult': {
                        'toolUseId': part.tool_call_id,
                        'content': [{'text': part.model_response()}],
                        'status': 'error',
                      }
                    }
                  ],
                }
              )
      elif isinstance(m, ModelResponse):
        content: list[ContentBlockOutputTypeDef] = []
        for item in m.parts:
          if isinstance(item, TextPart):
            content.append({'text': item.content})
          else:
            assert isinstance(item, ToolCallPart)
            content.append(self._map_tool_call(item)) # FIXME: MISSING key
        bedrock_messages.append({'role': 'assistant', 'content': content})
      else:
        assert_never(m)
    return system_prompt, bedrock_messages
  @staticmethod
  async def_map_user_prompt(part: UserPromptPart) -> list[MessageUnionTypeDef]:
    content: list[ContentBlockUnionTypeDef] = []
    if isinstance(part.content, str):
      content.append({'text': part.content})
    else:
      document_count = 0
      for item in part.content:
        if isinstance(item, str):
          content.append({'text': item})
        elif isinstance(item, BinaryContent):
          format = item.format
          if item.is_document:
            document_count += 1
            name = f'Document {document_count}'
            assert format in ('pdf', 'txt', 'csv', 'doc', 'docx', 'xls', 'xlsx', 'html', 'md')
            content.append({'document': {'name': name, 'format': format, 'source': {'bytes': item.data}}})
          elif item.is_image:
            assert format in ('jpeg', 'png', 'gif', 'webp')
            content.append({'image': {'format': format, 'source': {'bytes': item.data}}})
          else:
            raise NotImplementedError('Binary content is not supported yet.')
        elif isinstance(item, (ImageUrl, DocumentUrl)):
          response = await cached_async_http_client().get(item.url)
          response.raise_for_status()
          if item.kind == 'image-url':
            format = item.media_type.split('/')[1]
            assert format in ('jpeg', 'png', 'gif', 'webp'), f'Unsupported image format: {format}'
            image: ImageBlockTypeDef = {'fo