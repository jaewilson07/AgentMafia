---
url: https://ai.pydantic.dev/examples/rag/
session_id: pydantic_ai_docs
chunk_number: 1
title: RAG Search Example
summary: This document describes a demonstration of RAG (Retrieval-Augmented Generation) search using the Logfire documentation. It outlines how to create a searchable database from markdown documentation sections and register the search tool with the PydanticAI agent. The database is based on PostgreSQL with pgvector, and includes a Docker command for setup.
embedding: [-0.01147129014134407, 0.01636509597301483, 0.017452608793973923, -0.022143324837088585, -0.013115661218762398, -0.03259916603565216, -0.02395147830247879, 0.0016607493162155151, -0.0034295949153602123, 0.017950505018234253, 0.035953421145677567, -0.027253322303295135, 0.00919144507497549, -0.03768296167254448, 0.001501880818977952, -0.009027663618326187, -0.025052092969417572, 0.014373507350683212, -0.006944356486201286, 0.03548172861337662, 0.04174475371837616, -0.03527208790183067, 0.003734229365363717, 0.02292947843670845, -0.05225300416350365, -0.017164353281259537, 0.024043194949626923, 0.06420253962278366, -0.00892284233123064, -0.01350873801857233, 0.02543206699192524, -0.02596927247941494, 0.00837253499776125, 0.00699021527543664, 0.02602168172597885, 0.008601830340921879, -0.002142268465831876, -0.012165726162493229, -0.007789471186697483, 0.02134406939148903, 0.01682368665933609, -0.020505504682660103, 0.00174755381885916, 0.0017164351884275675, 0.026283733546733856, -0.008162894286215305, -0.022064710035920143, 0.002966091735288501, 0.03708024322986603, -0.014255584217607975, -0.021986093372106552, -0.0026843866799026728, -0.014504533261060715, 0.0056013441644608974, 0.0029120438266545534, 0.018579429015517235, -0.06551279872655869, 0.02488175965845585, 0.052672285586595535, 0.002106236293911934, -0.029664194211363792, -0.04475834220647812, -0.002582842018455267, 0.021095119416713715, -0.013875610195100307, 0.01724296808242798, -0.06252541393041611, 0.03603203594684601, -0.05838500335812569, -0.0012185380328446627, 0.04533485323190689, -0.04331706091761589, -0.04119444638490677, -0.03985798358917236, 0.0003543832863215357, -0.011065111495554447, 0.018972504884004593, 0.06666582077741623, -0.032284706830978394, -0.053248800337314606, 0.03008347563445568, -0.021173736080527306, -0.032363321632146835, -0.028615988790988922, -0.01122889295220375, -0.00963693205267191, -0.03823326900601387, -0.004965869709849358, -0.018002916127443314, -0.008470804430544376, -0.04635685309767723, 0.03223229572176933, -0.01988968439400196, 0.028589783236384392, 0.0675043836236, 0.02347978577017784, 0.0003220363287255168, -0.03055516816675663, 0.040513113141059875, 0.03715885803103447, 0.03212747350335121, -0.04022485762834549, 0.018998710438609123, -0.018644941970705986, 0.03346393629908562, 0.022300556302070618, 0.008018766529858112, 0.007809125352650881, -0.0025861174799501896, -0.013613559305667877, -0.08249371498823166, -0.026205118745565414, 0.01785878837108612, 0.01637819968163967, -0.025078298524022102, 0.002618873957544565, -0.031865425407886505, -0.036451321095228195, 0.023099811747670174, -0.018133942037820816, -0.0731646865606308, -0.01552653219550848, 0.005788055248558521, -0.02087237685918808, 0.01637819968163967, -0.0019440922187641263, 0.002890752162784338, -0.03810224309563637, -0.038364291191101074, 0.03419768065214157, 0.028878040611743927, 0.03223229572176933, 0.03870495781302452, -0.026729220524430275, -0.025091400370001793, -0.013312200084328651, -0.04942285269498825, -0.027882246300578117, -0.021697837859392166, 0.046540290117263794, -0.005611171014606953, -0.010351021774113178, -0.03354255110025406, 0.023008093237876892, -0.07552315294742584, 0.0014257222646847367, -0.022536400705575943, -0.026165811344981194, -0.009473150596022606, -0.010619624517858028, -0.006728163920342922, 0.0022438131272792816, -0.024134913459420204, -0.004386081825941801, -0.015369301661849022, -0.00892284233123064, 0.010278957895934582, 0.03157716616988182, -0.007723958697170019, -0.03527208790183067, -0.023689426481723785, 0.04622582718729973, 0.01120923925191164, -0.006708510220050812, -0.019051121547818184, -0.0056275492534041405, -0.01941799186170101, 0.006037004292011261, -0.04124685749411583, -0.01375768706202507, -0.008582176640629768, -0.0531177744269371, 0.027646400034427643, -0.01067858561873436, 0.013613559305667877, -0.025628605857491493, 0.001985037699341774, 0.007402945775538683, 0.019496608525514603, -0.026729220524430275, -0.06991525739431381, -0.002538620727136731, -0.010252752341330051, 0.014923814684152603, -0.007049176841974258, -0.004870876204222441, 0.024619707837700844, -0.02093788981437683, -0.028275322169065475, 0.015683762729167938, 0.0011579386191442609, 0.045596905052661896, 0.020990299060940742, 0.012899469584226608, -0.010377226397395134, -0.02895665541291237, 0.04842705652117729, -0.01675817370414734, 0.02341427281498909, -0.02851116843521595, 0.03569136932492256, 0.01628648117184639, 0.002625425346195698, -0.05597413331270218, -0.028747014701366425, -0.004120755009353161, -0.02092478610575199, -0.0030807391740381718, -0.02591686137020588, -0.01632578857243061, 0.01570996828377247, -0.03784019127488136, 0.04688095673918724, 0.0020096050575375557, -0.01249329000711441, -0.023702530190348625, -0.025301041081547737, 0.05306536331772804, 0.020086223259568214, -0.015251378528773785, -0.016076840460300446, 0.022641222923994064, -0.013259789906442165, 0.01147784199565649, -0.0017983262659981847, 0.013705276884138584, 0.04627823829650879, -0.07919186353683472, 0.02893044985830784, 0.02741055376827717, 0.04436526447534561, 0.034879013895988464, -0.021527504548430443, -0.006453010253608227, 0.08542868494987488, -0.004520382732152939, -0.028196707367897034, -0.010108624584972858, -0.012781546451151371, 0.015565840527415276, -0.006911600008606911, -0.028747014701366425, 0.027331938967108727, -0.014294891618192196, 0.012172277085483074, 0.008090830408036709, -0.010907880030572414, -0.03244193643331528, 0.09826919436454773, 0.02383355423808098, 0.024790041148662567, -0.03757813945412636, 0.0291138868778944, -0.06121515482664108, -0.02545827254652977, -0.03210126981139183, -0.03401424363255501, 0.0022339862771332264, -0.04567551985383034, -0.04546587914228439, 0.009112830273807049, 0.06886705011129379, -0.024659015238285065, 0.04740506038069725, -0.011012701317667961, -0.021986093372106552, -0.014216276817023754, -0.028380142524838448, -0.030791014432907104, -0.009237304329872131, -0.021003402769565582, 0.062473002821207047, 0.05995731055736542, 0.005637376103550196, -0.060795873403549194, 0.020138632506132126, 0.004140408709645271, 0.00405524205416441, 0.029323527589440346, -0.005663581192493439, -0.011359918862581253, -0.01404594350606203, 0.005588241387158632, 0.056288592517375946, 0.023217733949422836, 0.056812696158885956, -0.01830427534878254, -0.0037899152375757694, -0.022156426683068275, 0.015985121950507164, 0.006813330575823784, -0.041456498205661774, 0.03854772821068764, -0.0032199539709836245, -0.020112428814172745, 0.01780637726187706, 0.05482110753655434, 0.01580168679356575, 0.018513916060328484, -0.0071802022866904736, -0.0015264481771737337, -0.008542868308722973, 0.03608444705605507, -0.018068429082632065, 0.014845198951661587, 0.02290327288210392, -0.008103933185338974, -0.010848918929696083, 0.010979944840073586, -0.03626788407564163, 0.0013151693856343627, 0.005296709481626749, 0.008706650696694851, -0.0009139034664258361, -0.01322703342884779, -0.01446522492915392, 0.047143008559942245, 0.002679473254829645, 0.03857393562793732, -0.05296054482460022, 0.001395422499626875, -0.019562121480703354, 0.0836467370390892, -0.009650034829974174, -0.05738920718431473, -0.04740506038069725, 0.008018766529858112, -0.056865107268095016, -0.02587755396962166, 0.005663581192493439, 0.0228639654815197, -0.01838289014995098, -0.013613559305667877, 0.04017244651913643, -0.022523298859596252, -0.04999936372041702, -0.01123544480651617, 0.01831737719476223, -0.013213930651545525, 0.031262706965208054, -0.03907183185219765, 0.02741055376827717, -0.03569136932492256, -0.020112428814172745, -0.04580654576420784, 0.04640926420688629, -0.011248546652495861, 0.04520382732152939, -0.012820853851735592, 0.008765611797571182, 0.022274350747466087, 0.020688939839601517, -0.0023322554770857096, 0.01880217157304287, 0.04672372713685036, -0.06530315428972244, -0.04929182678461075, -0.028878040611743927, -0.016024429351091385, 0.006911600008606911, -0.06504110246896744, 0.011156829074025154, -0.01877596788108349, -0.02540586143732071, -0.0012553889537230134, 0.0028399797156453133, -0.017046429216861725, -0.02590375952422619, 0.017098840326070786, -0.025851348415017128, 0.018487710505723953, 0.019011812284588814, -0.04942285269498825, -0.00917179137468338, -0.03364737331867218, 0.008018766529858112, -0.012270546518266201, 0.007022971753031015, 0.017426403239369392, 0.07216889411211014, 0.018448403105139732, -0.019653838127851486, -0.019955197349190712, -0.01780637726187706, 0.0140197379514575, 0.04163993149995804, 0.0030610854737460613, 0.02651957981288433, -0.010875123552978039, 0.051728904247283936, -0.0072784717194736, -0.04570172727108002, -0.04481075331568718, -0.03820706158876419, -0.03367357701063156, 0.027174707502126694, 0.02809188701212406, -0.0031462518963962793, 0.05123100429773331, 0.004255055915564299, 0.013299097307026386, -0.05303915962576866, -0.0480077750980854, -0.007206407375633717, 0.003156078979372978, 0.04433906078338623, 0.07646653801202774, 0.036949217319488525, 0.007448805030435324, -0.033935628831386566, 0.025130707770586014, -0.04389357194304466, 0.019653838127851486, 0.003475453704595566, -0.00862148404121399, -0.02295568399131298, -0.009139034897089005, 0.004238677676767111, 0.01684989035129547, 0.03003106452524662, 0.001678765402175486, -0.06493628025054932, -0.017072634771466255, 0.009558317251503468, -0.003531139576807618, 0.06718992441892624, 0.0570223368704319, 0.00407817168161273, 0.03102686069905758, -0.01636509597301483, -0.009479701519012451, -0.024213528260588646, 0.06640376895666122, 0.01346943061798811, -0.020033812150359154, -0.0008078546379692852, 0.011366469785571098, 0.009486252442002296, -0.01526448130607605, -0.01168093178421259, 0.005548933986574411, -0.04292398318648338, -0.021645426750183105, 0.024750733748078346, -0.06666582077741623, -0.002053826116025448, -0.014543840661644936, -0.005493247881531715, 0.018959403038024902, -0.0040978253819048405, 0.013823200017213821, -0.027725014835596085, -0.008981804363429546, -0.01581478863954544, 0.025143811479210854, -0.045046597719192505, 0.037420909851789474, 0.0032084891572594643, 0.060795873403549194, -0.02544516883790493, 0.057336799800395966, 0.01350873801857233, -0.04483695700764656, 0.05990489944815636, 0.037420909851789474, -0.04373634234070778, -0.009283162653446198, 0.0017082461854442954, 0.04274054616689682, -0.0035114858765155077, -0.015421711839735508, 0.00014668724907096475, -0.03270398825407028, -0.03220608830451965, -0.03170819208025932, -0.036398909986019135, 0.007809125352650881, -0.04239987954497337, 0.003642511321231723, -0.02701747603714466, -0.0035966525319963694, 0.009086624719202518, 0.021527504548430443, 0.009073521941900253, 0.03629408776760101, 0.050628289580345154, -0.0020685666240751743, 0.004294363781809807, 0.014858301728963852, -0.008221855387091637, -0.030266910791397095, 0.012021597474813461, 0.03427629545331001, -0.014818994328379631, -0.011379572562873363, 0.010495149530470371, -0.019103530794382095, -0.03760434314608574, 0.023820452392101288, -0.03249434754252434, -0.020715145394206047, 0.021121324971318245, -0.014386610127985477, 0.060324180871248245, 0.0029267841018736362, 0.015395507216453552, 0.010298611596226692, 0.011484392918646336, -0.007324330508708954, 0.027227118611335754, 0.0026287008076906204, 0.0024387137964367867, 0.00776326609775424, 0.01506794337183237, 0.046618904918432236, 0.002284758724272251, -0.017491916194558144, 0.03705403581261635, -0.023165324702858925, -0.02642786130309105, 0.041430290788412094, -0.029218707233667374, -0.010783405974507332, -0.019129736348986626, 0.00919144507497549, -0.0203744787722826, -0.011176482774317265, -0.048610493540763855, -0.010639278218150139, -0.025287939235568047, -0.005689786281436682, 0.007566727697849274, 0.037001628428697586, 0.006407151464372873, -0.06446459144353867, -0.021082017570734024, -0.017452608793973923, 0.03008347563445568, -0.009401085786521435, -0.014871404506266117, -0.04905598238110542, 0.005886324681341648, -0.0001215057636727579, -0.01736089028418064, 0.009931739419698715, -0.0071277921088039875, -0.004091273993253708, 0.004477799404412508, 0.02545827254652977, -0.021186837926506996, 0.07515627890825272, 0.006397324614226818, 0.007140894886106253, -0.046042393893003464, 0.03718506172299385, 0.00015180543414317071, 0.0076912022195756435, -0.04132547229528427, 0.02541896514594555, -0.0053720492869615555, -0.003305120626464486, -0.004481075331568718, 0.02387286350131035, 0.011124072596430779, 0.012126418761909008, 0.02641475945711136, 0.029402142390608788, -0.04737885296344757, -0.005319639109075069, 0.0038587036542594433, 0.013914917595684528, -0.006534901447594166, -0.016967814415693283, -0.00970244500786066, 0.03141993656754494, 0.011726790107786655, -0.028747014701366425, -0.0207806583493948, -0.04205921292304993, 0.02134406939148903, -0.010082419030368328, -0.022221939638257027, -0.019470402970910072, 0.02092478610575199, -0.016142353415489197, -0.04127306118607521, 0.015225173905491829, 0.0006113162962719798, 0.02895665541291237, -0.03197024390101433, 0.014124558307230473, 0.012290200218558311, -0.019719351083040237, -0.016614044085144997, -0.023532196879386902, -0.0011947896564379334, 0.004920010920614004, -0.012585007585585117, -0.04905598238110542, 0.050628289580345154, 0.015447917394340038, -0.008051522076129913, -0.009577970951795578, 0.04436526447534561, 0.004693991970270872, -0.028118092566728592, -0.009833470918238163, 0.002220883732661605, 0.022143324837088585, 0.008713201619684696, 0.012598110362887383, -0.012670174241065979, -0.051676493138074875, -0.027725014835596085, -0.017662249505519867, 0.02392527274787426, -0.01783258281648159, -0.001507613225840032, 0.011870918795466423, -0.02796086110174656, 0.018120838329195976, -0.011124072596430779, 0.04224264994263649, -0.016116147860884666, 0.0055718631483614445, -0.00019868802337441593, -0.019955197349190712, -0.018749762326478958, -0.04614721238613129, 0.003292017849162221, -0.029664194211363792, 0.019457299262285233, 0.03493142127990723, -0.011589213274419308, 0.021553710103034973, 0.02539275959134102, 0.010645829141139984, -0.004680889192968607, 0.003303482662886381, -0.001594417612068355, 0.06582725793123245, 0.05130962282419205, 0.023637017235159874, -0.031262706965208054, 0.040015216916799545, -0.044496290385723114, -0.012827405706048012, 0.017491916194558144, 0.0001090173827833496, 0.005568587686866522, -0.005267228931188583, -0.02247088961303234, 0.01584099419414997, -0.0024976753629744053, 0.030345527455210686, -0.005873221904039383, -0.009931739419698715, -0.034852806478738785, -0.03210126981139183, 0.051702696830034256, -0.04719541594386101, 0.03417147323489189, -0.006269574631005526, -0.006905048619955778, -0.05660305544734001, 0.07803884148597717, 2.8994529202464037e-05, 0.030895834788680077, -0.0029136815574020147, 0.0015452830120921135, -0.03304465487599373, -0.015198968350887299, 0.005607895087450743, 0.012034700252115726, -0.00737674068659544, -0.0078680869191885, -0.0036752677988260984, 0.00509689562022686, 0.015185865573585033, 0.04315983131527901, 0.009545214474201202, -0.00967623945325613, -0.04318603500723839, -0.04119444638490677, 0.052750904113054276, -0.034381113946437836, 0.0038783575873821974, -0.005663581192493439, 0.002915319288149476, 0.010344469919800758, 0.003730953671038151, -0.023139119148254395, 0.003329687751829624, -0.0022159703075885773, 0.03815465047955513, 0.02754157967865467, -0.0007304676692001522, 0.01572307012975216, 0.01295843068510294, -0.09224201738834381, 0.019483504816889763, 0.03325429558753967, 0.004667786881327629, -0.039386291056871414, -0.004736575298011303, -0.029926244169473648, -0.009984149597585201, -0.02239227294921875, 0.04331706091761589, -0.007953253574669361, -0.030371731147170067, -0.0182911716401577, -0.04053931683301926, 0.013096007518470287, -0.04580654576420784, -0.0034558000043034554, -0.017963608726859093, 0.0013643039856106043, -0.018422197550535202, -0.019981402903795242, -0.037499524652957916, 0.019470402970910072, -0.0021897652186453342, -0.06420253962278366, 0.006263023242354393, -0.0500255711376667, -0.023230837658047676, 0.027856040745973587, 0.0008795092580839992, 0.0036326844710856676, 0.0035376909654587507, 0.0037473319098353386, 0.015932712703943253, -0.000650214496999979, 0.01878906972706318, -0.005840465892106295, -0.0209116842597723, 0.02452799119055271, -0.05086413398385048, -0.015906507149338722, 0.004435216076672077, -0.01302394364029169, 0.00471037020906806, 0.021553710103034973, -0.02801327034831047, -0.005866670981049538, 0.03301844745874405, 0.037368498742580414, -0.0063645681366324425, 0.020112428814172745, -0.022313658148050308, 0.010632726363837719, -0.005162408109754324, -0.0469333678483963, 0.033385321497917175, 0.0038357742596417665, -0.007815676741302013, -0.0011350092245265841, -0.034905217587947845, 0.002969367429614067, 0.008215304464101791, 0.00507396599277854, -0.007095035631209612, 0.0029185949824750423, -0.006937805097550154, 0.007697753608226776, 0.054716285318136215, -0.022300556302070618, -0.004746402148157358, 0.011241995729506016, -0.01631268672645092, -0.008097381331026554, -0.026637502014636993, -0.006534901447594166, 0.05007798224687576, -0.011805405840277672, -0.009270060807466507, -0.01019379124045372, -0.0013798632426187396, 0.007304676808416843, 0.03275639936327934, 0.0032527102157473564, 0.015081045217812061, -0.0028874764684587717, 0.02346668392419815, 0.008195650763809681, -0.0023748388048261404, 0.010043111629784107, -0.04541346803307533, -0.03207506611943245, -0.06703269481658936, -0.005657029803842306, -0.0219205804169178, -0.01375768706202507, -6.46427070023492e-05, 0.018553223460912704, 0.004101100843399763, -0.09507216513156891, -0.012257443740963936, -0.011248546652495861, 0.016692660748958588, 0.0005703707574866712, 0.02699127234518528, 0.07174961268901825, 0.018946301192045212, 0.004448318853974342, 0.0031233225017786026, 0.017544327303767204, -0.0011915139621123672, -0.020793762058019638, -0.005047760903835297, -0.016574736684560776, -0.027279527857899666, 0.03831188380718231, -0.015198968350887299, 0.025209324434399605, -0.010527906008064747, 0.006950907409191132, 0.010423085652291775, 0.004638305865228176, 0.021724043413996696, -0.003357530804350972, -0.023152220994234085, 0.0020849446300417185, 0.03616306185722351, 0.06021936237812042, 0.0001319468574365601, 0.0031397007405757904, -0.019038017839193344, 0.018002916127443314, -0.011359918862581253, -0.004438492003828287, 0.01637819968163967, 0.0027024028822779655, 0.006164753809571266, 0.0099513940513134, -0.025379657745361328, -0.005129652097821236, -0.016469916328787804, 0.021553710103034973, -0.010606521740555763, 0.03663475438952446, 0.03008347563445568, 0.0020439992658793926, -0.002951351460069418, 0.022706734016537666, 0.0033870115876197815, 0.005981318186968565, 0.024776939302682877, -0.001123544410802424, 0.014006635174155235, 0.03529829531908035, -0.0024436272215098143, -0.017138147726655006, -0.001286507467739284, 0.00010282437870046124, 0.028589783236384392, 0.009296265430748463, 0.00048807033454068005, 0.020230351015925407, -0.02342737466096878, -0.0038357742596417665, -0.011399226263165474, -0.003047982696443796, 0.0019899511244148016, -0.02140958234667778, -0.014674866572022438, 0.000996613409370184, 0.005231196526437998, -0.01986347883939743, 0.00700986897572875, -0.023728733882308006, 0.005873221904039383, 0.008261163718998432, -0.014910711906850338, -0.026637502014636993, -0.046094801276922226, 0.022025402635335922, -0.0274367593228817, -0.020086223259568214, 0.043055009096860886, -0.0145569434389472, -0.01890699192881584, 0.019706249237060547, -0.02492106705904007, -0.016443710774183273, 0.008916291408240795, 0.043474290519952774, -0.0086411377415061, 0.0396745502948761, 0.027672605589032173, -0.025209324434399605, 0.016561634838581085, -0.013548046350479126, 0.018212556838989258, 0.02651957981288433, 0.011215790174901485, 0.0357699878513813, 0.04085377976298332, -0.0011972463689744473, 0.007173650898039341, -0.037918806076049805, 0.028799423947930336, -0.02247088961303234, -0.030948244035243988, -0.024161119014024734, -7.569798617623746e-05, 0.017439506947994232, 0.014386610127985477, -0.019601428881287575, -0.025772733613848686, -0.010049662552773952, 0.04234747216105461, 0.07117310166358948, 0.002574652899056673, -0.04824362322688103, -0.001067039673216641, 0.017177455127239227, -0.014294891618192196, 0.0029726431239396334, 0.029716603457927704, -0.009374881163239479, -0.02388596534729004, -0.013187726028263569, -0.006171305198222399, 0.0014986052410677075, -0.00609268993139267, 0.01932627521455288, 0.019208351150155067, -0.023008093237876892, 0.0025435343850404024, -0.0020079670939594507, -0.015054840594530106, 0.04803398251533508, 0.016496121883392334, -0.013941123150289059, 0.006983663886785507, -0.0049134595319628716, -0.015565840527415276, 0.026231322437524796, 0.015592045150697231, -0.04192819073796272, 0.017413301393389702, -0.006528350058943033, 0.013456327840685844, -0.006787125486880541, 0.005892876069992781, -0.019981402903795242, -0.027174707502126694, -0.017098840326070786, 0.008084278553724289, 0.033490139991045, 0.06608930975198746, 0.0028842007741332054, -0.05639341473579407, -0.005277055781334639, -0.025759631767868996, 0.012906020507216454, 0.045570701360702515, 0.0218550693243742, -0.019129736348986626, -0.0035802742931991816, 0.01826496794819832, -0.03223229572176933, 0.0007349716615863144, -0.02798706665635109, 0.011752995662391186, -0.007809125352650881, 0.003898011287674308, 0.013836302794516087, -0.001713159610517323, 0.015185865573585033, 0.046592701226472855, 0.06546038389205933, 0.010488598607480526, -0.004481075331568718, 0.008837675675749779, -0.030817218124866486, -0.0007493026205338538, 0.00599114503711462, 0.03299224376678467, 0.023702530190348625, -0.01732158288359642, -0.014923814684152603, -0.008385637775063515, -0.003708024276420474, 0.003911113832145929, -0.0040683443658053875, -0.015316891483962536, 0.010115175507962704, 0.03212747350335121, 0.0015231724828481674, 0.024737631902098656, 0.008044971153140068, -0.010868572629988194, 0.006570933386683464, 0.017478814348578453, 0.03676578029990196, 0.05660305544734001, 0.02388596534729004, -0.00699021527543664, -0.005126376170665026, 0.04829603433609009, -0.024776939302682877, -0.01635199412703514, -0.008424945175647736, 0.043526701629161835, -0.029402142390608788, -0.009329021908342838, 0.0007116327178664505, 0.029900040477514267, 0.007317779120057821, 0.03862634301185608, -0.00711468979716301, 0.0047529530711472034, -0.026794733479619026, -0.002391217043623328, -0.010665482841432095, -0.05461146682500839, -0.029402142390608788, 0.014032840728759766, 0.005309812258929014, 0.0024354381021112204, 0.007429150864481926, 0.007193305063992739, 0.01422937959432602, -0.005945286247879267, 0.015081045217812061, 0.0010817800648510456, -0.025694118812680244, 0.019195249304175377, 0.04027726501226425, -0.008313573896884918, -0.00761913787573576, -0.012781546451151371, 0.041980598121881485, 0.0005597249255515635, 0.0021733869798481464, 0.010842368006706238, 0.010377226397395134, -0.017937403172254562, 0.011864366941154003, 0.01453073788434267, 0.04114203527569771, 0.03907183185219765, -0.00943384226411581, 0.013063251040875912, 0.015500327572226524, -0.02182886376976967, 0.03956972807645798, -0.004415562376379967, 0.03312326967716217, -0.0027187808882445097, -0.002222521463409066, 0.03396183252334595, 0.020728249102830887, -0.021645426750183105, -0.003357530804350972, -0.03561275452375412, -0.006584035698324442, -0.02801327034831047, 0.002573014935478568, -0.02599547803401947, 0.012368815951049328, 0.00376043445430696, 0.026860246434807777, 0.01622096821665764, -0.022235043346881866, 0.012401572428643703, -0.02590375952422619, 0.02751537412405014, -0.04494177922606468, -0.016640249639749527, -0.015631353482604027, -0.011523700319230556, -0.0005937097012065351, -0.029742809012532234, -0.02754157967865467, 0.004811914637684822, 0.001493691699579358, -0.027384348213672638, 0.011890572495758533, -0.012814302928745747, -0.0003034061228390783, -0.009466598741710186, 0.02793465554714203, -0.00419937027618289, 0.03865255042910576, 0.013901814818382263, -0.011248546652495861, -0.002353547140955925, 0.0367133691906929, 0.000713679997716099, -0.008195650763809681, 0.0015289048897102475, 0.009329021908342838, -0.009577970951795578, 0.016391301527619362, 0.04900357127189636, 0.013161520473659039, -0.03144614025950432, 0.03417147323489189, -0.012860161252319813, -0.01737399399280548, -0.022235043346881866, 0.04722162336111069, -0.006695407908409834, -0.016194762662053108, 0.030659988522529602, 0.011811956763267517, 0.003380460198968649, 0.009545214474201202, -0.003907838370651007, -0.03445972874760628, 0.025379657745361328, -0.028878040611743927, -0.0016271740896627307, -0.010547559708356857, 0.01994209550321102, -0.03356875479221344, -0.006495593581348658, 0.02244468405842781, -0.029716603457927704, -0.0033493416849523783, 0.016889197751879692, 0.00968279130756855, -0.019221454858779907, -0.0015190779231488705, 0.008221855387091637, 0.0017344512743875384, 0.011314059607684612, -0.04137787967920303, -0.007108138408511877, -0.03514106199145317, -0.0013921469217166305, -0.0026663707103580236, -0.005247574765235186, -0.012054353952407837, -0.03558655083179474, -0.0147927887737751, -0.005752023309469223, 0.036923009902238846, -0.013181174173951149, 0.04737885296344757, -0.004978972487151623, 0.032258499413728714, 0.03422388434410095, 0.0591711550951004, 0.021737145259976387, -0.009591072797775269, 0.002073480049148202, 0.015081045217812061, 0.0033673576544970274, 0.0163388904184103, 0.005408081226050854, -0.019103530794382095, -0.035927217453718185, -0.01876286417245865, 0.009990701451897621, 0.011065111495554447, 0.02603478543460369, -8.409181464230642e-05, -0.022261247038841248, 0.01094063650816679, 0.05130962282419205, 0.02139647863805294, -0.01627337746322155, 0.030397936701774597, 0.00028293338255025446, 0.007606035564094782, 0.016037533059716225, -0.0021209768019616604, -0.009361778385937214, 0.014032840728759766, 0.0029464380349963903, 0.016627147793769836, 0.05091654509305954, 0.03857393562793732, -0.05078551918268204, 0.02346668392419815, 0.033778395503759384, -0.042085420340299606, -0.0016320875147357583, 0.006531625520437956, 0.0037178511265665293, 0.007337433286011219, 0.018081530928611755, 0.013115661218762398, 0.01094718836247921, 0.006649548653513193, -0.011379572562873363, 0.021802658215165138, 0.019051121547818184, 0.030791014432907104, -0.01578858308494091, -0.005499799270182848, 0.017924301326274872, 0.01683678850531578, 0.0207806583493948, -0.006780574098229408, 0.009466598741710186, -0.0009802351705729961, -0.023008093237876892, 0.014439020305871964, 0.03257296234369278, 0.011910226196050644, 0.023008093237876892, -0.010789957828819752, 0.00023441297526005656, -0.011340265162289143, 0.007573279086500406, -0.005833914503455162, -0.0032003000378608704, -0.0050084530375897884, 0.011058559641242027, -0.002733521396294236, -0.012467085383832455, -0.03299224376678467, 0.01048204768449068, 0.02290327288210392, 0.021999197080731392, 0.022208837792277336, 0.0570223368704319, 0.026794733479619026, 0.0008541230927221477, 0.023309452459216118, 0.012539149262011051, -0.0140197379514575, -0.010108624584972858, -0.028327733278274536, 0.0007615862414240837, -0.0167450699955225, 0.002405957318842411, 0.004648132715374231, 0.00030606758082285523, -0.0346955768764019, 0.0259561687707901, 0.019955197349190712, -0.0033935627434402704, -0.020217249169945717, 0.05911874771118164, -0.01041653472930193, 0.033778395503759384, 0.009853124618530273, 0.022182632237672806, 0.012342610396444798, 0.017505018040537834, -0.008352881297469139, -0.011130623519420624, -0.04363152012228966, 0.02236606739461422, 0.021593017503619194, 0.024724528193473816, -0.023754939436912537, -0.019182145595550537, -0.0005372049054130912, 0.026192015036940575, 0.02438386157155037, 0.007088484242558479, 0.00274171051569283, 0.011648175306618214, -0.028589783236384392, 0.011012701317667961, -0.04525623843073845, 0.039386291056871414, -0.04216403514146805, -0.05634100362658501, -0.00024976753047667444, 0.030895834788680077, -0.0015485587064176798, 0.010088970884680748, 0.018186351284384727, 0.024554194882512093, 0.0004454870068002492, -0.042452290654182434, 0.02236606739461422, 0.0006190959247760475, 0.016089942306280136, -0.013299097307026386, 0.005673408042639494, -0.0059354593977332115, 0.013417020440101624, -0.01878906972706318, -0.0012660347856581211, -0.016469916328787804, 0.014334199950098991, -0.0013233585050329566, -0.012336059473454952, 0.041011009365320206, 0.005447389092296362, -0.0398055762052536, 0.01784568466246128, 0.0019539191853255033, 0.009564868174493313, 0.006548003759235144, 0.006806779652833939, 0.033280499279499054, -0.011038905940949917, 0.0068984972313046455, 0.0013053424190729856, 0.034826602786779404, 0.01677127555012703, 0.0014502895064651966, 0.0047136456705629826, -0.02448868378996849, -0.017177455127239227, -0.024069400504231453, -0.001854012138210237, 0.0006629076087847352, -0.01021344494074583, -0.011752995662391186, 0.03312326967716217, 0.014216276817023754, 0.02444937452673912, 0.017413301393389702, 0.003983178175985813, 0.018618736416101456, -0.036949217319488525, -0.027384348213672638, 0.0032215917017310858, -0.03367357701063156, -0.005516177508980036, -0.023243939504027367, -0.013390815816819668, 0.016705762594938278, -0.0011358280899003148, 0.03524588420987129, -0.0019178871298208833, 0.000643253733869642, -0.021134428679943085, -0.013430123217403889, 0.00168695452157408, 0.010468944907188416, 0.008189099840819836, -0.018540121614933014, 0.014648661017417908, -0.011615418829023838, -0.003172457218170166, 0.014190071262419224, 0.04318603500723839, -0.004517107270658016, 0.005591516848653555, 0.05036623775959015, 0.005768401548266411, -0.017727762460708618, 0.006315433420240879, -0.0172822754830122, -0.02853737398982048, 0.012434328906238079, 0.0009147223900072277, 0.00407817168161273, -0.004395908676087856, 0.0015026996843516827, -0.007900843396782875, 0.026192015036940575, -0.024619707837700844, -0.0027466239407658577, 0.017596736550331116, -0.024619707837700844, -0.010744098573923111, 0.016116147860884666, -0.005306536331772804, -0.001537912874482572, -0.0015739449299871922, -0.018553223460912704, -0.003170819254592061, -0.016456814482808113, 0.00045572337694466114, 0.008870432153344154, 0.0008672256371937692, -0.02194678597152233, 0.0029742808546870947, 0.010763752274215221, 0.013888712972402573, 0.016954710707068443, 0.012630866840481758, 0.025667913258075714, 0.009093175642192364, 0.020151736214756966, -0.012198482640087605, -0.016954710707068443, 0.00037055675056762993, -0.00546376733109355, -0.009604175575077534, 0.01982417143881321, 0.02653268165886402, -0.003118409076705575, -0.017701556906104088, 0.027882246300578117, 0.041063420474529266, -0.00473002390936017, -0.019103530794382095, -0.013089456595480442, 0.00621388852596283, 0.010003804229199886, -0.01774086430668831, -0.013679071329534054, 0.025707220658659935, 0.05492592602968216, -0.017636043950915337, -0.04785054549574852, -0.01019379124045372, -0.029769014567136765, -0.01548722479492426, 0.008411843329668045, -0.0007701847935095429, 0.012768443673849106, -0.014687968418002129, -0.005620997864753008, 0.020610325038433075, 0.019208351150155067, 0.020243452861905098, 0.010586868040263653, -0.0008053979254327714, 0.0010613072663545609, -0.016011327505111694, -0.008673894219100475, 0.012886366806924343, -0.01020689308643341, 0.014360404573380947, 0.004448318853974342, -0.01890699192881584, 0.006351465359330177, 0.022706734016537666, -0.0008467528969049454, -0.029271116480231285, -0.012506392784416676, 0.0066462731920182705, -0.007488112431019545, -0.017636043950915337, 0.011268200352787971, 0.004897081293165684, 0.02543206699192524, -0.018553223460912704, 0.0016918679466471076, 0.003347703954204917, -0.012781546451151371, 0.021986093372106552, 0.013548046350479126, -0.010757201351225376, 0.010364124551415443, -0.007966356351971626, -0.020767556503415108, 0.020544812083244324, -0.02045309543609619, -0.014661763794720173, -0.02392527274787426, -0.017020223662257195, -0.008365984074771404, 0.017701556906104088, 0.0037637101486325264, 0.004766055848449469, 0.05123100429773331, -0.0019342652522027493, -0.004304190631955862, -0.016207866370677948, -0.0037211268208920956, 0.024226631969213486, -0.027384348213672638, 0.025602400302886963, -0.02239227294921875, 0.0375257283449173, 0.05256746709346771, 0.0018572877161204815, 0.017439506947994232, -0.06048141419887543, -0.0034623511601239443, 0.009099727496504784, -0.013069802895188332, -0.004821741953492165, 0.010547559708356857, 0.06556520611047745, 0.009833470918238163, -0.011405778117477894, 0.006095965392887592, 0.04082757234573364, -0.04085377976298332, 0.01300428993999958, 0.03975316509604454, 0.036451321095228195, -0.0010105348192155361, -0.005981318186968565, -0.0007533971220254898, 0.03506244719028473, 0.012886366806924343, 0.031393732875585556, -0.002214332576841116, -0.016902301460504532, 0.012355713173747063, -0.024737631902098656, 0.014884507283568382, 0.005123100709170103, 0.002117701107636094, -0.005837189964950085, 0.008759060874581337, 0.02140958234667778, -0.018500814214348793, 0.01789809577167034, 0.021108223125338554, 0.02492106705904007, -0.019522812217473984, -0.01783258281648159, -0.02237917110323906, -0.004264882765710354, 0.016037533059716225, -0.016561634838581085, 0.028432553634047508, -0.0015149833634495735, 0.010239649564027786, -0.00038877749466337264, 0.010560662485659122, 0.005313087720423937, 0.02130476012825966, 0.0035376909654587507, 0.004415562376379967, -0.01734778843820095, 0.0032821909990161657, -0.009787611663341522, 0.01683678850531578, 0.02489486150443554, -0.017098840326070786, -0.005768401548266411, -0.056236185133457184, -0.012467085383832455, 0.0158671997487545, 0.037997420877218246, -0.058332592248916626, -0.007592932786792517, -0.012814302928745747, 0.022798452526330948, -0.01530378870666027, 0.015919608995318413, -0.01975865848362446, 0.008490458130836487, 0.0029398866463452578, -0.025235528126358986]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-14T10:15:02.342086", "url_path": "/examples/rag/", "chunk_size": 2248}
updated_dt: 2025-03-14T10:15:02.342086
---
# RAG
RAG search example. This demo allows you to ask question of the [logfire](https://pydantic.dev/logfire) documentation.
Demonstrates:
  * [tools](https://ai.pydantic.dev/tools/)
  * [agent dependencies](https://ai.pydantic.dev/dependencies/)
  * RAG search


This is done by creating a database containing each section of the markdown documentation, then registering the search tool with the PydanticAI agent.
Logic for extracting sections from markdown files and a JSON file with that data is available in [this gist](https://gist.github.com/samuelcolvin/4b5bb9bb163b1122ff17e29e48c10992).
[PostgreSQL with pgvector](https://github.com/pgvector/pgvector) is used as the search database, the easiest way to download and run pgvector is using Docker:
```
mkdirpostgres-data
dockerrun--rm\
-ePOSTGRES_PASSWORD=postgres\
-p54320:5432\
-v`pwd`/postgres-data:/var/lib/postgresql/data\
pgvector/pgvector:pg17

```

As with the [SQL gen](https://ai.pydantic.dev/examples/sql-gen/) example, we run postgres on port `54320` to avoid conflicts with any other postgres instances you may have running. We also mount the PostgreSQL `data` directory locally to persist the data if you need to stop and restart the container.
With that running and [dependencies installed and environment variables set](https://ai.pydantic.dev/examples/#usage), we can build the search database with (**WARNING** : this requires the `OPENAI_API_KEY` env variable and will calling the OpenAI embedding API around 300 times to generate embeddings for each section of the documentation):
[pip](https://ai.pydantic.dev/examples/rag/#__tabbed_1_1)[uv](https://ai.pydantic.dev/examples/rag/#__tabbed_1_2)
```
python-mpydantic_ai_examples.ragbuild

```

```
uvrun-mpydantic_ai_examples.ragbuild

```

(Note building the database doesn't use PydanticAI right now, instead it uses the OpenAI SDK directly.)
You can then ask the agent a question with:
[pip](https://ai.pydantic.dev/examples/rag/#__tabbed_2_1)[uv](https://ai.pydantic.dev/examples/rag/#__tabbed_2_2)
```
python-mpydantic_ai_examples.ragsearch"How do I configure logfire to work with FastAPI?"

```

```
uvrun-mpydantic_ai_examples.ragsearch"How do I configure logfire to work with FastAPI?"

```

## Example Code
rag.py