---
url: https://ai.pydantic.dev/api/models/test/
session_id: pydantic_ai_docs
chunk_number: 3
title: Handling Retry Prompts in Tool Calls
summary: This section describes the logic for managing retry prompts in a messaging system. It details how to identify any retry tools from previous messages and handles their retries by checking both function tools and result tools, assembling appropriate tool call parts for any identified retries before generating a response.
embedding: [-0.0039747231639921665, 0.039931509643793106, -0.014627997763454914, -0.025519564747810364, 0.0064307269640266895, -0.0027228917460888624, -0.030628561973571777, -0.036906782537698746, -0.012956771068274975, -0.01376378908753395, 0.023054029792547226, -0.0651206448674202, 0.012238715775310993, -0.03022187575697899, -0.007854129187762737, 0.01305208820849657, 0.0089407442137599, 0.06247718259692192, 0.004994615912437439, 0.06252802163362503, 0.015708258375525475, -0.00691366707906127, -0.00864843837916851, -0.016292870044708252, -0.001384480856359005, -0.008915326558053493, -0.024706192314624786, 0.05663106590509415, -0.002873810473829508, -0.022634634748101234, 0.027400489896535873, -0.0334753654897213, -0.027171727269887924, -0.008171852678060532, 0.004279737826436758, -0.023244664072990417, -0.016445377841591835, 0.00274036661721766, 0.00025914335856214166, 0.044430479407310486, -0.01847880892455578, -0.021249359473586082, -0.007491924334317446, -0.013801916502416134, -0.04656558111310005, 0.029891442507505417, -0.011050429195165634, 0.005747620947659016, 0.02352426014840603, 0.039143554866313934, -0.01139992568641901, 0.03599173575639725, 0.006348119117319584, -0.005321871489286423, -0.01036414597183466, -0.04303249344229698, -0.07050924003124237, 0.0339328870177269, 0.010326019488275051, -0.03591548278927803, 0.010497589595615864, -0.0007271900540217757, -0.022876104339957237, -0.0035998092498630285, -0.01894903928041458, -0.009868497028946877, -0.008858135901391506, 0.022761723026633263, 0.0006545107462443411, 0.008985225111246109, -0.003510846523568034, 0.03888937830924988, -0.058003634214401245, 0.008330714888870716, -0.023511551320552826, -0.02788342908024788, 0.01286780834197998, 0.030857322737574577, 0.020944343879818916, -0.012372159399092197, -0.014132348820567131, 0.010453108698129654, -0.005941432435065508, 0.000990503584034741, -0.0210968516767025, -0.03136568143963814, -0.052818384021520615, -0.04150741919875145, -0.03939773514866829, -0.018402554094791412, -0.044277969747781754, 0.002900817198678851, -0.008820009417831898, 0.03700845316052437, 0.08021887391805649, -0.005522037390619516, -0.0005572079098783433, -0.024413887411355972, -0.012353096157312393, 0.00494378013536334, 0.0545976348221302, -0.01669955626130104, -0.0660356879234314, 0.023409880697727203, 0.03866061568260193, -0.006608652416616678, 0.011952764354646206, -0.045625120401382446, -0.032636575400829315, 0.0016378655564039946, -0.07544030994176865, 0.0021811730694025755, -0.0029405325185507536, 0.013674826361238956, -0.04117698594927788, -0.004880235530436039, -0.025697490200400352, 0.017258750274777412, 0.021363738924264908, -0.01683935523033142, -0.0060272179543972015, -0.01110126543790102, 0.03169611468911171, -0.0051852501928806305, -0.01178754772990942, 0.015670131891965866, -0.005490264855325222, -0.03789807856082916, -0.06262969225645065, -0.03558504953980446, 0.0204105693846941, 0.0014988613547757268, -0.0030946284532546997, -0.028747636824846268, -0.0018745696870610118, -0.02788342908024788, -0.06806911528110504, 0.013509610667824745, -0.02811218984425068, 0.022405873984098434, 0.021999185904860497, -0.03995692729949951, -0.026815878227353096, 0.004155825357884169, 0.01050394494086504, 0.01319188717752695, -0.043642524629831314, -0.022647343575954437, -0.01298218872398138, 0.030298128724098206, -0.00030422041891142726, 0.038279347121715546, -0.0061415983363986015, 0.009410975500941277, -0.029154323041439056, -0.010484880767762661, 0.02930683083832264, 0.070610910654068, 0.012391222640872002, -0.035712141543626785, 0.00027066085021942854, 0.021961059421300888, -0.03627133369445801, 0.027095474302768707, -0.034110814332962036, -0.024706192314624786, -0.0027371894102543592, -0.022418582811951637, -0.07193263620138168, -0.04986990615725517, 0.013064797036349773, 0.022723596543073654, -0.03253490477800369, 0.011603268794715405, 0.028366368263959885, 0.0002998517011292279, -0.05152206867933273, -0.0499969981610775, -0.02032160572707653, -0.032229889184236526, -0.05292005464434624, -0.013077505864202976, -0.0738644003868103, -0.03985525667667389, -0.03883854299783707, -0.03131484612822533, 0.009144087322056293, 0.0009198100306093693, 0.033551618456840515, 0.017741689458489418, 0.015466787852346897, 0.020613912492990494, 0.024096162989735603, 0.01687748171389103, -0.01293135341256857, -0.026434609666466713, 0.046489328145980835, -0.026892131194472313, 0.005487087648361921, 0.00047777697909623384, 0.009989231824874878, 0.05556351691484451, 0.019914919510483742, -0.04516759514808655, 0.009900269098579884, -0.04308332875370979, -0.03134026378393173, 0.0316452756524086, -0.05815614014863968, -0.03772015497088432, 0.008146435022354126, -0.017538346350193024, 0.031899455934762955, -0.004324219189584255, -0.01747480221092701, 0.021617919206619263, -0.04737895354628563, 0.004362346138805151, 0.027807176113128662, 0.04559970274567604, 0.01870756968855858, 0.04059237614274025, 0.04796356335282326, -0.011304608546197414, -0.01849151775240898, 0.03266199305653572, -0.006138421129435301, -0.040439870208501816, -0.014361109584569931, -0.004762677941471338, -0.01073270570486784, -0.016890190541744232, 0.02963726408779621, -0.0268412958830595, -0.003984254784882069, -0.07737206667661667, 0.03266199305653572, 0.024363050237298012, 0.03276366367936134, -0.06425643712282181, 0.010129030793905258, 0.0063957772217690945, -0.023015903308987617, 0.05063244327902794, 0.03431415557861328, 0.01029424648731947, 0.018771113827824593, -0.052869219332933426, 0.010402272455394268, 0.03250948712229729, 0.08474325388669968, -0.05393676832318306, 0.025849997997283936, -0.029154323041439056, -0.00336469360627234, -0.030933575704693794, -0.019851375371217728, -0.0123848682269454, -0.024464722722768784, -0.015187191776931286, 0.01382733415812254, 0.016038691624999046, -0.05266587436199188, -0.0002720508782658726, -0.014437363483011723, 0.0019174623303115368, -0.0009071010863408446, -0.007136073429137468, 0.013331685215234756, -0.05114080011844635, 0.022545671090483665, 0.028722219169139862, 0.06359557062387466, -0.016801226884126663, -0.013357102870941162, -0.013141050934791565, 0.016394540667533875, 0.02049953117966652, 0.030704814940690994, -0.012772491201758385, 0.028518876060843468, 0.03995692729949951, 0.008997933939099312, 0.03202654421329498, -0.016902899369597435, -0.016025980934500694, 0.02651086263358593, -0.0031248123850673437, 0.016864772886037827, -0.0006402131984941661, 0.028315532952547073, -0.002212945371866226, -0.011228354647755623, -0.03746597468852997, -0.002727657789364457, -0.020308896899223328, 0.025379765778779984, -0.0058492929674685, 0.021033307537436485, -0.025062043219804764, 0.019330307841300964, -0.017118951305747032, -0.013992550782859325, 0.028290115296840668, 0.026434609666466713, 0.014361109584569931, 0.024426596239209175, -0.019978463649749756, 0.011406280100345612, -0.03134026378393173, 0.04425255209207535, 0.04923446103930473, -0.06359557062387466, -0.01752563752233982, -0.010948757641017437, -0.007002629805356264, 0.023219246417284012, -0.014729669317603111, 0.027781758457422256, -0.020474113523960114, -0.024731609970331192, 0.0024687128607183695, 0.00744108809158206, -0.002903994405642152, -0.004098635166883469, 0.013369811698794365, -0.01830088347196579, 0.007530050817877054, -0.02403261885046959, -0.012950416654348373, -0.01592431031167507, -0.0683741346001625, 0.001182726351544261, 0.03215363621711731, 0.028366368263959885, -0.013967132195830345, -0.03586464747786522, 0.00745379738509655, 0.0012121157487854362, 0.0724918320775032, -0.020283479243516922, 0.012804264202713966, -0.05292005464434624, -0.01144440658390522, 0.01259456668049097, -0.02338446117937565, 0.020715583115816116, 0.060291241854429245, -0.031111501157283783, 0.034110814332962036, 0.03695761784911156, 0.012143398635089397, 0.002476656110957265, 0.023054029792547226, -0.03878770396113396, -0.04018568992614746, -0.00930930394679308, 0.004619702231138945, -0.015797220170497894, 0.004168534651398659, -0.020613912492990494, 0.036118827760219574, 0.0032661992590874434, -0.04509134218096733, -0.03243323042988777, 0.04285456985235214, -0.04275289550423622, -0.04366794228553772, -0.0504545196890831, -0.0030755652114748955, 0.021935641765594482, 0.03324660286307335, -0.0037618482019752264, -0.024388467893004417, -0.006939084734767675, 0.0008443506667390466, -0.03998234495520592, 0.01311563327908516, -0.02628210186958313, 0.01577180251479149, 0.07300019264221191, 0.0009968579979613423, 0.031213173642754555, -0.007225036155432463, 0.021046016365289688, 0.03398372232913971, 0.014755086973309517, -0.0007081266376189888, -0.02541789412498474, 0.017029989510774612, 0.007333062123507261, -0.05408927798271179, -0.028722219169139862, -0.008368841372430325, 0.039931509643793106, 0.034746259450912476, 0.02375302091240883, 0.03932148218154907, 0.03929606452584267, -0.02522725984454155, 0.003930241800844669, -0.0005425131530500948, -0.0024353519547730684, 0.0036951261572539806, -0.00045315339230000973, 0.018593188375234604, 0.02151624672114849, 0.018745696172118187, 0.06547649204730988, -0.0016601061215624213, 0.05246253311634064, 0.00995110534131527, 0.01353502832353115, -0.018605897203087807, -0.024108871817588806, -0.06161297485232353, 0.02371489442884922, 0.011298253200948238, 0.020969761535525322, 0.02164333686232567, -0.024566393345594406, -0.05947786942124367, -0.04910736903548241, -0.00661500683054328, -0.008184561505913734, 0.07035672664642334, 0.026205848902463913, -0.06090127304196358, 0.021897515282034874, -0.040389031171798706, -0.013293558731675148, -0.01569554954767227, 0.0816422775387764, -0.010446754284203053, 0.011164809577167034, -0.009932042099535465, -0.018974456936120987, 0.01669955626130104, -0.012670819647610188, 0.02302861213684082, 0.022126276046037674, -0.010650097392499447, -0.02142728492617607, 0.051801666617393494, -0.04821774363517761, -0.0036188724916428328, -0.019457397982478142, -0.015085520222783089, 0.045065924525260925, -0.020258061587810516, 0.025799162685871124, 0.03418706730008125, -0.053326740860939026, -0.0007295729592442513, -0.017970450222492218, -0.020423278212547302, 0.0922161191701889, 0.04115156829357147, 0.03418706730008125, -0.049514055252075195, 0.05009866878390312, -0.012194233946502209, 0.012060790322721004, 0.018923621624708176, -0.030120203271508217, -0.05073411390185356, -0.010872503742575645, 0.00195241195615381, 0.0003673679893836379, 0.018199210986495018, 0.0049787298776209354, 0.005753975827246904, 0.004247965291142464, 0.012804264202713966, 0.011520660482347012, -0.008495930582284927, 0.015352407470345497, 0.0002730437845457345, 0.027807176113128662, 0.0059636733494699, 0.012365804985165596, -0.034466665238142014, -0.04753145948052406, 0.03154360502958298, -0.05536017194390297, 0.07620284706354141, -0.009868497028946877, -0.015326989814639091, -0.020029300823807716, -0.0033392757177352905, -0.01319188717752695, -0.0029548301827162504, 0.03139109909534454, -0.014043386094272137, 0.02445201389491558, 0.008953453041613102, -0.03118775598704815, 0.027451325207948685, 0.004330573603510857, -0.03225530683994293, -0.015543041750788689, 0.01861860789358616, 0.015898892655968666, 0.009213986806571484, 0.05866449698805809, 0.01359857339411974, 0.03477167710661888, 0.033958304673433304, -0.010878858156502247, 0.04277831315994263, -0.05030201002955437, 0.0011366563849151134, 0.007962155155837536, 0.03283991664648056, 0.021630628034472466, 0.012009955011308193, -0.0026895308401435614, -0.018567770719528198, -0.007688912563025951, -0.0009261645027436316, 0.02600250579416752, -0.013369811698794365, 0.0018443858716636896, -0.005604645702987909, -0.02353696897625923, -0.03362787142395973, -0.0048738811165094376, -0.005032742861658335, -0.024324923753738403, -0.015466787852346897, 0.027349652722477913, 0.006068522110581398, 0.03060314431786537, -0.021630628034472466, -0.01453903503715992, -0.013903588056564331, 0.024274088442325592, 0.001981007168069482, 0.006478385534137487, -0.0009698515059426427, 0.0018777468940243125, 0.02963726408779621, -0.049514055252075195, -0.010217993520200253, 0.008902616798877716, 0.058410320430994034, 0.025811871513724327, -0.009843079373240471, 0.015199900604784489, -0.025036625564098358, 0.01119022723287344, -0.03250948712229729, 0.02742590755224228, -0.05266587436199188, 0.020626621320843697, 0.023498842492699623, -0.02788342908024788, -0.004521207883954048, -0.00012818163668271154, 0.00715513713657856, 0.017500219866633415, 0.005512505769729614, 0.044735491275787354, 0.03507669270038605, -0.04788731038570404, 0.059782885015010834, 0.03271282836794853, 0.011571495793759823, 0.004683246836066246, -0.0011819320498034358, 0.01073270570486784, 0.005919191986322403, -0.008248106576502323, -0.027629250660538673, 0.0024845991283655167, -0.02055036649107933, 0.017258750274777412, -0.03459375351667404, -0.05157290771603584, 0.017741689458489418, -0.008839072659611702, -0.04069404676556587, 0.024464722722768784, 0.029230577871203423, -0.031035248190164566, 0.0183517187833786, -0.0021954705007374287, 0.004670538008213043, -0.001831676927395165, -0.005696785170584917, 0.01615307107567787, -0.023651350289583206, 0.0003747153386939317, 0.029942277818918228, -0.02541789412498474, -0.021795842796564102, 0.032916173338890076, -0.007472860626876354, -0.043362926691770554, 0.01870756968855858, 0.04331209138035774, -0.027578415349125862, -0.021274777129292488, 0.041812434792518616, -0.02082996442914009, -0.01342064794152975, 0.027400489896535873, 0.01364940870553255, -0.052411697804927826, 0.015860766172409058, 0.0004535505431704223, -0.01073270570486784, -0.004889767151325941, -0.025570400059223175, 0.017309585586190224, 0.018771113827824593, -0.037135541439056396, 0.008553121238946915, 0.05907118320465088, -0.042905405163764954, -0.015377825126051903, 0.003150230273604393, 0.029154323041439056, 0.009137732908129692, 0.013509610667824745, -0.0011724003124982119, 0.019228637218475342, -0.009804951958358288, 0.005099464673548937, 0.06547649204730988, 0.01488217618316412, 0.032865338027477264, 0.03182320296764374, 0.016292870044708252, -0.03306867927312851, 0.0268412958830595, 0.04397295415401459, 0.002011190867051482, -0.01256914809346199, -0.024807864800095558, 0.03375496342778206, 0.051344145089387894, 0.027832593768835068, -0.009156796149909496, 0.0006398160476237535, -0.0034345928579568863, -0.04852275922894478, 0.02027077041566372, 0.005061338189989328, -0.00027999398298561573, 0.016623301431536674, -0.03454291820526123, -0.010942403227090836, -0.016585174947977066, 0.015797220170497894, -0.009970168583095074, 0.00015915969561319798, 0.001726828166283667, -0.02164333686232567, -0.0026466380804777145, -0.053733427077531815, -0.021681463345885277, -0.024070745334029198, -0.00972234457731247, -0.006344941444694996, 0.04143116623163223, 0.02935766614973545, 0.008413323201239109, 0.020308896899223328, -0.00834977813065052, -0.03179778531193733, 0.020906217396259308, 0.021897515282034874, 0.00857853889465332, 0.013814625330269337, 0.01779252476990223, 0.026485444977879524, -0.03665260225534439, -0.026815878227353096, 0.060392916202545166, -0.032128218561410904, -0.0024369405582547188, -0.07737206667661667, 0.015339698642492294, 0.04984448850154877, -0.039702750742435455, 0.03721179440617561, 0.020766418427228928, 0.017373129725456238, 0.041126150637865067, -0.012480185367166996, -0.05017492175102234, -0.028366368263959885, -0.009461810812354088, 0.03344994783401489, 0.02077912725508213, -0.018732987344264984, 0.02278714068233967, 0.0032090090680867434, -0.05358092114329338, -0.002260603941977024, -0.021262068301439285, -0.020512240007519722, 0.0051534781232476234, -0.03883854299783707, 0.02628210186958313, -0.012804264202713966, -0.02174500748515129, 0.03154360502958298, -0.007250454276800156, -0.018644025549292564, 0.0074347336776554585, -0.029662681743502617, 0.03787266090512276, -0.04895486310124397, -0.002239951863884926, 0.016496213153004646, 0.018466100096702576, 0.011590559035539627, -0.0028070886619389057, -0.002216122578829527, 0.014373818412423134, -0.013903588056564331, -0.006325878202915192, 0.0031947114039212465, -0.030857322737574577, -0.007053465582430363, 0.04257497191429138, -0.003494960255920887, 0.01926676370203495, -0.0272988174110651, 0.008794590830802917, -0.0008840661030262709, -0.03248406946659088, -0.012626338750123978, -0.028061354532837868, -0.05947786942124367, 0.009633381851017475, -0.00715513713657856, 0.020423278212547302, 0.007333062123507261, -0.017500219866633415, 0.00910595990717411, -0.023130282759666443, -0.004495789762586355, -0.02032160572707653, -0.03820309415459633, 0.04651474580168724, -0.037821825593709946, -0.0032947943545877934, 0.010014650411903858, 0.009163150563836098, -0.0017204736359417439, 0.012658110819756985, 0.014272146858274937, -0.0147932143881917, -0.0049310713075101376, -0.006723032798618078, -0.03909271955490112, 0.03151818737387657, -0.0158226378262043, -0.0014750321861356497, -0.016979152336716652, 0.03200112655758858, -0.008928035385906696, -0.03306867927312851, 0.015835348516702652, 0.04125324264168739, 0.0008443506667390466, -0.006427549757063389, -0.026307519525289536, -0.011539723724126816, -0.024375759065151215, 0.021808553487062454, 0.041583672165870667, -0.02513829618692398, 0.03494960442185402, -0.0072059729136526585, -0.004200306721031666, -0.00769526744261384, 0.007885901257395744, -0.008140080608427525, -0.01863131672143936, -0.01047852635383606, 0.020715583115816116, 0.01733500324189663, -0.024693483486771584, -0.01119022723287344, -0.02271088771522045, -0.01107584685087204, -0.008603956550359726, 0.0028356837574392557, 0.023918237537145615, -0.006792931817471981, 0.01316646859049797, -0.03881312161684036, 0.027451325207948685, -0.10787353664636612, 0.0038730516098439693, 0.029484756290912628, 0.011965473182499409, 0.0158226378262043, -0.022965066134929657, -0.009182213805615902, 0.008114662952721119, -0.02224065735936165, -0.04476090893149376, 0.013077505864202976, 0.015632005408406258, -0.002865867456421256, -0.013484192080795765, 0.03467000648379326, -0.010014650411903858, 0.005229731556028128, -0.00739660719409585, 0.010586552321910858, -0.026155011728405952, 0.021999185904860497, 0.020258061587810516, -0.02586270682513714, 0.004327396396547556, -0.02668878808617592, -0.02673962339758873, -0.012391222640872002, 0.0013566800625994802, 0.04252413660287857, -0.0006199583294801414, -0.01605140045285225, 0.0321028009057045, -0.01761459931731224, 0.018288174644112587, -0.03472084179520607, 0.009989231824874878, 0.008915326558053493, 0.015110937878489494, 0.01405609492212534, -0.03128942847251892, 0.026205848902463913, 5.33676466147881e-05, 0.010573843494057655, 0.031772367656230927, 0.012359450571238995, -0.008699273690581322, -0.024642648175358772, 0.015352407470345497, 0.0041462937369942665, 0.018999874591827393, 0.012365804985165596, 0.0036951261572539806, -0.024960370734333992, 1.3776299965684302e-05, 0.03131484612822533, 0.04755687713623047, -0.05673273652791977, -0.030069367960095406, 0.005814343225210905, 0.032865338027477264, -0.014297565445303917, -0.0015346052823588252, -0.003048558486625552, 5.247404988040216e-05, 0.005985913798213005, -0.013039379380643368, -0.02999311499297619, -0.009366493672132492, -0.017462093383073807, -0.012874162755906582, -0.015593877993524075, 0.00529645336791873, -0.027959682047367096, -0.012994898483157158, -0.0147932143881917, -0.012270487844944, -0.0041462937369942665, -0.0059064831584692, -0.006176548078656197, -0.0027228917460888624, 0.031111501157283783, -0.015466787852346897, -0.010764477774500847, 0.025621237233281136, -0.03311951458454132, 0.0022002363111823797, 0.0019111079163849354, 0.010484880767762661, 0.043362926691770554, 0.020791836082935333, 0.023638641461730003, 0.017284167930483818, 0.003073976607993245, -0.01300760731101036, -0.0444813147187233, -0.00869291927665472, -0.03362787142395973, -0.014945721253752708, 0.00523926317691803, 0.0025640300009399652, 0.006386245600879192, 0.04544719308614731, -0.017906906083226204, 0.013929005712270737, 0.009843079373240471, 0.020995179191231728, -0.013852751813828945, 0.010611970908939838, -0.02307944744825363, 0.03627133369445801, 0.0034917830489575863, 0.01798315905034542, 0.03934689983725548, 0.04656558111310005, -0.03952482342720032, -0.02834095060825348, 0.10106154531240463, -0.02656169794499874, 0.004139939323067665, 0.028086772188544273, -0.016750391572713852, 0.06064709275960922, 0.011431697756052017, 0.01059290673583746, -0.01886007748544216, 0.03375496342778206, 0.004467194899916649, 0.00523926317691803, -0.00271177152171731, 0.017055407166481018, 0.01619119755923748, 0.04750604182481766, -0.029103487730026245, 0.030298128724098206, -0.03688136488199234, -0.00465782918035984, 0.029001817107200623, -0.007777875289320946, -0.028976399451494217, -0.014094222337007523, -0.0064561450853943825, -0.01417047530412674, 0.04898028075695038, -0.002179584465920925, -0.014996557496488094, -0.0031947114039212465, -0.02058849297463894, -0.001265334547497332, 0.022227948531508446, -0.001750657451339066, 0.0090614790096879, 0.01561929564923048, -0.005321871489286423, 0.051445815712213516, -0.027908846735954285, 0.011832029558718204, -0.014831340871751308, -0.03467000648379326, -0.0215543732047081, -0.013662117533385754, -0.026892131194472313, 0.043235838413238525, -0.02563394606113434, 0.0004332956450525671, 6.509611921501346e-06, -0.022304201498627663, -0.011336380615830421, -0.009932042099535465, -0.024185124784708023, 0.03352620080113411, -0.019597195088863373, -0.006214675027877092, 0.038228511810302734, 0.007968509569764137, 0.018999874591827393, 0.03479709476232529, 0.0005202725296840072, -0.006519689690321684, 0.0001927192643051967, 0.05096287652850151, 0.0059700277633965015, 0.04140574857592583, -0.008953453041613102, 0.01614036224782467, 0.04727728292346001, 0.014221311546862125, -0.011431697756052017, 0.03342453017830849, -0.0025322576984763145, 0.002481421921402216, 0.0302727110683918, 0.012607275508344173, -0.010936048813164234, 0.01245476771146059, -0.003927064593881369, 0.003259844845160842, 0.060087900608778, 0.011609623208642006, -0.0011596913682296872, 0.03606799244880676, 0.03253490477800369, 0.04572679102420807, 0.028747636824846268, -0.021935641765594482, 0.010027359239757061, 0.030145620927214622, -0.018275465816259384, -0.012054435908794403, -0.02673962339758873, 0.02884930931031704, 0.007631722372025251, -0.03650009632110596, 0.002861101645976305, 0.004972375463694334, -0.03202654421329498, -0.009480874054133892, -0.0316452756524086, -0.0034314156509935856, -0.018199210986495018, -0.022037314251065254, -0.014246729202568531, -0.015568459406495094, -0.02930683083832264, 0.026078758761286736, -0.01275342795997858, 0.0001847761741373688, -0.023740312084555626, 0.026587117463350296, 0.027273399755358696, -0.008305296301841736, 0.009506291709840298, -0.00025417894357815385, -0.04303249344229698, 0.002730834996327758, 0.05444512888789177, -0.038508109748363495, 0.029662681743502617, -0.012874162755906582, -0.008928035385906696, 0.001255008508451283, 0.023193826898932457, 0.03431415557861328, 0.003949305042624474, -0.021732298657298088, 0.023930946364998817, 0.028366368263959885, 0.016763100400567055, 0.031441934406757355, 0.0012637459440156817, -0.004489435348659754, -0.0014210190856829286, 0.016305578872561455, 0.01650892198085785, 0.0037427847273647785, 0.01270894706249237, -0.03545796126127243, 0.003596632042899728, 0.01921592839062214, 0.0003004474565386772, 0.01561929564923048, -0.004730905406177044, 0.028290115296840668, 0.03766931965947151, 0.010427691042423248, -0.006240092683583498, -0.014716960489749908, -0.014234020374715328, 0.017080824822187424, 0.03192487359046936, 0.029484756290912628, -0.042092032730579376, 0.03380579873919487, 0.015809928998351097, 0.026993803679943085, 0.0028197974897921085, -0.011920992285013199, -0.019114255905151367, -0.026815878227353096, 0.019851375371217728, -0.004330573603510857, -0.05058160796761513, -0.015072810463607311, 0.011241063475608826, -0.02260921709239483, 0.031162338331341743, -0.03273824602365494, 0.024337632581591606, -0.04948863759636879, 0.01300125289708376, 0.009144087322056293, 0.02714630961418152, 0.03505127504467964, -0.020245352759957314, -0.01793232373893261, 0.015441370196640491, -0.010554780252277851, 0.007765166461467743, 0.009493582881987095, 0.03322118520736694, -0.013954423367977142, 0.006313169375061989, -0.021567082032561302, -0.004187597893178463, 0.006634070072323084, -0.010078194551169872, -0.0012764548882842064, 0.004101812373846769, -0.03779640793800354, -0.026307519525289536, -0.004213016014546156, -0.0394485704600811, -0.015060101635754108, 0.018135666847229004, 0.006710323970764875, 0.0010214815847575665, 0.03848269209265709, -0.007460151799023151, 0.006792931817471981, -0.0204105693846941, 0.024146998301148415, -0.019241346046328545, 0.03418706730008125, 0.035940900444984436, -0.004819868132472038, 0.03418706730008125, -0.024871408939361572, -0.0007831888506188989, 0.0019968932028859854, -0.003380579873919487, -0.002035020152106881, 0.021579790860414505, -0.02701922133564949, 0.015441370196640491, 0.019597195088863373, -0.031772367656230927, -0.020258061587810516, -0.06064709275960922, -0.022494835779070854, -0.01293135341256857, -0.04237162694334984, 0.0019508233526721597, -0.00018835056107491255, -0.020308896899223328, 0.002106508007273078, -0.007555468939244747, 0.0019984818063676357, 0.018872786313295364, 0.023562386631965637, 0.008794590830802917, -0.021173104643821716, 0.07086508721113205, 0.017512928694486618, 0.012105272151529789, 0.03329744189977646, -0.01596243679523468, -0.005429897457361221, -0.006996275391429663, 0.026815878227353096, -0.0037173668388277292, -0.008070181123912334, -0.031441934406757355, 0.013331685215234756, 0.020613912492990494, 0.015301572158932686, 0.03911813721060753, -0.01107584685087204, 0.0015036272816359997, -0.014094222337007523, 0.02457910217344761, 0.014920303598046303, 0.017373129725456238, 0.035890065133571625, -0.011126683093607426, -0.008680210448801517, 0.01089156698435545, -0.003977900370955467, 0.005881065037101507, -0.014755086973309517, 0.03863519802689552, 0.04430338740348816, -0.017830653116106987, 0.005909660365432501, 0.002792790997773409, -0.006634070072323084, -0.044328805059194565, -0.009754116646945477, 0.010872503742575645, 0.0090614790096879, 0.01293770782649517, -0.011412634514272213, 0.015670131891965866, -0.00887719914317131, 0.016114944592118263, 0.004349636845290661, 0.009569836780428886, 0.011107619851827621, -0.0021764070261269808, -0.03250948712229729, 0.011247417889535427, 0.018555061891674995, 0.005601468496024609, -0.012645401991903782, -0.017970450222492218, -0.01119022723287344, -0.004740437027066946, -0.009080542251467705, 0.001812613569200039, 0.0367034375667572, 0.009576191194355488, -0.019736994057893753, -0.00970328040421009, -0.009506291709840298, -0.020372441038489342, 0.017601890489459038, 0.005236085969954729, -0.05861366167664528, 0.00969692599028349, -0.02691754885017872, -0.01678851805627346, 0.03586464747786522, -0.016636012122035027, 0.016038691624999046, 0.01199724618345499, -0.0019682981073856354, -0.01061832532286644, 0.0031454642303287983, -0.004899298772215843, -0.03629675135016441, 0.002640283666551113, 0.020105553790926933, 0.03774557262659073, -0.002616454381495714, -0.017080824822187424, 0.0178814884275198, -0.04732811823487282, 0.0007712742080911994, 0.014831340871751308, -0.03197570890188217, 0.00046506800572387874, -0.004543448332697153, 0.03949940577149391, 0.0008427620050497353, -0.020397858694195747, 0.03220447152853012, 0.01013538520783186, 0.0077588120475411415, 0.004568866454064846, 0.014437363483011723, 0.012130689807236195, -0.0049787298776209354, 0.0362459160387516, 0.0005111379432491958, 0.00620514340698719, 0.03388205170631409, -0.017487511038780212, -0.005839760880917311, -0.018567770719528198, -0.016025980934500694, -0.02765466831624508, 0.023905528709292412, -0.009690571576356888, 0.008928035385906696, -0.0008769173291511834, 0.016763100400567055, 0.008902616798877716, -0.009525355882942677, -0.030857322737574577, 0.03131484612822533, -0.03398372232913971, -0.03367871046066284, 0.0275275781750679, -0.007765166461467743, 0.014081512577831745, -0.004368700552731752, -0.006907312665134668, -0.0060272179543972015, 0.012327678501605988, -0.03329744189977646, -0.006014509126543999, 0.013395230285823345, -0.003058090340346098, 0.012035372667014599, 0.012721655890345573, -0.039601076394319534, -0.019978463649749756, -0.016750391572713852, -0.008057472296059132, -0.017182495445013046, -0.024731609970331192, 0.01431027427315712, 0.008108307607471943, 0.014246729202568531, -0.02260921709239483, -0.03233155980706215, 0.010465817525982857, 0.009576191194355488, -0.007765166461467743, -0.014602580107748508, 0.005547455046325922, 0.009029706940054893, -0.011044074781239033, -0.01931759901344776, 0.032814498990774155, -0.01357315480709076, 0.01353502832353115, -0.022494835779070854, 0.009277530945837498, -0.04308332875370979, -0.03642383962869644, 0.0057380893267691135, 0.03250948712229729, -0.011476178653538227, -0.014818632043898106, 0.004311510361731052, 0.02293964847922325, 0.03957565873861313, 0.0040319133549928665, 0.010631034150719643, -0.007136073429137468, 0.010440399870276451, -0.028035936877131462, -0.0016005330253392458, -0.009372848086059093, 0.03815225884318352, 0.01912696473300457, 0.014361109584569931, 0.0017490688478574157, -0.017284167930483818, -0.021389156579971313, -0.0268412958830595, -0.011222000233829021, 0.0005210668314248323, 0.0012383280554786325, 0.010383209213614464, -0.009004288353025913, 0.024693483486771584, 0.0012629515258595347, -0.015720967203378677, -0.03182320296764374, -0.04422713443636894, 0.024477431550621986, -0.010268828831613064, -0.009639736264944077, -0.006811995524913073, 0.011552432551980019, 0.015530332922935486, -0.0017172964289784431, 0.007593595888465643, 0.017945032566785812, 0.007282226346433163, 0.010129030793905258, -0.0031295781955122948, 0.0009221929358318448, 0.0043782321736216545, -0.006526044104248285, -0.0017728980164974928, -0.011711294762790203, -0.005709494464099407, -0.0011962295975536108, -0.013585863634943962, -0.013102924451231956, 0.014742378145456314, 0.016178488731384277, -0.015403243713080883, 0.030984412878751755, -0.01387816946953535, 0.009156796149909496, 0.008959807455539703, 0.009449101984500885, -0.04778563976287842, -0.020524948835372925, -0.020372441038489342, 0.021134978160262108, -0.004305155482143164, 0.01995304599404335, -0.00887719914317131, 0.0185804795473814, -0.004422713536769152, -0.014157766476273537, 0.02839178778231144, 0.015937019139528275, -0.028645966202020645, -0.012461122125387192, -0.0021335144992917776, 0.01921592839062214, -0.04590471461415291, -0.020842673256993294, -0.020804544910788536, 0.03276366367936134, -0.02023264393210411, -0.030043950304389, 0.03858436271548271, -0.019254054874181747, 0.005753975827246904, 0.007841420359909534, 0.015517624095082283, 0.016114944592118263, 0.019838666543364525, 0.015530332922935486, 0.021846679970622063, 0.0183517187833786, 0.037542227655649185, 0.0017586004687473178, -0.05058160796761513, 0.02023264393210411, 0.007873192429542542, 0.009436393156647682, -0.014589871279895306, 0.008673856034874916, 0.01770356297492981, -0.012994898483157158, -0.006030395161360502, 0.03444124385714531, -0.0094046201556921, 0.03261115774512291, 0.016127653419971466, -0.004136762116104364, -0.02793426439166069, -0.016826646402478218, 0.019152382388710976, 7.167399189711432e-07, -0.019457397982478142, 0.0009285474079661071, -0.017347712069749832, 0.004524385090917349, 0.027908846735954285, -0.010853440500795841, -0.046387653797864914, 0.01636912301182747, -0.02183397114276886, -0.026205848902463913, -0.0031168691348284483, -0.0041717118583619595, -0.0048961215652525425, 0.00366335385479033, 0.03586464747786522, -0.022367745637893677, 0.00021605209622066468, 0.01328084897249937, 0.02252025343477726, 0.016686847433447838, -0.011222000233829021, 0.01821191981434822, -0.018999874591827393, 0.020258061587810516, 0.030857322737574577, -0.0015473142266273499, -0.031162338331341743, 0.005086755845695734, -0.0089407442137599, -0.015161773189902306, -0.046438492834568024, 0.014933012425899506, -0.01371295377612114, -0.008889907971024513, 0.019343016669154167, 0.02032160572707653, 0.017805233597755432, -0.0527675487101078, 0.010904276743531227, 0.031213173642754555, -0.015174482017755508, 0.016394540667533875, 0.0007446648669429123, -0.010573843494057655, 0.0015949727967381477, 0.008254460990428925, -0.004791272804141045, 0.0015139533206820488, 0.008146435022354126, -0.0052996305748820305, -0.011507951654493809, 0.029383085668087006, -0.005747620947659016, 0.06201966106891632, 0.001807847642339766, -0.0367034375667572, 0.03037438355386257, 0.006659488193690777, -0.014094222337007523, -0.008603956550359726, -0.000562370871193707, 0.012334032915532589, 0.0041717118583619595, 0.00946816522628069, -0.004749968647956848, -0.008858135901391506, 0.012740719132125378, 0.0066849058493971825, 0.014551743865013123, -0.011895573697984219, -0.03266199305653572, 0.008642083965241909, 0.009531710296869278, 0.0026291634421795607, 0.05187791958451271, -0.019660741090774536, -0.03311951458454132, 0.0012899581342935562, -0.015326989814639091, -0.03207738324999809, 0.016216615214943886, 0.03535629063844681, -0.01779252476990223, -0.0017252395628020167, 0.01376378908753395, 0.005315517075359821, 0.014437363483011723, -0.01476779580116272, 0.001374949119053781, 0.01601327210664749, 0.02114768698811531, 0.010840731672942638, 0.03228072449564934, -0.006497449241578579, -0.0029357667081058025, 0.018237339332699776, 0.022189820185303688, 0.0020318429451435804, -0.00661500683054328, -0.01539053488522768, 0.011069492436945438, 0.027222564443945885, -0.000980971846729517, 0.014640706591308117, -0.01886007748544216, -0.022901521995663643, -0.043642524629831314, 0.022863395512104034, -0.009563482366502285, 0.04005860164761543, -0.02457910217344761, 0.014983848668634892, 0.0011676345020532608, -0.01453903503715992, -0.018237339332699776, -0.01162868645042181, -0.027603833004832268, -0.007987572811543941]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-14T10:14:49.708638", "url_path": "/api/models/test/", "chunk_size": 4722}
updated_dt: 2025-03-14T10:14:49.709268
---
`.'
      # check if there are any retry prompts, if so retry them
      new_retry_names = {p.tool_name for p in last_message.parts if isinstance(p, RetryPromptPart)}
      if new_retry_names:
        # Handle retries for both function tools and result tools
        # Check function tools first
        retry_parts: list[ModelResponsePart] = [
          ToolCallPart(name, self.gen_tool_args(args)) for name, args in tool_calls if name in new_retry_names
        ]
        # Check result tools
        if result_tools:
          retry_parts.extend(
            [
              ToolCallPart(
                tool.name,
                result.value
                if isinstance(result, _FunctionToolResult) and result.value is not None
                else self.gen_tool_args(tool),
              )
              for tool in result_tools
              if tool.name in new_retry_names
            ]
          )
        return ModelResponse(parts=retry_parts, model_name=self._model_name)
    if isinstance(result, _TextResult):
      if (response_text := result.value) is None:
        # build up details of tool responses
        output: dict[str, Any] = {}
        for message in messages:
          if isinstance(message, ModelRequest):
            for part in message.parts:
              if isinstance(part, ToolReturnPart):
                output[part.tool_name] = part.content
        if output:
          return ModelResponse(
            parts=[TextPart(pydantic_core.to_json(output).decode())], model_name=self._model_name
          )
        else:
          return ModelResponse(parts=[TextPart('success (no tool calls)')], model_name=self._model_name)
      else:
        return ModelResponse(parts=[TextPart(response_text)], model_name=self._model_name)
    else:
      assert result_tools, 'No result tools provided'
      custom_result_args = result.value
      result_tool = result_tools[self.seed % len(result_tools)]
      if custom_result_args is not None:
        return ModelResponse(
          parts=[ToolCallPart(result_tool.name, custom_result_args)], model_name=self._model_name
        )
      else:
        response_args = self.gen_tool_args(result_tool)
        return ModelResponse(parts=[ToolCallPart(result_tool.name, response_args)], model_name=self._model_name)

```
  
---|---  
####  call_tools `class-attribute` `instance-attribute`
```
call_tools: list[](https://docs.python.org/3/library/stdtypes.html#list)[str[](https://docs.python.org/3/library/stdtypes.html#str)] | Literal[](https://docs.python.org/3/library/typing.html#typing.Literal "typing.Literal")['all'] = 'all'

```

List of tools to call. If `'all'`, all tools will be called.
####  custom_result_text `class-attribute` `instance-attribute`
```
custom_result_text: str[](https://docs.python.org/3/library/stdtypes.html#str) | None = None

```

If set, this text is returned as the final result.
####  custom_result_args `class-attribute` `instance-attribute`
```
custom_result_args: Any[](https://docs.python.org/3/library/typing.html#typing.Any "typing.Any") | None = None

```

If set, these args will be passed to the result tool.
####  seed `class-attribute` `instance-attribute`
```
seed: int[](https://docs.python.org/3/library/functions.html#int) = 0

```

Seed for generating random data.
####  last_model_request_parameters `class-attribute` `instance-attribute`
```
last_model_request_parameters: (
  ModelRequestParameters[](https://ai.pydantic.dev/api/models/base/#pydantic_ai.models.ModelRequestParameters "pydantic_ai.models.ModelRequestParameters") | None
) = field[](https://docs.python.org/3/library/dataclasses.html#dataclasses.field "dataclasses.field")(default=None, init=False)

```

The last ModelRequestParameters passed to the model in a request.
The ModelRequestParameters contains information about the function and result tools available during request handling.
This is set when a request is made, so will reflect the function tools from the last step of the last run.
####  model_name `property`
```
model_name: str[](https://docs.python.org/3/library/stdtypes.html#str)

```

The model name.
####  system `property`
```
system: str[](https://docs.python.org/3/library/stdtypes.html#str) | None

```

The system / model provider.
###  TestStreamedResponse `dataclass`
Bases: `StreamedResponse[](https://ai.pydantic.dev/api/models/base/#pydantic_ai.models.StreamedResponse "pydantic_ai.models.StreamedResponse")`
A structured response that streams test data.
Source code in `pydantic_ai_slim/pydantic_ai/models/test.py`
```
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
```
|