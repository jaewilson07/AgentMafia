---
url: https://ai.pydantic.dev/api/pydantic_graph/graph/
session_id: pydantic_ai_docs
chunk_number: 5
title: Graph Node Execution in Pydantic
summary: This section outlines the process of executing nodes in a graph, including state management, dependency handling, and error messaging. It discusses the handling of the `End` node and the conditions under which to infer graph names.
embedding: [0.06294403970241547, 0.027241429314017296, -0.043648961931467056, -0.05031941831111908, 0.024264346808195114, 0.010358234867453575, -0.014605614356696606, -0.0063067153096199036, -0.01630680449306965, 0.04530538618564606, 0.0025210073217749596, -0.01113608106970787, 0.002774227410554886, -0.0836717039346695, 0.018880974501371384, 0.013519986532628536, -0.02574169635772705, 0.005629596766084433, -0.0037381418514996767, 0.03315082564949989, 0.04194777086377144, -0.005002842750400305, 0.03879161551594734, 0.014359389431774616, 0.010733167640864849, 0.020268786698579788, -0.022731035947799683, 0.06052656099200249, 0.024958252906799316, 0.012244093231856823, -0.014157932251691818, -0.014392965473234653, -0.016429917886853218, -0.023570438846945763, -0.0008156200055964291, 0.0065641324035823345, 0.011365517973899841, 0.0015221176436170936, -0.00616681482642889, 0.021757328882813454, 0.0152771370485425, -0.062227752059698105, -0.013990052044391632, 0.008539527654647827, -0.015098064206540585, 0.014460117556154728, -0.004188621416687965, 0.0553334541618824, 0.025361165404319763, -0.00569115299731493, -0.03247930482029915, 0.0021418770775198936, -0.019675608724355698, -0.00017924753774423152, -0.06648072600364685, -0.025831231847405434, -0.0005753408768214285, -0.024577723816037178, -0.01569124311208725, -0.02000017836689949, 0.04015704616904259, -0.00571913318708539, 0.019944218918681145, 0.021175343543291092, -0.03973174840211868, 0.052781667560338974, -0.010990585200488567, 0.05716894939541817, 0.0258760005235672, -0.00436769425868988, 0.04049280658364296, 0.032165925949811935, -0.028830699622631073, -0.05712417885661125, -0.012714159674942493, -0.05502007529139519, 0.02862924337387085, 0.028763547539711, 0.0003917214635293931, -0.028092024847865105, -0.0025014213752001524, -0.0007463693036697805, -0.01227766927331686, 0.00730840303003788, 0.014258661307394505, -0.054303787648677826, -0.033464204519987106, -0.044253334403038025, -0.018410908058285713, -0.023906201124191284, 0.012647006660699844, -0.056363120675086975, -0.05734802037477493, 0.04338035359978676, 0.048573460429906845, 0.026569906622171402, -0.012255285866558552, -0.012378398329019547, -0.010610055178403854, -0.007151714526116848, 0.004493604879826307, -0.04360419511795044, -0.06088470667600632, 0.0018718689680099487, 0.02659229002892971, 0.023077988997101784, -0.015590514056384563, 0.04105240851640701, 0.003324036253616214, -0.019351039081811905, -0.040918104350566864, 0.006894297432154417, 0.009569196030497551, 0.037068042904138565, -0.04467862844467163, -0.030576657503843307, -0.02609984017908573, 0.01855640485882759, 0.01964203268289566, -0.014851839281618595, -0.05810907855629921, -0.04897637292742729, -0.007028602063655853, 0.004012346733361483, 0.008578700013458729, -0.023682359606027603, -0.05112524703145027, 0.03722472861409187, 0.0035282911267131567, 0.03344181925058365, -0.013408065773546696, -0.012624623253941536, -0.0010569484438747168, -0.07601634413003922, 0.018175875768065453, 0.006452212110161781, -0.06867437064647675, -0.029502222314476967, 0.012210517190396786, 0.04291028901934624, 0.05578113719820976, -0.03572499752044678, -0.025562623515725136, -0.00909912958741188, 0.018612364307045937, 0.04333558678627014, -0.043402738869190216, 0.037314265966415405, -0.03091241978108883, -0.010033665224909782, 0.069927878677845, 0.036127910017967224, 0.01274773571640253, 0.005948570091277361, 0.037291884422302246, -0.007090158294886351, 0.0017011903692036867, -0.011298365890979767, 0.012893231585621834, -0.007179694715887308, -0.0644213929772377, 0.03415811061859131, -0.042350687086582184, -0.03435956686735153, -0.024465803056955338, 0.01036942657083273, -0.06178006902337074, -0.006793569307774305, -0.021007461473345757, -0.0026147407479584217, 0.005842245649546385, -0.05282643809914589, 0.008685024455189705, 0.013117073103785515, 0.011460650712251663, -0.009194262325763702, -0.05954166129231453, -0.028450170531868935, 0.003463936969637871, -0.005319017916917801, -0.018410908058285713, -0.00604929868131876, -0.07489714026451111, 0.015769585967063904, -0.07279303669929504, -0.013150649145245552, 0.00739234359934926, 0.05152815952897072, 0.024219578132033348, 0.056497424840927124, -0.04192538931965828, 0.020772429183125496, 0.008427606895565987, -0.04228353500366211, -0.005540060810744762, -0.007280423305928707, 0.08913341909646988, -0.0004896518075838685, 0.008942441083490849, 0.03355374187231064, 0.004728637635707855, 0.03283745050430298, 0.03317321091890335, -0.033598508685827255, 0.01347521785646677, -0.00886409729719162, -0.024935869500041008, -0.05188630521297455, 0.04633505269885063, -0.04875253513455391, 0.008757772855460644, 0.010386214591562748, 0.014415349811315536, 0.00035849507548846304, 0.028092024847865105, 0.005791881587356329, -0.03930645063519478, 0.014516077935695648, 0.02132083848118782, 0.026771362870931625, 0.0005067896563559771, 0.052871204912662506, -0.014225085265934467, -0.0036597975995391607, 0.019809912890195847, -5.477979721035808e-05, 0.012814887799322605, -0.04358180984854698, 0.010587671771645546, 0.08255250006914139, 0.008685024455189705, -0.00869062077254057, -0.002865162678062916, -0.024756796658039093, -0.004854548256844282, -0.038881152868270874, -0.026547523215413094, -0.011774027720093727, 0.017884882166981697, 0.00839403085410595, -0.010587671771645546, 0.027151893824338913, 0.02109699882566929, -0.021164150908589363, 0.02034713141620159, 0.02768911048769951, -0.015747202560305595, -0.03713519498705864, 0.009446083568036556, 0.020895542576909065, 0.016955943778157234, 0.006939065642654896, 0.019821105524897575, -0.026748979464173317, -0.014247468672692776, -0.03800817206501961, -0.03594883903861046, -0.029905134811997414, -0.022193819284439087, 0.019328655675053596, 0.03773956373333931, -0.0021152959670871496, -0.051931072026491165, -7.484677917091176e-05, -0.024823948740959167, 0.01653064601123333, 0.016866406425833702, -0.031449638307094574, -0.011527802795171738, -0.0452830009162426, 0.007174098864197731, 0.002912728814408183, 0.024846332147717476, 0.023391367867588997, -0.015903891995549202, 0.040425654500722885, 0.0017123824218288064, 0.06486907601356506, 0.02310037426650524, -0.04637981951236725, 0.00775608466938138, 0.017515545710921288, 0.058377690613269806, 0.03366566076874733, 0.001800519647076726, 0.004141055513173342, -0.005914994049817324, 0.018623556941747665, 0.05399040877819061, -0.032524071633815765, 0.026144608855247498, 0.009395718574523926, 0.012322437949478626, -0.014113164506852627, -0.0023922990076243877, -0.019351039081811905, 0.032054007053375244, 0.05399040877819061, 0.004462826531380415, 0.005131551064550877, -0.007375555578619242, -0.02130964770913124, 0.015142831951379776, 0.012758927419781685, 0.015355480834841728, 0.050364188849925995, -0.03393426910042763, -0.045439690351486206, 0.04888683930039406, 0.011527802795171738, -0.0397765152156353, 0.0036653936840593815, 0.006082874722778797, 0.025249246507883072, 0.02361520752310753, 0.030643809586763382, 0.05305027589201927, -0.0330389067530632, -0.006608900614082813, -0.033732812851667404, 0.0062227752059698105, -0.032031621783971786, 0.03212115913629532, 0.046648427844047546, -0.03377758339047432, -0.0020803208462893963, -0.02108580619096756, -0.010044856928288937, 0.02348090335726738, 0.030240897089242935, -0.006357079837471247, -0.011102505028247833, 0.019966602325439453, 0.03872446343302727, 0.05403517559170723, -0.05152815952897072, -0.02574169635772705, 0.0019628042355179787, 0.025585006922483444, 0.047364719212055206, -0.04279836639761925, -0.021522296592593193, -0.01478468719869852, -0.05712417885661125, -0.021589448675513268, 0.039507906883955, -0.01299396064132452, 0.040918104350566864, 0.014415349811315536, -0.043895188719034195, -0.001748756505548954, 0.02419719472527504, 0.062362056225538254, 0.033128444105386734, 0.015142831951379776, 0.004650293383747339, -0.011427074670791626, 0.003766122041270137, 0.02804725617170334, 0.02193640172481537, -0.0361950621008873, -0.002904334804043174, -0.03765002638101578, -0.002760237315669656, -0.04109717532992363, -0.013956476002931595, -0.04812577739357948, 0.06254112720489502, 0.06348125636577606, -0.00037878064904361963, 0.0356578454375267, 0.03341943770647049, 0.005153934936970472, 0.01263581495732069, -0.04396234080195427, -0.0004938488127663732, -0.007179694715887308, 0.011253598146140575, 0.02106342278420925, 0.06616734713315964, -0.007207674905657768, 0.015590514056384563, 0.016194883733987808, 0.03568022698163986, -0.03344181925058365, -0.007252443116158247, 0.03691135346889496, -0.006429827772080898, -0.00012075163976987824, 0.031785398721694946, 0.04758856073021889, -0.06231728941202164, -0.016105348244309425, -0.008063865825533867, -0.0009100529132410884, 0.024264346808195114, 0.013766211457550526, -0.04011227563023567, 0.04781240224838257, 0.0222945474088192, 0.004062711261212826, 0.0120426369830966, 0.012490318156778812, -0.012490318156778812, -0.00320651987567544, -0.01759388856589794, 0.07028602063655853, -0.0034667348954826593, -0.016217269003391266, -0.004899316001683474, 0.01998898573219776, 0.00730840303003788, 0.005727527197450399, -0.061645764857530594, -0.022081898525357246, -0.05399040877819061, 0.003175741760060191, -0.01132075022906065, 0.008852904662489891, 0.006105258595198393, -0.03368804603815079, -0.05573636665940285, 0.008763368241488934, -0.027129508554935455, -0.02753242291510105, 0.06339172273874283, 0.012188133783638477, -0.04040326923131943, 0.044253334403038025, -0.023794280365109444, -0.00831568706780672, 0.009373335167765617, 0.01402362808585167, 0.007235655095428228, 0.041992541402578354, -0.02923361212015152, -0.02252957969903946, 0.005534464493393898, 0.0002467495505698025, -0.03740380331873894, 0.00479578971862793, -0.026771362870931625, 0.04172392934560776, 0.020179251208901405, -0.027487654238939285, -0.03158394247293472, -0.0019236321095377207, -0.030039438977837563, 0.02013448253273964, -0.019373424351215363, 0.017224552109837532, -0.011650915257632732, -0.027868183329701424, -0.012378398329019547, -0.01700071059167385, -0.016362763941287994, 0.04861822724342346, -0.006815953180193901, 0.017034286633133888, -0.05963119864463806, -0.006648072507232428, 0.034695327281951904, -0.016933558508753777, 0.035881686955690384, -0.009205454029142857, -0.013307337649166584, 0.013340913690626621, 0.01413554884493351, 0.008063865825533867, 0.02240646816790104, 0.018265411257743835, -0.03259122371673584, -0.016732102259993553, -0.008455587550997734, 0.001210139482282102, -0.016317997127771378, -0.029054539278149605, 0.027465270832180977, 0.047991473227739334, 0.012546278536319733, -0.05434855446219444, -0.029502222314476967, 0.01442654151469469, -0.0378514863550663, -0.006362675689160824, -0.005942974239587784, 0.002502820221707225, -0.046648427844047546, -0.00784002523869276, 0.016452301293611526, -0.0005592523375526071, 0.02491348423063755, 0.020582163706421852, -0.008724196814000607, 0.013307337649166584, 0.007470687851309776, -0.055154379457235336, -0.023861432448029518, 0.024376267567276955, -0.02956937439739704, -0.023055605590343475, -0.03856777399778366, 0.01035263855010271, 0.021298455074429512, -0.011538994498550892, -0.10878664255142212, 0.02276461198925972, 0.0009653135784901679, 0.012143365107476711, 0.016217269003391266, -0.022227395325899124, -0.007246846798807383, 0.01317303255200386, 0.016452301293611526, 0.002223019255325198, 0.002445460995659232, -0.02082838863134384, 0.014963760040700436, 0.0033044503070414066, 0.004765011835843325, -0.03041996993124485, -0.03545638918876648, 0.007728104945272207, 0.014829454943537712, -0.0010751355439424515, -0.0001598363451194018, 0.031919702887535095, -0.06603304296731949, 0.007537839934229851, -0.020156867802143097, 0.032747913151979446, 0.02670421078801155, -0.026189377531409264, 0.03415811061859131, -0.029882751405239105, -0.034449104219675064, -0.012915615923702717, 0.021466335281729698, -0.037090424448251724, -0.006648072507232428, 0.002635725773870945, 0.021779712289571762, -0.0022901715710759163, -0.006541748531162739, 0.0038164861034601927, -0.017045479267835617, 0.02145514450967312, -0.035859301686286926, 0.007280423305928707, 0.003556271316483617, -0.00016132279415614903, -0.009496447630226612, 0.005604414734989405, -0.04687226936221123, -0.015747202560305595, 0.008047077804803848, -0.00015205437375698239, -0.018892167136073112, 0.0016592202009633183, 0.00683274120092392, 0.009160686284303665, -0.000874378252774477, 0.03136010095477104, 0.03568022698163986, -0.01688879169523716, 0.048215314745903015, 0.03149440512061119, 0.004765011835843325, -0.022104281932115555, 0.024734411388635635, 0.045439690351486206, -0.05604974552989006, 0.03254645690321922, -0.05618404969573021, 0.018041571602225304, -0.02645798586308956, -0.0008044280111789703, -0.011007373221218586, -0.00529943173751235, 0.007834428921341896, -0.052065376192331314, -0.01274773571640253, 0.0038360722828656435, 0.0016718112165108323, -0.02263030782341957, 0.025943152606487274, -0.0203695148229599, -0.004619515035301447, 0.015668857842683792, -0.035254932940006256, -0.03937360271811485, 0.014157932251691818, -0.011029756627976894, 0.006871913559734821, -0.005870225839316845, 0.010733167640864849, 0.023033222183585167, -0.006099662743508816, -0.05027465149760246, 0.014303429052233696, 0.02670421078801155, -0.0003044585173483938, -0.013564754277467728, 0.06334695219993591, -0.01963084191083908, 0.020985078066587448, 0.016485877335071564, -0.0024342690594494343, -0.0183101799339056, -0.0049692667089402676, -0.054438091814517975, 0.019608456641435623, -0.03632936626672745, -0.013049920089542866, -0.00940131489187479, 0.0038108902517706156, -0.028203945606946945, 0.033240363001823425, 0.02672659605741501, -0.04902114346623421, 0.01782892271876335, 0.013061112724244595, 0.007409131620079279, 0.010391810908913612, -0.004661485552787781, -0.002420278964564204, -0.02419719472527504, 0.028830699622631073, -0.02468964457511902, -0.03615029528737068, -0.04447717219591141, -0.02804725617170334, 0.01735885627567768, 0.010274293832480907, -0.038858767598867416, -0.00436769425868988, 0.019227927550673485, -0.00345834088511765, -0.0037297478411346674, 0.01914958283305168, 0.02874116227030754, 0.013363298028707504, -0.031046723946928978, 0.022540772333741188, 0.0021418770775198936, 0.02202593721449375, -0.013799787499010563, 0.03053188882768154, -0.00025514356093481183, 0.008819328621029854, -0.029188845306634903, -0.0007309802458621562, -0.0033324304968118668, 0.0005781389190815389, -0.0005403657560236752, -0.014392965473234653, -0.003556271316483617, -0.03608314320445061, -0.043178897351026535, 9.032327216118574e-05, -0.02430911362171173, 0.01918315887451172, -0.038881152868270874, 0.005400159861892462, -0.017056671902537346, 0.05399040877819061, 0.0018914550310000777, 0.008657043799757957, 0.01252389419823885, -0.0028413794934749603, 0.003477926831692457, 0.03200924023985863, 0.0426640622317791, 0.007644164375960827, -0.008321283385157585, -0.008181381970643997, 0.003844466293230653, -0.016441108658909798, -0.0014437733916565776, 0.04655889421701431, -0.01035263855010271, -0.0011660708114504814, -0.03198685497045517, 0.01630680449306965, 0.0663464218378067, -0.015366673469543457, -0.018589980900287628, 0.013340913690626621, 0.022093089297413826, -0.0010100817307829857, -0.03487440198659897, -0.0011331941932439804, -0.005400159861892462, 0.013990052044391632, -0.00940131489187479, 0.039709363132715225, 0.002105502877384424, 0.047499023377895355, 0.016082962974905968, -0.03245691955089569, 0.02791295200586319, -0.01698951981961727, -0.016810446977615356, 0.02217143401503563, 0.0055932230316102505, -0.001912440056912601, -0.004924498498439789, 0.01747077703475952, -0.0028903447091579437, -0.029681295156478882, -0.010610055178403854, 0.0015626888489350677, -0.054214250296354294, 0.0058030737563967705, -0.008528335951268673, -0.002491628285497427, 0.014907799661159515, 0.002306959591805935, -0.03556830808520317, -0.014303429052233696, 0.014247468672692776, 0.014851839281618595, -0.0520206093788147, -0.0022761814761906862, -0.0008170190267264843, -0.01882501319050789, 0.0033324304968118668, 0.012479126453399658, -0.011343134567141533, -0.03362089395523071, -0.05094617232680321, 0.031785398721694946, 0.018612364307045937, 0.019586073234677315, -0.038164861500263214, -0.012926807627081871, -0.013542369939386845, -0.002700079930946231, -0.005291037727147341, -0.009244626387953758, -0.03174062818288803, 0.015187600627541542, 0.016351573169231415, -0.024264346808195114, -0.013105880469083786, -0.05788524076342583, -0.02238408289849758, 0.015993427485227585, 0.012647006660699844, 0.03147201985120773, 0.003405178664252162, 0.006071682553738356, -0.015154024586081505, -0.026569906622171402, 0.053229350596666336, 0.033844735473394394, 0.03306129202246666, -0.00024202790518756956, -0.01773938536643982, 0.047857169061899185, -0.04946882277727127, -0.016474684700369835, -0.0042166016064584255, 0.02549547143280506, 0.004434846341609955, -0.02791295200586319, 0.03449387103319168, 0.03317321091890335, -0.010610055178403854, -0.007386747281998396, -0.045238230377435684, -0.007688932586461306, -0.00694466196000576, 0.01855640485882759, 0.023570438846945763, -0.02885308302938938, 0.027957720682024956, -0.03272552788257599, 0.021041037514805794, -0.01006164588034153, 0.013251377269625664, 0.007252443116158247, 0.015411441214382648, 0.024622492492198944, 0.03594883903861046, 0.006004530470818281, -0.038523007184267044, -0.01712382398545742, -0.008914461359381676, -0.018836205825209618, -0.05842245742678642, -0.06585397571325302, 0.02312275767326355, 0.00797432940453291, -0.0051511372439563274, -0.0035450791474431753, 0.013161840848624706, -0.08819328993558884, -0.010850684717297554, 0.03362089395523071, 0.0021404779981821775, 0.016082962974905968, 0.006871913559734821, -0.010246314108371735, -0.01700071059167385, 0.00454956479370594, -0.042350687086582184, -0.02849493734538555, -0.011180849745869637, 0.014986143447458744, -0.001439576386474073, 0.00454956479370594, 0.008158998563885689, -0.02659229002892971, -0.017056671902537346, 0.0074259196408092976, -0.02156706340610981, -0.011343134567141533, -0.020436668768525124, 0.007733700796961784, 0.00042110055801458657, 0.042328301817178726, -0.0009562200284563005, 0.003522695042192936, 0.007235655095428228, 0.006116450764238834, 0.010229526087641716, 0.02348090335726738, -0.01929507963359356, -0.019496535882353783, -0.006334695499390364, -0.030867651104927063, 0.03608314320445061, 0.02096269465982914, 0.015713626518845558, 0.022943684831261635, -0.03270314633846283, 0.0034555429592728615, -0.025965536013245583, -0.0020453454926609993, 0.007123734336346388, 0.01869070902466774, -0.0026385236997157335, -0.028965003788471222, 0.010212738066911697, -0.014851839281618595, 0.009322971105575562, -0.03174062818288803, 0.023771896958351135, 0.010643631219863892, -0.013374489732086658, 0.031225796788930893, 0.028226329013705254, -0.027375733479857445, -0.03196446970105171, -0.008948037400841713, 0.03292698785662651, 0.036217447370290756, 0.022786997258663177, -0.008035886101424694, -0.047991473227739334, -0.008774560876190662, -0.015859123319387436, -0.010503730736672878, -0.044007107615470886, 0.009177474305033684, -0.029546989127993584, 0.0005011936300434172, -0.0030945995822548866, -0.010246314108371735, -0.035053472965955734, -0.019116006791591644, 0.012949191965162754, 0.0072412509471178055, -0.020929118618369102, 0.004742627497762442, -0.01526594441384077, -0.011919524520635605, 0.004356502089649439, 0.043313201516866684, 0.018243027850985527, 0.01508687250316143, -0.006508172024041414, 0.014247468672692776, 0.014773494563996792, -0.009793036617338657, 0.01095700915902853, -0.015344289131462574, 0.02060454897582531, 0.027756262570619583, -0.00833247508853674, 3.0958453862695023e-06, -0.029054539278149605, 0.02851732261478901, 0.013743827119469643, 0.04326843470335007, -0.03521016240119934, 0.005651981104165316, 0.03371042758226395, -0.010587671771645546, 0.017638657242059708, -0.027263812720775604, 0.04888683930039406, -0.01029667817056179, 0.0033967846538871527, -0.03404619172215462, 0.01185237243771553, 0.017873691394925117, 0.03529969975352287, -1.935654836415779e-05, -0.012535086832940578, -0.02238408289849758, -0.002543391427025199, 0.004709051456302404, 0.0012171345297247171, -0.009748267941176891, 0.005137146916240454, -0.02549547143280506, 0.010632439516484737, -0.010302274487912655, 0.024040505290031433, -0.01407958846539259, -0.004082296974956989, -0.00194601621478796, -0.001873267930932343, -0.021858057007193565, 0.03556830808520317, -0.026569906622171402, 0.02144395187497139, -0.04071664810180664, 0.06455569714307785, 0.009082341566681862, -0.0037577280309051275, 0.014180316589772701, 0.0005008438602089882, -0.020044947043061256, 0.008634660392999649, -0.029144076630473137, -0.0022901715710759163, 0.01832137256860733, -0.03653082251548767, -0.03691135346889496, -0.00500564044341445, 0.014762302860617638, -0.011885948479175568, -0.02240646816790104, 0.005193107295781374, -0.014348197728395462, 0.006536152213811874, 0.028651626780629158, -0.013755018822848797, 0.003268076106905937, 0.06213821470737457, -0.017683425918221474, -0.004180227406322956, -0.01822064444422722, -0.011785219423472881, -0.017549121752381325, 0.041522473096847534, -0.007347575388848782, -0.005514878313988447, -0.013497602194547653, -0.01036942657083273, -0.0018229037523269653, 0.015500977635383606, -0.047857169061899185, 0.022484811022877693, -0.0021810492035001516, 0.031695861369371414, 0.030934803187847137, -0.013262568973004818, 0.039507906883955, 0.04219399765133858, 0.05354272574186325, 0.000854792189784348, -0.006010126322507858, 0.0465141236782074, -0.018466869369149208, 0.02565215900540352, 0.007106946315616369, 0.05076710134744644, 0.029681295156478882, -0.012837272137403488, 0.03760525956749916, 0.005610011052340269, -0.013340913690626621, 0.03160632401704788, 0.013408065773546696, 0.044857703149318695, -0.006625688634812832, 0.025607390329241753, 0.026323681697249413, -0.025428319349884987, 0.016194883733987808, 0.013788594864308834, 0.0024440621491521597, 0.00348632107488811, 0.040671877562999725, 0.03160632401704788, 0.005436534062027931, -0.04123147949576378, 0.0027196661103516817, 0.03290460258722305, -0.020190443843603134, 0.001643831143155694, -0.0024706432595849037, 0.03590406849980354, 0.004655889235436916, -0.014113164506852627, -0.011650915257632732, 0.014101972803473473, -0.04723041504621506, 0.002102704718708992, -0.01132075022906065, -0.0028679606039077044, 0.009082341566681862, -0.03465056046843529, -0.020268786698579788, -0.015646474435925484, 0.029636526480317116, -0.00387804233469069, -0.05005080997943878, 0.02118653431534767, -0.03140486776828766, 0.022003553807735443, -0.017090247943997383, -0.0010863275965675712, 0.007879197597503662, 0.006161218974739313, -0.04452194273471832, -0.038523007184267044, 0.015422632917761803, 0.011785219423472881, 0.022854149341583252, -0.0183101799339056, -0.002859566593542695, -0.0011136081302538514, -0.006261947099119425, -0.020761236548423767, -0.0316510945558548, -0.011108101345598698, 0.0012633017031475902, 0.03482963517308235, 0.018500445410609245, 0.0773593932390213, 0.016821637749671936, -0.01120882946997881, -0.015053295530378819, 0.018063955008983612, -0.00035202468279749155, -0.034672945737838745, -0.00604929868131876, 0.008914461359381676, 0.016732102259993553, 0.006592112593352795, 0.0013857146259397268, 0.020168058574199677, 0.01914958283305168, -0.018746670335531235, -0.01747077703475952, -0.053139813244342804, -0.013049920089542866, -0.016082962974905968, -0.03379996493458748, 0.04120909795165062, 0.04071664810180664, 0.023212295025587082, 0.021891633048653603, 0.022462427616119385, 0.01174045167863369, 0.027107125148177147, -0.01119204144924879, -0.011343134567141533, -0.026793748140335083, -0.010167969390749931, -0.009709096513688564, -0.008841712959110737, -0.014572038315236568, -0.0021656600292772055, 0.002852571662515402, 0.026972820982336998, -0.02576407976448536, -0.004420856479555368, -0.010195950046181679, -0.03254645690321922, -0.007095754612237215, 0.02529401332139969, 0.027151893824338913, -0.03626221418380737, -0.03147201985120773, -0.013654290698468685, 0.027487654238939285, -0.002239807276055217, -0.00975946057587862, 0.0005634493427351117, 0.010839492082595825, -0.009132705628871918, -0.02433149889111519, 0.0076609523966908455, -0.021119382232427597, -0.005596020724624395, -0.018243027850985527, 0.009742672555148602, 0.009837804362177849, -0.033732812851667404, -0.005014034453779459, 0.04673796519637108, -0.00839403085410595, 0.04076141491532326, -0.0229884535074234, -0.009054361842572689, 0.04660366103053093, 0.013486410491168499, -0.015422632917761803, 0.0031057915184646845, -0.035389237105846405, 0.03724711388349533, -0.02192520909011364, 0.011175253428518772, 0.016743294894695282, 0.0015682848170399666, -0.009608367457985878, -0.00875217653810978, -0.015154024586081505, 0.00999449286609888, 0.045573994517326355, 0.000926840933971107, -0.017795346677303314, 0.020694084465503693, -0.02634606510400772, 0.028651626780629158, -0.00029081819229759276, -0.000466917990706861, -0.04709611088037491, -0.03158394247293472, -0.006580920424312353, -0.047140877693891525, -0.02035832405090332, 0.006597708445042372, -0.040559958666563034, 0.007571415975689888, -0.0006239563226699829, -0.021387992426753044, -0.012322437949478626, 0.0014192907838150859, 0.029658909887075424, 0.023995736613869667, 0.04615597799420357, 0.02515970915555954, -0.01891455054283142, 0.026502754539251328, 0.004627909045666456, 0.004697859287261963, -0.009832208976149559, 0.0417015478014946, 0.001906844088807702, -0.02719666063785553, -0.011561378836631775, -0.007347575388848782, 0.024376267567276955, -0.00239369785413146, 0.021152958273887634, -0.020391900092363358, 0.006787973456084728, -5.036418588133529e-05, 0.003939598798751831, 0.01688879169523716, 0.05224445089697838, 0.04154485836625099, -0.0013983057579025626, 0.019821105524897575, 0.016608988866209984, 0.014874223619699478, -0.00415784353390336, -0.007991117425262928, 0.007297211326658726, 0.036933738738298416, 0.0026455188635736704, -0.036709897220134735, 0.021723752841353416, -0.017269320785999298, -0.023570438846945763, 0.013900515623390675, 0.014627998694777489, 0.015321904793381691, -0.03617267683148384, 0.029300764203071594, 0.022809380665421486, 0.006105258595198393, -0.003601039294153452, -0.015165216289460659, 0.023794280365109444, -0.014527269639074802, 0.022126667201519012, -0.008410818874835968, 0.00013902614591643214, -0.002609144663438201, 0.02348090335726738, 0.007767276838421822, 0.007280423305928707, -0.024219578132033348, 0.021130574867129326, -0.024018121883273125, -0.0033324304968118668, 0.051707230508327484, 0.013497602194547653, 0.043044593185186386, -0.011169657111167908, -0.013117073103785515, 0.03189731761813164, 0.003097397508099675, -0.01737004891037941, -0.021343223750591278, 0.015389056876301765, 0.009020785801112652, -0.008785752579569817, 0.023883817717432976, 0.0006855125539004803, -0.0028959407936781645, 0.005842245649546385, 0.03704565763473511, -0.00022768809867557138, 0.021600639447569847, 0.0022523982916027308, -0.021712560206651688, 0.014930183067917824, 0.024018121883273125, -0.007369959261268377, -0.01155018713325262, -0.018746670335531235, 0.03129294887185097, -0.029860366135835648, -0.0120426369830966, 0.03570261225104332, -0.017549121752381325, 0.03773956373333931, 0.017101438716053963, 0.05076710134744644, -0.028092024847865105, -0.013117073103785515, -0.004874133970588446, -0.010380618274211884, 0.040559958666563034, -0.007246846798807383, -0.0120426369830966, -0.03008420765399933, -0.004034731071442366, -0.00524347135797143, 0.029009772464632988, 0.0035310890525579453, 0.046066444367170334, 0.021511103957891464, 0.004974862560629845, -0.004876932129263878, -0.011180849745869637, -0.02981559932231903, 0.028226329013705254, -0.0009786041919142008, 0.0035003109369426966, -0.027375733479857445, -0.01750435307621956, -0.000821915571577847, -0.024152426049113274, -0.009306182153522968, -0.02372712828218937, -0.034807249903678894, -0.018052762374281883, 0.009804228320717812, 0.020671701058745384, -0.0014745515072718263, -0.0032792682759463787, -0.004792992025613785, -0.011046544648706913, 0.019250310957431793, -0.016127731651067734, -0.0023111565969884396, -0.014739918522536755, -0.011012968607246876, -0.008125422522425652, 0.014213892631232738, -0.018511636182665825, -0.01556812971830368, 0.019138392060995102, 0.004269763827323914, 0.011527802795171738, -0.02623414620757103, 0.022786997258663177, -0.03129294887185097, 0.029994672164320946, -0.017661042511463165, -0.0027070750948041677, 0.02370474487543106, 0.025808848440647125, 0.018422100692987442, 0.010895452462136745, 0.00024167814990505576, 0.013598330318927765, -0.0038612543139606714, 0.01413554884493351, -0.014583230018615723, 0.015456209890544415, -0.004482412710785866, -0.05681080371141434, -0.01113608106970787, -0.0028679606039077044, -0.011354326270520687, -0.028002487495541573, -0.00909353420138359, 0.007157310843467712, -0.011729259975254536, -0.02634606510400772, -0.01377740316092968, 0.034561023116111755, -0.03294936940073967, 0.03315082564949989, 0.012490318156778812, 0.0048153758980333805, -0.00348632107488811, 0.013005152344703674, 0.022798188030719757, 0.006804761476814747, -0.00029536496731452644, -0.004653091076761484, -0.004854548256844282, -0.01257985457777977, -0.010923432186245918, 0.009183069691061974, 0.016329187899827957, -0.0023769098334014416, 0.015769585967063904, 0.009278202429413795, 0.014717535115778446, -0.024241961538791656, 0.0197539534419775, -0.010100817307829857, 0.008214958943426609, -0.008343666791915894, 0.02706235647201538, -0.00616681482642889, -0.003978770691901445, -0.010307869873940945, -0.0034891190007328987, 0.018466869369149208, 0.004146651364862919, 0.0033100463915616274, -0.01288203988224268, 0.041007641702890396, -0.013117073103785515, -0.007577012293040752, -0.009087937884032726, 0.026144608855247498, -0.0167880617082119, 0.036821816116571426, -0.015154024586081505, -0.0036122314631938934, -0.00599333830177784, -0.007028602063655853, 0.016967134550213814, -0.013083497062325478, 0.02334659919142723, 0.01486303098499775, 0.03639651834964752, -0.008931249380111694, -0.03259122371673584, 0.004082296974956989, 0.036844201385974884, -0.006715225055813789, -0.00993293710052967, -0.010268698446452618, -0.004608323331922293, 0.010190353728830814, -0.03113625943660736, -0.013844555243849754, 0.04002274200320244, -0.011091313324868679, -0.009742672555148602, 0.011399094015359879, 0.030375201255083084, -0.012915615923702717, -0.022070705890655518, -0.0015626888489350677, 0.013340913690626621, -0.023033222183585167, -0.014281044714152813, -0.014706342481076717, 0.052647363394498825, -0.010929028503596783, 0.01834375597536564, 0.017325280234217644, 0.006038106512278318, 0.0070062181912362576, -0.03765002638101578, -0.02132083848118782, 0.038523007184267044, 0.015971044078469276, 0.018041571602225304, 0.0069054896011948586, -0.014627998694777489, 0.01771700195968151, 0.01000568550080061, -0.012400781735777855, -0.04230591654777527, 0.005668769124895334, 0.07444945722818375, 0.0013332519447430968, 0.0024146828800439835, 0.0003647906123660505, 0.04109717532992363, 0.042328301817178726, -0.008718600496649742, -0.035501156002283096, 0.0068998937495052814, -0.02190282568335533, 0.023391367867588997, -0.0043481080792844296, -0.0229884535074234, 0.004135459195822477, 0.006636880803853273, -0.009216646663844585, -0.00577509356662631, -0.011572571471333504, 0.017638657242059708, 0.020929118618369102, 0.0016522251535207033, -0.031337715685367584, 0.007045390084385872, -0.021298455074429512, 0.020156867802143097, -0.03158394247293472, -0.02395096980035305, -0.0033576125279068947, 0.013620714657008648, 0.002979881130158901, 0.01078912802040577, -0.00694466196000576, -0.026189377531409264, 0.008125422522425652, 0.02733096480369568, -0.004616717342287302, 0.026614675298333168, -0.02753242291510105, 0.025182094424962997, -0.019116006791591644, 0.01798561029136181, -0.01654183678328991, -0.00038892345037311316, 0.0066648609936237335, -0.020794812589883804, -0.03243453800678253, -0.005562444683164358, 0.015545745380222797, -0.017772961407899857, 0.0312481801956892, -0.004370492417365313, -0.012915615923702717, -0.0005637991125695407, -0.010705187916755676, -0.024712027981877327, 0.02397335320711136, -0.0006361976265907288, -0.02442103438079357, 0.034561023116111755, -0.0027840202674269676, 0.014202700927853584, 0.0012066420167684555, 0.0032121159601956606, 0.03259122371673584, 0.0268385149538517, -0.01185237243771553, -0.009373335167765617, 0.012960384599864483, 0.004672677256166935, -0.02433149889111519, -0.058288153260946274, -0.01407958846539259, 0.00839403085410595, -0.00020268087973818183, -0.014762302860617638, 0.015859123319387436, 0.01891455054283142, -0.010638035833835602, 0.032143544405698776, -0.014180316589772701, 0.027733879163861275, -0.0021013058722019196, 0.04145532101392746, -0.002688887994736433, -0.0036625955253839493, 0.02013448253273964, 0.006838337518274784, -0.038970690220594406, -0.025607390329241753, -0.012971576303243637, -0.016620181500911713, -0.02719666063785553, -0.008013501763343811, 0.0059653581120073795, 0.010509327054023743, 0.0020803208462893963, 0.03321797773241997, -0.024286730214953423, -0.021477527916431427, 0.009009593166410923, -0.018511636182665825, 0.0312481801956892, -0.03675466403365135, 0.03044235333800316, -0.011941908858716488, 0.008354859426617622, -0.017269320785999298, 0.008119826205074787, -0.051214780658483505, 0.019362231716513634, 0.006172411143779755, 0.0021390789188444614, 0.015433825552463531, 0.005369381979107857, 0.010492539033293724, -0.029032155871391296, 0.008091846480965614, -0.007129330653697252, 0.017705809324979782, -0.021276071667671204, 0.004160641692578793, -0.03561307489871979, -0.01880262978374958, 0.00043579013436101377, -0.00499724643304944, -0.008841712959110737, -0.024286730214953423, -0.02095150202512741, 0.013687866739928722, -0.00466987956315279, 0.011718067340552807, -0.01822064444422722, -0.03807532414793968]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-14T10:14:52.645692", "url_path": "/api/pydantic_graph/graph/", "chunk_size": 4900}
updated_dt: 2025-03-14T10:14:52.645692
---
NOTE: this will be mutated to add the new step.
      state: The current state of the graph.
      deps: The dependencies of the graph.
      infer_name: Whether to infer the graph name from the calling frame.
    Returns:
      The next node to run or [`End`][pydantic_graph.nodes.End] if the graph has finished.
    """
    if infer_name and self.name is None:
      self._infer_name(inspect.currentframe())
    if isinstance(node, End):
      # While technically this is not compatible with the documented method signature, it's an easy mistake to
      # make, and we should eagerly provide a more helpful error message than you'd get otherwise.
      raise exceptions.GraphRuntimeError(f'Cannot call `next` with an `End` node: {node!r}.')
    node_id = node.get_id()
    if node_id not in self.node_defs:
      raise exceptions.GraphRuntimeError(f'Node `{node}` is not in the graph.')
    with ExitStack() as stack:
      if self._auto_instrument:
        stack.enter_context(_logfire.span('run node {node_id}', node_id=node_id, node=node))
      ctx = GraphRunContext(state, deps)
      start_ts = _utils.now_utc()
      start = perf_counter()
      next_node = await node.run(ctx)
      duration = perf_counter() - start
    history.append(
      NodeStep(state=state, node=node, start_ts=start_ts, duration=duration, snapshot_state=self.snapshot_state)
    )
    if isinstance(next_node, End):
      history.append(EndStep(result=next_node))
    elif not isinstance(next_node, BaseNode):
      if TYPE_CHECKING:
        typing_extensions.assert_never(next_node)
      else:
        raise exceptions.GraphRuntimeError(
          f'Invalid node return type: `{type(next_node).__name__}`. Expected `BaseNode` or `End`.'
        )
    return next_node
  defdump_history(
    self: Graph[StateT, DepsT, T], history: list[HistoryStep[StateT, T]], *, indent: int | None = None
  ) -> bytes:
"""Dump the history of a graph run as JSON.
    Args:
      history: The history of the graph run.
      indent: The number of spaces to indent the JSON.
    Returns:
      The JSON representation of the history.
    """
    return self.history_type_adapter.dump_json(history, indent=indent)
  defload_history(self, json_bytes: str | bytes | bytearray) -> list[HistoryStep[StateT, RunEndT]]:
"""Load the history of a graph run from JSON.
    Args:
      json_bytes: The JSON representation of the history.
    Returns:
      The history of the graph run.
    """
    return self.history_type_adapter.validate_json(json_bytes)
  @cached_property
  defhistory_type_adapter(self) -> pydantic.TypeAdapter[list[HistoryStep[StateT, RunEndT]]]:
    nodes = [node_def.node for node_def in self.node_defs.values()]
    state_t = self._get_state_type()
    end_t = self._get_run_end_type()
    token = nodes_schema_var.set(nodes)
    try:
      ta = pydantic.TypeAdapter(list[Annotated[HistoryStep[state_t, end_t], pydantic.Discriminator('kind')]])
    finally:
      nodes_schema_var.reset(token)
    return ta
  defmermaid_code(
    self,
    *,
    start_node: Sequence[mermaid.NodeIdent] | mermaid.NodeIdent | None = None,
    title: str | None | typing_extensions.Literal[False] = None,
    edge_labels: bool = True,
    notes: bool = True,
    highlighted_nodes: Sequence[mermaid.NodeIdent] | mermaid.NodeIdent | None = None,
    highlight_css: str = mermaid.DEFAULT_HIGHLIGHT_CSS,
    infer_name: bool = True,
    direction: mermaid.StateDiagramDirection | None = None,
  ) -> str:
"""Generate a diagram representing the graph as [mermaid](https://mermaid.js.org/) diagram.
    This method calls [`pydantic_graph.mermaid.generate_code`][pydantic_graph.mermaid.generate_code].
    Args:
      start_node: The node or nodes which can start the graph.
      title: The title of the diagram, use `False` to not include a title.
      edge_labels: Whether to include edge labels.
      notes: Whether to include notes on each node.
      highlighted_nodes: Optional node or nodes to highlight.
      highlight_css: The CSS to use for highlighting nodes.
      infer_name: Whether to infer the graph name from the calling frame.
      direction: The direction of flow.
    Returns:
      The mermaid code for the graph, which can then be rendered as a diagram.
    Here's an example of generating a diagram for the graph from [above][pydantic_graph.graph.Graph]:
```py {title="mermaid_never_42.py" py="3.10"}
    from never_42 import Increment, never_42_graph
    print(never_42_graph.mermaid_code(start_node=Increment))
    '''
    ---
    title: never_42_graph
    ---
    stateDiagram-v2
     [*] --> Increment
     Increment --> Check42
     Check42 --> Increment
     Check42 --> [*]
    '''
```
    The rendered diagram will look like this:
```mermaid
    ---
    title: never_42_graph
    ---
    stateDiagram-v2
     [*] --> Increment
     Increment --> Check42
     Check42 --> Increment
     Check42 --> [*]