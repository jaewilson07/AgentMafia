---
url: https://ai.pydantic.dev/graph/
session_id: pydantic_ai_docs
chunk_number: 10
title: Asynchronous Graph Processing with Pydantic
summary: This document introduces an asynchronous graph processing implementation using Pydantic, involving nodes for checking divisibility by 5 and incrementing values. Key classes include 'DivisibleBy5' which checks divisibility and 'Increment' which increments integers. It also sets up a graph structure and demonstrates using a process pool for concurrent execution.
embedding: [-0.0062821125611662865, 0.005408936180174351, -0.00024122768081724644, -0.02045338973402977, 0.004940071143209934, 0.0046614701859653, -0.030632518231868744, 0.01666169799864292, -0.0346008837223053, 0.04506540670990944, 0.02739802747964859, -0.017436344176530838, 0.017490705475211143, -0.06458106637001038, 0.01162649504840374, -0.016226807609200478, -0.013624267652630806, 0.018537158146500587, 0.017708150669932365, 0.04677778482437134, 0.05610072612762451, 0.02628362365067005, 0.05275751277804375, 0.006594689097255468, -0.007569792680442333, 0.03177410364151001, 0.00499443244189024, 0.03125767037272453, -0.012917572632431984, 0.01803431659936905, -0.005317201837897301, -0.02071160450577736, -0.01742275431752205, -0.014487250708043575, -0.026106949895620346, 0.021527022123336792, -0.006506352219730616, 0.024081997573375702, 0.014133903197944164, 0.018061498180031776, 0.013644653372466564, -0.06534212082624435, 0.00623794412240386, 0.022587064653635025, -0.03449216112494469, 0.007100927643477917, -0.036720968782901764, 0.05468733236193657, 0.03006172552704811, 0.015900641679763794, -0.04259197413921356, 0.02107854187488556, -0.01187111996114254, 0.023769419640302658, -0.07039771229028702, -0.0608845055103302, -0.03894977644085884, 0.006091848481446505, 0.013746580109000206, -0.012231262400746346, 0.03837898373603821, -0.02387814223766327, 0.012007023207843304, 0.05773155763745308, -0.03468242287635803, 0.03335057571530342, -0.06316767632961273, 0.01358349621295929, 0.0005661206087097526, -0.0019536043982952833, 0.043652016669511795, 0.042918141931295395, -0.03307877108454704, -0.030224809423089027, 0.014215445145964622, -0.03275260329246521, 0.01023348979651928, 0.04574492201209068, 0.007841598242521286, -0.026487478986382484, 0.0014312275452539325, 8.42491936055012e-05, 0.0012494574766606092, -0.005184696521610022, 0.0031988148111850023, -0.04270069673657417, -0.062406618148088455, -0.01466392446309328, -0.06463542580604553, -0.06931048631668091, -0.011735216714441776, -0.0360686331987381, -0.03473678603768349, 0.031964365392923355, 0.07757338881492615, 0.05444270744919777, 0.016022954136133194, -0.021241625770926476, -0.046071089804172516, -0.033894188702106476, 0.01584628038108349, -0.06680987775325775, -0.04762038215994835, 0.004002341069281101, 0.06360256671905518, -0.0038698355201631784, -0.006642255000770092, 0.08317258208990097, -0.03351365774869919, -0.025984637439250946, -0.10236207395792007, -0.0165665652602911, 0.015982182696461678, 0.01921667344868183, -0.008629835210740566, -0.04185809940099716, -0.041341666132211685, -0.03237207606434822, 0.05669869855046272, -0.0336223803460598, -0.03740048408508301, 0.009227808564901352, -0.00019631601753644645, -0.001172162708826363, 0.012747693806886673, 0.005150720477104187, -0.03174692019820213, -0.010580042377114296, -0.018795372918248177, 0.01497650146484375, -0.02043979801237583, -0.0026738899759948254, 0.010980955325067043, -0.06468978524208069, 0.001466902089305222, 0.02241039089858532, -0.061917368322610855, 0.011939071118831635, -0.01995054818689823, 0.020915459841489792, 0.04476642236113548, -0.0346008837223053, -0.011830349452793598, 0.015085224062204361, -0.00024887220934033394, 0.03359520062804222, -0.037944093346595764, 0.04531003162264824, -0.03422035649418831, 0.029871461912989616, 0.04237452894449234, 0.03082278184592724, -0.03479114547371864, 9.85826991382055e-05, 0.01429698709398508, -0.029028862714767456, 0.03677532821893692, -0.0016011062543839216, -0.018047908321022987, -0.023946093395352364, -0.028159083798527718, -0.005643368698656559, -0.04275505617260933, -0.01730044186115265, -0.023687878623604774, 0.02533230371773243, -0.03297004848718643, 0.004756601992994547, -0.053871914744377136, -0.007134903222322464, -0.013726194389164448, -0.045119769871234894, 0.005470092408359051, 0.012265237979590893, 0.0196243803948164, -0.0016291362699121237, -0.05637253075838089, -0.01791200414299965, 0.018822554498910904, -0.008154175244271755, -0.028947321698069572, -0.015438571572303772, -0.06121067330241203, -0.0007249571499414742, -0.055937640368938446, -0.00797750148922205, 0.0015722268726676702, 0.0038086792919784784, 0.004202797543257475, 0.03226335346698761, -0.01541139092296362, 0.02105136215686798, 0.032208990305662155, -0.007345552556216717, -0.004494988825172186, -0.03283414617180824, 0.11861606687307358, 0.00212857942096889, 0.04854452237486839, 0.01460956409573555, 0.027805736288428307, 0.03881387412548065, 0.007053361274302006, -0.03351365774869919, 0.00797750148922205, -0.010593632236123085, -0.011538158170878887, -0.05482323840260506, -0.005867608357220888, -0.043298669159412384, 0.037944093346595764, -0.055203765630722046, 0.04381510242819786, 0.008439571596682072, -0.007671719882637262, -0.0044508203864097595, -0.048870690166950226, 0.014759057201445103, 0.028947321698069572, 0.022138584405183792, -0.03310595080256462, 0.0750727728009224, 0.03522603586316109, 0.02227448858320713, 0.005245852749794722, 0.025291532278060913, 0.0275067500770092, -0.011028521694242954, -0.01064799353480339, 0.04468487948179245, 0.00499443244189024, -0.007216444704681635, -0.0019196287030354142, -0.029545294120907784, 0.01053927093744278, -0.03370392322540283, -0.008337643928825855, -0.038161538541316986, -0.018795372918248177, -0.01690632291138172, -0.0068155312910676, 0.024652788415551186, 0.017708150669932365, -0.00809981394559145, 0.01984182558953762, 0.0184012558311224, -0.018075088039040565, -0.02984428033232689, 0.014460070058703423, 0.02423148974776268, 0.0096287215128541, -0.02276373840868473, -0.006863097194582224, -0.028566792607307434, -0.02461201883852482, -0.021472660824656487, -0.02848525159060955, -0.0018720626831054688, -0.029789919033646584, 0.011354688555002213, -0.00013377943832892925, 0.008120199665427208, -0.03286132588982582, 0.02105136215686798, 0.008983182720839977, 0.020670833066105843, 0.014772647060453892, -0.02554974891245365, -0.029789919033646584, -0.056807421147823334, -0.008011477068066597, 0.016253989189863205, 0.01739557273685932, 0.014799827709794044, -0.00011031494796043262, -0.03283414617180824, 0.013060270808637142, 0.04612544924020767, -0.009091905318200588, -0.012584609910845757, -0.00870458222925663, 0.014364938251674175, 0.04968610778450966, 0.05542121082544327, -0.032942868769168854, 0.02421789988875389, -0.037563566118478775, 0.014215445145964622, 0.01958361081779003, -0.009472433477640152, 0.05137130245566368, -0.0024428549222648144, 0.029789919033646584, -0.007454275153577328, 0.036693789064884186, -0.05104513466358185, 0.003910606261342764, 0.04482078179717064, 0.01996413804590702, -0.0026178299449384212, 0.017259670421481133, -0.02302195504307747, -0.01138866413384676, 0.020861098542809486, -0.0004399856843519956, 0.012999113649129868, -0.03495423123240471, 0.018224582076072693, 0.035008590668439865, 0.004732819274067879, -0.01441929955035448, 0.002254289574921131, 0.026378756389021873, 0.018115859478712082, -0.001356480992399156, 0.002084410982206464, 0.05832953378558159, -0.030496614053845406, -0.0007058457704260945, -0.07344193756580353, -0.0034366450272500515, -0.01875460334122181, 0.04819117486476898, -0.0042673517018556595, -0.015995772555470467, -0.014147493988275528, -0.004658072721213102, -0.005422526504844427, 0.009642312303185463, -0.0002911295450758189, -0.01606372557580471, -0.008473547175526619, 0.004749807063490152, 0.06572265177965164, 0.0029253102838993073, 0.0021166878286749125, -0.006795146036893129, 0.049985092133283615, 0.02519640140235424, 0.0603952556848526, -0.039765194058418274, -0.02299477346241474, -0.001516166958026588, -0.05563865602016449, -0.04965892434120178, 0.020480569452047348, 0.005823439918458462, 0.04805527254939079, 0.00469204830005765, 0.003023840021342039, -0.0016919913468882442, 0.016485024243593216, 0.05237698554992676, 0.027669833973050117, 0.04286377876996994, 0.015982182696461678, -0.002721455879509449, 0.006013703998178244, -0.019746694713830948, 0.018659470602869987, -0.06659243255853653, -0.01144982036203146, -0.045119769871234894, 0.005514260847121477, -0.0294637531042099, -0.012000227347016335, -0.007277601398527622, 0.01187111996114254, 0.060830146074295044, 0.0023799999617040157, 0.03212745115160942, 0.014106722548604012, 0.0009513203985989094, 0.0049740467220544815, -0.03712867572903633, -0.02546820603311062, -0.007508635986596346, -0.01643066294491291, 0.011918686330318451, 0.040607791393995285, -0.01667528785765171, -0.024258671328425407, 0.013549520634114742, 0.007073746994137764, -0.004810963291674852, 0.024693559855222702, -0.0026891790330410004, -0.0005189792718738317, -0.011048907414078712, 0.013379641808569431, 0.017232490703463554, -0.05370883271098137, 0.0008009778102859855, 0.009017158299684525, -0.007732876110821962, 0.018659470602869987, -0.014677515253424644, -0.005826837383210659, 0.05112667754292488, 0.02618849277496338, 0.009621926583349705, -0.013848507776856422, -0.011361483484506607, -0.01180996373295784, 0.010974160395562649, 0.003389079123735428, 0.0304422527551651, 0.006197173148393631, -0.0035096928477287292, 0.0018890505889430642, 0.019271032884716988, -0.049876369535923004, 0.005228864960372448, -0.015125994570553303, -0.006499556824564934, -0.061808645725250244, -0.019094359129667282, -0.02424507960677147, 0.008833689615130424, 0.02058929204940796, -0.04759320244193077, -0.05148002505302429, -0.0008154175011441112, -0.04821835458278656, -0.01984182558953762, 0.053056500852108, 0.013712604530155659, -0.03691123425960541, 0.04612544924020767, -0.05398063734173775, 0.024272261187434196, 0.004586723633110523, 0.021146494895219803, -0.0005839578225277364, 0.06392873078584671, 0.009295759722590446, 0.01083146221935749, 0.002549878554418683, -0.004060099832713604, -0.03748202323913574, -0.02069801464676857, -0.03152947872877121, 0.04675060510635376, 0.006900470703840256, -0.05259443074464798, -0.00876573845744133, -0.041232943534851074, -0.035008590668439865, -0.017694560810923576, -0.04916967451572418, 0.015329848974943161, 0.04995791241526604, -0.025250762701034546, 0.004946866072714329, -0.028675515204668045, 0.02155420184135437, 0.07452916353940964, 0.02629721537232399, 0.05273033306002617, -0.049740467220544815, 0.03321467339992523, 0.007039770949631929, -0.006285510025918484, 0.052675969898700714, -0.03326903283596039, 0.003693161765113473, 0.0025668663438409567, 0.01802072674036026, 0.0022593860048800707, -0.007970706559717655, -0.01959720067679882, -0.0018278942443430424, 0.011293532326817513, -0.010070405900478363, -0.007868778891861439, -0.013406822457909584, 0.0006434153765439987, 0.033921368420124054, 0.03258952125906944, -0.0030493217054754496, -0.00822212640196085, -0.041450388729572296, 0.0051439255475997925, 0.008296873420476913, 0.003502897685393691, 0.039493389427661896, 0.0010617414955049753, -0.045364394783973694, -0.008174560964107513, -0.02459842897951603, -0.01679760031402111, 0.009343325160443783, 0.019203081727027893, -0.01666169799864292, 0.020303895696997643, 0.020752375945448875, -0.020276715978980064, -0.04574492201209068, 0.015030862763524055, -0.02802318148314953, 0.010077201761305332, -0.005432719364762306, 0.0021812417544424534, 0.008589064702391624, 0.009995659813284874, -0.0740942731499672, 0.061536841094493866, 0.017477115616202354, 0.038786694407463074, 0.023837372660636902, -0.015207536518573761, -0.04177655652165413, 0.018455617129802704, 0.0019688934553414583, -0.011361483484506607, 0.02533230371773243, -0.003037430113181472, 0.023946093395352364, -0.01443288940936327, -0.008860870264470577, -0.01658015511929989, -0.032453615218400955, 0.013053474947810173, -0.010437344200909138, -0.007590177934616804, -0.02071160450577736, 0.00684610940515995, -0.04723985493183136, -0.01004322525113821, -0.019094359129667282, 0.01887691579759121, -0.006397629622370005, -0.019080769270658493, 0.015003682114183903, -0.061047591269016266, -0.006485966965556145, -0.010518886148929596, -0.015751147642731667, -0.035253215581178665, -0.028675515204668045, -0.005276430863887072, 0.026691332459449768, -0.0031444537453353405, -0.021975502371788025, -0.010090791620314121, -0.00046419340651482344, 0.015343439765274525, -0.03576964884996414, -0.006193775683641434, 0.027234945446252823, 0.009914117865264416, -0.006951434072107077, 0.004800770431756973, -0.04721267521381378, 0.011076088063418865, 0.008493931964039803, -0.005140528082847595, -0.014215445145964622, 0.005069178994745016, -0.022954002022743225, 0.012360370717942715, -0.016974274069070816, 0.019570020958781242, 0.005045395810157061, -0.015357029624283314, 0.08523830771446228, 0.020901868119835854, -0.0064044250175356865, -0.01766737923026085, 0.0292191281914711, 0.011055702343583107, 0.0033534045796841383, 0.020888278260827065, -0.010151947848498821, 0.02156779356300831, -0.03316031023859978, -0.02582155354321003, -0.019447706639766693, -0.006149607244879007, -0.03468242287635803, -0.037944093346595764, -0.0652877613902092, 0.009017158299684525, -0.016389891505241394, -0.03552502393722534, 0.01717812940478325, 0.0047837826423347, 0.01406595204025507, -0.009683082811534405, -0.009377301670610905, -0.025060497224330902, 0.004861926659941673, -0.024788692593574524, 0.036938413977622986, -0.024394573643803596, -0.027588292956352234, 0.002239000517874956, -0.012754488736391068, -0.05968856066465378, 0.013080655597150326, 0.019080769270658493, -0.019039999693632126, -0.03821590170264244, 0.044141266494989395, -0.002804696559906006, 0.017599428072571754, 0.01702863536775112, 0.004909493029117584, -0.014446480199694633, 0.00629910035058856, -0.0537903755903244, 0.017803281545639038, -0.007060156669467688, -0.025277942419052124, -0.04052624851465225, 0.0011245966888964176, -0.029164766892790794, 0.04965892434120178, 0.033432118594646454, -0.018931277096271515, 0.024408163502812386, 0.03528039902448654, 0.0013947037514299154, -0.0136922188103199, -0.004834746476262808, 0.0392487607896328, 0.00022976087348069996, 0.0006480870652012527, -0.011273146606981754, -0.010077201761305332, -0.04868042469024658, 0.0272621251642704, 0.03169256076216698, 0.0073115769773721695, -0.02239680103957653, -0.006424810271710157, 0.004617301747202873, -0.005561826750636101, -0.007257215678691864, -0.03150229528546333, 0.0073727332055568695, -0.0018652675207704306, -0.031366392970085144, 0.013005909509956837, 0.013067065738141537, 0.009723853319883347, -0.006659242790192366, 0.008752147667109966, 0.017246080562472343, -0.009703468531370163, -0.03522603586316109, -0.009764624759554863, 0.0192574430257082, -0.013685423880815506, 0.008623040281236172, -0.015547294169664383, -0.020494159311056137, -0.04392382130026817, -0.0343562588095665, 0.013060270808637142, -0.043407391756772995, 0.007230035029351711, -0.010967365466058254, -0.0034706208389252424, -0.03375828638672829, 0.059471115469932556, 0.0012324695708230138, 0.019556429237127304, 0.005126937758177519, -0.008459956385195255, -0.015737557783722878, 0.03163819760084152, 0.05414372310042381, -0.005164310801774263, -0.006227751262485981, -0.025237170979380608, 0.00021510884107556194, -0.04294532164931297, -0.009153061546385288, 0.03267106041312218, -0.0075426120311021805, 0.004022726323455572, -0.04501104727387428, 0.05903622880578041, 0.06757093220949173, -0.0304422527551651, 0.007834803313016891, 0.009044338949024677, -0.006129221525043249, 0.00629910035058856, 0.000648936431389302, 0.011640084907412529, 0.006333075929433107, 0.0013148607686161995, 0.001965495990589261, 0.016865551471710205, 0.014025181531906128, 0.07349629700183868, -0.01168085541576147, -0.08589064329862595, -0.008657015860080719, -0.01861869916319847, -0.003978557884693146, 0.020032089203596115, 0.008792919106781483, -0.016403481364250183, 0.002014760859310627, 0.03620453551411629, 0.03710149601101875, -0.02154061198234558, 0.006030691787600517, -0.012272033840417862, -0.02813190408051014, 0.030632518231868744, -0.013671833090484142, -0.00770569546148181, 0.014392118901014328, -0.0007869628607295454, -0.0018601712072268128, -0.031366392970085144, -0.018292533233761787, 0.004668265115469694, -0.030768420547246933, -0.027357257902622223, -0.0034757170360535383, -0.04270069673657417, -0.024027636274695396, -0.008194945752620697, 0.0018550747772678733, 0.0008145681349560618, -0.030985865741968155, 0.019175902009010315, 0.009587951004505157, -0.018047908321022987, -0.02851243130862713, 0.02227448858320713, -0.04675060510635376, -0.00803865771740675, -0.02957247570157051, -0.023891732096672058, -0.022124994546175003, 0.007427094504237175, -0.0051133474335074425, -0.010994546115398407, -0.009411277249455452, 0.010138357989490032, -0.02046697959303856, 0.029518114402890205, -0.03370392322540283, 0.02545461617410183, 0.005898186471313238, 0.011578928679227829, -0.01454161200672388, -0.03006172552704811, 0.02911040559411049, 0.02692236751317978, 0.026365166530013084, -0.027941640466451645, -0.017830463126301765, 0.03759074583649635, -0.009581156075000763, -0.007223240099847317, -0.033377755433321, -0.014133903197944164, -0.002364710671827197, -0.016131676733493805, 0.022940412163734436, 0.01113044936209917, 0.016892733052372932, 0.011415844783186913, -0.020059270784258842, -0.005731705576181412, 0.02239680103957653, 0.03568810597062111, 0.02851243130862713, -0.0033941753208637238, 0.04202118143439293, -0.015125994570553303, 0.00672379694879055, -0.006679628510028124, 0.010729535482823849, 0.01596859283745289, 5.96167883486487e-05, 0.00797750148922205, 0.040852416306734085, 0.011775988154113293, -0.001011627377010882, -0.02802318148314953, -0.038542065769433975, -0.007746466435492039, -0.05919931083917618, -0.04188527911901474, 0.005211876705288887, -0.008568678982555866, 0.01034221239387989, -0.02349761500954628, 0.0008757244213484228, -0.1168765127658844, 0.001810906338505447, 0.04737575724720955, -0.02519640140235424, 0.03688405081629753, -0.013501955196261406, 0.028458071872591972, 0.00014301658666227013, 0.014460070058703423, -0.03470960631966591, -0.009064724668860435, -0.014949320815503597, -0.013868892565369606, -0.013535930775105953, 0.029246307909488678, -0.01161969918757677, -0.0036523910239338875, 0.0004370128153823316, 0.04270069673657417, -0.03552502393722534, -0.02640593610703945, -0.02448970638215542, -0.004603711422532797, 0.031828463077545166, 0.02594386786222458, -0.005031805485486984, 0.011361483484506607, 0.02409558743238449, 0.018781783059239388, 0.03174692019820213, -0.005001227371394634, -0.03174692019820213, -0.0036150175146758556, 0.030007364228367805, -0.022954002022743225, 0.006978614721447229, 0.02654184028506279, 0.01875460334122181, 0.025522567331790924, 0.010845053009688854, -0.017110178247094154, -0.049359939992427826, 0.0050046248361468315, -0.017993547022342682, 0.026324395090341568, 0.029735557734966278, -0.024897415190935135, 0.015791919082403183, -0.04112422466278076, -0.020276715978980064, -0.01825176179409027, -4.877375431533437e-06, -0.01297193393111229, -0.00822212640196085, 0.03867797181010246, 0.023783011361956596, -0.03079560026526451, -0.026854416355490685, -0.02957247570157051, 0.028458071872591972, 0.008609449490904808, 0.04150475189089775, 0.03786255419254303, -0.01678401045501232, 0.004253761377185583, -0.03824308142066002, 0.008752147667109966, -0.02314426749944687, -0.007651334162801504, -0.02166292443871498, 0.004403254482895136, -0.004243568517267704, 0.009418072178959846, -0.02436739392578602, -0.02567206136882305, 0.004277544561773539, 0.0385148860514164, -0.001924725016579032, 0.013848507776856422, -0.01995054818689823, -0.017477115616202354, -0.016851961612701416, 0.0039038113318383694, 0.03538912162184715, 0.012204081751406193, -0.020915459841489792, 0.030170448124408722, -0.0037135472521185875, 0.004919685423374176, 0.030523795634508133, -0.01431057695299387, -0.01429698709398508, 0.0020861097145825624, -0.013957229442894459, -0.014025181531906128, -0.016389891505241394, -0.021893959492444992, 0.006672833114862442, 0.033404938876628876, -0.018727421760559082, 0.005938957445323467, 0.02911040559411049, -0.007046566344797611, -0.01667528785765171, -0.021268807351589203, 0.04174937680363655, -0.006356859114021063, 0.00814738031476736, -0.027792146429419518, -0.012081769295036793, 0.009717058390378952, -0.008786123245954514, 0.010940184816718102, -0.015887051820755005, -0.037210218608379364, 0.021499842405319214, 0.05115385726094246, 0.011843939311802387, 0.005391948390752077, -0.004746409598737955, 0.004776987712830305, -0.0029966593720018864, -0.02302195504307747, 0.03163819760084152, -0.014813418500125408, -0.03307877108454704, 0.0005763132940046489, -0.011674060486257076, -0.010532476007938385, 0.011157630011439323, 0.009411277249455452, 0.018781783059239388, -0.06865815073251724, 0.04006417840719223, 0.007834803313016891, -0.013352462090551853, 0.024149948731064796, 0.02323939837515354, -0.0033024409785866737, -0.012407936155796051, -0.007780442014336586, -0.012652561999857426, 0.019325394183397293, -0.00863663014024496, -0.021771647036075592, -0.015805508941411972, 0.01812944933772087, -0.014745466411113739, -0.0292191281914711, 0.017327621579170227, 0.0011670662788674235, 0.038052815943956375, 0.030958684161305428, 0.003788293804973364, 0.0008081976557150483, 0.05604636296629906, 0.015628835186362267, -0.046071089804172516, -0.0015110705280676484, -0.029001682996749878, -0.010124767199158669, 0.007162083871662617, 0.0029321054462343454, -0.014161083847284317, -0.02567206136882305, -0.023687878623604774, -0.01248947810381651, -0.004997829906642437, -0.03104022704064846, 0.021092133596539497, -0.039520569145679474, 0.03650352358818054, 0.017694560810923576, 0.014337757602334023, 0.05979728326201439, 0.04982201009988785, 0.0786062479019165, -0.006394232157617807, -0.04563619941473007, 0.03117612935602665, -0.04136884957551956, 0.011633289977908134, 0.008718172088265419, 0.029164766892790794, 0.04677778482437134, -0.0387595109641552, 0.020154403522610664, 0.015737557783722878, 0.009574360214173794, 0.013481569476425648, 0.007963910698890686, 0.02556333877146244, -0.0034587292466312647, 0.023157857358455658, 0.030251989141106606, 0.03359520062804222, 0.03302440792322159, 0.012992318719625473, -0.005701127462089062, -0.026446707546710968, 0.0030561168678104877, 0.04188527911901474, -0.005089564248919487, -0.019814645871520042, 0.002035146113485098, 0.03639480099081993, -0.020290305837988853, -0.0186458807438612, -0.03595991060137749, 0.027751374989748, -0.004246965982019901, -0.024544067680835724, 0.03345929831266403, 0.0072504207491874695, -0.02716699242591858, 0.012951548211276531, 0.009934503585100174, 0.0022644824348390102, -0.014772647060453892, -0.009519999846816063, -0.03772664815187454, -0.03867797181010246, -0.01935257576406002, 0.01973310299217701, -0.033432118594646454, 0.008541498333215714, 0.0036082223523408175, 0.007535816635936499, -0.017096586525440216, -0.001654618070460856, 0.01946129836142063, 0.03666660562157631, -0.015329848974943161, -0.0135087501257658, 0.012523453682661057, -0.004929878283292055, 0.0013488364638760686, 0.00180241244379431, 0.011273146606981754, -0.0040363166481256485, 0.003621812677010894, -0.010151947848498821, 0.0024802281986922026, -0.012530248612165451, -0.008126994594931602, -0.00770569546148181, 0.020602881908416748, 0.02554974891245365, -0.016362711787223816, -0.002595745725557208, -0.02484305389225483, 0.007168878801167011, 0.01753147691488266, -0.01641707308590412, -0.003798486664891243, -0.036449164152145386, 0.02167651616036892, 0.006098643410950899, 0.0021812417544424534, 0.02728930674493313, -0.005487080197781324, 0.026949549093842506, 0.0034434401895850897, -0.046587519347667694, -0.011171219870448112, -0.013780555687844753, -0.00475320452824235, 0.01971951313316822, 0.03813435882329941, 0.05433398485183716, -0.014827008359134197, 0.03258952125906944, 0.017477115616202354, 0.02788727916777134, 0.0159550029784441, -0.015873460099101067, -0.03242643550038338, -0.017354803159832954, -0.0018244966631755233, -0.02606618031859398, -0.001672455226071179, 0.004868722055107355, 0.008473547175526619, 0.033404938876628876, 0.005915174726396799, -0.010879028588533401, -0.011123653501272202, -0.03981955349445343, -0.01705581694841385, -0.0072504207491874695, 0.05126257985830307, -0.012876801192760468, -0.0013862097403034568, -0.031366392970085144, 0.006064667832106352, 0.018836144357919693, 0.007991091348230839, -0.0012018914567306638, -0.0024411561898887157, -0.04017290100455284, 0.01596859283745289, 0.012455502524971962, -0.009465638548135757, 0.016267579048871994, 0.013128221966326237, 0.011986637488007545, 0.02520999126136303, -0.05389909818768501, 0.019175902009010315, 0.04234734922647476, -0.009486023336648941, 0.026759283617138863, -0.00820853654295206, -0.010145152918994427, 0.035606563091278076, 0.038161538541316986, -0.01899922825396061, 0.0004896752070635557, -0.05259443074464798, 0.039384666830301285, -0.034410618245601654, 0.012149720452725887, 0.015887051820755005, 0.025250762701034546, 0.0039038113318383694, -0.014120313338935375, 0.006900470703840256, 0.00416542449966073, 0.045119769871234894, -0.0034332475624978542, 0.0011110063642263412, 0.04087959602475166, 0.006431605666875839, 0.005120142363011837, -0.009404482319951057, 0.008480342105031013, -0.04821835458278656, -0.015588064678013325, -0.00608845055103302, -0.016403481364250183, -0.0028709492180496454, -0.019094359129667282, -0.033540841192007065, 0.006767965387552977, 0.02022235468029976, -0.02799600176513195, -0.0006943789776414633, -0.0006761170225217938, 0.004365881439298391, 0.039765194058418274, 0.06767965108156204, 0.008738557808101177, -0.012577814981341362, 0.0348455086350441, 0.037183038890361786, 0.008956002071499825, 0.006781555712223053, 0.018795372918248177, -0.013352462090551853, -0.058873143047094345, -0.0157103780657053, -0.009085110388696194, 0.010036430321633816, 0.005891391541808844, 0.011782783083617687, -0.023293759673833847, -0.00502501055598259, 0.011123653501272202, 0.03519885614514351, 0.00784839317202568, 0.04699523001909256, 0.03960211202502251, 0.015397800132632256, 0.004243568517267704, 0.0193797554820776, -0.010056816041469574, 0.01174201164394617, 0.019162312150001526, 0.02254629321396351, 0.017830463126301765, 0.005605995189398527, -0.0368025116622448, 0.027697015553712845, 0.001510221161879599, -0.032208990305662155, 0.010396572761237621, -0.00992091279476881, 0.018292533233761787, 0.00038859740016050637, 0.031719740480184555, -0.001955303130671382, -0.004321713000535965, 0.0036116200499236584, -0.0011067594168707728, 0.01417467463761568, 0.007032976020127535, 0.025291532278060913, 0.007365938276052475, -0.0047124335542321205, -0.017477115616202354, 0.018917685374617577, 0.0062821125611662865, 0.010274260304868221, -0.020045680925250053, -0.0035572589840739965, -0.03843334689736366, 0.017218898981809616, 0.043026864528656006, -0.0012749392772093415, 0.04202118143439293, -0.027112632989883423, 0.014935730956494808, 0.010654788464307785, 0.007861983962357044, -0.01333887130022049, -0.04117858409881592, -0.004865324590355158, -0.022614246234297752, -0.009159856475889683, 0.03114894963800907, -0.012686537578701973, -0.009574360214173794, 0.014962911605834961, 0.009649107232689857, 0.0009300856036134064, 0.03946620598435402, 0.018808964639902115, -0.01921667344868183, 0.016485024243593216, 0.04492950439453125, -0.0033381155226379633, -0.022342439740896225, -0.033676743507385254, -0.006339871324598789, -0.024027636274695396, 0.004923083353787661, 0.020847506821155548, 0.003001755801960826, -0.010070405900478363, 0.014161083847284317, 0.021024180576205254, 0.00967628788203001, 0.004817758221179247, 0.03457370400428772, -0.024911005049943924, 0.005222069565206766, -0.0053579723462462425, 0.0019909776747226715, -0.010573247447609901, 0.028784237802028656, 0.02461201883852482, 0.004338700789958239, -0.009825780987739563, 0.02010004222393036, 0.023348120972514153, 0.009560770355165005, 0.0011866023996844888, -0.011803168803453445, -0.009696673601865768, 0.03541630133986473, 0.0010498500196263194, 0.007807622663676739, -0.02434021234512329, -0.012353574857115746, -0.008670605719089508, 0.01460956409573555, -0.00901036337018013, 0.0057283081114292145, -0.03653070330619812, -0.018047908321022987, 0.017354803159832954, 0.010321826674044132, -0.010349007323384285, -0.0024870233610272408, 0.017966365441679955, -0.0013420413015410304, -0.008059043437242508, -0.031611017882823944, -0.0013386437203735113, -0.032208990305662155, -0.009295759722590446, 0.03468242287635803, 0.0012970234965905547, 0.02323939837515354, -0.005969535559415817, 0.009221012704074383, -0.008154175244271755, -0.0018771589966490865, -0.04639725759625435, 0.015397800132632256, -0.02034466713666916, 0.030387893319129944, 0.0136310625821352, -0.021730877459049225, 0.028920140117406845, 0.009730649180710316, 0.013284510001540184, 0.016879143193364143, -0.010247079655528069, 0.01910795085132122, 0.013916458934545517, -0.0133864376693964, 0.004246965982019901, 0.010226694867014885, -0.018958456814289093, -0.044385891407728195, 0.020059270784258842, -0.012632176280021667, -0.004780385177582502, -0.039275944232940674, 0.001088922144845128, -0.008956002071499825, -0.0297083780169487, -0.04664188250899315, 0.00790954940021038, 0.000170728046214208, -0.01643066294491291, 0.015982182696461678, 0.010410163551568985, -0.015343439765274525, 0.0033347178250551224, -0.0006676230696029961, 0.010097586549818516, 0.019420526921749115, -0.006136016920208931, -0.003866438055410981, 0.025237170979380608, -0.006883482914417982, -0.010131562128663063, 0.00425715884193778, 0.002714660717174411, -0.013257329352200031, -0.007304782047867775, -0.008351234719157219, -0.007365938276052475, 0.01223805733025074, 0.004440627992153168, -0.01730044186115265, 0.01199343241751194, -0.010009249672293663, 0.013535930775105953, -0.02302195504307747, -0.0270175002515316, 0.005684139672666788, 0.006418015342205763, 0.05979728326201439, -0.002337530255317688, 0.010946979746222496, 0.01985541544854641, 0.04737575724720955, -0.016131676733493805, -0.008018271997570992, -0.019570020958781242, 0.01861869916319847, -0.023402482271194458, 0.02631080523133278, -0.018700242042541504, 0.0004934974713250995, 0.00038307634531520307, 0.03373110294342041, -0.007345552556216717, -0.024380983784794807, -0.014337757602334023, 0.005847223103046417, -0.009846166707575321, 0.0005724910297431052, -0.003457030514255166, 0.005330792162567377, 0.017735330387949944, 0.027438798919320107, -0.011014931835234165, -0.01946129836142063, 0.022206537425518036, 0.0031257672235369682, -0.014351348392665386, -0.011463411152362823, 0.04079805687069893, 0.002035146113485098, -0.024027636274695396, -0.0070193856954574585, 0.02144548110663891, -0.04805527254939079, -0.024380983784794807, 0.027860097587108612, 0.017096586525440216, -0.010206309147179127, 0.0011526265880092978, -0.040852416306734085, 0.035253215581178665, -0.002026652218773961, -0.011198400519788265, 0.043896641582250595, 0.005290021188557148, -0.002959286095574498, -0.02667774260044098, -0.006458786316215992, 0.0268951877951622, -0.010777100920677185, 0.00967628788203001, -0.0009793504141271114, 0.037672288715839386, 0.018700242042541504, 0.000648936431389302, -0.02300836332142353, -0.0049740467220544815, -0.006078258156776428, 0.02957247570157051, 0.004525566939264536, 0.025998227298259735, 0.005901584401726723, -0.0035402709618210793, 0.0031206707935780287, -0.008650220930576324, -0.022342439740896225, 0.035606563091278076, -0.010328621603548527, -0.010335416533052921, 0.003723739879205823, -0.024666380137205124, -0.002041941275820136, -0.0033024409785866737, 0.014568792656064034, -0.010321826674044132, -0.0009037543786689639, 0.015751147642731667, 0.004926480818539858, 0.0028216843493282795, 0.009730649180710316, 0.001658015651628375, -0.014786237850785255, 0.04251043125987053, -0.027126222848892212, -0.008813303895294666, -0.005762283690273762, 0.011225581169128418, 0.018061498180031776, 0.008969592861831188, -0.008956002071499825, -0.005171106196939945, 0.007454275153577328, 0.03788973391056061, 0.011925481259822845, 0.020643653348088264, -0.00011902122787432745, 0.017436344176530838, 0.004212990403175354, 0.027751374989748, -0.06561392545700073, -0.0196243803948164, -0.007399913854897022, -0.0135087501257658, 0.006064667832106352, 0.046587519347667694, -0.0033007420133799314, 0.014718285761773586, 0.03373110294342041, 0.01296513807028532, -0.002152362372726202, 0.009227808564901352, -0.022342439740896225, 0.02507408894598484, -0.002174446592107415, -0.0067883506417274475, -0.028648335486650467, 0.048381440341472626, 0.01327771507203579, 0.0026025408878922462, -0.0013089149724692106, 0.0008209385559894145, 0.02959965541958809, 0.04332584887742996, 0.01029464602470398, 0.003344910452142358, -0.015737557783722878, 0.034519340842962265, 0.00502501055598259, -0.03008890524506569, -0.006129221525043249, 0.0017463525291532278, -0.027669833973050117, 0.014283396303653717, 0.02251911349594593, 0.018958456814289093, -0.024041226133704185, 0.01679760031402111, -0.018944866955280304, 0.01083825808018446, -0.005592404864728451, 0.0297083780169487, 0.01572396792471409, -0.025971047580242157, 0.016593746840953827, -0.018482796847820282, -0.00011169521167175844, -0.022668607532978058, 0.023103496059775352, -0.009730649180710316, 0.0015051248483359814, 0.007868778891861439, 0.024815872311592102, 0.004362483508884907, -0.017218898981809616, 0.001863568788394332, -0.01924385316669941, -0.0010515488684177399, -0.0007011741399765015, -0.0010447537060827017, 0.015085224062204361, -0.02400045469403267, 0.01791200414299965, -0.01443288940936327, 0.01132750790566206, 0.012156516313552856, -0.014473660849034786, -0.03547066077589989, 0.011674060486257076, 0.0024683368392288685, -0.0033109348732978106, -0.004539157263934612, -0.011055702343583107, 0.0024156742729246616, -0.011551748029887676, 0.007963910698890686, -0.014133903197944164, 0.005490477662533522, -0.035987094044685364, -0.020358256995677948, -0.021499842405319214, 0.024503296241164207, -0.018931277096271515, 0.0059593431651592255, -0.02095622941851616, 0.015357029624283314, -0.02981710061430931, 0.014759057201445103, -0.006285510025918484, -0.018904095515608788, 0.015302668325603008, -0.032154630869627]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-14T10:14:06.678209", "url_path": "/graph/", "chunk_size": 4865}
updated_dt: 2025-03-14T10:14:06.678209
---
```
from__future__import annotations
importasyncio
fromconcurrent.futuresimport ProcessPoolExecutor
fromdataclassesimport dataclass
frompydantic_graphimport BaseNode, End, Graph, GraphRunContext

@dataclass
classGraphDeps:
  executor: ProcessPoolExecutor

@dataclass
classDivisibleBy5(BaseNode[None, GraphDeps, int]):
  foo: int
  async defrun(
    self,
    ctx: GraphRunContext[None, GraphDeps],
  ) -> Increment | End[int]:
    if self.foo % 5 == 0:
      return End(self.foo)
    else:
      return Increment(self.foo)

@dataclass
classIncrement(BaseNode[None, GraphDeps]):
  foo: int
  async defrun(self, ctx: GraphRunContext[None, GraphDeps]) -> DivisibleBy5:
    loop = asyncio.get_running_loop()
    compute_result = await loop.run_in_executor(
      ctx.deps.executor,
      self.compute,
    )
    return DivisibleBy5(compute_result)
  defcompute(self) -> int:
    return self.foo + 1

fives_graph = Graph(nodes=[DivisibleBy5, Increment])

async defmain():
  with ProcessPoolExecutor() as executor:
    deps = GraphDeps(executor)
    result = await fives_graph.run(DivisibleBy5(3), deps=deps)
  print(result.output)
  #> 5
  # the full history is quite verbose (see below), so we'll just print the summary
  print([item.data_snapshot() for item in result.history])
"""
  [
    DivisibleBy5(foo=3),
    Increment(foo=3),
    DivisibleBy5(foo=4),
    Increment(foo=4),
    DivisibleBy5(foo=5),
    End(data=5),
  ]
  """

```

_(This example is complete, it can be run "as is" with Python 3.10+ — you'll need to add`asyncio.run(main())` to run `main`)_
## Mermaid Diagrams
Pydantic Graph can generate [mermaid](https://mermaid.js.org/) [`stateDiagram-v2`](https://mermaid.js.org/syntax/stateDiagram.html) diagrams for graphs, as shown above.
These diagrams can be generated with:
  * [`Graph.mermaid_code`](https://ai.pydantic.dev/api/pydantic_graph/graph/#pydantic_graph.graph.Graph.mermaid_code) to generate the mermaid code for a graph
  * [`Graph.mermaid_image`](https://ai.pydantic.dev/api/pydantic_graph/graph/#pydantic_graph.graph.Graph.mermaid_image) to generate an image of the graph using [mermaid.ink](https://mermaid.ink/)
  * [`Graph.mermaid_save`](https://ai.pydantic.dev/api/pydantic_graph/graph/#pydantic_graph.graph.Graph.mermaid_save) to generate an image of the graph using [mermaid.ink](https://mermaid.ink/) and save it to a file


Beyond the diagrams shown above, you can also customize mermaid diagrams with the following options:
  * [`Edge`](https://ai.pydantic.dev/api/pydantic_graph/nodes/#pydantic_graph.nodes.Edge) allows you to apply a label to an edge
  * [`BaseNode.docstring_notes`](https://ai.pydantic.dev/api/pydantic_graph/nodes/#pydantic_graph.nodes.BaseNode.docstring_notes) and [`BaseNode.get_note`](https://ai.pydantic.dev/api/pydantic_graph/nodes/#pydantic_graph.nodes.BaseNode.get_note) allows you to add notes to nodes
  * The [`highlighted_nodes`](https://ai.pydantic.dev/api/pydantic_graph/graph/#pydantic_graph.graph.Graph.mermaid_code) parameter allows you to highlight specific node(s) in the diagram


Putting that together, we can edit the last [`ai_q_and_a_graph.py`](https://ai.pydantic.dev/graph/#custom-control-flow) example to:
  * add labels to some edges
  * add a note to the `Ask` node
  * highlight the `Answer` node
  * save the diagram as a `PNG` image to file


ai_q_and_a_graph_extra.py```
...
fromtypingimport Annotated

frompydantic_graphimport BaseNode, End, Graph, GraphRunContext, Edge

...
@dataclass
classAsk(BaseNode[QuestionState]):
"""Generate question using GPT-4o."""
  docstring_notes = True
  async defrun(
    self, ctx: GraphRunContext[QuestionState]
  ) -> Annotated[Answer, Edge(label='Ask the question')]:
    ...
...
@dataclass
classEvaluate(BaseNode[QuestionState]):
  answer: str
  async defrun(
      self,
      ctx: GraphRunContext[QuestionState],
  ) -> Annotated[End[str], Edge(label='success')] | Reprimand:
    ...
...
question_graph.mermaid_save('image.png', highlighted_nodes=[Answer])

```

_(This example is not complete and cannot be run directly)_
This would generate an image that looks like this:
### Setting Direction of the State Diagram
You can specify the direction of the state diagram using one of the following values:
  * `'TB'`: Top to bottom, the diagram flows vertically from top to bottom.
  * `'LR'`: Left to right, the diagram flows horizontally from left to right.
  * `'RL'`: Right to left, the diagram flows horizontally from right to left.
  * `'BT'`: Bottom to top, the diagram flows vertically from bottom to top.


Here is an example of how to do this using 'Left to Right' (LR) instead of the default 'Top to Bottom' (TB): 
vending_machine_diagram.py```
fromvending_machineimport InsertCoin, vending_machine_graph
vending_machine_graph.mermaid_code(start_node=InsertCoin, direction='LR')

```

© Pydantic Services Inc. 2024 to present