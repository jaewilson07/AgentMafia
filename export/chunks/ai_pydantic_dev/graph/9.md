---
url: https://ai.pydantic.dev/graph/
session_id: pydantic_ai_docs
chunk_number: 9
title: Order Processing with Pydantic Graph
summary: This document explains the implementation of an order processing state machine using Pydantic's `GraphRunResult` and `OrderState`. It details how the `OrderState` tracks order details and describes the functionality of node classes like `CheckOrder` and `HumanReview`, which manage the order processing workflow and human review requirements.
embedding: [-0.005558760836720467, 0.04060637205839157, -0.03629397228360176, -0.039484649896621704, 0.03377632796764374, -0.017648441717028618, -0.01572904922068119, 0.04279996454715729, 0.008525094948709011, 0.010394632816314697, 0.028018148615956306, -0.04035710170865059, -0.02117563784122467, -0.04479413852095604, -0.0022559096105396748, -0.013697484508156776, 0.0198918879032135, 0.0010648579336702824, 0.02371820993721485, 0.03629397228360176, 0.038786690682172775, 0.005019710399210453, 0.03995826467871666, 0.0032748079393059015, -0.0348731204867363, 0.0035583546850830317, 0.013261258602142334, 0.0209637563675642, -0.020240869373083115, -0.03808872774243355, 0.03619426116347313, -0.005720787215977907, -0.03816350921988487, -0.0015782020054757595, 0.0018742121756076813, 0.005976290907710791, -0.0278436578810215, 0.0310592632740736, 0.02307010255753994, 0.058678578585386276, 0.03711656853556633, -0.05045260861515999, -0.013149086385965347, 0.0013920271303504705, -0.03604469820857048, 0.040033046156167984, -0.008493935689330101, 0.025438185781240463, 0.03601977229118347, 0.03417516127228737, -0.06525935232639313, 0.013959219679236412, -0.04656396806240082, 0.002350944560021162, -0.058728430420160294, 0.005471515469253063, -0.020203478634357452, 0.006848742254078388, -0.008749439381062984, -0.026846570894122124, 0.04828394576907158, -0.014295736327767372, 0.039060886949300766, 0.04382197931408882, -0.061520274728536606, 0.05394241213798523, -0.03990841284394264, 0.011472733691334724, -0.014632253907620907, -0.0015392532804980874, 0.03836292773485184, 0.050627097487449646, -0.0010897850152105093, -0.03240533173084259, 0.020490139722824097, -0.02983783185482025, 0.03198156878352165, 0.0330534391105175, 0.03362676501274109, -0.0022247505839914083, -0.024553271010518074, -0.013809656724333763, 0.003570818342268467, 0.03848756477236748, 0.01726207137107849, -0.06660541892051697, -0.04197736829519272, -0.018059739843010902, -0.05309488996863365, -0.06276663392782211, 0.008780598640441895, 0.029912613332271576, -0.0031844470649957657, 0.07024478912353516, 0.08360575884580612, 0.03290387615561485, 0.02579963020980358, 0.004754859022796154, -0.03965913876891136, 0.029114944860339165, 0.007041927892714739, -0.026597298681735992, -0.05543804541230202, -0.015031088143587112, 0.0709926038980484, 0.01142911147326231, -0.0019708049949258566, 0.08240924775600433, -0.04422081261873245, -0.01625251956284046, -0.05987508222460747, -0.009752758778631687, -0.013959219679236412, 0.016975408419966698, -0.0004786797217093408, -0.03218098729848862, 0.015230505727231503, 0.011416647583246231, 0.006580775137990713, -0.007459457963705063, -0.032455187290906906, -0.00800162460654974, -0.015118333511054516, 0.006340851075947285, 0.004807829391211271, 0.004854567814618349, -0.015517168678343296, -0.025874411687254906, -0.007739888969808817, -0.015778902918100357, -0.021412445232272148, -0.014956306666135788, 0.0028759732376784086, -0.055338334292173386, -0.008363068103790283, 0.025525430217385292, -0.02401733584702015, 0.00977768562734127, 0.010058116167783737, 0.025051813572645187, 0.011528819799423218, -0.08769381046295166, -0.005075796507298946, 0.035596009343862534, 0.002438189694657922, 0.04990421235561371, -0.041628386825323105, 0.047810327261686325, -0.03950957581400871, 0.037016861140728, 0.050078701227903366, 0.015928465873003006, -0.015978321433067322, -0.0038138581439852715, -0.005630426574498415, 0.013747339136898518, 0.002065839944407344, 0.02460312470793724, 0.0069858417846262455, -0.02943899668753147, -0.023568646982312202, 0.04422081261873245, -0.03709164261817932, 0.0016046870732679963, -0.018184376880526543, 0.0004479102208279073, -0.044046323746442795, -0.009310301393270493, -0.027943367138504982, -0.03614440932869911, 0.011354329995810986, -0.0446695014834404, -0.022347215563058853, 0.03876176103949547, 0.04289967194199562, 0.021836208179593086, -0.031832005828619, 0.013074304908514023, 0.014756889082491398, -0.014731962233781815, 0.002086093183606863, -0.014545008540153503, -0.06909813731908798, -0.011746932752430439, -0.01793510466814041, -0.010756077244877815, -0.01081839483231306, 0.0021188100799918175, -0.05149954929947853, 0.038263216614723206, 0.024702833965420723, 0.06122114881873131, -0.018807556480169296, 0.038537416607141495, 0.019667543470859528, -0.025650065392255783, 0.07757338136434555, 0.031682442873716354, 0.015903539955615997, 0.043099090456962585, -0.003164193592965603, 0.019019436091184616, -0.010076811537146568, 0.008481472730636597, 0.035446446388959885, -0.04005797579884529, 0.002023775363340974, -0.04120462387800217, -0.025749774649739265, -0.028890598565340042, 0.00830698199570179, -0.043099090456962585, 0.019355954602360725, 0.0015618435572832823, -0.03484819456934929, -0.05149954929947853, -0.06859959661960602, 0.03400067239999771, 0.03955943137407303, 0.042525764554739, -0.0029601023998111486, 0.008400458842515945, -0.028815817087888718, -0.007104245945811272, 0.015105869621038437, 0.016564110293984413, 0.0071541001088917255, -0.0486578531563282, 0.0076838028617203236, 0.044320523738861084, 0.006611933931708336, -0.028043074533343315, 0.0014372075675055385, -0.01808466762304306, 0.015866149216890335, -0.02717062458395958, -0.01833393983542919, -0.026921352371573448, 0.014034001156687737, -0.03444936126470566, -0.03587020933628082, 0.012625616043806076, 0.007702498231083155, -0.011341866105794907, 0.05713309347629547, 0.023169811815023422, -0.03013695776462555, -0.0017729455139487982, 0.02151215448975563, 0.04800974577665329, -0.020577386021614075, -0.022409532219171524, -0.037315987050533295, -0.00722888158634305, -0.02092636562883854, -0.05389256030321121, 0.014744426123797894, 0.007278736215084791, -0.010587818920612335, 0.04098027944564819, -0.00760278943926096, 0.03412530571222305, -0.01594093069434166, 0.03385110944509506, 0.0007154879276640713, -0.01014536153525114, 0.044744282960891724, -0.014096318744122982, 0.0017012798925861716, -0.03290387615561485, 0.03454906865954399, 0.03372647240757942, 0.011503892950713634, -0.00954710878431797, -0.0034929208923131227, -0.017847860231995583, 0.0023057640064507723, 0.0602739155292511, -0.006755265407264233, -0.02184867113828659, 0.011454038321971893, 0.0006695284391753376, 0.04870770499110222, 0.013871974311769009, -0.013485603034496307, 0.044445157051086426, -0.0006477171555161476, 0.003530311631038785, 0.023730672895908356, 0.012245476245880127, 0.013909365050494671, 0.03509746491909027, 0.0028962264768779278, -0.012862423434853554, 0.05309488996863365, -0.06276663392782211, -0.0008241548202931881, 0.02931436151266098, 0.018558284267783165, -0.01539253257215023, -0.004175302106887102, -0.007577862124890089, 0.0018975813873112202, 0.011715773493051529, -0.003820090088993311, -0.0019349722424522042, -0.04980450123548508, -0.000908284040633589, 0.007521776016801596, 0.005346879828721285, -0.029214652255177498, 0.03589513525366783, -0.0048452201299369335, -0.0024194943252950907, -0.011771859601140022, 0.043772123754024506, 0.07717454433441162, -0.04048173874616623, -0.004408994689583778, -0.06196896359324455, -0.007141636684536934, -0.06336488574743271, 0.04534253850579262, 0.01176562812179327, -0.018620602786540985, -0.002475580433383584, 0.02542572095990181, -0.023693282157182693, -0.008693353272974491, 0.019630152732133865, -0.013198941014707088, -0.015068478882312775, 0.005695860367268324, 0.01802234910428524, 0.006060420069843531, -0.006749033462256193, -0.001238569151610136, 0.0310592632740736, 0.06401299685239792, 0.0434480719268322, -0.05474008247256279, -0.028317274525761604, -0.02717062458395958, -0.03876176103949547, 0.0013943640515208244, 0.02839205600321293, 0.0045803687535226345, 0.03120882622897625, -0.0063875894993543625, 0.005082028452306986, -0.0017589239869266748, -0.01066260039806366, -0.0013273722724989057, 0.03120882622897625, 0.013747339136898518, -0.00578310526907444, 0.020801730453968048, -0.023032711818814278, -0.03143317252397537, -0.021823745220899582, -0.05488964542746544, 0.0034866889473050833, -0.01405892800539732, 0.02536340430378914, -0.05100100487470627, -0.009048565290868282, -0.005736366845667362, -0.008768134750425816, 0.03118390031158924, 0.06171969324350357, 0.07777279615402222, 0.047162219882011414, 0.02429153583943844, -0.019380880519747734, -0.05174882337450981, -0.01017652079463005, -0.0005121756112203002, 0.02401733584702015, 0.008606107905507088, 0.024303998798131943, 0.03128360956907272, 0.0026313753332942724, 0.014707035385072231, 0.004814061336219311, -0.025413258001208305, 0.03791423887014389, -0.001673236838541925, 0.011609832756221294, -0.015990784391760826, 0.017124971374869347, 0.026846570894122124, -0.06321532279253006, 0.0023898931685835123, 0.028940454125404358, -0.02986275963485241, -0.0009690440492704511, 0.018508430570364, -0.004141027573496103, 0.06835032254457474, 0.015704121440649033, 0.01833393983542919, -0.009952175430953503, -0.044594720005989075, 0.013074304908514023, 0.006019913591444492, -0.020702021196484566, 0.03911074250936508, -0.014769352972507477, -0.0020736295264214277, 0.037465550005435944, 0.027195550501346588, -0.014844134449958801, 0.0022855105344206095, -0.01479427982121706, -0.014071391895413399, -0.05194823816418648, -0.0113979522138834, -0.0052752140909433365, -0.00989608932286501, 0.02714569680392742, -0.030485939234495163, -0.06286634504795074, -0.014607326127588749, -0.038786690682172775, -0.032205913215875626, 0.06276663392782211, 0.017174825072288513, -0.0746818259358406, 0.008755670860409737, -0.03041115775704384, 0.03158273547887802, 0.010413328185677528, 0.0498792827129364, 0.006007449701428413, 0.029663341119885445, 0.011921422556042671, 0.014507617801427841, 0.0034617618657648563, -0.001816568081267178, -0.04451993852853775, -0.012937205843627453, -0.04382197931408882, 0.018583212047815323, 0.04120462387800217, -0.020178550854325294, -0.022434459999203682, -0.022596487775444984, -0.030062176287174225, -0.02123795635998249, -0.036917150020599365, 0.01661396399140358, 0.028317274525761604, -0.040556520223617554, 0.012525906786322594, -0.03726613149046898, 0.0018227999098598957, 0.06226808950304985, -0.0001857853785622865, 0.017324388027191162, -0.00045336305629462004, 0.028466837480664253, 0.0046613821759819984, -0.025749774649739265, 0.029214652255177498, -0.009335228241980076, 0.01559195015579462, 0.045541953295469284, 0.01230156235396862, -0.009603194892406464, 0.02227243408560753, 0.02879089117050171, -0.057631634175777435, -0.032754313200712204, 0.02022840455174446, -0.0026952510233968496, 0.0038076264318078756, 0.008861611597239971, 0.04357270896434784, -0.0133858947083354, 0.0455918088555336, -0.023556184023618698, 0.005265866406261921, 0.010195216163992882, 0.040805790573358536, 0.03975884988903999, 0.042824890464544296, -0.006767728831619024, -0.04706251248717308, -0.05204794928431511, 0.038138583302497864, -0.009472327306866646, 0.010363474488258362, 0.04658889397978783, -0.01323633175343275, 0.01949305273592472, 0.018034813925623894, -0.053992267698049545, -0.037066712975502014, 0.01817191205918789, 0.0005503453430719674, -0.005390502046793699, 0.007372213061898947, -0.007166563533246517, 0.02466544322669506, -0.022259969264268875, -0.056534841656684875, 0.023394156247377396, -0.017361778765916824, 0.03654324263334274, 0.006216214969754219, -0.01945566199719906, -0.00901117455214262, 0.0227959044277668, 0.015517168678343296, -0.019717397168278694, 0.02365589141845703, -0.0038076264318078756, 0.023755600675940514, -0.008774366229772568, -0.0030255361925810575, -0.02557528391480446, -0.014669644646346569, -0.010768541134893894, 0.004870147444307804, 0.020614776760339737, -0.0028884366620332003, 0.006418748293071985, -0.002188917715102434, -0.002980355639010668, -0.001259601442143321, 0.0155296316370368, 0.007384676486253738, 0.002760685048997402, 0.02144983597099781, -0.0553881898522377, 0.0051910849288105965, -0.004829640965908766, -0.02414197288453579, -0.019754787907004356, -0.005723903421312571, -0.016726136207580566, 0.010805931873619556, -0.00074392044916749, -0.02420428954064846, 0.017324388027191162, 0.008980016224086285, 0.036767587065696716, -0.05459051951766014, 0.00148784089833498, 0.02594919316470623, 0.014407908543944359, 0.004200229421257973, -0.024615587666630745, -0.03631889820098877, 0.0008514189394190907, 0.0172869972884655, -0.011354329995810986, -0.0042625474743545055, 0.021075928583741188, 0.012008667923510075, 0.0037110336124897003, -0.013734875246882439, 0.03552122786641121, 0.005262750666588545, -0.029538705945014954, 0.0856996402144432, 0.03203142434358597, -0.04723700135946274, -0.03739076852798462, 0.016314838081598282, -0.019380880519747734, -0.0041939979419112206, -0.015953393653035164, -0.010375937446951866, 0.04414603114128113, -0.010980421677231789, -0.012606920674443245, -0.01842118427157402, 0.0018820019904524088, -0.003947841934859753, -0.04601557180285454, -0.06171969324350357, 0.008057710714638233, 0.0006948451045900583, -0.030984481796622276, 0.04763583838939667, -0.007702498231083155, 0.0209637563675642, -0.009846235625445843, 0.007995392195880413, -0.013498066924512386, -0.011242156848311424, 0.017324388027191162, 0.018284084275364876, -0.023917626589536667, 0.0021110204979777336, 0.005007246974855661, 0.01741163432598114, -0.03522210195660591, 0.010195216163992882, -0.017311925068497658, -0.011441574431955814, -0.010375937446951866, 0.0013709948398172855, 0.008101332932710648, 0.00944116897881031, 0.030909700319170952, 0.014906452037394047, 0.019318563863635063, 0.004773554392158985, -0.0013959219213575125, -0.025139059871435165, -0.02199823409318924, -0.04137911647558212, -0.03392589092254639, 0.022621413692831993, -0.025450648739933968, 0.04509326443076134, 0.042027223855257034, -0.052945327013731, 0.01930609904229641, 0.022222578525543213, -0.009565804153680801, -0.012426198460161686, -0.029139870777726173, -0.0062380265444517136, -0.022933004423975945, -0.00181501021143049, -0.022446922957897186, 0.01392182894051075, -0.013996610417962074, 0.00313303479924798, 0.03170736879110336, 0.009322764351963997, -0.013610239140689373, -0.0037297289818525314, -0.00325922854244709, -0.022421997040510178, 0.020577386021614075, 0.004275010898709297, -0.0037889310624450445, 0.014470227062702179, -0.026198463514447212, -0.009721599519252777, 0.01976725272834301, 0.016850773245096207, -0.0020549341570585966, 0.03494790196418762, 0.028217565268278122, -0.04287474602460861, -0.03656816855072975, -0.008095101453363895, 0.04200229421257973, 0.006792656145989895, -0.004954276606440544, -0.012151999399065971, -0.04347299784421921, -0.0480346716940403, -0.019742324948310852, -0.01768583245575428, -0.025849483907222748, 0.02151215448975563, -0.003405675757676363, -0.0048576840199530125, -0.010905640199780464, 0.03158273547887802, 0.014831670559942722, 0.03337749093770981, 0.04531760886311531, 0.021474763751029968, -0.03858727216720581, 0.04272518306970596, 0.03796409070491791, 0.006013681646436453, -0.044744282960891724, 0.0015431480715051293, -0.01405892800539732, -0.025512967258691788, 0.016651354730129242, 0.029488852247595787, -0.012613152153789997, 0.01642701029777527, -0.02973812259733677, 0.051848530769348145, 0.06157013028860092, -0.05464037507772446, -0.009572036564350128, 0.006505993660539389, 0.01083085872232914, 0.000516849453561008, 0.005917089059948921, -0.013323577120900154, 0.008631035685539246, -0.017274534329771996, 0.008749439381062984, -0.00020370178390294313, 0.00017439287330489606, 0.04369734227657318, -0.0021188100799918175, -0.04706251248717308, -0.012999523431062698, -0.0022621413227170706, -0.014968770556151867, 0.016589036211371422, -0.019866960123181343, -0.002600216306746006, -0.016053102910518646, 0.04369734227657318, 0.00620998302474618, -0.02931436151266098, -0.013946755789220333, 0.018583212047815323, -0.03552122786641121, 0.03205635026097298, -0.034374579787254333, -0.04825901612639427, 0.0012074102414771914, 0.001695048063993454, 0.015629339963197708, -0.029912613332271576, 0.0016654471401125193, 0.0002210339589510113, -0.012407503090798855, -0.0327293835580349, -0.004003928042948246, -0.023506328463554382, 0.007390908431261778, 0.023830382153391838, 0.003530311631038785, 0.006004333961755037, -0.019268708303570747, -0.0029242695309221745, 0.007577862124890089, -0.037166424095630646, -0.012999523431062698, -0.008930161595344543, -0.035296883434057236, 0.010805931873619556, -0.03432472422719002, 0.02365589141845703, -0.0324302576482296, 0.010058116167783737, -0.021287810057401657, -0.029887687414884567, -0.019318563863635063, -0.03818843513727188, -0.0003672863822430372, 0.05738236382603645, -0.02353125624358654, 0.0036580634769052267, -0.05907741189002991, 0.008849148638546467, -0.033801253885030746, 0.007870756089687347, 0.04668860509991646, 0.005885929800570011, 0.015654267743229866, -0.0055276015773415565, -0.026697007939219475, 0.0012837497051805258, -0.05179867520928383, -0.005053985398262739, -0.02943899668753147, 0.007322358433157206, -0.005929552484303713, -0.021013611927628517, 0.0030862961430102587, -0.004729932174086571, -0.0008296076557599008, 0.029414070770144463, -0.011603601276874542, 0.01930609904229641, 0.007253808900713921, 0.0357954278588295, 0.02227243408560753, -0.007559166755527258, 0.026048900559544563, -0.01655164547264576, 0.03587020933628082, -0.011042740195989609, 0.021375054493546486, 0.0047455113381147385, 0.029364215210080147, 0.002667207969352603, 0.011478965170681477, 0.008176114410161972, -0.027893511578440666, -0.03424994274973869, -0.02702106162905693, -0.010855786502361298, -0.06859959661960602, -0.022770976647734642, 0.02221011556684971, -0.009796380996704102, 0.0059420159086585045, -0.013398358598351479, 0.014245882630348206, -0.10878220200538635, -0.010949263349175453, 0.02702106162905693, -0.018807556480169296, 0.007976696826517582, -0.032081279903650284, 0.01357284840196371, 0.0104818781837821, 0.012095913290977478, -0.04299938306212425, 0.006300344131886959, -0.02866625413298607, -0.04526775702834129, -0.015429923310875893, 0.026572370901703835, -0.016514254733920097, 0.007540471386164427, -0.01869538426399231, 0.031807079911231995, -0.028691181913018227, -0.02304517664015293, -0.031682442873716354, -0.04033217579126358, 0.008188578300178051, 0.007422067224979401, 0.003182888962328434, 0.01352299377322197, 0.026971206068992615, 0.012762715108692646, 0.028416983783245087, 0.006599470507353544, -0.04531760886311531, -0.00017604819731786847, 0.013311113230884075, -0.007515544071793556, 0.0327293835580349, 0.021350128576159477, 0.03836292773485184, 0.020128697156906128, 0.03295372799038887, -0.01289981510490179, -0.011815482750535011, 0.008780598640441895, -0.014470227062702179, 0.02809293009340763, 0.010824627242982388, -0.004555441904813051, 0.002914921846240759, -0.040033046156167984, -0.010101739317178726, -0.0005071123014204204, -0.019081754609942436, -0.008612340316176414, -0.020278260111808777, 0.05608614906668663, 0.0486578531563282, -0.02931436151266098, -0.011697078123688698, -0.008593644946813583, 0.018732775002717972, 0.007858293130993843, 0.037714820355176926, 0.01648932881653309, -0.011186070740222931, -0.005817380268126726, -0.010868249461054802, 0.018059739843010902, 0.021138247102499008, -0.004165954422205687, -0.03375139832496643, 0.01505601592361927, 0.022446922957897186, 0.022135334089398384, -0.009584499523043633, -0.00011334076407365501, 0.002871299395337701, -0.0049262335523962975, -0.0053593432530760765, 0.0012120840838178992, -0.0267717894166708, -0.004200229421257973, -0.0005628089420497417, 0.025326013565063477, 0.020664630457758904, -0.007739888969808817, -0.014021537266671658, -0.01743656024336815, -0.005804916378110647, 0.006100927013903856, -0.0024896019604057074, -0.012525906786322594, -0.0206521674990654, 0.009198128245770931, -0.012663006782531738, -0.021686645224690437, 0.01063144113868475, 0.025999046862125397, -0.007247576955705881, 0.06102173030376434, 0.012588225305080414, 0.03011203184723854, 0.027519604191184044, -0.013286185450851917, 0.002847930183634162, -0.02212287113070488, 0.027519604191184044, 0.013560384511947632, -0.016638891771435738, -0.023630965501070023, -0.004571021068841219, 0.01734931580722332, -0.0021530850790441036, -0.01749887876212597, -0.000700687407515943, -0.023842845112085342, 0.01540499646216631, 0.007658875547349453, 0.006181939970701933, -0.016352228820323944, 0.003122129011899233, -0.02637295424938202, 0.013410821557044983, -0.01860813796520233, 0.0410052090883255, -0.01976725272834301, 0.005119419191032648, -0.013161550275981426, 0.0034524141810834408, 0.008543790318071842, 0.00544658862054348, 0.0070543913170695305, 0.0364186055958271, -0.029488852247595787, 0.059526100754737854, 0.006755265407264233, -0.0007961117662489414, 0.03200649842619896, -0.025774702429771423, 0.003938494250178337, -0.007278736215084791, 0.023506328463554382, -0.03998319432139397, 0.016813382506370544, 0.00030048933695070446, -0.006172592286020517, 0.005483979359269142, 0.04317387193441391, -0.03038622997701168, -0.03761511296033859, 0.004275010898709297, -0.008014087565243244, 0.041354186832904816, 0.0002539456181693822, 0.011404183693230152, -0.023668356239795685, 0.05100100487470627, -0.002724852180108428, -0.0357954278588295, -0.02169910818338394, -0.016227593645453453, -0.019044363871216774, 0.02622339129447937, -0.008026551455259323, -0.031956642866134644, 0.0013040030607953668, -0.025288622826337814, -0.009036102332174778, 0.0002730304840952158, -0.02475268766283989, -0.03340241685509682, -0.034623850136995316, 0.004916885867714882, 0.01833393983542919, 0.04384690523147583, 0.06361415982246399, 0.057083237916231155, 0.06117129325866699, 0.002411704510450363, -0.042575620114803314, 0.03420008718967438, -0.009360155090689659, 0.02098868414759636, 0.027394969016313553, 0.01017652079463005, 0.03385110944509506, -0.010718686506152153, -0.0012338953092694283, 0.034349650144577026, -0.0001795535790733993, 0.008755670860409737, 0.02374313771724701, 0.02548803947865963, 0.005349995568394661, 0.03883654251694679, -0.0009877394186332822, 0.009497255086898804, 0.009322764351963997, 0.0006648545968346298, 0.009696672670543194, 0.006580775137990713, -0.02849176526069641, 0.01713743433356285, 0.01817191205918789, -0.021038537845015526, -0.0073348223231732845, 0.050228264182806015, -0.006029261276125908, -0.009491022676229477, -0.027619313448667526, 0.01031361985951662, 0.014495153911411762, 0.017374243587255478, 0.010886944830417633, 0.011940117925405502, -0.021611863747239113, 0.00759655749425292, -0.02502688765525818, 0.006035493221133947, -0.018097130581736565, -0.009285373613238335, -0.027345113456249237, -0.014731962233781815, 0.012289098463952541, 0.029787978157401085, -0.04240113124251366, 0.011852873489260674, -0.009653049521148205, 0.018321475014090538, 0.03230562433600426, 0.005536949262022972, -0.01119853463023901, 0.03564586490392685, -0.0015610645059496164, -0.01602817513048649, 0.005300141405314207, -0.047735545784235, 0.008219736628234386, -0.020976221188902855, 0.02454080618917942, -0.005552528891712427, -0.016589036211371422, -0.01820930279791355, -0.011348097585141659, -0.03467370569705963, -0.0009246424888260663, 0.0009347691666334867, 0.0005149019998498261, 0.03350212797522545, 0.014183564111590385, 0.003033326007425785, -0.011958813294768333, -0.0005445030401460826, -0.003739076666533947, -0.013610239140689373, -0.0041939979419112206, -0.022957930341362953, 0.00830698199570179, 0.002808981342241168, -0.022995321080088615, 0.013597775250673294, 0.001774503500200808, 0.03038622997701168, 0.01787278614938259, -0.010500573553144932, -0.004181534051895142, 0.011803018860518932, -0.007496848702430725, -0.0028588357381522655, 0.03200649842619896, 0.01867045648396015, -0.0379391647875309, 0.02120056562125683, 0.00884291622787714, 0.03350212797522545, -0.01425834558904171, 0.0031299188267439604, -0.044694431126117706, 0.0074843852780759335, -0.018034813925623894, -0.051449693739414215, -0.030834918841719627, 0.026597298681735992, -0.039783775806427, 0.04678831249475479, 0.020053915679454803, -0.044744282960891724, 0.003754656296223402, -0.029887687414884567, -0.03444936126470566, 0.038662053644657135, 0.02607382833957672, -0.006297228392213583, 0.021287810057401657, -0.007995392195880413, -0.020789265632629395, 0.00722888158634305, 0.014769352972507477, -0.009428705088794231, -0.020976221188902855, -0.014358054846525192, 0.01905682682991028, -0.007378444541245699, -0.010064348578453064, 0.034648776054382324, 0.01903190091252327, -0.000741973053663969, -0.031034337356686592, -0.0700453668832779, -0.0002385608822805807, 0.02230982482433319, -0.005399849731475115, -0.0002208392252214253, 0.001733996788971126, 0.008444081991910934, 0.006094695068895817, 0.04267532750964165, -0.006792656145989895, 0.004088057205080986, -0.025350939482450485, 0.011011580936610699, -0.010400865226984024, 0.02022840455174446, 0.0004377835721243173, 0.010930567979812622, 0.011740701273083687, -0.0005308709805831313, 0.0034804572351276875, 0.02417936362326145, 0.017374243587255478, -0.002869741292670369, 0.01554209552705288, 0.016975408419966698, 0.01713743433356285, 0.007010768633335829, -0.03238040581345558, 0.017212215811014175, -0.03452414274215698, 0.001158334780484438, 0.007216418161988258, -0.010855786502361298, 0.01793510466814041, -0.0016046870732679963, -0.022297360002994537, 0.00944116897881031, 0.021923452615737915, -0.01793510466814041, -0.021100856363773346, -0.01600324921309948, -0.008793062530457973, 0.01122969388961792, 0.0682506114244461, -0.005568108521401882, -0.0038294377736747265, 0.036393679678440094, 0.015018625184893608, -0.0031548459082841873, 0.01814698614180088, 0.0069858417846262455, -0.001321140443906188, -0.05244678258895874, -0.015866149216890335, 0.013672556728124619, 0.005633542314171791, 0.0006099368911236525, 0.01566673070192337, -0.014694571495056152, 0.01266923826187849, 0.01823423057794571, 0.008082637563347816, 0.024279071018099785, 0.04918132349848747, 0.0670042559504509, 0.0050259423442184925, -0.01052550133317709, 0.03120882622897625, 0.0013912480790168047, -0.00800162460654974, 0.0048576840199530125, 0.004141027573496103, 0.03130853548645973, 0.0010243512224406004, -0.045666590332984924, -0.012426198460161686, -0.006010565906763077, -0.021686645224690437, 0.027768876403570175, -0.0007189933094196022, -0.013909365050494671, -0.0017059537349268794, 0.039185523986816406, 0.017062652856111526, -0.0024896019604057074, -0.016302375122904778, -0.009266678243875504, -0.006197519600391388, 0.001448892173357308, 0.030585646629333496, -0.004418342374265194, 0.0036861065309494734, -0.0192811731249094, 0.03447428718209267, 0.01539253257215023, 0.033302709460258484, -0.01789771392941475, 0.0002936733071692288, -0.0014675876591354609, 0.01827162131667137, 0.05459051951766014, 0.010762308724224567, 0.02634802646934986, -0.03345227241516113, 0.01762351579964161, 0.012295330874621868, 0.026946280151605606, 0.006166360806673765, -0.028691181913018227, -0.009247982874512672, -0.020864048972725868, -0.019592761993408203, 0.0144577631726861, -0.01961768977344036, 0.015305287204682827, 0.005920204799622297, 0.01688816398382187, 0.026721935719251633, 0.023419084027409554, -0.021861135959625244, -0.025051813572645187, 0.037315987050533295, 0.017386706545948982, 0.007216418161988258, 0.00921059213578701, -0.03178215026855469, 0.027768876403570175, -0.03567079082131386, 0.0052907937206327915, 0.02971319667994976, 0.013959219679236412, -0.008855380117893219, 0.03694207966327667, 0.023144884034991264, 0.04167824238538742, 0.014881525188684464, 0.012195621617138386, 0.024528343230485916, -0.006356430239975452, -0.010625209659337997, -6.660230428678915e-05, -0.038811616599559784, 0.01719975285232067, -0.002664092229679227, -0.010413328185677528, -0.002062723971903324, 0.016663817688822746, 0.01985449716448784, 0.013560384511947632, 0.012924741953611374, 0.0031299188267439604, -0.03539659455418587, 0.010251302272081375, -0.021001147106289864, -0.005680280737578869, 0.006300344131886959, -0.017511341720819473, -0.000464268698124215, -0.007976696826517582, -0.031931716948747635, 0.002950754715129733, -0.03768989443778992, -0.005150577984750271, 0.008724512532353401, -0.030710283666849136, -0.02058984898030758, -0.002435073722153902, -0.008120028302073479, 0.02056492120027542, 0.0249396413564682, -0.03811365365982056, -0.013398358598351479, -0.02169910818338394, 0.00792684219777584, 0.021125784143805504, -0.0035334276035428047, -0.005237823352217674, -0.008288286626338959, 0.03066042810678482, 0.011223461478948593, 0.002125042024999857, -0.013697484508156776, -0.038013946264982224, -0.011204766109585762, 0.01405892800539732, -0.01485659833997488, -0.02169910818338394, 0.010756077244877815, -0.011753164231777191, 0.003897987538948655, 0.019443199038505554, 0.010033189319074154, 0.041628386825323105, 0.011678382754325867, -0.015317751094698906, 0.014358054846525192, 0.01961768977344036, -0.016177738085389137, -0.0728372111916542, 0.008039015345275402, -0.014183564111590385, 0.008755670860409737, -0.03210620582103729, 0.0020097538363188505, -0.006091579329222441, 0.00532506825402379, -0.01848350279033184, -0.0002808202407322824, 0.00760278943926096, -0.008375531993806362, 0.0029601023998111486, 0.02759438566863537, -0.01358531229197979, 0.019742324948310852, 0.005670933052897453, 0.018134521320462227, 0.013697484508156776, 0.023568646982312202, -0.00827582273632288, 0.008786830119788647, -0.02227243408560753, 0.006163244601339102, -0.001839937292970717, -0.03390096127986908, -0.014744426123797894, 0.005864118691533804, 0.012070986442267895, 0.010924335569143295, 0.018122058361768723, -0.006110274698585272, -0.012525906786322594, -0.0006730338209308684, -0.009995798580348492, 0.00363002042286098, -0.010064348578453064, -0.009472327306866646, 0.008556254208087921, 0.007041927892714739, 0.054939500987529755, 0.004586600698530674, -0.01896958239376545, -0.0038917555939406157, 0.04604049772024155, -0.025924265384674072, -0.01661396399140358, -0.0212628822773695, 0.016601501032710075, -0.008612340316176414, 0.027245406061410904, 0.01029492449015379, -0.0066243973560631275, 0.030710283666849136, -0.007864524610340595, -0.0053437636233866215, -0.007633948232978582, 0.003754656296223402, -0.020664630457758904, 0.05097607895731926, -0.0007369096856564283, -0.012712860479950905, 0.009852467104792595, 0.03347719833254814, -0.010618978179991245, 0.015031088143587112, -0.01500616129487753, 0.02756945975124836, -0.016788454726338387, -0.01519311498850584, -0.005318836774677038, 0.03666787967085838, 0.047685690224170685, -0.03392589092254639, -0.008412922732532024, 0.010868249461054802, -0.04643933102488518, -0.006512225139886141, 0.009840003214776516, 0.01646440103650093, -0.034225016832351685, 0.011684615164995193, -0.03589513525366783, 0.01753626950085163, -0.016663817688822746, -0.010656368918716908, 0.02004145085811615, 0.009827540256083012, 0.007914379239082336, -0.002393009141087532, -0.012949668802320957, 0.050352901220321655, -0.02304517664015293, -0.010089275427162647, 0.007696266286075115, -0.00595136359333992, 0.019941741600632668, -0.0026749977841973305, -0.03400067239999771, -0.002202939474955201, -0.004985435400158167, 0.0267717894166708, -0.01823423057794571, 0.022833295166492462, 0.018657993525266647, -0.011528819799423218, 0.005552528891712427, -0.024528343230485916, 0.004231388680636883, 0.026048900559544563, 0.0011201651068404317, -0.01106143556535244, 0.02212287113070488, -0.033427346497774124, 0.021798817440867424, 0.010668831877410412, 0.015990784391760826, -0.0007166563882492483, -0.006668020039796829, -0.011989972554147243, 0.0249396413564682, 0.001774503500200808, 0.007864524610340595, 0.018408721312880516, -0.015355141833424568, 0.013984146527945995, -0.021487226709723473, -0.04145389795303345, 0.015043552033603191, -0.002511413302272558, 0.01425834558904171, 0.0391605980694294, 0.02422921732068062, -0.008774366229772568, -0.0019116029143333435, 0.03726613149046898, 0.012083449400961399, 0.02916479855775833, -0.010002030059695244, 0.021075928583741188, 0.00927291065454483, 0.028940454125404358, -0.02904016338288784, -0.02132520079612732, -0.01011420227587223, -0.005100723821669817, -0.003950957674533129, 0.047112368047237396, -0.019842034205794334, 0.01572904922068119, 0.029887687414884567, 0.03940986841917038, 0.019605224952101707, -0.010338546708226204, -0.002067397814244032, -0.012712860479950905, -0.0029398491606116295, 0.0019645732827484608, -0.012887351214885712, 0.019106682389974594, 0.01903190091252327, -0.01833393983542919, 0.004502471536397934, 0.013124159537255764, 0.04544224590063095, 0.04703758656978607, 0.012663006782531738, -0.01918146386742592, -0.006088463123887777, 0.024378780275583267, 0.007914379239082336, -0.009173201397061348, 0.01266923826187849, -0.0011692404514178634, -0.01863306574523449, 0.002393009141087532, 0.039459723979234695, 0.05733250826597214, 0.02294546738266945, 0.0035427752882242203, 0.008088869042694569, 0.024004872888326645, 0.009098419919610023, 0.03352705389261246, 0.01783539541065693, -0.022870685905218124, 0.0045959483832120895, 0.019480589777231216, 0.02037796750664711, 0.011055203154683113, 0.04319879785180092, -0.0023649660870432854, -0.0070855505764484406, -0.028840744867920876, 0.012127072550356388, -0.0003694285696838051, 0.005328184459358454, 0.0177481509745121, 0.009684208780527115, -0.015604413114488125, 0.0063751256093382835, 0.01304937805980444, 0.001673236838541925, -0.004197113681584597, 0.011491429060697556, -0.022696195170283318, -0.0015727491118013859, 0.012600688263773918, -0.016775991767644882, -0.0198918879032135, -0.008942625485360622, 0.015043552033603191, -0.0004377835721243173, 0.003218721831217408, -0.01337343081831932, 0.02090143971145153, -0.03385110944509506, -0.0023073218762874603, -0.010288693010807037, -0.020465213805437088, -0.06221823766827583, -0.014632253907620907, -0.020178550854325294, 0.01084955409169197, -0.005346879828721285, 0.019069291651248932, -0.020240869373083115, 0.0033776327036321163, -0.024528343230485916, -0.0018414952792227268, 0.014171101152896881, -0.02435385249555111, 0.016838308423757553, -0.030311448499560356]
metadata : {"source": "pydantic_ai_docs", "crawled_at": "2025-03-16T00:34:56.569458", "url_path": "/graph/", "chunk_size": 3817}
updated_dt: 2025-03-16T00:34:56.570967
---
if __name__ == '__main__':
  print(asyncio.run(main()))
"""
  [
    GraphRunResult(
      output='Order order-1 processed successfully!',
      state=OrderState(order_id='order-1', amount=100, human_approved=False),
    ),
    (
      HumanReview(kind='human-review'),
      OrderState(order_id='order-2', amount=1500, human_approved=True),
    ),
    GraphRunResult(
      output='Order order-2 processed successfully!',
      state=OrderState(order_id='order-2', amount=1500, human_approved=True),
    ),
  ]
  """

```

**How it works:**
  1. **`OrderState`and Node Classes** - We define an `OrderState` dataclass that tracks the order ID, amount, and a `human_approved` flag. - Three node classes (`CheckOrder`, `HumanReview`, `ProcessOrder`) use `pydantic-graph` generics to model a small state machine:
     * `CheckOrder` decides whether we need human review (returns `HumanReview`) or can finalize directly.
     * `HumanReview` loops on itself until someone sets `human_approved=True`.
     * `ProcessOrder` completes the graph with an [`End`](https://ai.pydantic.dev/api/pydantic_graph/nodes/#pydantic_graph.nodes.End) node and a success message.
  2. **Global`STORED_RUNS` for Persistence** - We simulate storing run state with a dictionary of typed-dict entries (`StoredRun`). - For each "run," we store `OrderState`, serialized history (via [`graph.dump_history`](https://ai.pydantic.dev/api/pydantic_graph/graph/#pydantic_graph.graph.Graph.dump_history)), and a serialized node.
  3. **`run_until_interrupted`**- Accepts a starting node, plus the current`state` and `history`. - Calls [`graph.iter`](https://ai.pydantic.dev/api/pydantic_graph/graph/#pydantic_graph.graph.Graph.iter) to begin or continue the graph. - If it encounters a `HumanReview` node, it persists the run and returns that node (thus "interrupting" the workflow). - Otherwise, it continues until the graph ends.
  4. **`begin_run`**- Creates a fresh`OrderState` (initializing the run) and starts from `CheckOrder`. - It either completes immediately if no review is required or returns a `HumanReview` node if it needs sign-off.
  5. **`approve_order`**- Emulates a real "human review" step by flipping`.human_approved` to True in the stored state.
  6. **`resume_run`**- Loads the previously saved state, history, and node. - Calls`run_until_interrupted` to continue from exactly where we left off, typically finalizing or pausing again.
  7. **In`main`** - We run two orders: one small (`order-1`) that finishes immediately, and one large (`order-2`) that pauses. - We call `approve_order("order-2")` to simulate a human approval, and then `resume_run("order-2")`. - This finalizes the second order's workflow.


While this is just a toy example, you can take a similar approach to build a persistent, interruptible workflow that uses `pydantic-graph` to pause execution at any node, store its state, and resume again after external events (like human approval) occur.
## Dependency Injection
As with PydanticAI, `pydantic-graph` supports dependency injection via a generic parameter on [`Graph`](https://ai.pydantic.dev/api/pydantic_graph/graph/#pydantic_graph.graph.Graph) and [`BaseNode`](https://ai.pydantic.dev/api/pydantic_graph/nodes/#pydantic_graph.nodes.BaseNode), and the [`GraphRunContext.deps`](https://ai.pydantic.dev/api/pydantic_graph/nodes/#pydantic_graph.nodes.GraphRunContext.deps) field.
As an example of dependency injection, let's modify the `DivisibleBy5` example [above](https://ai.pydantic.dev/graph/#graph) to use a [`ProcessPoolExecutor`](https://docs.python.org/3/library/concurrent.futures.html#concurrent.futures.ProcessPoolExecutor) to run the compute load in a separate process (this is a contrived example, `ProcessPoolExecutor` wouldn't actually improve performance in this example):
deps_example.py